[
    {
        "title": "Rebasing rewards will get stuck on the contract",
        "content": "##### Description\nThe main problem here is that `stored_balances` does not account for rewards for rebaseable tokens (e.g. stETH):\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L380\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L440\nThis leads to the situation where deposited tokens with accrued rewards cannot be removed from the contract because of the revert on the lines pointed above. The test scenario was sent to the client during the audit. This finding is classified as critical because pools' contracts do not allow upgrades, which means that users' tokens will get stuck on the contract and there will be no possibility to retrieve them.\n\n##### Recommendation\nWe recommend updating work with the `stored_balances` so that it will account for possible token balance rebases.\n\n\n***\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#1-rebasing-rewards-will-get-stuck-on-the-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`get_virtual_price()` can be manipulated",
        "content": "##### Description\n`get_virtual_price()` can be manipulated by directly transferring tokens to the pools. The thing is that directly transferred tokens can be skimmed via the `exchange_received()` function:\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L1629\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L1610\nOne example of an attack that can make a profit for a hacker is:\n1. Directly transfer one of the tokens to a base_pool that was added to a meta_pool.\n2. `get_virtual_price()` increases, because D increases and total_supply remains the same.\n3. The hacker can call `remove_liquidity_one_coin()` in meta_pool. Due to the increased virtual_price of the base_pool LP token, it will cost a lot less to remove coin[0] from meta_pool.\n4. After this, the hacker can call `exchange_received` in the base_pool and return the deposited in (1) funds.\nThe test scenario was sent to the client during the audit.\nThis finding is classified as critical because many protocols rely on the virtual_price of the pool (even Curve relies on it), and manipulation of the virtual_price is very dangerous.\n\n##### Recommendation\nWe recommend updating the design of the exchange_received() and _balances() functions so that they work with donations correctly.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#2-get_virtual_price-can-be-manipulated",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Read-only reentrancy in meta_pool with an old base_pool",
        "content": "##### Description\nOld base pools cannot be added to CurveStableSwapFactory. Using an old base pool in meta_pool can lead to read-only reentrancy attacks because of the possible manipulation of the virtual price of a base pool LP token. There is a possible read-only reentrancy attack with a call to `get_virtual_price` in a metapool (At the line https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L457). Virtual price can be incorrectly increased, and that rate can be used during a swap from base pool LP to the second coin in metapool. It will work with old base pools that use ETH (new ones have a reentrancy lock on the `get_virtual_price` function).\nThis issue has been assigned a CRITICAL severity level because working with old base pools that contain ETH will lead to rate manipulation and funds loss (exchanging tokens using manipulated prices).\n\n##### Recommendation\nWe recommend adding checks to the `CurveStableSwapFactoryNG` contract when base pools are added. It shouldn't be possible to add pools paired with ETH.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#3-read-only-reentrancy-in-meta_pool-with-an-old-base_pool",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Addresses for oracles should be whitelisted",
        "content": "##### Description\nThe current implementation of the Pools Factory allows users to create pools with user-supplied oracles to determine prices of assets:\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapFactoryNG.vy#L531\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapFactoryNG.vy#L657\nThis allows malicious users to create pools with oracles that can change their returned values. This could lead to imbalanced pools where a malicious user can steal assets via swaps or liquidity removes. However, the pools created by malicious users should not accumulate any liquidity since these pools will not be accepted by the community and LPs in these pools will not be rewarded with CRV tokens. \nBut there is one more dangerous scenario that can lead to lost value by Curve users. Let's imagine a situation where a new protocol builds an integration with Curve and deploys a stable pool with some custom mechanics, which is allowed because of the user-supplied oracles. But developers didn't pay enough attention to the security of their price oracle, and a hack took place with the manipulation of the price oracle (flashloan manipulation, donation attack, price control in the pool, etc.) set by that team in the pool. In this case, Curve LPs will lose value.\nIn our opinion, it is impossible to control the quality of price oracles in an automated way (it is impossible to build this type of check inside any function) which is why we recommend adding a whitelist for oracles so the community can assess the quality of new oracles. Moreover, pools with volatile oracles will lead to permanent losses for LPs (if someone decides to create a wETH/wBTC pool with an oracle that sets the price from wETH to wBTC).\n\n##### Recommendation\nWe recommend adding a whitelist for oracles' addresses.\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#1-addresses-for-oracles-should-be-whitelisted",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect storage update",
        "content": "##### Description\n`stored_balances` is increased by `dx_w_fee` for meta_coin in meta_pool here https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L1065 but actually it should be increased by `dx_w_fee` that returned from the `_meta_add_liquidity` because the actual increase in meta_coin balance will be less than `dx_w_fee` from `_transfer_in` due to possible fees on liquidity addition. This finding is classified as HIGH because the current implementation of the meta_pool will become broken after one call of the exchange_underlying() function (exchange_received will not work after this).\n\n##### Recommendation\nWe recommend updating the storage value with the correct value.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#2-incorrect-storage-update",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect work for the base_pool swap",
        "content": "##### Description\nMeta_pool incorrectly updates `stored_balances` when a user tries to swap tokens in base_pool from the meta_pool. https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L1087-L1089 In the case of swap base_pool tokens from meta_pool, `stored_balances` shouldn't be updated in `_transfer_in`. Because of this update, the pool will become broken and always revert on the `exchange_received` call.\n\n##### Recommendation\nWe recommend removing the ability to swap base_pool tokens from meta_pool or correctly updating meta_pool storage in such cases.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#3-incorrect-work-for-the-base_pool-swap",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An incorrect `rate` update",
        "content": "##### Description\n`rate` is fetched before epoch update in the `CRV` contract https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/LiquidityGauge.vy#L237-L238 which can lead to an incorrect rate being saved to the storage. This finding is classified as HIGH severity because an incorrect `rate` update will lead to incorrect CRV distribution to users.\n\n##### Recommendation\nWe recommend fetching `rate` after the epoch update in the `CRV` contract.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#4-an-incorrect-rate-update",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect rewards distribution",
        "content": "##### Description\nSome of the rewards will be blocked on the contract if they were deposited to the empty gauge (when totalSupply == 0) https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/LiquidityGauge.vy#L318 This happens because `last_update` will be updated nevertheless totalSupply is zero. This finding is classified as HIGH severity since the reward distributor will block some rewards on the contract without a possibility ti retrieve them.\n\n##### Recommendation\nWe recommend updating `last_update` only if totalSupply > 0.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#5-incorrect-rewards-distribution",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Meta_pool doesn't allow base_pools with len(coins) > 3",
        "content": "##### Description\nThe current implementation of the meta_pool doesn't allow base_pools with more than 3 tokens https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L64-L68 but such base_pools can be added in the factory. If meta_pool will be created with base_pool with more than 3 tokens, part of the meta_pool functionality will not work.\n\n##### Recommendation\nWe recommend adding a check in the constructor that `BASE_N_COINS < 4`.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#1-meta_pool-doesnt-allow-base_pools-with-lencoins-3",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible DoS of `exchange_received`",
        "content": "##### Description\n`exchange_received` can be DoSed if someone sends 1 wei of one of the base_pool tokens to the meta_pool https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L389.\n\n##### Recommendation\nWe recommend changing the strict check `dx == _dx` to `dx >= _dx`.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#2-possible-dos-of-exchange_received",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect parameters passed to fee calculation",
        "content": "##### Description\n`xs` is calculated using token balances in the following places:\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L700\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L827\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L589\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L712.\n`ys` is calculated using balances * rates (D / N_COINS ~ balance[i] * rate[i] / PRECISION). As `ys` is calculated with `rates` and `xs` is calculated without them, the fees will be higher than they should be and users will pay more (if rates >> PRECISION e.g. if token decimals < 18).\n\n##### Recommendation\nWe recommend multiplying `xs` by `rates`.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#3-incorrect-parameters-passed-to-fee-calculation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An incorrect oracle update",
        "content": "##### Description\nEMA oracle for `D` is updated with the `D2` value here https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L598 but it should be updated with a slightly different value since `D2` accounts for all fees, but the oracle should be updated with the value that accounts only admin fees.\n\n##### Recommendation\nWe recommend calculating the `D3` value that accounts only for admin fees and using this value for the oracle update.\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#4-an-incorrect-oracle-update",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Dynamic fee not used",
        "content": "##### Description\nThe dynamic fee is calculated here but not accounted for:\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L714\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNGViews.vy#L284.\n\n##### Recommendation\nWe recommend using a calculated dynamic fee value.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#5-dynamic-fee-not-used",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Fee-on-transfer tokens cannot be used as rewards",
        "content": "##### Description\n`amount` from transfer is used to update the rate in the liquidity gauge https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/LiquidityGauge.vy#L691. If a fee-on-transfer token is used as a reward token, then some user will not be able to claim rewards until the reward distributor tops up the contract.\n\n##### Recommendation\nWe recommend using the exact transferred value instead of the parameter that is passed to the `transfer` call.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#6-fee-on-transfer-tokens-cannot-be-used-as-rewards",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "LP balance shouldn't be multiplied by virtual_price",
        "content": "##### Description\nLP balance from the `_base_calc_token_amounts` shouldn't be multiplied by a virtual_price.\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNGViews.vy#L116-L118\n\n##### Recommendation\nWe recommend removing multiplication by virtual_price of LP balance that returned from the `_base_calc_token_amounts`.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#7-lp-balance-shouldnt-be-multiplied-by-virtual_price",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Fees applied twice",
        "content": "##### Description\nFees are already accounted for in the `_base_calc_token_amounts`, so there is no need to account them twice. https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNGViews.vy#L184\n\n##### Recommendation\nWe recommend removing fees applying in the `get_dy_underlying` function.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#8-fees-applied-twice",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An incorrect sequence of math operations",
        "content": "##### Description\nIf rates[0] becomes less than 10**18, then `get_dy_underlying` will revert here:\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNGViews.vy#L206.\n\n##### Recommendation\nWe recommend updating implementation like this: dy = dy * 10**18 / rates[0].\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#9-an-incorrect-sequence-of-math-operations",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Admin balances don't account for potential token rebases",
        "content": "##### Description\nAdmin fees (stored in an array https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L208) don't account for potential slashings. If admin fees are withdrawn first (after the slashing event), then LPs are getting unfairly diluted.\nThis issue has been assigned a MEDIUM severity level because admin balances don't account for both rebases up and down while slashings are quite rare events (so that rebases down would be outweighed with rebases up).\n\n##### Recommendation\nWe recommend adding a comment in the `_balances` function that admin balances don't account for token rebases.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#10-admin-balances-dont-account-for-potential-token-rebases",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Rewards `rate` can be set to 0",
        "content": "##### Description\nThere is an issue with a `deposit_reward_token` function defined at the line https://github.com/curvefi/stableswap-ng/blob/86462096e40a878faee369839eb27fcd10e112f5/contracts/main/LiquidityGauge.vy#L680. It is possible to provide quite a big `_epoch` compared to `_amount` being deposited. It can cause the rate to be calculated as 0 here https://github.com/curvefi/stableswap-ng/blob/86462096e40a878faee369839eb27fcd10e112f5/contracts/main/LiquidityGauge.vy#L695 and here https://github.com/curvefi/stableswap-ng/blob/86462096e40a878faee369839eb27fcd10e112f5/contracts/main/LiquidityGauge.vy#L699.\nThis issue has been assigned a MEDIUM severity level as it will lead to a small amount of reward tokens being stuck on a contract.\n\n##### Recommendation\nWe recommend calculating the `rate` value using precision to prevent divisions from leading to zeroes.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#11-rewards-rate-can-be-set-to-0",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`CurveStableSwapNG` and `CurveStableSwapMetaNG` DOS by manual token sent",
        "content": "##### Description\nIn `CurveStableSwapNG` and `CurveStableSwapMetaNG` if 1 wei of any token is sent to an empty pool, `get_D()` fails. Consequently, `add_liquidity()` also fails. This situation can be resolved manually by sending 1 wei of the remaining tokens.\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L991\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L1005\n\n##### Recommendation\nWe recommend considering the scenario of tokens sent to an empty pool when calculating D.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#12-curvestableswapng-and-curvestableswapmetang-dos-by-manual-token-sent",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary approve",
        "content": "##### Description\nThe current implementation of the Factory grants approves tokens to newly created pools, which is unnecessary:\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapFactoryNG.vy#L550-L557\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapFactoryNG.vy#L661.\n\n##### Recommendation\nWe recommend removing approves granting from the Factory to newly created pools.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#1-unnecessary-approve",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unusable constants and parameters",
        "content": "##### Description\nConstants and parameters from the list below are unused and can be removed:\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapFactoryNG.vy#L76\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L920\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L1024\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L315\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L317\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L805\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNGViews.vy#L350\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNGViews.vy#L664.\n\n##### Recommendation\nWe recommend removing unused constants and parameters.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#2-unusable-constants-and-parameters",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect comments",
        "content": "##### Description\nThere are several places in the scope where comments are outdated/incorrect:\n`Integer array` - https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapFactoryNG.vy#L444.\nLength of `base_pool_list` instead of `pool_list` here - https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapFactoryNG.vy#L89.\nduplicated `the` - https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapFactoryNG.vy#L477-L478\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L374\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L1032\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L1038\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L322\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L367.\nFix spelling - https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L488, https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L547\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/LiquidityGauge.vy#L88.\n\n##### Recommendation\nWe recommend correcting the comments.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#3-incorrect-comments",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary checks",
        "content": "##### Description\nThere are several places in the scope with unnecessary checks that can be removed:\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L456\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L1012\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L937\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/LiquidityGauge.vy#L169.\n\n##### Recommendation\nWe recommend removing the unnecessary checks.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#4-unnecessary-checks",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Parameters should be restricted",
        "content": "##### Description\nThere are several places in the scope where input parameters should be restricted for correct work:\n`len(coins)` should be at least greater or equal to 2:\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapFactoryNG.vy#L490\n`_A` and `_ma_exp_time` should be limited:\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapFactoryNG.vy#L519-L533; https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapFactoryNG.vy#L642-L659\n`_burn_amount` can be 0:\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L738-L745\n`_s` should be restricted:\n(https://eips.ethereum.org/EIPS/eip-2) https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L1515; https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L1543; https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/LiquidityGauge.vy#L576\n`i` should be restricted within `N_COINS`:\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L1304; https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L1310; https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L1334\nA possible deposit for 0 address:\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/LiquidityGauge.vy#L418\n0-value transfer https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/LiquidityGauge.vy#L497; https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/LiquidityGauge.vy#L511\n`_distributor` can be zero address https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/LiquidityGauge.vy#L702\n\n##### Recommendation\nWe recommend restricting parameters according to the description.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#5-parameters-should-be-restricted",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Loops can be simplified",
        "content": "##### Description\nSeveral loops can be simplified:\nTh loop can be in range (i, MAX_COINS): https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapFactoryNG.vy#L511.\nThere is no need to get the oracle price for the LP token:\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L463.\n\n##### Recommendation\nWe recommend reducing loop steps to save some gas.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#6-loops-can-be-simplified",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "View functions are vulnerable to the read-only reentrancy",
        "content": "##### Description\nSome of the functions are vulnerable to the read-only reentrancy:\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L1357\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L1539\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L1553\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L1559\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L1573\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L1579\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L1618\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L1315\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L1567\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L1581\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L1595\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L1637.\n\nIf another protocol decides to use these functions as price sources, then it can be attacked via the read-only reentrancy if the pool contains hookable tokens.\n\n##### Recommendation\nWe recommend adding a `nonreentrant` lock for these functions.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#7-view-functions-are-vulnerable-to-the-read-only-reentrancy",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Input parameters are not validated",
        "content": "##### Description\nThe current implementation of the Factory contract doesn't properly validate input parameters for the `add_pool` function https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapFactoryNG.vy#L719-L725 which allows admins to add meta_pool as base_pool by mistake.\n\n##### Recommendation\nWe recommend reading parameters from the pool instead of passing them to the function.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#8-input-parameters-are-not-validated",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`_stored_rates` doesn't account for asset types",
        "content": "##### Description\n`_stored_rates` doesn't account for asset types, so an asset with type 0 and set by a mistake oracle will work as type 1:\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L415\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L479.\n\n##### Recommendation\nWe recommend accounting for asset type or removing type 1.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#9-_stored_rates-doesnt-account-for-asset-types",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`get_virtual_price` is vulnerable to a donation attack",
        "content": "##### Description\nThe current implementation of `get_virtual_price` allows a malicious user to directly transfer some funds to the contract and increase `get_virtual_price`. This behavior can be used in a complex hack if it makes economic sense to lose some value by a direct transfer of funds to the contract and use the manipulated value of `get_virtual_price` in another protocol to steal more assets that were transferred to the protocol.\n\n##### Recommendation\nWe recommend adding this information to the documentation so protocols that will decide to integrate with stable pools will be aware of this risk.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#10-get_virtual_price-is-vulnerable-to-a-donation-attack",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect check",
        "content": "##### Description\nThe check used here https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/LiquidityGauge.vy#L236 leads to the update of `inflation_params` on every call of `_checkpoint`.\n\n##### Recommendation\nWe recommend changing this check to:\n`if prev_future_epoch <= block.timestamp:`.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#11-incorrect-check",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The killed gauge will return the incorrect rate",
        "content": "##### Description\n`rate` is not updated in the killed gauge https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/LiquidityGauge.vy#L242-L243 which will lead to a situation where the killed gauge returns a non-zero rate.\n\n##### Recommendation\nWe recommend updating `self.inflation_params` for the killed gauge.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#12-the-killed-gauge-will-return-the-incorrect-rate",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Rewards duration should be flexible",
        "content": "##### Description\nIn the current implementation of the Liquidity Gauge, rewards can be set for one week only https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/LiquidityGauge.vy#L691. Some of the financial teams of the protocols plan budget for a month, so it will be more convenient for them to set reward duration as one month.\n\n##### Recommendation\nWe recommend giving more flexibility to reward duration.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#13-rewards-duration-should-be-flexible",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An incorrect invariant logged",
        "content": "##### Description\nThere is an issue at the lines:\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L615, https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L733, https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L730, and https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L847. `D1` is logged as an invariant even if it were recalculated to `D2` (accounting for applied fees).\n\n##### Recommendation\nWe recommend logging `D1` or `D2` depending on whether the fees were applied or not.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#14-an-incorrect-invariant-logged",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Weak checks",
        "content": "##### Description\nThere are weak checks at line https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L414 and https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L476. There is no need in these checks because if there weren't a revert on a call to the oracle, the response length would always be equal to 32.\n\n##### Recommendation\nWe recommend introducing more secure checks that can check for the returned value from the oracle.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#15-weak-checks",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The variable can be used instead of reading from the array",
        "content": "##### Description\nThere is an `xp_j` variable defined here - https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L1177. This variable can be used in the following calculations - https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L1181 and https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L1184 instead of reading array member `xp[j]`. The same issue can be found at line https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L1233 and https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L1236.\n\n##### Recommendation\nWe recommend using the `xp_j` value on the mentioned lines instead of accessing the `xp[j]` array member.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#16-the-variable-can-be-used-instead-of-reading-from-the-array",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An unnecessary arithmetic operation",
        "content": "##### Description\nThere is an issue at line https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/LiquidityGauge.vy#L254. There is no need to divide and then multiply the `prev_week_time` value by `WEEK` as it is done inside the GaugeController contract.\n\n##### Recommendation\nWe recommend removing unnecessary arithmetic operations.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#17-an-unnecessary-arithmetic-operation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "It is possible to fire empty events",
        "content": "##### Description\nThere is an issue at line https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/LiquidityGauge.vy#L435 and https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/LiquidityGauge.vy#L436. It is possible to call the `deposit` function with `_value` equal to 0 which will lead to the `Deposit` and `Transfer` events being emitted.\n\n##### Recommendation\nWe recommend emitting the mentioned events only if `_value` isn't equal to 0.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#18-it-is-possible-to-fire-empty-events",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An incorrect argument name inside the function descriptor",
        "content": "##### Description\nThere is an incorrect argument name used at the lines: https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L53, https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L54 and https://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapMetaNG.vy#L56. `dx` should be used instead of `dy`.\n\n##### Recommendation\nWe recommend changing the argument name inside the mentioned declarations.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#19-an-incorrect-argument-name-inside-the-function-descriptor",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`D_oracle()` One Transaction Manipulation By The Only One Liquidity Provider",
        "content": "##### Description\nIf there is only one liquidity provider in `CurveStableSwapNG` or `CurveStableSwapMetaNG` at the moment, it's possible to get two different values of `D_oracle()` in one transaction by the following algorithm:\n1. Use old values based on previous block info.\n1. Remove all liquidity. `total_supply` becomes equal to 0. \n2. Add new liquidity to an empty pool; `last_D_packed` is overwritten and can be used immediately by `D_oracle()`.\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L1340\nhttps://github.com/curvefi/stableswap-ng/blob/8c78731ed43c22e6bcdcb5d39b0a7d02f8cb0386/contracts/main/CurveStableSwapNG.vy#L605\n\n##### Recommendation\nWe recommend not overwriting `last_D_packed` when adding liquidity to an empty pool, but using a general mechanism for the moving average.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#20-d_oracle-one-transaction-manipulation-by-the-only-one-liquidity-provider",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Pools with low liquidity cannot be used as price oracles",
        "content": "##### Description\nThere is a risk of usage pools with low liquidity or with low trading volume as price oracles. Protocols that will be integrated with Curve StablePools and use prices from them as price oracles should be aware of these risks and check pool parameters (liquidity, trading volume) during their usage.\n\n##### Recommendation\nWe recommend adding a warning about the usage of stale pools or pools with low liquidity as price oracles to the documentation.\n\n\n***\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-11-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/README.md#21-pools-with-low-liquidity-cannot-be-used-as-price-oracles",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/StableSwapNG/Curve%20Finance%20StableSwapNG%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The `VestingEscrowSimple` instance can be initialized without supplying a sufficient amount of vesting tokens",
        "content": "##### Description\nThe `VestingEscrowSimple` contract assumes that the contract holds a sufficient amount of vesting tokens. However, the vesting contract can be initialized without supplying the required tokens if the instance is created without involving the original `VestingEscrowFactory` contract https://github.com/banteg/yearn-vesting-escrow/blob/945b5ca09d8bb2d2ad9132df7368cb4992496f6a/contracts/VestingEscrowSimple.vy#L54.\n\nThis may mislead the recipient regarding the actual amount to be distributed. Additionally, it may cause the `claim()` function with default arguments to be reverted https://github.com/banteg/yearn-vesting-escrow/blob/945b5ca09d8bb2d2ad9132df7368cb4992496f6a/contracts/VestingEscrowSimple.vy#L142.\n##### Recommendation\nIt is recommended to perform a check of the vesting token amount during the contract initialization. If support for fee-on-transfer tokens is planned, the `initialize` function can store the actual amount of tokens present on the contract, instead of relying on its argument value.",
        "protocol": "Yearn Finance",
        "report_date": "2023-10-13",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vesting%20Escrow/README.md#1-the-vestingescrowsimple-instance-can-be-initialized-without-supplying-a-sufficient-amount-of-vesting-tokens",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vesting%20Escrow/Yearn%20Finance%20Vesting%20Escrow%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Inaccurate value representation by the `locked` function after the `owner` revocation",
        "content": "##### Description\nhttps://github.com/banteg/yearn-vesting-escrow/blob/945b5ca09d8bb2d2ad9132df7368cb4992496f6a/contracts/VestingEscrowSimple.vy#L127\nA vulnerability was discovered in the internal `_locked` function. If the `owner` revokes access and subsequently someone sends tokens to the contract, then the balance of the contract no longer reflects the remaining tokens available for claim. As a result, the value returned by the `locked` function can be larger than expected.\n\n##### Recommendation\nWe recommend modifying the internal `_locked` function as follows:\n```python\nreturn self._total_vested_at(self.disabled_at) - self._total_vested_at(time)\n```\n\n***\n",
        "protocol": "Yearn Finance",
        "report_date": "2023-10-13",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vesting%20Escrow/README.md#1-inaccurate-value-representation-by-the-locked-function-after-the-owner-revocation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vesting%20Escrow/Yearn%20Finance%20Vesting%20Escrow%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Malfunction of the `collect_dust` function after the `owner` revocation",
        "content": "##### Description\nhttps://github.com/banteg/yearn-vesting-escrow/blob/945b5ca09d8bb2d2ad9132df7368cb4992496f6a/contracts/VestingEscrowSimple.vy#L216\nhttps://github.com/banteg/yearn-vesting-escrow/blob/945b5ca09d8bb2d2ad9132df7368cb4992496f6a/contracts/VestingEscrowSimple.vy#L178\nThe issue was identified in the `collect_dust` function. When a `recipient` attempts to withdraw an amount of `self.token` that exceeds the total value, they can claim via the `collect_dust` call after the `self.owner` has invoked the `revoke` function, so the issue arises. In such a scenario, the `self.token` balance of the contract diminishes below the `self.total_locked` value. Consequently, the residual funds or \"dust\" transferred to the contract cannot be collected.\n\n##### Recommendation\nWe recommend modifying the expression located here https://github.com/banteg/yearn-vesting-escrow/blob/945b5ca09d8bb2d2ad9132df7368cb4992496f6a/contracts/VestingEscrowSimple.vy#L216 to:\n```python\namount = amount +self.total_claimed -self._total_vested_at(self.disabled_at)\n```\n\n***\n",
        "protocol": "Yearn Finance",
        "report_date": "2023-10-13",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vesting%20Escrow/README.md#2-malfunction-of-the-collect_dust-function-after-the-owner-revocation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vesting%20Escrow/Yearn%20Finance%20Vesting%20Escrow%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An unintentionally large vesting period",
        "content": "##### Description\nThe `VestingEscrowSimple` contract can be initialized with an unintentionally large vesting period, i.e., by supplying a value denoted in milliseconds instead of seconds https://github.com/banteg/yearn-vesting-escrow/blob/945b5ca09d8bb2d2ad9132df7368cb4992496f6a/contracts/VestingEscrowFactory.vy#L92.\n##### Recommendation\nWe recommend performing a range check of the vesting period or denoting it in days in order to prevent issues related to specifying time in seconds or milliseconds.",
        "protocol": "Yearn Finance",
        "report_date": "2023-10-13",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vesting%20Escrow/README.md#3-an-unintentionally-large-vesting-period",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vesting%20Escrow/Yearn%20Finance%20Vesting%20Escrow%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Lack of the `target` parameter checks",
        "content": "##### Description\nThe vesting factory constructor doesn't have necessary checks for the `target` parameter:\nhttps://github.com/banteg/yearn-vesting-escrow/blob/945b5ca09d8bb2d2ad9132df7368cb4992496f6a/contracts/VestingEscrowFactory.vy#L51.\nThis may lead to the loss of vesting tokens, transferred to an uncontrolled address or the wrong smart contract.\n\n##### Recommendation\nWe recommend adding a zero address check and a bytecode length check or performing EIP-165 checks. \n",
        "protocol": "Yearn Finance",
        "report_date": "2023-10-13",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vesting%20Escrow/README.md#4-lack-of-the-target-parameter-checks",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vesting%20Escrow/Yearn%20Finance%20Vesting%20Escrow%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Farming can be deactivated by accident",
        "content": "##### Description\nThe current check for farming deactivation can be triggered by accident if `tick` hasn't changed during the swap and `zeroToOne` is false https://github.com/cryptoalgebra/Algebra/blob/6f57b3e218630106a4d41aedefd38f9e83b41e2b/src/farming/contracts/farmings/EternalVirtualPool.sol#L131-L134. This action will disconnect farming from the pool and will affect incentive distribution for users.\n\n##### Recommendation\nWe recommend using this check https://github.com/cryptoalgebra/Algebra/blob/6f57b3e218630106a4d41aedefd38f9e83b41e2b/src/farming/contracts/farmings/EternalVirtualPool.sol#L137-L141 before setting the `deactive` state to the virtual pool.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-09-25",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/README.md#1-farming-can-be-deactivated-by-accident",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/Algebra%20Plugins%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Overflow will entirely block the plugin",
        "content": "##### Description\nOverflow will occur here on the second time of the list initialization https://github.com/cryptoalgebra/Algebra/blob/6f57b3e218630106a4d41aedefd38f9e83b41e2b/src/plugins/contracts/libraries/VolatilityOracle.sol#L72-L74. This will block plugin updates that will affect the pool and further recovery can be executed by admin only.\n\n##### Recommendation\nWe recommend using the `unchecked` block here since overflow is desired.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-09-25",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/README.md#2-overflow-will-entirely-block-the-plugin",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/Algebra%20Plugins%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Manipulation of volatility through zero-amount swaps",
        "content": "##### Description\nSwaps executed with a zero amount are currently factored into the volatility oracle. This vulnerability allows an attacker to artificially manipulate the volatility index, which in turn affects the dynamic fee calculations to their advantage.\n\nThe issue has been categorized with a MEDIUM severity level. This is because the attacker can manipulate the fee only under specific conditions and within a predefined range.\n##### Recommendation\nTo mitigate this issue, it is recommended to exclude zero-amount swaps from volatility calculations.",
        "protocol": "Algebra Finance",
        "report_date": "2023-09-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/README.md#1-manipulation-of-volatility-through-zero-amount-swaps",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/Algebra%20Plugins%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Missing flags validation in new `pluginConfig`",
        "content": "##### Description\nThere is no validation of flags in new `pluginConfig` set with `AlgebraPool.setPluginConfig()`. This can lead to the invocation of hooks that will constantly revert. E.g. `BEFORE_FLASH_FLAG`, `AFTER_FLASH_FLAG`,  `AFTER_SWAP_FLAG` (without currently connected incentive) can be switched on.\nThis issue has a MEDIUM severity since it can partially or fully stop the pool until `pluginConfig` is corrected.\n\n##### Recommendation\nWe recommend moving all interaction with `pluginConfig` to the plugin contract. Any modification of `pluginConfig` should consider the current version and state of the plugin.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-09-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/README.md#2-missing-flags-validation-in-new-pluginconfig",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/Algebra%20Plugins%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Plugin timestamps data can be overwritten by a call to the `prepayTimepointsStorageSlot` function",
        "content": "##### Description\nThere is an issue at the line https://github.com/cryptoalgebra/Algebra/blob/6f57b3e218630106a4d41aedefd38f9e83b41e2b/src/plugins/contracts/AlgebraBasePluginV1.sol#L67.\nPlugin timestamps data can be overwritten by a call to the `prepayTimepointsStorageSlots` function in cases when the\nplugin was configured from AlgebraPool by a call to `setPluginConfig` (and `setPlugin`) and the `initialize` function inside plugin wasn't called. An attacker can wait for some swaps and data in the timepoints array to overwrite the existing timestamps. But due to uninitialized ticks in the first timepoint, users won't be able to perform many swaps from AlgebraPool because the plugin will operate with null initial data.\nThis issue has been assigned a MEDIUM severity level because an attacker is able to overwrite data only for a few timepoints.\n\n##### Recommendation\nWe recommend restricting the `prepayTimepointsStorageSlots` function to be called only by the plugin factory manager.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-09-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/README.md#3-plugin-timestamps-data-can-be-overwritten-by-a-call-to-the-prepaytimepointsstorageslot-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/Algebra%20Plugins%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An incorrect comment",
        "content": "##### Description\nThere is a comment that says that volume is used to calculate volatility, which is wrong https://github.com/cryptoalgebra/Algebra/blob/6f57b3e218630106a4d41aedefd38f9e83b41e2b/src/plugins/contracts/libraries/AdaptiveFee.sol#L36.\n\n##### Recommendation\nWe recommend updating the comment.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-09-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/README.md#1-an-incorrect-comment",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/Algebra%20Plugins%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Farming deactivation can be triggered on the farming entering",
        "content": "##### Description\nFarming deactivation can be triggered on the farming entering, so the user who enters farming and deactivates it will need to exit farming immediately to avoid losing rewards.\n\n##### Recommendation\nWe recommend updating the project architecture to account for this scenario.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-09-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/README.md#2-farming-deactivation-can-be-triggered-on-the-farming-entering",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/Algebra%20Plugins%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "There is no check in `AlgebraEternalFarming._isIncentiveActive()` that the plugin is still connected to the pool",
        "content": "##### Description\nhttps://github.com/cryptoalgebra/Algebra/blob/6f57b3e218630106a4d41aedefd38f9e83b41e2b/src/farming/contracts/farmings/AlgebraEternalFarming.sol#L349\nA plugin with some incentive connected to that plugin can be replaced with another plugin by calling `Algebra.setPlugin()`. `AlgebraEternalFarming._isIncentiveActive()` will still return `true` for that incentive for some time even if there is already another active incentive in the new plugin. So, new users can still enter that old incentive and new rewards can be brought to it.\n\n##### Recommendation\nWe recommend adding a check to `AlgebraEternalFarming._isIncentiveActive()` that `Incentive.pluginAddress` is a current pool's plugin.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-09-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/README.md#3-there-is-no-check-in-algebraeternalfarming_isincentiveactive-that-the-plugin-is-still-connected-to-the-pool",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/Algebra%20Plugins%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`AlgebraBasePluginV1.isIncentiveActive()` returns true for deactivated incentives",
        "content": "##### Description\nThe external view function `AlgebraBasePluginV1.isIncentiveActive()` doesn't check whether the current state of incentive and `EternalVirtualPool` is active or not. It just checks that some incentive is connected to the plugin. So, the result can be misinterpreted.\n\n##### Recommendation\nWe recommend renaming this function.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-09-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/README.md#4-algebrabasepluginv1isincentiveactive-returns-true-for-deactivated-incentives",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/Algebra%20Plugins%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "TODO comments should be resolved",
        "content": "##### Description\nThere are multiple TODO comments - https://github.com/cryptoalgebra/Algebra/blob/6f57b3e218630106a4d41aedefd38f9e83b41e2b/src/farming/contracts/farmings/AlgebraEternalFarming.sol#L169, https://github.com/cryptoalgebra/Algebra/blob/6f57b3e218630106a4d41aedefd38f9e83b41e2b/src/farming/contracts/farmings/AlgebraEternalFarming.sol#L354, https://github.com/cryptoalgebra/Algebra/blob/6f57b3e218630106a4d41aedefd38f9e83b41e2b/src/farming/contracts/FarmingCenter.sol#L87 and https://github.com/cryptoalgebra/Algebra/blob/6f57b3e218630106a4d41aedefd38f9e83b41e2b/src/farming/contracts/FarmingCenter.sol#L115.\n\n##### Recommendation\nWe recommend removing the above-mentioned comments.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-09-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/README.md#5-todo-comments-should-be-resolved",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/Algebra%20Plugins%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The risk of storage overflow in volatility oracle",
        "content": "##### Description\nThe volatility oracle's storage is constrained by a `UINT16_MODULO` capacity, allowing for approximately 45 values to be recorded per minute over a 24-hour period.\n\nhttps://github.com/cryptoalgebra/Algebra/blob/6f57b3e218630106a4d41aedefd38f9e83b41e2b/src/plugins/contracts/libraries/VolatilityOracle.sol#L14-L15\n\nWhile this capacity is sufficient for the Ethereum mainnet, which generates about 5 blocks per minute, it may be insufficient for other EVM-compatible networks with more frequent block generation. An attacker could exploit this limitation to cause the loss of some volatility data by triggering an excessive number of volatility records.\n\nThis issue has been rated as LOW severity due to its limited impact and the complexity involved in reproducing the exploit.\n##### Recommendation\nTo address this issue, it is recommended to adjust the frequency of volatility storage updates in accordance with both the storage capacity and the desired time window for data retention.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-09-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/README.md#6-the-risk-of-storage-overflow-in-volatility-oracle",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Plugins/Algebra%20Plugins%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Bypassing payment fees through various methods",
        "content": "##### Description\n\nSwapExecutor, a contract responsible for executing token swaps, is vulnerable to multiple methods of bypassing payment fees, allowing an attacker to perform swaps without paying the required fees.\n\nThe first method involves specifying a personal transfer of all tokens in the final swap, leaving only 2 wei of `tokenToTransfer` on the contract to avoid paying fees. This enables the attacker to evade payment and execute swaps at no cost.\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapExecutor.sol#L146\n\nThe second method involves passing a swap-path that ends with a poisonous token created by the attacker. The attacker pays fees in their own token, which is worthless, thus bypassing payment fees.\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapFacade.sol#L35\n\nThe third method involves copying the code of SwapExecutor and removing the payment logic, allowing the attacker to continue using the SwapFacade without paying any fees by passing the custom SwapExecutor to `SwapFacade.swap()`.\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapFacade.sol#L29\n\nOverall, these vulnerabilities allow attackers to perform swaps without paying the required fees, leading to potential financial losses for the SwapExecutor owners.\n\n##### Recommendation\n\nOne way to address the vulnerabilities in SwapExecutor is to take a fixed fee in a fixed token, such as Ether, in SwapFacade.\n",
        "protocol": "Barter DAO",
        "report_date": "2023-09-05",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/README.md#1-bypassing-payment-fees-through-various-methods",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/Barter%20DAO%20Security%20Audit%20Report%20(diff).pdf"
    },
    {
        "title": "Hashflow RFQ-integration",
        "content": "##### Description\n\nSince we receive `HashflowQuote` before the call occurred, the information at the time of the transaction may not be up to date. \n\nIn that case, due to this code:\n\n```\nif (amount > quote.maxBaseTokenAmount) {\n    emit AmountExceedsQuote(amount, quote.maxBaseTokenAmount);\n    quote.effectiveBaseTokenAmount = quote.maxBaseTokenAmount;\n} else {\n    quote.effectiveBaseTokenAmount = amount;\n}\n```\n\npart of the money may remain with the `SwapExecutor`.\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/helpers/HashflowHelper.sol#L24\n\n##### Recommendation\n\nWe recommend adding a revert if the input `amount` is not actual.\n",
        "protocol": "Barter DAO",
        "report_date": "2023-09-05",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/README.md#2-hashflow-rfq-integration",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/Barter%20DAO%20Security%20Audit%20Report%20(diff).pdf"
    },
    {
        "title": "Swaps through an ERC777 token can lead to DoS of these swaps",
        "content": "##### Description\n\nERC777 tokens allow hooks before and after balance changes.\nTransfer `_from` and `to` can choose the exact receivers of these hooks via `Registry.setInterfaceImplementer()`:\n- [ERC1820Registry](https://etherscan.io/address/0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24)\n\nAlso, Executor allows anyone to call `executeSwap()` and decide on the following targets and calldata.\n\n1) An attacker uses `executeSwap()` so that Executor calls `ERC1820Registry.setInterfaceImplementer(implementer=attacker)`. \n2) User A swaps an ERC777 token to something with low `minReturn`. It must be at least one ERC777 among the list of tokens in swaps.\n3) Executor receives ERC777 tokens from Facade (hook).\n4) The attacker reverts on the hook.\n\nAs a result, any ERC777 token going through Executor will lead to DoS and swap will revert.\n\nSo, one of the attack flows can be like this:\n1) Attacker uses `executeSwap()` so that Executor calls `ERC1820Registry.setInterfaceImplementer(implementer=attacker)'. \nSo, anytime Executor receives ERC777 tokens, a frontrunner contract will be called.\n2) User A swaps the ERC777 tokens to something with low `minReturn`.\n3) Executor receives the ERC777 tokens from Facade (hook).\n4) Attacker contract enters Executor.executeSwap() and Executor thinks that current ERC777 tokens belong to Attacker. So, he can withdraw these tokens, or swap them to something.\n\nOr at least Attacker can revert when recieving a call, not allowing a swap with this token at all.\n\n##### Recommendation\n\nWe recommend that Facade be the only allowed caller for `SwapExecutor.execureSwap()` with the Reentrancy guard and be sure that `minReturn` is set even for small swaps.\n",
        "protocol": "Barter DAO",
        "report_date": "2023-09-05",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/README.md#3-swaps-through-an-erc777-token-can-lead-to-dos-of-these-swaps",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/Barter%20DAO%20Security%20Audit%20Report%20(diff).pdf"
    },
    {
        "title": "Facade allows any unauthorized Executor",
        "content": "##### Description\n\nSwapFacade allows to choose any SwapExecutor address, even not authored by the team. Fees are charged on SwapExecutor. So, it is rational to fork SwapExecutor with zero fees and choose it as an executor for swaps.\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapFacade.sol#L87\n\nSome other possible scenarios:\n- users can choose out date executors\n- users can choose executors with bugs\n\n##### Recommendation\nWe recommend having a list of allowed executors and taking fees on SwapFacade.\n",
        "protocol": "Barter DAO",
        "report_date": "2023-09-05",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/README.md#1-facade-allows-any-unauthorized-executor",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/Barter%20DAO%20Security%20Audit%20Report%20(diff).pdf"
    },
    {
        "title": "Anyone can withdraw funds left on `SwapExecutor`",
        "content": "##### Description\n\nFunds left on the `SwapExecutor` can be withdrawn by anyone who specifies a transfer call in the swaps.\n\nThere are multiple reasons why funds may be left on the `SwapExecutor`:\n1. A user may not set the `tokenRatio` to 100% in a swap.\n\n```\nuint256 poolSwapAmount = (balanceToSwap * swap.tokenRatio) / _ONE;\n\n# sum (tokenRatio) > _ONE - is not risky, revert happens\n# sum (tokenRatio) < _ONE - is risky, as some tokens \n          are left not swapped and can be taken by anyone.\n```\n\n2. The `SwapExecutor` may run arbitrary calls to protocols that reward it with additional tokens. The `SwapFacade` only checks the `tokenToTransfer`, and a user may forget to transfer other tokens from the `SwapExecutor` immediately.\n3. If a user transfers tokens to the `SwapExecutor` first and then runs the `SwapFacade.swap()` function in a separate transaction.\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapExecutor.sol#L58\n\n##### Recommendation\nTo address this, a similar approach to that used in CowProtocol could be implemented: allowing only whitelisted managers to execute swaps in SwapExecutor.\n\nIt is also recommended to check that all `tokenRatio` used eventually sum up to 100%. \n",
        "protocol": "Barter DAO",
        "report_date": "2023-09-05",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/README.md#2-anyone-can-withdraw-funds-left-on-swapexecutor",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/Barter%20DAO%20Security%20Audit%20Report%20(diff).pdf"
    },
    {
        "title": "ETH value above limited value can be lost",
        "content": "##### Description\n\nSwapExecutor has the following lines for ETH:\n\n```\nif (value > valueLimit) {\n    value = valueLimit;\n}\n(success, result) = target.call{ value: value }(data);\n```\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapExecutor.sol#L116-L120\n\nSo, only a limited amount will be used if sent ETH is above valueLimit.\nThis ETH will be lost on the contract and anyone can withdraw these exceeded amounts.\n\n##### Recommendation\nWe recommend redesigning valueLimit purpose so that no funds are lost in edge situations.\n",
        "protocol": "Barter DAO",
        "report_date": "2023-09-05",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/README.md#3-eth-value-above-limited-value-can-be-lost",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/Barter%20DAO%20Security%20Audit%20Report%20(diff).pdf"
    },
    {
        "title": "A swap with permit can be blocked if a frontrunner swaps using copied permit",
        "content": "##### Description\n\nFacade does not check that msg.sender is the owner of a permit.\nSo, a frontrunner can use permits of other users available from mempool, so that their transactions would revert (as permit are used by the frontrunner).\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapFacade.sol#L58-L64\n\nA user will receive revert and will have to build new calldata, without permit.\n\n##### Recommendation\n\nWe recommend decoding permits to extract their owner, then check that msg.sender is this owner. Some example used by 1inch:\n- https://github.com/1inch/solidity-utils/blob/60fa6eba06f50f2acac5286dea5fb54f206e2434/contracts/libraries/SafeERC20.sol#L158-L245\n\n***",
        "protocol": "Barter DAO",
        "report_date": "2023-09-05",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/README.md#4-a-swap-with-permit-can-be-blocked-if-a-frontrunner-swaps-using-copied-permit",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/Barter%20DAO%20Security%20Audit%20Report%20(diff).pdf"
    },
    {
        "title": "Unprotected access to `makeCheckpoint()` in SwapGuardV2",
        "content": "##### Description\n\nSwapGuardV2 functions are planned to be used as separate calls in a set of swaps. However, if during the swaps process a hacker manages to get a callback to their own contract (for example, if the victim operates with ERC-777 tokens), the hacker can call public accessible function `makeCheckpoint()` to modify the SwapGuardV2 state so that the `ensureCheckpoint()` function at the victim's end would not work correctly.\n\nhttps://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapGuardV2.sol#L20\n\n##### Recommendation\n\nIt is recommended to revise the approach to using SwapGuardV2. It may be reasonable to leave only one function in SwapGuardV2, which receives a set of tokens, deltas and a callback. The function records the current token balances in memory instead of a storage, then calls the user's callback (which performs swaps), and then checks for changes in the balances.\n",
        "protocol": "Barter DAO",
        "report_date": "2023-09-05",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/README.md#5-unprotected-access-to-makecheckpoint-in-swapguardv2",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/Barter%20DAO%20Security%20Audit%20Report%20(diff).pdf"
    },
    {
        "title": "`Ownable` can be upgraded to `Ownable2Step`",
        "content": "##### Description\n\nSwapExecutor uses the `Ownable` functionality:\n\nhttps://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapExecutor.sol#L24\n\nThe `Ownable` contract can be upgraded to Open Zeppelin's `Ownable2Step`:\nhttps://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/Ownable2Step.sol\n\n`Ownable2Step` provides added safety due to its securely designed two-step process.\n\n\n##### Recommendation\n\nWe recommend applying `Ownable2Step` instead of `Ownable`.\n\n\n***\n",
        "protocol": "Barter DAO",
        "report_date": "2023-09-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/README.md#1-ownable-can-be-upgraded-to-ownable2step",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/Barter%20DAO%20Security%20Audit%20Report%20(diff).pdf"
    },
    {
        "title": "Simplifying `setFeeAndFeeRecipient()` logic for gas optimization",
        "content": "##### Description\n\nThe current implementation manually packs and unpacks the fee and address from a uint256 value, which increases the likelihood of errors and may cause unnecessary gas usage.\n\n* https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapExecutor.sol#L48\n* https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapExecutor.sol#L137\n\n##### Recommendation\n\nTo simplify the logic and optimize gas usage, it's recommended to store the fee and address separately in the contract's state using two separate variables:\n```soliditiy\nuint160 feeAddress;\nuint96 fee;\n```\n\nBoth variables will fit into a single storage slot. This will also allow more efficient retrieval of the fee-related data.\n\n***\n",
        "protocol": "Barter DAO",
        "report_date": "2023-09-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/README.md#2-simplifying-setfeeandfeerecipient-logic-for-gas-optimization",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/Barter%20DAO%20Security%20Audit%20Report%20(diff).pdf"
    },
    {
        "title": "Missing zero-checks",
        "content": "##### Description\n\nThere are no zero checks for `recipient` and `minReturn`:\n* https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapFacade.sol#L32\n* https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapFacade.sol#L33\n\nSome programs may pass zero values for some arguments by default. A user may not notice this behaviour and lose funds.\n\n##### Recommendation\n\nIt is recommended to add requirements which check that the `recipient` and `minReturn` are not zero.\n\n***\n",
        "protocol": "Barter DAO",
        "report_date": "2023-09-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/README.md#3-missing-zero-checks",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/Barter%20DAO%20Security%20Audit%20Report%20(diff).pdf"
    },
    {
        "title": "SwapGuardV2 has multiple problems",
        "content": "##### Description\n\n1. Contracts that use SwapGuardV2 together with Facade+Executor are out of scope\n2. All functions are public and anyone can makeCheckpoint()\n3. This contract will not work with native ETH.\n4. allowedLoss adds up with tokens having different decimals. Or tokensPrices must at least include decimals\n5. Lengths of tokens, tokenPrices and balanceChanges are not checked to be the same\n6. All checkpoints are written to storage, no need if it is used in one transaction\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapGuardV2.sol#L20-L58\n\n##### Recommendation\n\nWe recommend using more efficient ways to check profitability of swaps.\n",
        "protocol": "Barter DAO",
        "report_date": "2023-09-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/README.md#4-swapguardv2-has-multiple-problems",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/Barter%20DAO%20Security%20Audit%20Report%20(diff).pdf"
    },
    {
        "title": "Protection against accidential ETH sendings does not work",
        "content": "##### Description\n\nBoth Facade and Executor inherit ContractOnlyEthRecipient.sol with the following code.\n\n```\n/**\n * @title ContractOnlyEthRecipient\n * @notice Base contract that rejects any direct ethereum deposits. \n This is a failsafe against users who can accidentaly send ether\n */\nabstract contract ContractOnlyEthRecipient {\n    receive() external payable {\n        // solhint-disable-next-line avoid-tx-origin\n        if (msg.sender == tx.origin) {\n            revert DirectEthDepositIsForbidden();\n        }\n    }\n}\n```\n\nIn fact, only Executor needs this inheritance, as it can receive ETH from external exchanges.\nBut Facade should only receive ETH as msg.value at swap().\n\nAlso, in the comments developers stated that it is against accidential ETH sendings.\nBy the way, it still allows to receive accidential ETH from users as contracts (like user wallets). Moreover, any accidential ETH on balances are bad (can be stolen), so it is better to remove options to receive accidential money when it\u2019s possible.\n\n##### Recommendation\n\nWe recommend removing `recieve()` for `SwapFacade` and `SwapGuardV2`.\n\n***\n",
        "protocol": "Barter DAO",
        "report_date": "2023-09-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/README.md#5-protection-against-accidential-eth-sendings-does-not-work",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/Barter%20DAO%20Security%20Audit%20Report%20(diff).pdf"
    },
    {
        "title": "Not effective depositETH() and withdrawETH()",
        "content": "##### Description\n\n`depositETH()` and `withdrawETH()` are inherited and make calls to WETH.\n\nIt is used to swap between native ETH and WETH. But the implementation makes Executor call itself (external call), send ETH itself.\n\nThis step is useless and can be dropped.\n\n```\nfunction depositWeth(uint256 amount) external payable {\n    if (amount != msg.value) {\n        revert EthValueAmountMismatch();\n    }\n    weth.deposit{value: amount}();\n}\n\nfunction withdrawWeth(uint256 amount) external {\n    weth.withdraw(amount);\n}\n```\n\n##### Recommendation\n\nWe recommend removing these functions and use WETH as target directly.\n\n***\n",
        "protocol": "Barter DAO",
        "report_date": "2023-09-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/README.md#6-not-effective-depositeth-and-withdraweth",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/Barter%20DAO%20Security%20Audit%20Report%20(diff).pdf"
    },
    {
        "title": "Use `encodeCall`",
        "content": "##### Description\n\n`abi.encodeCall` is a safer way to avoid mistakes during compilation. The compiler checks that the types of args are compatible with a call.\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/helpers/UniswapV2Helper.sol#L31\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/helpers/HashflowHelper.sol#L30\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/helpers/DssPsmHelper.sol#L31\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/helpers/DodoV1Helper.sol#L22\n\n##### Recommendation\n\nWe recommend changing `encodeWithSelector` to `encodeCall`.\n\n***\n",
        "protocol": "Barter DAO",
        "report_date": "2023-09-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/README.md#7-use-encodecall",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/Barter%20DAO%20Security%20Audit%20Report%20(diff).pdf"
    },
    {
        "title": "Missing caller verification in `uniswapV3SwapCallback()`",
        "content": "##### Description\n\nThe `uniswapV3SwapCallback()` function in the `IUniswapV3SwapCallback` interface, which is part of the Uniswap v3 protocol, is used to handle the results of a swap. However, the function in `UniswapV3Executor` does not include any caller verification, which can lead to potential vulnerabilities.\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/features/UniswapV3Executor.sol#L20\n\n##### Recommendation\n\nThe uniswap team recommends checking that the caller of the `uniswapV3SwapCallback()` is a `UniswapV3Pool` deployed by the canonical `UniswapV3Factory`:\n- https://github.com/Uniswap/v3-core/blob/main/contracts/interfaces/callback/IUniswapV3SwapCallback.sol\n\nNote that this increases the amount of gas used.\n\n\n***\n",
        "protocol": "Barter DAO",
        "report_date": "2023-09-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/README.md#8-missing-caller-verification-in-uniswapv3swapcallback",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/Barter%20DAO%20Security%20Audit%20Report%20(diff).pdf"
    },
    {
        "title": "Funds stuck in `SwapFacade` cannot be withdrawn",
        "content": "##### Description\n\nERC-20 token funds cannot be withdrawn from SwapFacade if a user accidentally sends tokens to the SwapFacade contract instead of SwapExecutor.\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapFacade.sol#L16\n\n##### Recommendation\n\nIt is recommended to add a `sweep(token) onlyOwner` function with the onlyOwner modifier. This function will allow the owner of the contract to sweep any funds that are stuck in the contract and transfer them to a designated account. This will provide a safety net for users who accidentally send funds to the contract, preventing their funds from being lost or stolen.\n\n***\n",
        "protocol": "Barter DAO",
        "report_date": "2023-09-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/README.md#9-funds-stuck-in-swapfacade-cannot-be-withdrawn",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/Barter%20DAO%20Security%20Audit%20Report%20(diff).pdf"
    },
    {
        "title": "A potential overflow due to unsafe math",
        "content": "##### Description\nIn `SwapExecutor` this line `uint256 poolSwapAmount = (balanceToSwap * swap.tokenRatio) / _ONE` allows making overflow.\n\nExample (https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapExecutor.sol#L73):\n```\nuint256 poolSwapAmount = (balanceToSwap * swap.tokenRatio) / _ONE;\n```\n\n##### Recommendation\n\nWe recommend removing unsafe math from critical functions.\n",
        "protocol": "Barter DAO",
        "report_date": "2023-09-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/README.md#10-a-potential-overflow-due-to-unsafe-math",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/Barter%20DAO%20Security%20Audit%20Report%20(diff).pdf"
    },
    {
        "title": "Use `UniswapV2Router02` to avoid duplication of code",
        "content": "##### Description\n\n`UniswapV2Helper` duplicates the existing code of `UniswapV2Router` from the official Uniswap repo.\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/helpers/UniswapV2Helper.sol#L18\n\n##### Recommendation\n\nWe recommend using the existing functionality to avoid potential mistakes.\n",
        "protocol": "Barter DAO",
        "report_date": "2023-09-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/README.md#11-use-uniswapv2router02-to-avoid-duplication-of-code",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/Barter%20DAO%20Security%20Audit%20Report%20(diff).pdf"
    },
    {
        "title": "`SwapFacade.swap()` gas optimisations",
        "content": "##### Description\n\nThe logic in `SwapFacade.swap()` can be simplified to always call the `_permit()`.\n\nThe logic at lines 59-73\nhttps://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapFacade.sol#L63\n```solidity\n uint256 currentBalance = sourceToken.balanceOf(address(executor));\nif (currentBalance < amount)\n{\n    if (permit.length > 0) {\n        _permit(address(sourceToken), permit);\n    }\n    uint256 approveAmount = sourceToken.allowance(\n        msg.sender,\n        address(this)\n    );\n    if (approveAmount < amount) {\n        revert NotEnoughApprovedFundsForSwap(approveAmount, amount);\n    }\n    sourceToken.safeTransferFrom(msg.sender, address(executor), amount);\n}\n```\n\ncan be simplified down to just two lines (always call `_permit()`):\n\n```solidity\n_permit(address(sourceToken), permit);\nsourceToken.safeTransferFrom(msg.sender, address(executor), amount);\n```\n\nNote that the 1inch `_permit()` is already checking `permit.length` and does nothing in case it is zero:\n```solidity\ncontract Permitable {\n    error BadPermitLength();\n\n    function _permit(address token, bytes calldata permit) \n    internal virtual {\n        if (permit.length > 0) {\n            bool success;\n            if (permit.length == 32 * 7) {\n                // solhint-disable-next-line avoid-low-level-calls\n                (success,) = token.call(\n                    abi.encodePacked(IERC20Permit.permit.selector, permit)\n                );\n            } else if (permit.length == 32 * 8) {\n                // solhint-disable-next-line avoid-low-level-calls\n                (success,) = token.call(\n                    abi.encodePacked(IDaiLikePermit.permit.selector, permit)\n                );\n            } else {\n                revert BadPermitLength();\n            }\n            if (!success) {\n                RevertReasonForwarder.reRevert();\n            }\n        }\n    }\n}\n```\n\n##### Recommendation\n\nIt is recommended to remove unnecessary conditions to save gas.\n\n***\n\n",
        "protocol": "Barter DAO",
        "report_date": "2023-09-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/README.md#12-swapfacadeswap-gas-optimisations",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO%20(diff)/Barter%20DAO%20Security%20Audit%20Report%20(diff).pdf"
    },
    {
        "title": "Incorrect `defaultedDebt` interest accrual",
        "content": "##### Description\nhttps://github.com/prisma-fi/prisma-contracts/blob/52b26b8a2f1904b048754d5443e08d2144610b92/contracts/core/TroveManager.sol#L1201\n\nIn Prisma, there are liquidations which distribute the debt and collateral from liquidated troves among the remaining ones. For example, these are liquidations when ICR < 100% or liquidations the size of which the StabilityPool cannot cover. Each liquidation of this kind increases the values of `defaultedDebt`, `L_debt`, and `L_collateral` in the relevant TroveManager. These variables are used to track the total debt for each trove.\n\nThe `_applyPendingRewards()` function is triggered with every user interaction with a trove and increases the `trove.debt` by the pending debt from the `defaultedDebt` pool, but only if `rewardSnapshots[trove].collateral < L_collateral`:\n```\nfunction _applyPendingRewards\n    ...\n    if (rewardSnapshots[_borrower].collateral < L_collateral) {\n        ...\n        // add pending interest\n        debt = debt + pendingDebtReward;\n        ...\n    }\n    ...\n    // update trove debt\n    t.debt = debt;\n```\nhttps://github.com/prisma-fi/prisma-contracts/blob/52b26b8a2f1904b048754d5443e08d2144610b92/contracts/core/TroveManager.sol#L1201\n\nOver time, the value of `L_debt` and the size of `defaultedDebt` increase:\n```\nfunction _redistributeDebtAndColl\n    ...\n    if (lastIndexUpdateCached < block.timestamp) {\n        ...\n        uint256 accruedInterest = Math.mulDiv(defaultedDebt, interestFactor,\n        INTEREST_PRECISION);\n        ...\n        debtWithInterests += accruedInterest;\n    }\n    ...\n    defaultedDebt += debtWithInterests;\n```\nhttps://github.com/prisma-fi/prisma-contracts/blob/52b26b8a2f1904b048754d5443e08d2144610b92/contracts/core/TroveManager.sol#L1367\n\nHowever, `L_collateral` can remain the same until the next bad liquidation (i.e., a liquidation with ICR < 100% or a liquidation which StabilityPool cannot cover).\n\nThus, if a hacker triggers `_applyPendingRewards()` for themselves after a bad liquidation (which increases `L_collateral` and `L_debt`), for example, using the `claimReward()` function, they will set their `rewardSnapshots[hacker].collateral` equal to the new `L_collateral`, and subsequent increases in the `L_debt` variable over time will be incorrectly tracked for them.\n\nFor example, the `getTroveCollAndDebt()` function will return the correct debt for the hacker, including the accumulated `defaultedDebt` interest. However, `_applyPendingRewards()` will not update the `trove.debt` variable because the condition `rewardSnapshots[hacker].collateral < L_collateral` is not satisfied as `L_collateral` remained unchanged. This allows the hacker to close their trove without paying the accrued `defaultedDebt` interest, which can be arbitrarily large. Upon trove closure, all their pending interest will be distributed among unsuspecting remaining troves.\n\nThis leads to instant losses for all troves, which will be forced to pay off the accumulated debt in `defaultedDebt` on behalf of the hacker, and it also leads to instability in the system when a multitude of troves can suddenly go underwater due to the sudden distribution of unpaid debt by the hacker.\n\nThe PoC was sent to the Prism team.\n\n##### Recommendation\nThe issue with incorrect interest accrual could be addressed by expanding the check in the `_applyPendingRewards()` function as follows:\n```\nif (\n    (rewardSnapshots[_borrower].collateral < L_collateral)\n    ||\n    (rewardSnapshots[_borrower].debt < L_debt)\n)\n```\n\nHowever, it's worth noting that the `defaultedDebt` pool can only be zeroed out if after a bad liquidation, the `_applyPendingRewards()` function is called for absolutely all troves in the system, which transfers the debt from `defaultedDebt` to the `totalActiveDebt` pool:\n```\n_movePendingTroveRewardsToActiveBalance(pendingDebtReward, \npendingCollateralReward);\n```\n\nThis is not practically possible. Therefore, `defaultedDebt` will remain positive because some accounts in the system will be inactive. Consequently, the interest accumulated over time in the `defaultedDebt` pool will be distributed among all other active accounts. This seems unfair to active accounts, who will have to pay for the debts of inactive users.\n\nTherefore, the best solution seems to be a complete abandonment of interest accrual on the `defaultedDebt` pool.\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#1-incorrect-defaulteddebt-interest-accrual",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Mint awards can be manipulated",
        "content": "##### Description\n- https://github.com/prisma-fi/prisma-contracts/blob/52b26b8a2f1904b048754d5443e08d2144610b92/contracts/core/TroveManager.sol#L135\n\nMint awards can be manipulated. Next steps:\n\n1. A hacker waits until TCR becomes 149% in TroveManager\n2. The hacker takes the collateral flashloan and inside the transaction:\n- Open a \"huge\" trove to get \"accountLatestMint\" (mint awards https://github.com/prisma-fi/prisma-contracts/blob/52b26b8a2f1904b048754d5443e08d2144610b92/contracts/core/TroveManager.sol#L1018). No commission due to recovery mode (https://0xsydbs-organization.gitbook.io/prisma-finance/core-protocol-operations/recovery-mode#impact-on-fees).\n- Open a \"small\" trove to increase TCR from 149% to 150% (by hacker_helper).\n- In the end, recovery mode is more than 150, and the hacker can close the \"huge\" trove without a commission.\n3. The hacker has a huge \"accountLatestMint\" after flashloan and they can claim prisma tokens.\n\nThe script has been provided.\n\n##### Recommendation\nThis finding shows a way to open any trove without a commission. It is not recommended to give awards for minting directly (https://github.com/prisma-fi/prisma-contracts/blob/52b26b8a2f1904b048754d5443e08d2144610b92/contracts/core/TroveManager.sol#L1018).\n\nWe recommend revising the architecture of rewards.\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#2-mint-awards-can-be-manipulated",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An attacker can steal the StabilityPool depositors profit",
        "content": "##### Description\nThe liquidation flow of the protocol is supposed to be as follows:\n- users open troves and join `StabilityPool`\n- anyone calls liquidation that iterates the given troves and liquidates them one by one\n- in `StabilityPool` there are more collateral tokens\n\nBy using a flash loan, any user can bypass the provision of liquidity to the protocol for a long time and steal some of the `StabilityPool` provider's profit taking the following steps:\n1. An attacker gets a flash mint (https://github.com/prisma-fi/prisma-contracts/blob/52b26b8a2f1904b048754d5443e08d2144610b92/contracts/core/DebtToken.sol#L199).\n2. The attacker makes a deposit `mkUSD` to `StabilityPool`.\n3. The attacker calls the [`liquidateTroves`](https://github.com/prisma-fi/prisma-contracts/blob/52b26b8a2f1904b048754d5443e08d2144610b92/contracts/core/LiquidationManager.sol#L143) function to liquidate the troves.\n4. The attacker calls [`withdrawFromSP`](https://github.com/prisma-fi/prisma-contracts/blob/52b26b8a2f1904b048754d5443e08d2144610b92/contracts/core/StabilityPool.sol#L241)\n5. The attacker gets profit and returns the flash loan.\n\nThe attack's impact:\n- loss of profit from liquidations by `StabilityPool` providers;\n- decreased motivation to use the Stability Pool which may cause mkUSD to unpeg.\n\n##### Recommendation\nWe recommend that you use the time factor to prevent flash loan attacks.\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#1-an-attacker-can-steal-the-stabilitypool-depositors-profit",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Whale governance attack on the protocol takes 1 day and cannot be cancelled by DAO",
        "content": "##### Description\n\nThe flow of the attack:\n1) A whale prepares funds so that the lock for one week gives a weight to bypass the `passingPct`.\n2) In the end of week [N], one minute before week [N+1], the whale calls`TokenLocker.lock(week=1)`. The token locker will register the weight for week [N]\n3) Week [N+1] begins in one minute after Step 2. The funds for the attack are unlocked and can be withdrawn.\n4) The whale calls `AdminVoting.createNewProposal()`\nThe payload is the following:\n-- `PrismaCore.setGuardian()`\n-- `Treasury.transferTokens(token=prisma, receiver=whale, amount=everything)`\n5) The whale calls \n`AdminVoting.voteForProposal()` and votes for the proposal from Step 4.\nAdminVoting uses weights from the previous week [N] which is already finalized and the whale was the largest voter at the end of the week.\nThe whale bypasses `passingPct` for this proposal, so the proposal can be executed in 1 day.\n6) In one day, the whale calls\n`AdminVoting.executeProposal()` and withdraws all funds from the Treasury.\n\nThe guardian cannot cancel this attack. Because the first call in the payload is `PrismaCore.setGuardian()` which is the only type of call that cannot be cancelled, thus the whole payload cannot be cancelled.\n- https://github.com/prisma-fi/prisma-contracts/blob/c0122d27677cd4e1aaee7f1e21f807ccadf46ac8/contracts/dao/AdminVoting.sol#L193-L196\n\n##### Recommendation\nWe recommend that:\n- the guardian restriction to cancel `PrismaCore.setGuardian()` should be fixed. For example, the guardian is not allowed to cancel `PrismaCore.setGuardian()` only if `payload.length == 1`. In this case proposers must have only one call in the payload. Otherwise, the guardian can cancel.\n- when a proposal changes a guardian the protocol can require higher `passingPct`.\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#2-whale-governance-attack-on-the-protocol-takes-1-day-and-cannot-be-cancelled-by-dao",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Small amounts can be withdrawn without penalties from TockenLocker",
        "content": "##### Description\n- https://github.com/prisma-fi/prisma-contracts/blob/c0122d27677cd4e1aaee7f1e21f807ccadf46ac8/contracts/dao/TokenLocker.sol#L806\n\nThere's a rounding error in the penalty calculation:\n```\nuint256 penaltyOnAmount = (lockAmount * weeksToUnlock) / MAX_LOCK_WEEKS;\n```\n\nThe penalty becomes zero if `lockAmount * weeksToUnlock < MAX_LOCK_WEEKS`. For example, if `lockToTokenRatio=1e18`, then 1e18 PRISM is locked for 51 weeks (or alternatively, 51e18 PRISMA is locked for 1 week) can be withdrawn without penalties.\n\nOne example of an attack that allows you to withdraw 23% of the tokens from the `AllocationVesting` contract:\n- We send a small amount of tokens using `allocation_vesting.transferPoints` to any of the addresses (https://github.com/prisma-fi/pris`ma-contracts/blob/c0122d27677cd4e1aaee7f1e21f807ccadf46ac8/contracts/dao/AllocationVesting.sol#L83)\n- Lock these tokens `allocation_vesting.lockFutureClaims` releasing 23% of future transfers (https://github.com/prisma-fi/prisma-contracts/blob/c0122d27677cd4e1aaee7f1e21f807ccadf46ac8/contracts/dao/AllocationVesting.sol#L116)\n- Call `locker.withdrawWithPenalty` in a loop (https://github.com/prisma-fi/prisma-contracts/blob/c0122d27677cd4e1aaee7f1e21f807ccadf46ac8/contracts/dao/TokenLocker.sol#L769). In this case, the commission is not taken\n- Get PRISMA tokens without blocking for 12 weeks\n\nPoC has been sent to the customer.\n\n##### Recommendation\n\nWe recommended that you improve the precision of the penalty calculation or prohibit the early withdrawal of small amounts.\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#3-small-amounts-can-be-withdrawn-without-penalties-from-tockenlocker",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The implementation of contracts is mutable in Factory",
        "content": "##### Description\n- https://github.com/prisma-fi/prisma-contracts/blob/52b26b8a2f1904b048754d5443e08d2144610b92/contracts/core/Factory.sol#L131\n\n`troveManagerImpl` can be changed (https://github.com/prisma-fi/prisma-contracts/blob/52b26b8a2f1904b048754d5443e08d2144610b92/contracts/core/Factory.sol#L124).\n\nIn `Factory` `cloneDeterministic` (`create2`) `troveManagerImpl` is used as a base contract for copying contracts, so the `getTroveManager` method may return incorrect results if `troveManagerImpl` is changed.\n\n##### Recommendation\nWe recommend revising `predictDeterministicAddress` and getting the trove manager using a collateral.\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#1-the-implementation-of-contracts-is-mutable-in-factory",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Users can lock tokens for a few seconds and receive the same weight as users with a one week lock",
        "content": "##### Description\n\nThe weight received right after the lock is stored in the `accountWeeklyWeights[currentWeek]`.\n- https://github.com/prisma-fi/prisma-contracts/blob/c0122d27677cd4e1aaee7f1e21f807ccadf46ac8/contracts/dao/TokenLocker.sol#L441\n\nImagine two users:\n1) the first one locks tokens at the **first** seconds of week 6, duration is 1 week;\n2) the second one locks tokens at the **last** seconds of week 6, duration is 1 week. \n\nBoth of them will receive the weight of `tokenAmount*1` and both of them will have all their tokens unlocked in week 7. They can withdraw their unlocked tokens in the first seconds of week 7.\n\nIt means that the protocol treats these two users identically though the first user locked PRISMA tokens for 1 week and the second one in fact locked tokens for only a few seconds.\n\n##### Recommendation\n\nWe recommend requiring the minimum length of the lock for more than 1 week. It would allow the protocol to have a liquidity lock for at least 1 week even in case of malicius locks in last seconds.\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#2-users-can-lock-tokens-for-a-few-seconds-and-receive-the-same-weight-as-users-with-a-one-week-lock",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "A guardian cannot cancel a malicious proposal in AdminVoting",
        "content": "##### Description\nhttps://github.com/prisma-fi/prisma-contracts/blob/c0122d27677cd4e1aaee7f1e21f807ccadf46ac8/contracts/dao/AdminVoting.sol#L186\n\nA user can create a new proposal via `createNewProposal()` with a payload of actions. A guardian, however, is prohibited from using `cancelProposal()` on a proposal, if the first action is a call to `IPrismaCore.setGuardian()`. Therefore, if the proposal contains a malicious action, the guardian is unable to cancel it.\n\n##### Recommendation\n\nOur recommendation is to allow the cancellation of a proposal if its `payload.length > 1`.\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#3-a-guardian-cannot-cancel-a-malicious-proposal-in-adminvoting",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No time to cancel a malicious proposal in AdminVoting",
        "content": "##### Description\n\n- https://github.com/prisma-fi/prisma-contracts/blob/c0122d27677cd4e1aaee7f1e21f807ccadf46ac8/contracts/dao/AdminVoting.sol#L211\n\nA malicious whale can create a proposal, wait for `MIN_TIME_TO_EXECUTION + 1` (currently 24 hours), and then vote and execute it in the same block, leaving no time for a guardian to cancel it.\n\nIt becomes possible because of `MIN_TIME_TO_EXECUTION < VOTING_PERIOD` and there are only two requirements to execute a proposal:\n```\nrequire(proposal.currentWeight >= proposal.requiredWeight, \"Not passed\");\nrequire(proposal.createdAt + MIN_TIME_TO_EXECUTION < block.timestamp,\n\"MIN_TIME_TO_EXECUTION\");\n```\n\n##### Recommendation\n\nWe recommend adding a delay between the point in time when the proposal gains enough votes for execution and the execution itself.\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#4-no-time-to-cancel-a-malicious-proposal-in-adminvoting",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`1e18-1` wei PRISMA can get lost in `AllocationVesting.lockFutureClaimsWithReceiver()`",
        "content": "##### Description\n\n- https://github.com/prisma-fi/prisma-contracts/blob/d9a2b2ba4d26e01115731fffadd8306c5955a660/contracts/dao/AllocationVesting.sol#L172-L173\n\nIn function `AllocationVesting.lockFutureClaimsWithReceiver()`, an `amount` of tokens is debited from the user. However, a number with a rounding error is locked:\n```\ntokenLocker.lock(receiver, amount / lockToTokenRatio, 52);\n```\n\nIf `lockToTokenRatio==1e18`, then the dust up to 1e18 wei PRISMA will be lost by the user and will accumulate in the `AllocationVesting` contract.\n\n##### Recommendation\n\nIt seems that the loss of `1e18-1` wei PRISMA would be unpleasant for the user, so it's recommended to prevent this.\n\nOne way to do this is to discard the dust at the beginning of the function:\n```\nfunction lockFutureClaimsWithReceiver(\n    address account,\n    address receiver,\n    uint256 amount\n) public callerOrDelegated(account) {\n    amount = (amount / lockToTokenRatio) * lockToTokenRatio;  \n    // truncating the dust\n    ...\n```\n\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#5-1e18-1-wei-prisma-can-get-lost-in-allocationvestinglockfutureclaimswithreceiver",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Using the `RESPONSE_TIMEOUT` constant for all oracles",
        "content": "##### Description\n\n- https://github.com/prisma-fi/prisma-contracts/blob/d9a2b2ba4d26e01115731fffadd8306c5955a660/contracts/core/PriceFeed.sol#L58\n\nChainlink uses the heartbeat when checking if the data feed is fresh.\n\nCurrently, the `25 hours` constant is used for the definition of staling. However, there are feeds that update the data faster (for example, https://data.chain.link/ethereum/mainnet/crypto-usd/eth-usd).\n\nWithout this, data can be considered fresh for a long time.\n\n##### Recommendation\n\nIt is recommended not to use the `RESPONSE_TIMEOUT` constant. Each oracle can contain this variable.\n\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#6-using-the-response_timeout-constant-for-all-oracles",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "A flashmint max amount check is easily bypassed",
        "content": "##### Description\nUsers can take two or more flashloans and bypass the requirement of the `maxFlashLoan()` size.\n- https://github.com/prisma-fi/prisma-contracts/blob/52b26b8a2f1904b048754d5443e08d2144610b92/contracts/core/DebtToken.sol#L155C14-L157\n\nThe current cap for flashloans is set to `2**128`.\nIf this check aims to limit the flashloan amount in order not to exceed max totalSupply, take into account that OpenZeppelin\u00b4s ERC20 will not allow new totalSupply overflow `2**256` limit.\n- https://github.com/OpenZeppelin/openzeppelin-contracts/blob/f29307cfe08c7d76d96a38bf94bab5fec223c943/contracts/token/ERC20/ERC20.sol#L243\n\n##### Recommendation\nWe recommend either removing this check or introducing a reentrancy protection for the flashloan function only.\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#1-a-flashmint-max-amount-check-is-easily-bypassed",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The callerOrDelegated specification is not followed for CloseTrove",
        "content": "##### Description\nFor all key functions in `BorrowerOperations` users can choose their privileged address to delegate an operation.\n- https://github.com/prisma-fi/prisma-contracts/blob/52b26b8a2f1904b048754d5443e08d2144610b92/contracts/dependencies/DelegatedOps.sol#L22-L29\n\nComment there states that:\n```\nIn executing the call, \nall internal state updates \nshould be applied for `account` \nand all value transfers \nshould occur to or from the caller.\n```\nIt is not the case for `closeTrove()`.\n- https://github.com/prisma-fi/prisma-contracts/blob/52b26b8a2f1904b048754d5443e08d2144610b92/contracts/core/BorrowerOperations.sol#L393-L398\nHere, the contract closes the trove taking debtToken from `msg.sender` (as it should), but the remaining collateral is sent to `account`, so the specification is not followed.\n\n##### Recommendation\nWe recommend either sending collateral to `msg.sender` or fixing the comment describing the desired behavior.\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#2-the-callerordelegated-specification-is-not-followed-for-closetrove",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "During the global pause users can increase and decrease TCR",
        "content": "##### Description\nWe have two contracts that check the global pause:\n- BorrowerOperations.sol (BO)\n- StabilityPool.sol (SP)\n\nThese contracts have the following functions for users and sometimes they are allowed to be called during the global pause.\n\nfunction | allowed on pause ?\n--- | ---\nBO.openTrove() | no\nBO.addColl() | no\nBO.withdrawCall() | yes\nBO.withdrawDebt() | no\nBO.repayDebt() | yes\nBO.adjustTrove() | allowed if adjusted to [no more collateral] & [less debt]\nBO.closeTrove() | yes\nSP.provideToSP() | no\nSP.withdrawFromSP() | yes\n\nWithdrawing collateral makes TCR lower.\nRepaying debt makes TCR higher.\nClosing troves makes TCR lower, likely.\n\nAs a result, the \"pause\" does not serve as a true global pause and does not stop all operations.\n\n##### Recommendation\nWe recommend ensuring that this pause behavior is enough and complete. If the project needs a true global pause, we recommend introducing a new type of pause that stops all functions.\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#3-during-the-global-pause-users-can-increase-and-decrease-tcr",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "TroveManager bytecodes are not recommended to be different",
        "content": "##### Description\n`Factory` allows selecting any implementation addresses for `TroveManager` and `SortedTroves`.\n- https://github.com/prisma-fi/prisma-contracts/blob/52b26b8a2f1904b048754d5443e08d2144610b92/contracts/core/Factory.sol#L83-L84\n\nThe problem is that TroveManagers are not completely separated and the TCR calculation is made via iterating through each TroveManager. Thus, the issue in one TroveManager can break the whole system. That is why it is risky that potentially not audited implementations are allowed.\n\n##### Recommendation\nWe recommend ensuring that all connected TroveManagers share the same code. It is better to have new features separated from the audited codebase, e.g. in v2 of the protocol.\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#4-trovemanager-bytecodes-are-not-recommended-to-be-different",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "MCR and CCR management",
        "content": "##### Description\n`MCR` and `CCR` are constants:\n- https://github.com/prisma-fi/prisma-contracts/blob/52b26b8a2f1904b048754d5443e08d2144610b92/contracts/dependencies/PrismaBase.sol#L13-L17\n\nOver time, the value and volatility of the collateral token may change. It will require to adapt `MCR` and `CCR` to new market behavior. \n\n##### Recommendation\nWe recommend that you add methods for changing `MCR` and `CCR` parameters.\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#5-mcr-and-ccr-management",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Use `SafeTransfer`",
        "content": "##### Description\nWhen transfer tokens, there are checks for returned value:\n- https://github.com/prisma-fi/prisma-contracts/blob/52b26b8a2f1904b048754d5443e08d2144610b92/contracts/core/TroveManager.sol#L850\n- https://github.com/prisma-fi/prisma-contracts/blob/52b26b8a2f1904b048754d5443e08d2144610b92/contracts/core/TroveManager.sol#L1381\n- https://github.com/prisma-fi/prisma-contracts/blob/52b26b8a2f1904b048754d5443e08d2144610b92/contracts/core/StabilityPool.sol#L679\n\nThis is the right way. But when working with specific tokens, we can use `SafeERC20`.\n\n##### Recommendation\nWe recommend using [SafeERC20](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/utils/SafeERC20.sol).\n\n`SafeERC20` helps:\n- check the boolean return values of ERC20 operations and revert the transaction if they fail;\n- at the same time allowing you to support some non-standard ERC20 tokens that don\u2019t have boolean return values.\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#6-use-safetransfer",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "A note about exotic tokens",
        "content": "##### Description\nThe project's current implementation does not account for the unique behaviors associated with rebaseable tokens, fee-on-transfer tokens, ERC-777 (callback) tokens, or non-18 decimal tokens, exposing the system to potential risks and undesirable consequences, if such a token is used as a collateral.\n\n##### Recommendation\nIt is necessary to manage the collateral registration process to ensure that such exotic tokens are not added as part of the protocol.\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#7-a-note-about-exotic-tokens",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unused approval from Treasury to TokenLock",
        "content": "##### Description\n\nIn the constructor of Treasury we have this line:\n```\n_token.approve(address(_locker), type(uint256).max);\n```\n- https://github.com/prisma-fi/prisma-contracts/blob/c0122d27677cd4e1aaee7f1e21f807ccadf46ac8/contracts/dao/Treasury.sol#L111\n\nBut TokenLocker never takes PrismaTokens from the Treasury. Moreover, TokenLocker does not store Treasury address.\n\n##### Recommendation\n\nThis approval can be removed.\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#8-unused-approval-from-treasury-to-tokenlock",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`CurveProxy` contract needs to be approved by Curve DAO",
        "content": "##### Description\n\nThere is the following line in the methods for blocking CRV tokens (in Curve vesting contract):\n```\nself.assert_not_contract(msg.sender)\n```\n\n- https://github.com/prisma-fi/prisma-contracts/blob/c0122d27677cd4e1aaee7f1e21f807ccadf46ac8/contracts/staking/Curve/CurveProxy.sol#L307\n\nIn order to make`CurveProxy` work, you need to get an approval from the Curve DAO.\n\n##### Recommendation\n\nWe recommend documenting the CurveProxy deployment process.\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#9-curveproxy-contract-needs-to-be-approved-by-curve-dao",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Events missing",
        "content": "##### Description\nThe function should emit an event for better UX in possible integrations:\n- https://github.com/prisma-fi/prisma-contracts/blob/c0122d27677cd4e1aaee7f1e21f807ccadf46ac8/contracts/dao/Treasury.sol#L173.\n\n##### Recommendation\nWe recommend emitting events.\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#10-events-missing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Old votes can be called",
        "content": "##### Description\n- https://github.com/prisma-fi/prisma-contracts/blob/c0122d27677cd4e1aaee7f1e21f807ccadf46ac8/contracts/dao/AdminVoting.sol#L207\n\n\nOld approved proposals may be called after a long time.\n\nOne example of using this loophole:\n1. A hacker generates a duplicate proposal from the PRISMA team and motivates users to vote for it. \n2. The proposal gets enough votes but doesn't execute `executeProposal`.\n3. After a long time, the hacker returns to this proposal and calls it for their own purposes. \n\n##### Recommendation\n\nWe recommend making the maximum lifetime for the proposal.\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#11-old-votes-can-be-called",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`AllocationVesting.setAllocations()` allows setting a zero `numberOfWeeks`",
        "content": "##### Description\n\n- https://github.com/prisma-fi/prisma-contracts/blob/d9a2b2ba4d26e01115731fffadd8306c5955a660/contracts/dao/AllocationVesting.sol#L94\n\n`setAllocations()` allows an admin to create an allocation with zero `numberOfWeeks`, leading to unexpected behavior. For example, the `_vestedAt()` function for allocations with zero `numberOfWeeks` always returns zero and thus the `claim()` function reverts, so a user can't withdraw funds from such an allocation.\n\nHowever, `transferPoints()` assumes that if an allocation has zero `numberOfWeeks`, then this allocation is empty and therefore rewrites `numberOfWeeks` with the sender's value:\n```\nif (numberOfWeeksTo == 0) {\n    allocations[to].numberOfWeeks = numberOfWeeksFrom;\n}\n```\n\n- https://github.com/prisma-fi/prisma-contracts/blob/d9a2b2ba4d26e01115731fffadd8306c5955a660/contracts/dao/AllocationVesting.sol#L130-L133\n\nThus, after transferring additional points, this allocation becomes available for withdrawal.\n\n##### Recommendation\n\nWe recommend adding a check in the `AllocationVesting.setAllocations()` function to ensure that `numberOfWeeks` cannot be zero.\n\n",
        "protocol": "Prisma Finance",
        "report_date": "2023-09-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/README.md#12-allocationvestingsetallocations-allows-setting-a-zero-numberofweeks",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Prisma%20Finance/Prisma%20Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Pool initialization can be front-run",
        "content": "##### Description\nAfter the pool deployment https://github.com/cryptoalgebra/Algebra/blob/6c22b64977e0b0266aec89470480df74977eb606/src/core/contracts/AlgebraFactory.sol#L95, the initialize function isn't called which allows anyone to set the initial price in the pool. The price setting can affect liquidity addition in the `mint` function. Initialization can also be front-run if the pool is created from the periphery, so this problem allows a malicious user to ddos any pool.\nAlso, the `swap` function can be executed without any tokens from the `msg.sender` if it operates entirely within an interval with zero active liquidity. Concurrently, the `mint` function in the `AlgebraPool` contract does not include the `amount0Max` and `amount1Max` parameters making it vulnerable to undesirable price fluctuations. This creates a loophole that malicious actors can exploit capitalizing on price slippage to their advantage.\n\nFor clarity, consider the following sequence of events (these events can also take place after the pool creation):\n\n1. A liquidity provider (LP) initiates the `mint` transaction to the `AlgebraPool` with the current price set to `P` and the pool's actual liquidity standing at zero. The LP's intention is to set a position with the `amount0` of token0 and `amount1` of token1.\n2. An exploiter front-runs this action by performing a `swap` which shifts the price to `P' < P` undervaluing `token0`. This operation costs the exploiter nothing in terms of `token0` due to the absence of liquidity.\n3. Subsequently, the LP mints the new position acquiring `amount0' < amount0` of token0 and `amount1' > amount1` of token1.\n4. Then the exploiter conducts another `swap` acquiring `token0` and reverting its price back to the prevalent market rate capitalizing on the arbitrage window.\n5. These actions result in the LP contributing more of `token1` than it was initially planned incurring a loss.\n\nThis issue is classified as `high` severity. It offers bad actors an opportunity to exploit the lack of price slippage checks in the `mint` function. Even though conditions without `amount0Max` and `amount1Max` might be managed through the `periphery`, it still exposes the system to the near-zero cost of significant price shifts within intervals with zero active liquidity. This could potentially pave the way for DoS attacks targeting liquidity positions.\n\n##### Recommendation\nWe recommend calling the initialize function after the pool deployment in the `createPool` function. Also, we recommend implementing constraints on the `swap` function, especially when the swap ends in a non-initialized tick with zero liquidity. This will retain malicious entities from manipulating prices within intervals of zero liquidity and will limit the feasibility of DoS attacks in such scenarios. For solving the problem when the pool is initialized with a correct price but a malicious actor uses token-free swaps to move the price, we recommend adding a method that allows users to move price and add liquidity in one tx. Price moving, in this case, will be token-free because total pool liquidity will be 0.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-08-25",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/README.md#1-pool-initialization-can-be-front-run",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/Algebra%20Finance%20Core%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Ownership renouncement will grant a role to zero address",
        "content": "##### Description\nAfter the ownership renouncement, the owner will be zero address, and it will be granted with `DEFAULT_ADMIN_ROLE` https://github.com/cryptoalgebra/Algebra/blob/6c22b64977e0b0266aec89470480df74977eb606/src/core/contracts/AlgebraFactory.sol#L165.\n\n##### Recommendation\nWe recommend adding a check that `owner` is not a zero address.\n\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-08-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/README.md#1-ownership-renouncement-will-grant-a-role-to-zero-address",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/Algebra%20Finance%20Core%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "A broken hook can block user funds",
        "content": "##### Description\nFor closing position, a user should call the `burn` function which uses hooks to external contract https://github.com/cryptoalgebra/Algebra/blob/6c22b64977e0b0266aec89470480df74977eb606/src/core/contracts/AlgebraPool.sol#L137. If a hook were broken, then users would not be able to get the deposited funds.\n\n##### Recommendation\nWe recommend adding an emergency exit for users that can be triggered if the hook breaks.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-08-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/README.md#2-a-broken-hook-can-block-user-funds",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/Algebra%20Finance%20Core%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Active pool `plugin` can be modified without updating `pluginConfig`",
        "content": "##### Description\nhttps://github.com/cryptoalgebra/Algebra/blob/6c22b64977e0b0266aec89470480df74977eb606/src/core/contracts/AlgebraPool.sol#L402\nAn issue has been found in the `setPlugin` function.\nPool administrators can alter the `plugin` of an active pool. However, there is a discrepancy as the `pluginConfig` of the newly-introduced `plugin` might differ from its predecessor. This could lead to invoking unimplemented hooks that were previously operational in the old `plugin`. Furthermore, if the former `plugin` employed dynamic fees set beforehand, and the succeeding plugin operates with static fees or vice versa, the pool `fee` parameter stays in an inconsistent state resulting in incorrect fee withdrawals. Additionally, when associating a `plugin` to an active `pool`, certain pre-initialization logic might be imperative, particularly when establishing the new plugin configuration, initializing internal local variables, and designating the new fee.\n\nThis vulnerability is classified as `medium` as linking a new `plugin` to the pool could temporarily block specific `pool` functionality and unintentionally trigger inappropriate `fee` actions, persisting until the correct `plugin` initialization is carried out.\n\n##### Recommendation\nWe recommend adding a hook call to the `plugin` as part of the `setPlugin` function. This inclusion should initialize the `plugin`'s local variables and concurrently define the fresh `pluginConfig` and `fees` within the `pool`.\n\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-08-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/README.md#3-active-pool-plugin-can-be-modified-without-updating-pluginconfig",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/Algebra%20Finance%20Core%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Admin can set non-zero `pluginConfig` in `pool` with zero `plugin`",
        "content": "##### Description\nhttps://github.com/cryptoalgebra/Algebra/blob/6c22b64977e0b0266aec89470480df74977eb606/src/core/contracts/AlgebraPool.sol#L431\nThe `Administrator` can set a non-zero value for `pluginConfig` while setting the `plugin` to zero. Such a configuration can potentially trigger reverts in pool functions. \nThis issue is classified as `medium`, as the combination of a non-zero `pluginConfig` with a zero `plugin` can disrupt certain functionalities of the `pool`.\n\n##### Recommendation\nIn order to ensure consistency and prevent potential disruptions, we recommend including a conditional check: `if (plugin == 0) require(pluginConfig == 0);`.\n\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-08-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/README.md#4-admin-can-set-non-zero-pluginconfig-in-pool-with-zero-plugin",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/Algebra%20Finance%20Core%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Requires without a message",
        "content": "##### Description\nThere are some `require` checks that do not contain a revert message (e.g., https://github.com/cryptoalgebra/Algebra/blob/6c22b64977e0b0266aec89470480df74977eb606/src/core/contracts/AlgebraCommunityVault.sol#L37). If some logic broke in the contract, then it would be tough to find the specific place which leads to the revert.\n\n##### Recommendation\nWe recommend adding revert messages to all `require` checks.\n\n\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-08-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/README.md#1-requires-without-a-message",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/Algebra%20Finance%20Core%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Zero fees will reset accrued rewards",
        "content": "##### Description\nIf the admin of the community vault decided to set algebra fee to 0, then all previously accumulated rewards would be lost\nhttps://github.com/cryptoalgebra/Algebra/blob/6c22b64977e0b0266aec89470480df74977eb606/src/core/contracts/AlgebraCommunityVault.sol#L79-L82.\n\n##### Recommendation\nWe recommend being aware of these fee mechanics.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-08-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/README.md#2-zero-fees-will-reset-accrued-rewards",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/Algebra%20Finance%20Core%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Dangerous type casting",
        "content": "##### Description\nType casting here https://github.com/cryptoalgebra/Algebra/blob/6c22b64977e0b0266aec89470480df74977eb606/src/core/contracts/AlgebraPool.sol#L146 can lead to a potential loss of user funds.\n\n##### Recommendation\nWe recommend using a safe type cast there.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-08-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/README.md#3-dangerous-type-casting",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/Algebra%20Finance%20Core%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "A flash loan fee sandwich attack",
        "content": "##### Description\nhttps://github.com/cryptoalgebra/Algebra/blob/6c22b64977e0b0266aec89470480df74977eb606/src/core/contracts/AlgebraPool.sol#L328\nThe flash loan fee is spread among current active liquidity providers. A malicious actor can get a flash loan transaction from the mempool and wrap it into a sandwich:\n1. `AlgebraPool.mint()` with highly concentrated liquidity to the pool (for the current active tick with the minimal interval).\n2. A flash loan transaction from the mem pool.\n3. `AlgebraPool.burn()`.\nSo, the malicious actor will get a big amount of flash loan fee from liquidity providers.\n\n##### Recommendation\nWe recommend distributing flash loan commissions equally among all LPs.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-08-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/README.md#4-a-flash-loan-fee-sandwich-attack",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/Algebra%20Finance%20Core%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No parameter redundancy checks",
        "content": "##### Description\n\nCertain setters in the `AlgebraCommunityVault` and `AlgebraPool` contracts are missing checks to ensure that the incoming parameter value isn't identical to the existing one. Specific instances include:\nhttps://github.com/cryptoalgebra/Algebra/blob/6c22b64977e0b0266aec89470480df74977eb606/src/core/contracts/AlgebraCommunityVault.sol#L102\nhttps://github.com/cryptoalgebra/Algebra/blob/6c22b64977e0b0266aec89470480df74977eb606/src/core/contracts/AlgebraCommunityVault.sol#L123\nhttps://github.com/cryptoalgebra/Algebra/blob/6c22b64977e0b0266aec89470480df74977eb606/src/core/contracts/AlgebraCommunityVault.sol#L134\nhttps://github.com/cryptoalgebra/Algebra/blob/6c22b64977e0b0266aec89470480df74977eb606/src/core/contracts/AlgebraPool.sol#L423.\n\n##### Recommendation\nWe recommend integrating the necessary redundancy checks into the mentioned functions to ensure no reassignment with identical values.\n\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-08-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/README.md#5-no-parameter-redundancy-checks",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/Algebra%20Finance%20Core%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No explicit checks for `mint` and `swap` calls on uninitialized Pool",
        "content": "##### Description\nhttps://github.com/cryptoalgebra/Algebra/blob/6c22b64977e0b0266aec89470480df74977eb606/src/core/contracts/AlgebraPool.sol#L66  https://github.com/cryptoalgebra/Algebra/blob/6c22b64977e0b0266aec89470480df74977eb606/src/core/contracts/AlgebraPool.sol#L210 https://github.com/cryptoalgebra/Algebra/blob/6c22b64977e0b0266aec89470480df74977eb606/src/core/contracts/AlgebraPool.sol#L253 The `swap` and `mint` functions can be invoked on an uninitialized pool, leading to a potential `revert` midway through execution due to invariant checks. This might introduce vulnerabilities if there are modifications to the implementation in subsequent updates.\n##### Recommendation\nWe recommend adding an explicit precondition to preempt the following errors: `require(globalState.price != 0)`, to the`swap`, `swapWithPaymentInAdvance`, and `mint` functions.\n\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-08-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/README.md#6-no-explicit-checks-for-mint-and-swap-calls-on-uninitialized-pool",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/Algebra%20Finance%20Core%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Missing event emissions in `AlgebraCommunityVault`",
        "content": "##### Description\nCertain setters within the `AlgebraCommunityVault` contract do not emit events upon execution. Specific instances include:\nhttps://github.com/cryptoalgebra/Algebra/blob/6c22b64977e0b0266aec89470480df74977eb606/src/core/contracts/AlgebraCommunityVault.sol#L111\nhttps://github.com/cryptoalgebra/Algebra/blob/6c22b64977e0b0266aec89470480df74977eb606/src/core/contracts/AlgebraCommunityVault.sol#L123\nhttps://github.com/cryptoalgebra/Algebra/blob/6c22b64977e0b0266aec89470480df74977eb606/src/core/contracts/AlgebraCommunityVault.sol#L129.\t \n\n##### Recommendation\nTo enhance transparency and traceability, we recommend implementing appropriate event emissions for the above-mentioned functions.\n\n\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-08-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/README.md#7-missing-event-emissions-in-algebracommunityvault",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/Algebra%20Finance%20Core%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Users can't control upgrades in the plugin implementation",
        "content": "##### Description\nPlugins can affect the number of tokens that users will receive after the swap, so updating the plugin without a time delay can negatively affect users (https://github.com/cryptoalgebra/Algebra/blob/6c22b64977e0b0266aec89470480df74977eb606/src/core/contracts/AlgebraPool.sol#L401).\n\n##### Recommendation\nWe recommend adding a time delay before updating the plugin implementation.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-08-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/README.md#8-users-cant-control-upgrades-in-the-plugin-implementation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/Algebra%20Finance%20Core%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`swap` function can be executed without any tokens",
        "content": "##### Description\nThe `swap` function can be executed without any tokens from the `msg.sender` if it operates entirely within an interval with zero active liquidity.\n\n##### Recommendation\nWe recommend implementing constraints on the `swap` function, especially when the swap ends in a non-initialized tick with zero liquidity.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-08-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/README.md#9-swap-function-can-be-executed-without-any-tokens",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Core/Algebra%20Finance%20Core%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "EIP712 DOMAIN_SEPARATOR stored as immutable",
        "content": "##### Description\nTo prevent so-called \"replay attacks\", EIP712 incorporates the chain ID into the signed data. However, the audited [code's](https://github.com/bebop-dex/bebop-smart-contracts/blob/f42cc5efe7a843bb015aec409aaa08e7643d0ca9/src/contracts/base/BebopSigning.sol#L42) EIP712 implementation uses cached values (stored as immutable variables), independent of the actual chain ID which could be returned by the `CHAINID` EVM opcode. This approach is potentially unsafe as such signatures could be deemed valid in forked networks, thus creating a vulnerability to replay attacks.\n\nWhen combined with unlimited approvals (refer to Medium.1), orders placed on one network could be \"replayed\" on a forked network without the account owner's consent.\n##### Recommendation\nTo prevent replay attacks, it is recommended to adhere to the best practices of the EIP712 implementation (refer to OpenZeppelin's EIP712.sol).\n",
        "protocol": "Bebop",
        "report_date": "2023-07-27",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bebop/README.md#1-eip712-domain_separator-stored-as-immutable",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bebop/Bebop%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unjustified unlimited approvals",
        "content": "##### Description\nSeveral parts of code grant unlimited `type(uint).max` approvals even when it's not justifiable:\n- https://github.com/bebop-dex/bebop-smart-contracts/blob/f42cc5efe7a843bb015aec409aaa08e7643d0ca9/src/contracts/BebopSettlement.sol#L155\n- https://github.com/bebop-dex/bebop-smart-contracts/blob/f42cc5efe7a843bb015aec409aaa08e7643d0ca9/src/contracts/base/BebopTransfer.sol#L103\n\nNo threat is inherent to it. However, it diminishes the overall contract security and could potentially be exploited by various attack vectors.\n##### Recommendation\nIt's recommended to grant approvals only for the exact amount that is anticipated to be spent.\n",
        "protocol": "Bebop",
        "report_date": "2023-07-27",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bebop/README.md#1-unjustified-unlimited-approvals",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bebop/Bebop%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potentially unsafe usage of `ecrecover` return value",
        "content": "##### Description\nThe `ecrecover` function may return a non-zero value even if the signature is invalid. It's unsafe to use the return value of `ecrecover` for any purpose other than comparing it with a valid signer value. Currently, these parts of the code use it as an index for the `address => boolean map`:\n- https://github.com/bebop-dex/bebop-smart-contracts/blob/f42cc5efe7a843bb015aec409aaa08e7643d0ca9/src/contracts/base/BebopSigning.sol#L119\n- https://github.com/bebop-dex/bebop-smart-contracts/blob/f42cc5efe7a843bb015aec409aaa08e7643d0ca9/src/contracts/base/BebopSigning.sol#L137\n\nWhile it's unlikely that this issue can be exploited in the current code, future modifications could potentially make the issue more severe.\n##### Recommendation\nIt is recommended to use the `ecrecover` value only for comparison with the expected value, and not as an arbitrary value.\n",
        "protocol": "Bebop",
        "report_date": "2023-07-27",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bebop/README.md#2-potentially-unsafe-usage-of-ecrecover-return-value",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bebop/Bebop%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Truncation of the `nonce` value",
        "content": "##### Description\nIn the [`invalidateOrder`](https://github.com/bebop-dex/bebop-smart-contracts/blob/f42cc5efe7a843bb015aec409aaa08e7643d0ca9/src/contracts/base/BebopSigning.sol#L167) function, a `uint256` value is cast to `uint64`, silently ignoring higher bits of the value. This could lead to value collisions when different nonce values as `uint256` have the same values as `uint64`.\n\nAlthough the `uint64` value range is generally sufficient for the purpose of a `nonce`, and a `nonce` collision would likely cause a revert and, thus, it doesn't seem to be exploitable, the code's security could be further enhanced by addressing this issue.\n##### Recommendation\nIt's recommended to utilize as many bits of the value as possible (248 bits seems to be a reasonable approach for this code). Additionally, it's recommended to ensure that the truncated bits of the value were actually zero to prevent value collisions.\n",
        "protocol": "Bebop",
        "report_date": "2023-07-27",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bebop/README.md#3-truncation-of-the-nonce-value",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bebop/Bebop%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Extra msg.value could be lost",
        "content": "##### Description\nThis code ensures that the passed msg.value is large enough, but it ignores any extra msg.value that's passed:\n- https://github.com/bebop-dex/bebop-smart-contracts/blob/f42cc5efe7a843bb015aec409aaa08e7643d0ca9/src/contracts/BebopSettlement.sol#L76\n- https://github.com/bebop-dex/bebop-smart-contracts/blob/f42cc5efe7a843bb015aec409aaa08e7643d0ca9/src/contracts/BebopSettlement.sol#L210\n\nAny extra value passed to the transaction will be lost by the user.\n##### Recommendation\nIt is recommended to refund the extra msg.value or to revert transactions with an unexpectedly large msg.value.\n",
        "protocol": "Bebop",
        "report_date": "2023-07-27",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bebop/README.md#4-extra-msgvalue-could-be-lost",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bebop/Bebop%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Consequent `WETH` `deposit`/`withdraw`",
        "content": "##### Description\nIf both `nativeTokens.toMaker` and `nativeTokens.toTaker` are non-zero, the audited code will trigger a consequent `deposit` and then a `withdraw` to the `WETH`:\n- https://github.com/bebop-dex/bebop-smart-contracts/blob/f42cc5efe7a843bb015aec409aaa08e7643d0ca9/src/contracts/BebopSettlement.sol#L77-L90\n- https://github.com/bebop-dex/bebop-smart-contracts/blob/f42cc5efe7a843bb015aec409aaa08e7643d0ca9/src/contracts/BebopSettlement.sol#L211-L223\n\nIt can be simplified to a single `deposit` or `withdraw` depending on the difference between the `toMaker` and `toTaker` values.\n##### Recommendation\nIn order to optimize gas consumption, it is recommended to improve the code in accordance with the issue outlined above.\n",
        "protocol": "Bebop",
        "report_date": "2023-07-27",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bebop/README.md#1-consequent-weth-depositwithdraw",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bebop/Bebop%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Double voting in `Bootstrap.vy` in case of violation of time intervals",
        "content": "##### Description\n\n- https://github.com/yearn/yETH-bootstrap/blob/2dd219d3af49952275934638e8c9d50d0fef0d8f/contracts/Bootstrap.vy#L423\n\nThe Bootstrap contract is deployed by the owner setting key periods using the following functions: \n- set_whitelist_period()\n- set_incentive_period()\n- set_deposit_period()\n- set_vote_period()\n- set_lock_end()\n\nThere is a scenario in which the `deposit_end` and `vote_end` parameters in the `Bootstrap` contract end up being higher than `lock_end`. This can happen, for example, if the management initially sets the correct values for the time intervals but later decides to manually extend the voting by calling `set_deposit_period()` and `set_vote_period()` with increased values, forgetting to also call `set_lock_end()`.\n\nCalling `set_deposit_period()` with increased values will work without an error because requirement `_begin >= self.whitelist_begin` will be satisfied. Calling `set_vote_period()` with increased values will also work without an error because condition `_begin >= self.deposit_begin` will be satisfied.\n\nIf `deposit_end` and `vote_end` are increased enough to be higher than `lock_end`, a hacker can call `claim()` to withdraw their funds in styETH, sell them for ETH, and vote again repeating this process multiple times. Potentially, it can be done with a flash loan if the hacker finds a place to sell styETH or yETH, for example, via a curve stable pool. By accumulating votes, the hacker can claim 99.99% of all incentives from winning projects.\n\n##### Recommendation\n\nIt is recommended to check invariant `vote_end < lock_end` in the `set_vote_period()` function.\n",
        "protocol": "Yearn Finance",
        "report_date": "2023-07-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/README.md#1-double-voting-in-bootstrapvy-in-case-of-violation-of-time-intervals",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/Yearn%20Finance%20yETH-bootstrap%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Votes for cancelled protocols are lost",
        "content": "##### Description\n\n- https://github.com/yearn/yETH-bootstrap/blob/2dd219d3af49952275934638e8c9d50d0fef0d8f/contracts/Bootstrap.vy#L453\n\nIf the management calls `undo_whitelist()` for a protocol in `Bootstrap.vy` that users have already voted for, these users will not be able to reallocate their canceled votes to other projects.\n\n##### Recommendation\n\nIt is recommended to add a function that allows users to call off their votes for a canceled project.\n",
        "protocol": "Yearn Finance",
        "report_date": "2023-07-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/README.md#2-votes-for-cancelled-protocols-are-lost",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/Yearn%20Finance%20yETH-bootstrap%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "CurveLP setters should not be used to update pools if the previous liquidity is not withdrawn yet",
        "content": "##### Description\n\nCurveLP stores key pool addresses - deposits, withdrawals and approvals are deterministic to these pool. \nBut, for example, if the management calls `set_pool()` with the new pool, the operator will not be able to withdraw liquidity from the previous pool.\n\nThe are multiple of such setters:\n- https://github.com/yearn/yETH-bootstrap/blob/2dd219d3af49952275934638e8c9d50d0fef0d8f/contracts/modules/CurveLP.vy#L216\n- https://github.com/yearn/yETH-bootstrap/blob/2dd219d3af49952275934638e8c9d50d0fef0d8f/contracts/modules/CurveLP.vy#L270\n- https://github.com/yearn/yETH-bootstrap/blob/2dd219d3af49952275934638e8c9d50d0fef0d8f/contracts/modules/CurveLP.vy#L320\n- https://github.com/yearn/yETH-bootstrap/blob/2dd219d3af49952275934638e8c9d50d0fef0d8f/contracts/modules/CurveLP.vy#L349\n- https://github.com/yearn/yETH-bootstrap/blob/2dd219d3af49952275934638e8c9d50d0fef0d8f/contracts/modules/CurveLP.vy#L428\n\n##### Recommendation\n\nWe recommend checking that the previous pool does not have liquidity or allowing withdrawal from any pool and setting restriction only for new deposits.\n",
        "protocol": "Yearn Finance",
        "report_date": "2023-07-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/README.md#3-curvelp-setters-should-not-be-used-to-update-pools-if-the-previous-liquidity-is-not-withdrawn-yet",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/Yearn%20Finance%20yETH-bootstrap%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Multiple ways for the management to mint any amount of yETH not backed by real ETH",
        "content": "##### Description\n\nThe POL contract seems to manage yETH minting, even for management and modules. But current limitations are easily avoidable.\n\nFirst option. The management can:\n1) send 10 ETH to `POL.__default__()`.\n`self.available` is 10 ETH now.\n2) call send back 10 ETH to management calling `POL.send_native()`.\n`self.available` is not updated and remain 10 ETH.\n3) send received 10 ETH to `POL.__default__()`.\n`self.available` is 20 ETH now.\n\nAs a result, 10 ETH was used to set `self.available` as 20 ETH. The management can mint 20 yETH backed by only 10 ETH.\n\nSecond option, an easier one. The management can:\n1) flashloan X ETH\n2) send X ETH to `POL.__default__()`\n`self.available` is set to X ETH.\n3) call `POL.send_native()` to withdraw X ETH\n4) repay X ETH flashloan\n\nAs a result, `self.available` is set to any amount X with little cost and in one transaction.\n\n##### Recommendation\n\nThe current version of `self.available` does not set any restrictions and the whole contract does not control the backing of minted yETH.\n\nWe recommend some options:\n1) checking that this behavior is intended (`self.available` can be dropped in this case)\n2) adding the `self.available` decrease on ETH withdrawal\n3) redesigning the control of yETH backing.\n",
        "protocol": "Yearn Finance",
        "report_date": "2023-07-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/README.md#1-multiple-ways-for-the-management-to-mint-any-amount-of-yeth-not-backed-by-real-eth",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/Yearn%20Finance%20yETH-bootstrap%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An economic attack allowing protocols to bribe voters more effectively",
        "content": "##### Description\n\nAll voters receive the incentive from the winner protocol despite the direction of their votes. Voters can vote for random protocols and still receive rewards from winners. Some economic attacks are allowed:\n\n1) Protocol A bribes Voters A outside the Bootstrap. 10k USD are put on some external contract and distributed among Voters A only if Protocol A is a winner.\n2) Protocol A does not put 10k USD as incentive to Bootstrap. But Protocol B gives 10k USD to Bootstrap.\n3) Voters A vote their 50% for Protocol A. Voters B vote their 50% for Protocol B. All protocols are winners.\n4) Claiming happens:\n\nVoters A receive 10k USD from Protocol A on the external contract + 5k USD from Protocol B = 15k USD\nVoters B receive 5k USD from Protocol B.\n\nAs a result, Protocol A arranged additional profits for their Voters A stealing rewards from Voters B.\n\n##### Recommendation\n\nOnly management decides which protocols are the winners and takes into account potential vote bypasses. Therefore, with monitoring, such attacks won't work.\n",
        "protocol": "Yearn Finance",
        "report_date": "2023-07-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/README.md#2-an-economic-attack-allowing-protocols-to-bribe-voters-more-effectively",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/Yearn%20Finance%20yETH-bootstrap%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "A variable is not used",
        "content": "##### Description\n\n`POL_SPLIT` is not used.\n- https://github.com/yearn/yETH-bootstrap/blob/2dd219d3af49952275934638e8c9d50d0fef0d8f/contracts/Bootstrap.vy#LL125C1-L125C10\n\nIt was likely designed to calculate the funds split between treasury and POL during `split()`.\n\n##### Recommendation\n\nWe recommend removing this constant.\n",
        "protocol": "Yearn Finance",
        "report_date": "2023-07-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/README.md#3-a-variable-is-not-used",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/Yearn%20Finance%20yETH-bootstrap%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The yETH contract has one step for management role transferring and allows zero address as management",
        "content": "##### Description\n\nThe function does not use a two-step process for management role transferring.\n- https://github.com/yearn/yETH-bootstrap/blob/2dd219d3af49952275934638e8c9d50d0fef0d8f/contracts/Token.vy#L125-L131\n\nBut other contracts use a two-step process with the pending_management role.\n- https://github.com/yearn/yETH-bootstrap/blob/2dd219d3af49952275934638e8c9d50d0fef0d8f/contracts/POL.vy#L125-L147\n\n##### Recommendation\n\nWe recommend using the same process of management role transferring as on other contracts (with the pending_management).\n",
        "protocol": "Yearn Finance",
        "report_date": "2023-07-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/README.md#4-the-yeth-contract-has-one-step-for-management-role-transferring-and-allows-zero-address-as-management",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/Yearn%20Finance%20yETH-bootstrap%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The Bootstrap.repay() function is likely supposed to be called by protocol addresses only, but it is public and just burns tokens",
        "content": "##### Description\n\nrepay() takes yETH tokens and burn them, giving nothing in return.\n- https://github.com/yearn/yETH-bootstrap/blob/2dd219d3af49952275934638e8c9d50d0fef0d8f/contracts/Bootstrap.vy#L262-L271\n\n\nIt is used in the Shutdown contract as a part of a multi-step logic.\n- https://github.com/yearn/yETH-bootstrap/blob/2dd219d3af49952275934638e8c9d50d0fef0d8f/contracts/modules/Shutdown.vy#L47-L58\n\nThis function is available for all users and it is not obvious that it results in just losing funds.\n\n##### Recommendation\n\nWe recommend shortlisting addresses allowed to call this function.\n",
        "protocol": "Yearn Finance",
        "report_date": "2023-07-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/README.md#5-the-bootstraprepay-function-is-likely-supposed-to-be-called-by-protocol-addresses-only-but-it-is-public-and-just-burns-tokens",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/Yearn%20Finance%20yETH-bootstrap%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Rebase and deflationary tokens used as incentive can get stuck on the Bootstrap contract",
        "content": "##### Description\n\nThe Bootstrap contract for incentives stores the amount of tokens \"to be transferred\", but not the amount which can be sent later.\n\n- https://github.com/yearn/yETH-bootstrap/blob/2dd219d3af49952275934638e8c9d50d0fef0d8f/contracts/Bootstrap.vy#L168-L183\n\nAs a result, claim_incentive() and refund_incentive() can leave some tokens stuck on the contract if Bootstrap does not have enough balance for transfers.\n- https://github.com/yearn/yETH-bootstrap/blob/2dd219d3af49952275934638e8c9d50d0fef0d8f/contracts/Bootstrap.vy#L300-L338\n\n##### Recommendation\n\nWe recommend adding the list of allowed tokens in the documentation or accept the risk that some tokens can get stuck.\n",
        "protocol": "Yearn Finance",
        "report_date": "2023-07-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/README.md#6-rebase-and-deflationary-tokens-used-as-incentive-can-get-stuck-on-the-bootstrap-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/Yearn%20Finance%20yETH-bootstrap%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The `operator` can make an approve to the zero address",
        "content": "##### Description\n\n- https://github.com/yearn/yETH-bootstrap/blob/2dd219d3af49952275934638e8c9d50d0fef0d8f/contracts/modules/CurveLP.vy#L232\n\nThe operator can make an extra approve to the zero address.\n\n##### Recommendation\n\nWe recommend adding the following check:\n\n```\nassert self.pool != empty(address)\n```\n",
        "protocol": "Yearn Finance",
        "report_date": "2023-07-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/README.md#7-the-operator-can-make-an-approve-to-the-zero-address",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/Yearn%20Finance%20yETH-bootstrap%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Add an additional event",
        "content": "##### Description\n\nThere is no event for the change of `convex_pool_id`:\n- https://github.com/yearn/yETH-bootstrap/blob/2dd219d3af49952275934638e8c9d50d0fef0d8f/contracts/modules/CurveLP.vy#L336\n\n##### Recommendation\n\nWe recommend adding a new event for `convex_pool_id`.\n",
        "protocol": "Yearn Finance",
        "report_date": "2023-07-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/README.md#8-add-an-additional-event",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yETH-bootstrap/Yearn%20Finance%20yETH-bootstrap%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unrestricted access to the `setVibeFees` function in `MintSaleBase`",
        "content": "##### Description\nThe `setVibeFees` function within the `MintSaleBase` contract is protected by the `onlyMasterContractOwner` modifier. However, anyone can call this function if the contract is the implementation contract itself, meaning it has no master contract. An exploiter via this vulnerability can monitor the deployment transactions of the `MintSaleBase` inheritor contracts and submit their transaction before deployment, thereby setting the `vibeTreasury` field to their address and arbitrarily increasing the value of the `feeTake` field. Consequently, the owner of the `masterContract` must reset the values back and re-establish the `fee` parameters of the affected copy.\n\n##### Recommendation\nWe recommend adding the following require statement to the `onlyMasterContractOwner` modifier that verifies if the contract doesn't have a master contract. In such cases, only the owner of the contract should be allowed to pass this modifier. We propose adding the following line here: [https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/MintSaleBase.sol#L69]\n```solidity\nrequire(msg.sender == owner())\n```\n\n***\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#1-unrestricted-access-to-the-setvibefees-function-in-mintsalebase",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potential reinitialization of the `VibeERC721` contract",
        "content": "##### Description\nThe `baseURI` field can be set to an empty string using the `changeBaseURI` function https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/tokens/VibeERC721.sol#L223. It allows to call the `init` function by anyone and subsequently claim the ownership of the entire `VibeERC721` contract https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/tokens/VibeERC721.sol#L79.\n\n##### Recommendation\nWe recommend adding the following check to the `changeBaseURI` function:\n`require(bytes(baseURI)_.length != 0);`\n\n***\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#1-potential-reinitialization-of-the-vibeerc721-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`NFTMintSaleMultiple` won't work if other minter mints tokens with an id intersected with the id range on sale",
        "content": "##### Description\nIf an external minter of `nft` mints a token with an id that falls within the range of ids specified for sale, the functionality of `NFTMintSaleMultiple` can be disrupted. When such an intersecting mint occurs, the `buyNFT` function will fail to execute as the `nft.mintWithId(recipient, id)` https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSaleMultiple.sol#L77 call will revert due to the conflicting id.\n\n##### Recommendation\nWe recommend allowing to use only `mint` or `mintWithId` in a specific instance of the VibeERC721 contract.\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#2-nftmintsalemultiple-wont-work-if-other-minter-mints-tokens-with-an-id-intersected-with-the-id-range-on-sale",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Lack of checks in the `setVibesFee` function",
        "content": "##### Description\nThe `setVibesFee` function currently lacks checks to ensure that the `vibeTreasury_` parameter is not set to the zero address and that the `feeTake_` parameter does not exceed the `BPS`. It can potentially lead to a DoS scenario if these parameters are mistakenly set in such a way.\n\n##### Recommendation\nWe recommend setting the following checks within the `setVibesFee` function https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/MintSaleBase.sol#L76:\n```solidity\nrequire(vibeTreasury_ != address(0));\nrequire(feeTake_ <= BPS);\n```\n***\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#1-lack-of-checks-in-the-setvibesfee-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Lack of checks in the `init` function of `NFTMintSale` and `NFTMintSaleMultiple` contracts",
        "content": "##### Description\nThe `init` function in both the `NFTMintSale` and `NFTMintSaleMultiple` contracts currently lacks checks to prevent certain scenarios that can lead to unintended consequences. Firstly, there is no check to ensure that the `proxy` argument is not set to the zero address which can potentially lead to the reinitalization of the contract with the complete loss of ownership. Additionally, there are no checks to verify that `endTime >= beginTime` and that `beginTime > block.timestamp`. These checks are essential to maintain the integrity of the contract and prevent violations of the specified invariants.\n\n##### Recommendation\nWe recommend implementing the stated checks within the `init` function of both the `NFTMintSale` https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSale.sol#L31 and `NFTMintSaleMultiple` https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSaleMultiple.sol#L30 contracts.\n\n***\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#2-lack-of-checks-in-the-init-function-of-nftmintsale-and-nftmintsalemultiple-contracts",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "External mints affect the number of tokens available for sale in `NFTMintSale`",
        "content": "##### Description\nIf an external minter of `nft` mints a token, it affects the `nft.totalSupply()` value, reducing the number of available tokens for sale in the `NFTMintSale` contract.\n\n##### Recommendation\nWe recommend using a local counter of minted tokens within the `NFTMintSale` contract instead of relying solely on the `nft.totalSupply()` https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSale.sol#L59. This approach will prevent interference between external mints and the availability of tokens for sale.\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#3-external-mints-affect-the-number-of-tokens-available-for-sale-in-nftmintsale",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Lack of checks on the payed amount in `buyNFT` and `buyMultipleNFT` functions if `paymentToken` is `WETH`",
        "content": "##### Description\nThe `buyNFT` and `buyMultipleNFT` functions currently lack checks to verify that `msg.value` matches the expected payment amount when the `paymentToken` is set to `WETH`. If users accidentally send more ether than the intended payment amount, the funds that exceed the payment amount will be locked within the contract forever, as there is no mechanism to redeem ether from the contract.\n\n##### Recommendation\nWe recommend adding the following checks to `buyNFT` (https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSale.sol#L69,\n https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSaleMultiple.sol#L76) \nand `buyMultipleNFT` (https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSale.sol#L80,\nhttps://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSaleMultiple.sol#L86) functions:\n```solidity=\nif (paymentToken == WETH) {\n    require(msg.value == payedAmount)\n} else {\n    require(msg.value == 0)\n}\n```\nHere, the `payedAmount` is the sum of prices for the tokens being purchased.\n\n***\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#4-lack-of-checks-on-the-payed-amount-in-buynft-and-buymultiplenft-functions-if-paymenttoken-is-weth",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Lack of checks in the `setMerkleTree` function of `NFTMintSaleWhitelistingMultiple`",
        "content": "##### Description\n\nThe `setMerkleTree` function in the `NFTMintSaleWhitelistingMultiple` contract currently lacks checks to ensure that the `merkleRoot` values are set for all tiers. It allows the contract owner to accidentally set the `merkleRoot` of higher tiers to `bytes32(0)`, effectively allowing anyone to mint up to the `NON_WHITELISTED_MAX_PER_USER` amount of tokens from those tiers.\n\n##### Recommendation\nWe recommend adding the following check within `setMerkleRoot` https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSaleWhitelistingMultiple.sol#L28 function:\n```solidity=\nrequire(\n    merkleRoot_.length == tiers.length && \n    merkleRoot_.length == externalURI_.length\n);\n```\nIt ensures that the `merkleRoot` values are set intentionally for all the tiers.\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#5-lack-of-checks-in-the-setmerkletree-function-of-nftmintsalewhitelistingmultiple",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Lack of checks of tier range in the `init` function of the `NFTMintSaleMultiple` contract",
        "content": "##### Description\nThe `init` function within the `NFTMintSaleMultiple` contract currently verifies that the id ranges of different tiers do not intersect with each other and appear in increasing order. However, there is a missing check for the last tier with index `0`.\nhttps://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSaleMultiple.sol#L62\n\n##### Recommendation\nWe recommend adding a corresponding check for the last tier in the `init` function of the `NFTMintSaleMultiple` contract.\n\n***\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#6-lack-of-checks-of-tier-range-in-the-init-function-of-the-nftmintsalemultiple-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Lack of checks within the `init` function of `RoyaltyReceiver`",
        "content": "##### Description\nThe `init` function within the `RoyaltyReceiver` contract currently lacks a check to ensure that the lengths of the `recipients_` and `recipientsBPS_` arrays are equal. It leaves the contract exposed to a potential DoS until the owner of the contract calls `setRecipientsAndBPS` again to rectify the mismatched lengths.\n\n##### Recommendation\nWe recommend adding a check within the init function to verify that `recipients_.length == recipientsBPS_.length`.\nhttps://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/RoyaltyReceiver.sol#L19\n\n***\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#7-lack-of-checks-within-the-init-function-of-royaltyreceiver",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Ownership is not set in `createERC721` in some cases",
        "content": "##### Description\nThe user can call the `createERC721` function declared here - https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/VibeFactory.sol#L352. If the user set the `owner` parameter to `address(0)` then `SimpleFactory` would own the `VibeERC721` contract and anyone would be able to trigger `transferOwnership` here - https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/SimpleFactory.sol#L35. If the user wanted to transfer ownership to themself in the second step, then their second transaction could be frontrunned by an attacker, a new minter can be set and then ownership can be given back to `SimpleFactory` so that users tx would succeed.\n\n##### Recommendation\nWe recommend transferring ownership to `msg.sender` in the `createERC721` function if the `owner` parameter is equal to `address(0)`. There are cases when `createERC721` is intentionally called with `address(0)` to leave `factory` as an owner for future initialization. Instead of `address(0)` - `address(factory)` can be passed.\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#8-ownership-is-not-set-in-createerc721-in-some-cases",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Royalty parameters are not checked",
        "content": "##### Description\nRoyalty parameters are used to calculate how much fees should be paid to the royalty receiver https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/tokens/VibeERC721.sol#L205-L210. If `royaltyRate_` is greater than `BPS` then royalty payment will revert.\n\n##### Recommendation\nWe recommend adding checks for royalty parameters.\n\n***\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#9-royalty-parameters-are-not-checked",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`OPERATOR_FILTER_REGISTRY` can be missing in a new network",
        "content": "##### Description\n`VibeERC721` contract uses `onlyAllowedOperatorApproval` and `onlyAllowedOperator` modifiers that required deployed `OPERATOR_FILTER_REGISTRY` for correct work https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/tokens/VibeERC721.sol#L132 But it can be not deployed on a new networks.\n\n##### Recommendation\nWe recommend adding a check that `OPERATOR_FILTER_REGISTRY` is deployed on the network that will be used for the protocol deployment.\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#10-operator_filter_registry-can-be-missing-in-a-new-network",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`NON_WHITELISTED_MAX_PER_USER` of `NFTMintSaleWhitelistingMultiple` is shared between the tiers",
        "content": "##### Description\nThe `NON_WHITELISTED_MAX_PER_USER` parameter is currently shared across all tiers in the `NFTMintSaleWhitelistingMultiple` contract https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSaleWhitelistingMultiple.sol#L53. This means that non-whitelisted users are allowed to purchase the same maximum amount of tokens for each tier.\n\n##### Recommendation\nWe recommend modifying the parameter `NON_WHITELISTED_MAX_PER_USER` to be an array that describes the maximum amount of tokens non-whitelisted users are allowed to mint for each tier.\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#1-non_whitelisted_max_per_user-of-nftmintsalewhitelistingmultiple-is-shared-between-the-tiers",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unused variables",
        "content": "##### Description\n`masterNFT` within `MintSaleBase` https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/MintSaleBase.sol#LL41C15-L41C15 is unused.\n\n##### Recommendation\nWe recommend removing the `masterNFT` variable.\n\n***\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#2-unused-variables",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Lack of event emission in setter functions",
        "content": "##### Description\nThe following setter functions do not emit any events:\n* `setVibesFee` within `NFTMintSaleBase` https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/MintSaleBase.sol#L76,\n* `setMerkleRoot` within `NFTMintSaleWhitelisting` https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSaleWhitelisting.sol#L26,\n* `setMerkleRoot` within `NFTMintSaleWhitelistingMultiple` https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSaleWhitelistingMultiple.sol#L27.\n##### Recommendation\nWe recommend adding `emit event` statements within the listed functions.\n\n***\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#3-lack-of-event-emission-in-setter-functions",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`paymentToken` argument within the `getPayment` function can be removed",
        "content": "##### Description\nThe `getPayment` internal function within the `NFTMintSaleBase` contract currently includes the `paymentToken` argument https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/MintSaleBase.sol#L80. All the occurrences of this function are called with the value of`paymentToken` field of the `NFTMintSaleBase` contract.\n\n##### Recommendation\nWe recommend removing the `paymentToken` argument from the `getPayment` function.\n\n***\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#4-paymenttoken-argument-within-the-getpayment-function-can-be-removed",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unused function parameter",
        "content": "##### Description\nAt line https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/RoyaltyReceiver.sol#L64 the `distribute` function is declared. It has an `amount` as an input parameter, but its value is never used.\n\n##### Recommendation\nWe recommend removing the `amount` parameter and not passing the `total - fee` value here - https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/MintSaleBase.sol#L99.\n\n***\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#5-unused-function-parameter",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Repetition of time range checks in the `buyMultipleNFT` functions",
        "content": "##### Description\nThe `buyMultipleNFT` function in both the `NFTMintSale` and `NFTMintSaleMultiple` contracts currently calculates check that the sale is still ongoing multiple times. It results in redundant calculations of the same expression https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSale.sol#L59, https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSaleMultiple.sol#L75.\n\n##### Recommendation\nWe recommend moving this time range check to the beginning of the corresponding `buyNFT` and `buyMultipleNFT` functions ensuring this check is performed only once and refactoring the base logic of the `buyNFT` function of the `NFTMintSaleMultiple` contract to the internal `_buyNFT` function.\n\n***\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#6-repetition-of-time-range-checks-in-the-buymultiplenft-functions",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Multiple `getPayment` calls within the `buyMultipleNFT` function of `NFTMintSaleMultiple` can be simplified",
        "content": "##### Description\nThe `buyMultipleNFT` function in the `NFTMintSaleMultiple` contract currently makes multiple calls to `buyNFT` in a loop https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSaleMultiple.sol#L84, which results in multiple calls to `getPayment` for each minted token. This can be simplified by using an accumulator variable to keep track of the total price of the minted tokens. With this accumulator sum, you can make a single call to the `getPayment` function after all the tokens have been minted.\n\n##### Recommendation\nWe recommend using one `getPayment` call here using the accumulator sum variable representing the total sum price.\n\n***\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#7-multiple-getpayment-calls-within-the-buymultiplenft-function-of-nftmintsalemultiple-can-be-simplified",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The `NON_WHITELISTED_MAX_PER_USER` parameter is taking effect only if `merkleRoot` is not set",
        "content": "##### Description\nThe current implementation of the `_preBuyCheck` function in the `NFTMintSaleWhitelisting` contract relies on the `merkleRoot` being set to `bytes32(0)` to make the `NON_WHITELISTED_MAX_PER_USER` parameter the maximum limit of tokens to mint https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSaleWhitelisting.sol#L40. This means that if the `merkleRoot` is set, the `NON_WHITELISTED_MAX_PER_USER` parameter has no effect, making it impossible to create a sale that allows whitelisted users to have a different maximum mint amount than non-whitelisted users.\n\n##### Recommendation\nWe recommend adjusting the `require` statement within the `_preBuyCheck` functions (https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSaleWhitelisting.sol#L33,\nhttps://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSaleWhitelistingMultiple.sol#L36) as follows:\n\n```solidity\nrequire(\n    claimed[msg.sender].claimed < claimed[msg.sender].max ||\n    claimed[msg.sender].claimed < NON_WHITELISTED_MAX_PER_USER\n);\n```\nWith this adjustment, the `require` statement ensures that a user can buy up to the `NON_WHITELISTED_MAX_PER_USER` amount of NFT tokens if they haven't called `initUser`. This change allows for more fine-grained control over the maximum mint amount for whitelisted and non-whitelisted users.\n\nAfter making this adjustment, the `else` branch in the `initUser` function becomes redundant and can be removed (https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSaleWhitelisting.sol#L50,\nhttps://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSaleWhitelistingMultiple.sol#L53). Additionally, this change allows the owner of the sale to set `NON_WHITELISTED_MAX_PER_USER` to `0` if they don't want to sell tokens to non-whitelisted users.\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#8-the-non_whitelisted_max_per_user-parameter-is-taking-effect-only-if-merkleroot-is-not-set",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Inconsistent order of `name` and `symbol` arguments in creation functions",
        "content": "##### Description\nThe order of the `name` and `symbol` arguments in the creation functions of the `VibeFactory` contract (`createERC721` https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/VibeFactory.sol#L353, `createNFTMintSaleMultiple` https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/VibeFactory.sol#L279, `createNFTMintSaleMultipleWhitelisting` https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/VibeFactory.sol#L238, `createNFTMintSaleWhitelisting` https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/VibeFactory.sol#L165, `createNFTMintSale` https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/VibeFactory.sol#L120) differs, causing potential confusion for users who interact with these functions. Since both arguments have the same type, inconsistent ordering may lead to unintended parameter assignments and mistakes.\n\n##### Recommendation\nWe recommend using the same order for the `name` and `symbol` arguments in all the creation functions of the `VibeFactory` contract.\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#9-inconsistent-order-of-name-and-symbol-arguments-in-creation-functions",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`SimpleFactory` can be drained out of ether",
        "content": "##### Description\nThe `SimpleFactory` contract inherits from `BoringFactory` and `BoringBatchable`. `BoringBatchable` acts as a multicall and `BoringFactory` uses `msg.value` inside the `deploy` function. It is possible for `SimpleFactory` to store ether as it has an `exec` function which is not `payable`, but uses `value` with a call. An attacker can provide their contract to the `deploy` function and create multiple deployments using `batch`. Together with a batch attacker can provide a small `msg.value` which will be duplicated inside the `deploy` function on `init`. The attackers' contract would send the `msg.value` amount to a pre-defined address in the `init` function. It will lead to `SimpleFactory` being drained out of funds.\n\n##### Recommendation\nWe recommend changing the `exec` function and making it `payable` here - https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/SimpleFactory.sol#L39 so that in future there is no need to pre-fund `SimpleFactory` with ether.\n\n***\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#10-simplefactory-can-be-drained-out-of-ether",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Dust can be left on the contract because of the rounding",
        "content": "##### Description\nAt line https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/RoyaltyReceiver.sol#L58 transferrable `amount` is calculated based on `totalAmount` and pre-defined `recipientBPS[i]`. In some cases, there will be a residue here `totalAmount * recipientBPS[i] / BPS` which will be stuck in the contract.\n\n##### Recommendation\nWe recommend sending dust to any of the recipients.\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#11-dust-can-be-left-on-the-contract-because-of-the-rounding",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary inheritance from `Ownable`",
        "content": "##### Description\n`NFTMintSale` and `NFTMintSaleMultiple` contracts are inherited from `MintSaleBase` and `Ownable`. But `MintSaleBase` is already inherited from `Ownable`. \n\n##### Recommendation\nWe recommend removing unnecessary inheritance from `Ownable` in `NFTMintSale` and `NFTMintSaleMultiple` contracts.\n\n***\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#12-unnecessary-inheritance-from-ownable",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Missing zero address and zero total checks in `claimEarnings`",
        "content": "##### Description\nThere is a `claimEarnings` function here - https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/MintSaleBase.sol#LL88C14-L88C27. It accepts the `proceedRecipient` address as a parameter and uses the `total` variable which represents the contract balance in pre-defined `paymentToken`. In cases when the `total` is zero ,`claimEarnings` call would still be completed. Also, it is possible to transfer funds to a zero address. \n\n##### Recommendation\nWe recommend adding checks that `proceedRecipient` is not a zero address and `total` is not equal to zero.\n\n***\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#13-missing-zero-address-and-zero-total-checks-in-claimearnings",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`renounceMinter` can be called by anyone",
        "content": "##### Description\nThe `renounceMinter` function is declared here - https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/tokens/VibeERC721.sol#L68. That function can be called by anyone and it emits the `LogMinterChange` event. Such events can be misleading for some external tools.\n\n##### Recommendation\nWe recommend adding the `require(isMinter[msg.sender])` check at the beginning of the function. It will ensure that the caller is an actual minter.\n\n***\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#14-renounceminter-can-be-called-by-anyone",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The missing check for `newEndTime`",
        "content": "##### Description\nThere is an `extendEndTime` function here - https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/MintSaleBase.sol#L124. It allows contract owner to set new `endTime` for sale. But there is no check that `newEndTime` is bigger than `beginTime`. `beginTime` may be in the future, so it is possible to make a mistake.\n\n##### Recommendation\nWe recommend adding a check that `newEndTime` is bigger than `beginTime`. Also, check that `nft.isMinter(address(this)) == true` can be added to exclude cases when the current minter was renounced.\n\n***\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#15-the-missing-check-for-newendtime",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`totalSupply` doesn't represent the actual token supply",
        "content": "##### Description\nThe `totalSupply` variable is used here - https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/tokens/VibeERC721.sol#L87. It helps to define the next minted token id. But in cases of `burn` or `mintWithId` that variable doesn't represent actual total token supply. \n\n##### Recommendation\nWe recommend using different naming for the variable which is used to define the next token id.\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#16-totalsupply-doesnt-represent-the-actual-token-supply",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`require` checks without messages",
        "content": "##### Description\nThere are a few `require` checks without corresponding messages - https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/RoyaltyReceiver.sol#L21, https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/RoyaltyReceiver.sol#L32, https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/RoyaltyReceiver.sol#L42, https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/RoyaltyReceiver.sol#L49, https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/tokens/VibeERC721.sol#L59, https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/tokens/VibeERC721.sol#L79, https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/tokens/VibeERC721.sol#L187, https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/tokens/VibeERC721.sol#L200, https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/MintSaleBase.sol#L67, https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/MintSaleBase.sol#L125, https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSale.sol#L59, https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSaleMultiple.sol#L75.\n\n##### Recommendation\nWe recommend adding necessary messages to the mentioned checks.\n\n***\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#17-require-checks-without-messages",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The current minter status is not checked",
        "content": "##### Description\nStatus can be changed to the same one here https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/tokens/VibeERC721.sol#L64.\n\n##### Recommendation\nWe recommend adding a check that the new status differs from the previous one.\n\n***\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#18-the-current-minter-status-is-not-checked",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`claimed` can be updated for non-existing tiers",
        "content": "##### Description\nIt is possible to update `claimed` mapping for non-existing tiers https://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/mint/NFTMintSaleWhitelistingMultiple.sol#L56\n\n##### Recommendation\nWe recommend adding a check that the `claimed` mapping cannot be updated for non-existing tiers.\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#19-claimed-can-be-updated-for-non-existing-tiers",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Fees are not distributed at the beginning of `RoyaltyReceiver.setRecipientsAndBPS()`",
        "content": "##### Description\nIf `RoyaltyReceiver.setRecipientsAndBPS()` is called, collected to that moment royalties are not distributed between old recipients. So, old royalties will be collected by new recipients.\n\n##### Recommendation\nWe recommend distributing already collected royalties at the beginning of `RoyaltyReceiver.setRecipientsAndBPS()`.\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#20-fees-are-not-distributed-at-the-beginning-of-royaltyreceiversetrecipientsandbps",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "NFT-owner can run minting again after `MintSaleBase.removeTokensAndReclaimOwnership()` was called",
        "content": "##### Description\nAfter `MintSaleBase.removeTokensAndReclaimOwnership()` was called by NFT-owner, they can make a minting contract minter again with `VibeERC721.setMinter()`:\nhttps://github.com/vibexyz/vibe-contract/blob/d08057edbaf83b00d94dcaca2a05e3c44a45e4d9/contracts/tokens/VibeERC721.sol#L63\nSo, multiple `SaleEnded` or `SaleEndedEarly` events can be emitted for the same minting. If these events are used somewhere, it can lead to problems.\n\n##### Recommendation\nWe recommend adding some flags so that the minting is finished.\n",
        "protocol": "Vibe",
        "report_date": "2023-06-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/README.md#21-nft-owner-can-run-minting-again-after-mintsalebaseremovetokensandreclaimownership-was-called",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Vibe/Vibe%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Withdrawal of tokens from AMM",
        "content": "##### Description\n\n`Controller` allows to call `AMM` via callback:\n\n```\nwithdraw_sig = get_method_id(\"withdraw(address,uint256)\") # AMM\n\ncontroller.liquidate_extended(user, 0, frac, True, \n    market_amm.address, withdraw_sig, [])\n```\n\nhttps://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/AMM.vy#L728\n\n```\ndef withdraw(user: address, frac: uint256) -> uint256[2]:\n```\n\nThis method is sufficient to fulfill all the necessary conditions for a callback (https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/Controller.vy#L525).\n\nUsing `liquidate_extended`, a hacker has the ability to withdraw any amount from `AMM`. It is also possible to make a complete liquidation through a partial one.\n\nThe test script was handed over to the customer.\n\n##### Recommendation\n\nIt is recommended to use a specific signature for calling a callback.\n",
        "protocol": "Curve Finance",
        "report_date": "2023-06-05",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/README.md#1-withdrawal-of-tokens-from-amm",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/Curve%20Stablecoin%20(crvUSD)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Inflation attack on empty ticks",
        "content": "##### Description\n\nEach AMM tick represents an empty vault, where shares are issued for collateral. A hacker can manipulate a tick so that it contains just 1 wei share and any amount of collateral. For example, suppose the hacker initially inflates the tick so that it contains 1 wei share and 1 ETH. Next, the hacker sees a victim's transaction in the mempool, which is going to deposit 20 ETH into this tick. The hacker then needs to inflate the tick to contain 1 wei share and 10 ETH + 1 wei right before the victim's transaction.\n\nHow many shares will the victim receive in this tick? The victim receives 1 wei share due to a rounding error:\n```\n1 wei share * 20 ETH / (10 ETH + 1 wei) = 1 wei share\n```\n\nNow there are 2 wei shares in total in this tick, one for the victim and one for the hacker.\n\nThe hacker then self-liquidates and receives 50% of the ether from the entire tick, which is 15 ETH, even though they initially invested 10 ETH. The profit is +5 ETH.\n\n**How does the hacker inflate the collateral in the tick?**\n\nStep 1. Before the frontrunning, the hacker ensures that the tick contains 1 share and 100+ wei ETH. They can do it using the AMM fee, performing `exchange()` back and forth. This is a heavy operation, plus there may be fees if there are other positions before the hacker's ticks. Therefore, this must be done in advance. After that the hacker self-liquidates 99% of their position, leaving one share. If there are no other positions before the hacker, they only spend money on gas.\n\nStep 2. Next, the hacker attacks themselves using an inflation attack. To do this, they perform `create_loan()+repay()` 100 times from another account. Each pass inflates the collateral by 1.5 times.\n\nHow it works:\n\nSuppose the tick currently contains 1 wei share and 106 wei collateral. The hacker deposits (106 * 2 - 1) wei collateral into the tick. How many shares will be minted?\n```\n1 wei share * (106 * 2 - 1) / 106 = 1 wei share\n```\n\nOnly 1 wei share was minted due to a rounding error.\n\nNow the tick has 2 wei shares and approximately `106 * 3` wei collateral.\n\nWhat happens when the hacker performs a full repay? They get back approximately\n```\n106 * 3 / 2 wei\n```\n\nThe tick remains with approximately the same amount: 1 wei share and `106 * 3 / 2` wei collateral.\n\nIt can be seen that one pass of `create_loan()+repay()` does not change the number of shares but increases the collateral by 1.5 times. 100 rounds can inflate the collateral from 106 wei to 42 ETH.\n\nThe test script was handed over to the customer.\n\n##### Recommendation\n\nThere are different approaches on how to solve the Inflation Attack problem. Some of the approaches along with their pros and cons, can be found in the OpenZeppelin github issue: https://github.com/OpenZeppelin/openzeppelin-contracts/issues/3706.\n\nOne way to resolve the problem is to use virtual dead shares, as implemented in the latest OpenZeppelin ERC-4626 vault:\n* https://github.com/OpenZeppelin/openzeppelin-contracts/blob/51294b7480fd13e716207a621ac1d55a6290d56d/contracts/token/ERC20/extensions/ERC4626.sol#L200\n* https://github.com/OpenZeppelin/openzeppelin-contracts/blob/51294b7480fd13e716207a621ac1d55a6290d56d/contracts/token/ERC20/extensions/ERC4626.sol#L207\n\nIn case this particular fix is chosen, it is recommended to use a virtual offset of 1000 ([which is the same number used in Uniswap V2](https://github.com/Uniswap/v2-core/blob/ee547b17853e71ed4e0101ccfd52e70d5acded58/contracts/UniswapV2Pair.sol#L120)), as this will make the residual possibility of griefing practically unattainable.\n",
        "protocol": "Curve Finance",
        "report_date": "2023-06-05",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/README.md#2-inflation-attack-on-empty-ticks",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/Curve%20Stablecoin%20(crvUSD)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Withdrawal of tokens with debt as zero",
        "content": "##### Description\n\nThis code allows you not to spend debt in liquidation (\nhttps://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/Controller.vy#L990):\n```\ndebt = unsafe_div(debt * frac, 10**18)\n```\n\nIf `debt * frac` is less than 10**18, then you don't have to pay for the liquidation part. We especially have the ability to eliminate the entire collateral by passing frac as 1. Example:\n\n```\nl_amount = 1\n\ncollateral_token._mint_for_testing(user, c_amount)\nmarket_controller.create_loan(c_amount, l_amount, n)\nmarket_controller.liquidate_extended(user, 0, 10 ** 18 - 1, \n    True, ZERO_ADDRESS, [])\n# d_debt = 0\n# xy[0] = 0\n# xy[1] 1000\n# PROFIT stablecoin.balanceOf(user) +0\n# PROFIT collateral_token.balanceOf(user) +1000\n```\n\nIn this case, the attack is disadvantageous due to the gas.\n\n##### Recommendation\n\nIt is recommended to add an additional check that `debt != 0`.\n",
        "protocol": "Curve Finance",
        "report_date": "2023-06-05",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/README.md#1-withdrawal-of-tokens-with-debt-as-zero",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/Curve%20Stablecoin%20(crvUSD)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`AMM.exchange()` produces negative fees",
        "content": "##### Description\n\nUsing `exchange()` back-and-forth can generate profit without losing stablecoins. This occurs due to inaccuracies in calculating the invariant when AMM fees are low.\n\nThe profit generated from each tick is small (approximately 0.000000000136353050%), but under certain circumstances it can be significant enough for a hacker to execute an attack.\n\nFor example, let's assume that there are 100 billion USD spread across 1000 ticks and both the AMM fee and AMM admin fee are equal to zero. In this case, during a single back-and-forth pass, the hacker would earn 0.000000000136353050% from each tick and their total profit from the 100 billion would be approximately 0.136 USD.\n\nIf we consider that such a back-and-forth pass would take 833,333 gas, then at the current gas prices on the Ethereum mainnet, such an attack would not be economically feasible.\n\nHowever, the attack may become more relevant in the future if it is executed on a sidechain with low gas fees. For example, at a gas price of 130 gwei on the Polygon MATIC network (1 MATIC = $0.93), the hacker would spend approximately $0.10 on the attack but earn $0.136. The hacker can repeat the back-and-forth passes in a cycle within a single transaction 1000 times in a cycle and will get a net profit of $36 from a single transaction. By repeating this attack over and over again, they would be able to drain a significant portion of the funds available in the AMM.\n\nThe attack works with an AMM fee ranging from 0 to 650,000. Starting from an AMM fee of 1,000,000, the attack fails.\n\n##### Recommendation\n\nIt is recommended to set a limit on the minimum possible AMM fee of no less than 1,000,000.\n",
        "protocol": "Curve Finance",
        "report_date": "2023-06-05",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/README.md#2-ammexchange-produces-negative-fees",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/Curve%20Stablecoin%20(crvUSD)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Raw calls on ETH transfers allow reentrancy",
        "content": "##### Description\n\nIf WETH is used as collateral, users can choose to receive native ETH when it is sent to users. It happens in function `_withdraw_collateral()`.\n\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/Controller.vy#L514-L521\n\nIt breaks Checks-Effects-Interactions pattern. So, a call to an arbitrary address can be made in the middle of functions `repay()` and `_liquidate()`.\n\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/Controller.vy#L731\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/Controller.vy#L795\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/Controller.vy#L1054\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/Controller.vy#L1069\n\nThus, an attacker can reenter some other smart contract (excluding this Controller). For example, this attacker can call`rate_write()` in `AggMonetaryPolicy`, and the rate will be updated using old `total_debt` (not affected by ongoing `repay` or `liquidate`).\n\n##### Recommendation\n\nWe recommend limiting gas on native ETH transfers.\n\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-06-05",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/README.md#1-raw-calls-on-eth-transfers-allow-reentrancy",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/Curve%20Stablecoin%20(crvUSD)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Not formalized stablecoin minting to addresses",
        "content": "##### Description\n\nAdmin of `ControllerFactory` can mint any amount of stablecoin to any address calling `set_debt_ceiling`. It is designed to mint tokens to Controllers, but the function does not check that a receiver is among Controllers.\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/ControllerFactory.vy#L306-L313\n\nMoreover, this function is used to mint tokens to PegKeepers, and there are no checks that a receiver is among PegKeepers. The whole process is not protected and requires strong admin attention.\n\n##### Recommendation\n\nWe recommend checking that the inputted address in `set_debt_ceiling` is allowed to receive mint stablecoins (is among either Controllers or PegKeepers).\n",
        "protocol": "Curve Finance",
        "report_date": "2023-06-05",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/README.md#2-not-formalized-stablecoin-minting-to-addresses",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/Curve%20Stablecoin%20(crvUSD)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Early liquidations via `repay()` front-running",
        "content": "##### Description\n\nIf a user's position is underwater, a partial `repay()` does not move the borrower's bands but merely reduces the `initial_debt`:\n```\nelse:  # partial repay\n\nif ns[0] > active_band:\n    # Not in liquidation - can move bands\n    ...\n\nelse:\n    # Underwater - cannot move band but can avoid a bad liquidation\n    ... # do nothing\n\nself.loan[_for] = Loan({initial_debt: debt, rate_mul: rate_mul})    \n```\n\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/Controller.vy#L777-L781\n\nA hacker can sandwich the victim's transaction:\n1. The hacker uses `exchange()` to move the `active_band` forward so the user's position becomes underwater. \n2. Then the user performs a partial `repay()` which now will not move the user's bands.\n3. The hacker returns their funds (minus fee) using `exchange()` back.\n\nIn the above example, if the collateral price goes lower, the user's position will be subject to liquidation much earlier.\n\nCurrently, a user cannot protect themselves from such griefing. If the user calls `repay(0)` to move their bands according to the actual debt, nothing will happen:\n\n```\ndef repay(_d_debt: ...):\n...\nif _d_debt == 0:\n    return\n```\n\n- https://github.com/curvefi/curve-stablecoin/blob/1471b4177ece58d3f8c897cd8084be6ea03f11e0/contracts/Controller.vy#L731\n\n##### Recommendation\n\nIt is recommended to allow the user to move their bands by calling `repay(0)`.\n",
        "protocol": "Curve Finance",
        "report_date": "2023-06-05",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/README.md#3-early-liquidations-via-repay-front-running",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/Curve%20Stablecoin%20(crvUSD)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`AggregateStablePrice` can be manipulated",
        "content": "##### Description\n\nIf there is not enough liquidity in the pools or there are no pools, then `10**18` is returned as the price in `AggregateStablePrice`.\n\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/price_oracles/AggregateStablePrice.vy#L151\n\n```\nif Dsum == 0:\n    return 10**18\n```\n\nIt is supposed to be used to manipulate the price. At an early stage of the project, this can be significant.\n\n##### Recommendation\nWe recommend taking these conditions into account when deploying contracts.\n",
        "protocol": "Curve Finance",
        "report_date": "2023-06-05",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/README.md#4-aggregatestableprice-can-be-manipulated",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/Curve%20Stablecoin%20(crvUSD)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No checks of the result of `AMM.withdraw`",
        "content": "##### Description\n\nAfter `withdraw` there is no check that this method did not return any amount.\n\nhttps://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/Controller.vy#L770\n\nThere will be either emptiness or dust, but it is worth checking or providing for such a possibility in a comment.\n\n##### Recommendation\nIt is recommended that you further check `xy[0]`.\n\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-06-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/README.md#1-no-checks-of-the-result-of-ammwithdraw",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/Curve%20Stablecoin%20(crvUSD)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`AMM.exchange()` has no deadline",
        "content": "##### Description\n\nThe `AMM.exchange()` and `AMM.exchange_dy()` functions have slippage checks for output tokens; however, they do not have a deadline check for the transaction:\n\n```\ndef exchange(i, j, in_amount, min_amount, _for)\n...\ndef exchange_dy(i, j, out_amount, max_amount, _for)\n```\n\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/AMM.vy#L1284-L1312\n\nA realistic scenario is possible where, due to high gas prices, an `exchange()` transaction will remain in the mempool for a significant amount of time, and the prices in the AMM may change significantly. This would allow MEV-bots to steal the user's positive slippage (unrealized profit).\n\n##### Recommendation\n\nIt is recommended to add a `deadline` parameter in exchange functions.\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-06-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/README.md#2-ammexchange-has-no-deadline",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/Curve%20Stablecoin%20(crvUSD)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Not compatible with rebase/deflationary/hookable tokens and tokens with fees",
        "content": "##### Description\n\nSmart contracts do not check token balances, and it only works for normal tokens without unexpected balance behavior. In addition, tokens with additional hooks can open additional attack vectors.\n\n##### Recommendation\n\nThis design is acceptable and even has some security advantages - if the project does not have plans to have AMMs with such tokens.\n",
        "protocol": "Curve Finance",
        "report_date": "2023-06-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/README.md#3-not-compatible-with-rebasedeflationaryhookable-tokens-and-tokens-with-fees",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/Curve%20Stablecoin%20(crvUSD)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Key functions do not have return values",
        "content": "##### Description\n\nMany key functions do not have return values but they imply different behavior in case of non-revert.\n\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/Controller.vy#L586\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/Controller.vy#L600\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/Controller.vy#L671\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/Controller.vy#L685\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/Controller.vy#L700\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/Controller.vy#L731\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/Controller.vy#L795\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/Controller.vy#L1054\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/Controller.vy#L1069\n\nIt can add more complexity on integration with other smart contracts.\n\n##### Recommendation\n\nWe recommend returning key values that can explain the results of call executions.\n\n\n",
        "protocol": "Curve Finance",
        "report_date": "2023-06-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/README.md#4-key-functions-do-not-have-return-values",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/Curve%20Stablecoin%20(crvUSD)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "ControllerFactory has unnecessary calculation operations",
        "content": "##### Description\n\n\nControllerFactory stores the number of collaterals as a unit starting from `2**128`.\n\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/ControllerFactory.vy#L215\n\nThen it reads the number by subtracting`2**128`.\n\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/ControllerFactory.vy#L249\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/ControllerFactory.vy#L260\n\nCalculations with `2**128` can likely be dropped.\n\n##### Recommendation\n\nWe recommend removing calculations with `2**128`.\n",
        "protocol": "Curve Finance",
        "report_date": "2023-06-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/README.md#5-controllerfactory-has-unnecessary-calculation-operations",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/Curve%20Stablecoin%20(crvUSD)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "ControllerFactory.set_admin() does not have two-step ownership transferring",
        "content": "##### Description\n\nAdmin can transfer ownership to anyone, even if it is a wrong address or zero-value address.\n\n- https://github.com/curvefi/curve-stablecoin/blob/0d9265cc2dbd221b0f27f880fac1c590e1f12d28/contracts/ControllerFactory.vy#L281-L288\n\n##### Recommendation\n\nWe recommend following a two-step procedure of ownership transferring when a new owner has to accept ownership.\n",
        "protocol": "Curve Finance",
        "report_date": "2023-06-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/README.md#6-controllerfactoryset_admin-does-not-have-two-step-ownership-transferring",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Curve%20Finance/Curve%20Stablecoin%20(crvUSD)/Curve%20Stablecoin%20(crvUSD)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect usage of the parameter",
        "content": "##### Description\nThere are not enough checks on the amount of liquidity that can be removed from the limit order in the `decreaseLimitOrder` function. `liquidity` can be greater than the available liquidity on the limit order and in this case tx will revert. https://github.com/cryptoalgebra/Algebra/blob/bddd6487c86e0d6afef39638159dc403a91ba433/src/periphery/contracts/LimitOrderManager.sol#L162\n##### Recommendation\nWe recommend decreasing `liquidity` to `cache.liquidityLast` if `liquidity > cache.liquidityLast`.\n\n\n\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/README.md#1-incorrect-usage-of-the-parameter",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/Algebra%20Periphery%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The operator address is not reset after the position token transfer",
        "content": "##### Description\nA NFT position owner can set token `operator` to use permit functionality - https://github.com/cryptoalgebra/Algebra/blob/bddd6487c86e0d6afef39638159dc403a91ba433/src/periphery/contracts/LimitOrderManager.sol#L275. The operator address is used at the line https://github.com/cryptoalgebra/Algebra/blob/bddd6487c86e0d6afef39638159dc403a91ba433/src/periphery/contracts/LimitOrderManager.sol#L270. The `getApproved` function is used in a ERC721 standard to get an address of the entity which is allowed to make transfers. The user may give a permit to desired `operator`, then sell/transfer the NFT token. A new owner may not know about the given permit - the token operator is still able to make transfers and burn/collect a limit order position on behalf of the new token owner.\n##### Recommendation\nWe recommend overriding the ERC721 `_transfer` functionality and resetting the `_limitPositions[tokenId]` value on transfer.\n\n\n\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/README.md#2-the-operator-address-is-not-reset-after-the-position-token-transfer",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/Algebra%20Periphery%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An inverted price is used for overflow validation during the creation of new limit orders",
        "content": "##### Description\nIn function `core.LimitOrderManagement.addOrRemoveLimitOrder` the price used to evaluate whether the parameter `amountToBuy` is prone to overflow or does not appear to be inverted:\nhttps://github.com/cryptoalgebra/Algebra/blob/bddd6487c86e0d6afef39638159dc403a91ba433/src/core/contracts/libraries/LimitOrderManagement.sol#L46-L48\n```solidity\nuint256 amountToBuy = (tick > currentTick)\n  ? FullMath.mulDivRoundingUp(_amountToSell, Constants.Q144, priceX144)\n  : FullMath.mulDivRoundingUp(_amountToSell, priceX144, Constants.Q144);\n```\nPrice is represented as the ratio `token1/token0`. In the specified expression, if `tick` is greater than `currentTick`, then the new limit order position will sell `token0` in exchange for `token1`. Accordingly, to calculate the `amountToBuy`, `_amountToSell` , it should be multiplied by `priceX144` instead of being divided.\n##### Recommendation\nWe recommend inverting the specified expression.\n\n\n\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/README.md#3-an-inverted-price-is-used-for-overflow-validation-during-the-creation-of-new-limit-orders",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/Algebra%20Periphery%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible reverts with no message",
        "content": "##### Description\nThere are some places in the contracts that have the `require` checks without a revert message:\nhttps://github.com/cryptoalgebra/Algebra/blob/bddd6487c86e0d6afef39638159dc403a91ba433/src/periphery/contracts/LimitOrderManager.sol#L207\nhttps://github.com/cryptoalgebra/Algebra/blob/bddd6487c86e0d6afef39638159dc403a91ba433/src/periphery/contracts/libraries/PoolAddress.sol#L30.\n##### Recommendation\nWe recommend adding a message to all `require` statements.\n\n\n\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/README.md#1-possible-reverts-with-no-message",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/Algebra%20Periphery%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Callback verification can be made more secure",
        "content": "##### Description\nThe current callback verification is safe enough, but to increase the security of the protocol we would recommend saving the address of the pool that is used in the `_createLimitOrder` function to the storage variable to check that callback is called by the specific pool.\nhttps://github.com/cryptoalgebra/Algebra/blob/bddd6487c86e0d6afef39638159dc403a91ba433/src/periphery/contracts/base/LimitOrderManagement.sol#L24\n##### Recommendation\nWe recommend increasing the security of the callback validation.",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/README.md#2-callback-verification-can-be-made-more-secure",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/Algebra%20Periphery%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Contract `LimitOrderManagement` can be removed",
        "content": "##### Description\nSome functions of `LimitOrderManager` are placed in `LimitOrderManagement`. This contract has only one inheritor. There is also another contract with name `LimitOrderManagement` in the core part of the project. It may lead to confusion. \n##### Recommendation\nWe recommend moving functions from `LimitOrderManagement` to `LimitOrderManager` and removing `LimitOrderManagement`.\n\n\n\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/README.md#3-contract-limitordermanagement-can-be-removed",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/Algebra%20Periphery%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The `LimitOrderManagement._createLimitOrder()` duplicated pool address calculation",
        "content": "##### Description\n`LimitOrderManagement._createLimitOrder()` is called only from `LimitOrderManager.addLimitOrder()`. But it recalculates the address of the pool that was already calculated in `LimitOrderManagement._createLimitOrder()`:\nhttps://github.com/cryptoalgebra/Algebra/blob/bddd6487c86e0d6afef39638159dc403a91ba433/src/periphery/contracts/LimitOrderManager.sol#L81\nhttps://github.com/cryptoalgebra/Algebra/blob/bddd6487c86e0d6afef39638159dc403a91ba433/src/periphery/contracts/base/LimitOrderManagement.sol#L39.\n##### Recommendation\nWe recommend using a pool address as a parameter.\n\n\n\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/README.md#4-the-limitordermanagement_createlimitorder-duplicated-pool-address-calculation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/Algebra%20Periphery%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Accidental calling of `LimitOrderManagement.collectLimitOrder()` with zero recipient may lead to tokens stealing",
        "content": "##### Description\nIf `LimitOrderManagement.collectLimitOrder()` is called by accident for zero recipient, tokens will be transferred to the contract address:\nhttps://github.com/cryptoalgebra/Algebra/blob/bddd6487c86e0d6afef39638159dc403a91ba433/src/periphery/contracts/LimitOrderManager.sol#LL229C1-L229C1\nAfter that, anyone can claim them.\n##### Recommendation\nWe recommend reverting `LimitOrderManagement.collectLimitOrder()` if `recipient` is `address(0)`.",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/README.md#5-accidental-calling-of-limitordermanagementcollectlimitorder-with-zero-recipient-may-lead-to-tokens-stealing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/Algebra%20Periphery%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Gas optimization",
        "content": "##### Description\nThere is a `_getAndIncrementNonce` function at the line https://github.com/cryptoalgebra/Algebra/blob/bddd6487c86e0d6afef39638159dc403a91ba433/src/periphery/contracts/LimitOrderManager.sol#L262. Its logic can be put into an `unchecked` block to skip overflow checks (like it is done here - https://github.com/cryptoalgebra/Algebra/blob/bddd6487c86e0d6afef39638159dc403a91ba433/src/periphery/contracts/NonfungiblePositionManager.sol#L480).\n##### Recommendation\nWe recommend putting the function code into the `unchecked` block.\n\n\n\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/README.md#6-gas-optimization",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/Algebra%20Periphery%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The missing check for a recipient's address",
        "content": "##### Description\nThere are two functions - https://github.com/cryptoalgebra/Algebra/blob/bddd6487c86e0d6afef39638159dc403a91ba433/src/periphery/contracts/base/PeripheryPayments.sol#L21 and https://github.com/cryptoalgebra/Algebra/blob/bddd6487c86e0d6afef39638159dc403a91ba433/src/periphery/contracts/base/PeripheryPayments.sol#L32 which accept the `recipient` address as a parameter. As the `recipient` parameter value is not checked, it is possible to transfer tokens to zero address.\n##### Recommendation\nWe recommend adding checks that the `recipient` is not a zero address in both functions.",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/README.md#7-the-missing-check-for-a-recipients-address",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/Algebra%20Periphery%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An unnecessary subtraction operation",
        "content": "##### Description\nAt the line https://github.com/cryptoalgebra/Algebra/blob/bddd6487c86e0d6afef39638159dc403a91ba433/src/periphery/contracts/LimitOrderManager.sol#L246 the `position.tokensOwed0` and `position.tokensOwed1` values are set to the result of subtraction of the previous `tokensOwed` value and the amount collected. But at line https://github.com/cryptoalgebra/Algebra/blob/bddd6487c86e0d6afef39638159dc403a91ba433/src/periphery/contracts/LimitOrderManager.sol#L239 the collected values are initialized with the owed values. It is unnecessary to do a subtraction when both operators have the same value.\n##### Recommendation\nWe recommend assigning zero values to `position.tokensOwed0` and `position.tokensOwed1` here - https://github.com/cryptoalgebra/Algebra/blob/bddd6487c86e0d6afef39638159dc403a91ba433/src/periphery/contracts/LimitOrderManager.sol#LL246C32-L246C52.\n\n\n\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/README.md#8-an-unnecessary-subtraction-operation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/Algebra%20Periphery%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`decreaseLimitOrder` can be called multiple times on an emptied order",
        "content": "##### Description\nThere is a function https://github.com/cryptoalgebra/Algebra/blob/bddd6487c86e0d6afef39638159dc403a91ba433/src/periphery/contracts/LimitOrderManager.sol#L137 which is used to reduce a user's position (or fully close limit orders). When a user removes all liquidity from their position but not burns the NFT token, they are still able to call `decreaseLimitOrder` multiple times. \n##### Recommendation\nWe recommend adding a check for `position.liquidity` being greater than zero at the beginning of the `decreaseLimitOrder` function.\n\n\n\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/README.md#9-decreaselimitorder-can-be-called-multiple-times-on-an-emptied-order",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/Algebra%20Periphery%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unprotected `sweep` function",
        "content": "##### Description\nCurrently, any user can call the sweep function and get all tokens from the contract.\nhttps://github.com/cryptoalgebra/Algebra/blob/bddd6487c86e0d6afef39638159dc403a91ba433/src/periphery/contracts/base/PeripheryPayments.sol#L32-L48\n##### Recommendation\nWe recommend adding an admin role for calling this function.",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/README.md#10-unprotected-sweep-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/Algebra%20Periphery%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Code impossible to reach out",
        "content": "##### Description\nThere is a branch in the `pay` function that cannot be reached:\nhttps://github.com/cryptoalgebra/Algebra/blob/bddd6487c86e0d6afef39638159dc403a91ba433/src/periphery/contracts/base/PeripheryPayments.sol#L64-L66.\n##### Recommendation\nWe recommend removing this branch from the contract.",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/README.md#11-code-impossible-to-reach-out",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Periphery/Algebra%20Periphery%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Users' rewards can be lost if the incentive maker adds a new farming with the same key",
        "content": "##### Description\nIf the incentive maker adds a new farming after the previous one was unattached by the pool, then all users' rewards will be lost.\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L113\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L303\n\n##### Recommendation\nWe recommend adding a check that the maker cannot create a farming with the same key.\n\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#1-users-rewards-can-be-lost-if-the-incentive-maker-adds-a-new-farming-with-the-same-key",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The reward distributor can send funds to an unattached pool",
        "content": "##### Description\nThere is no check in the `addRewards()` function that would stop the reward distributor from sending funds to a virtual pool that was unattached from the Algebra pool due to a revert in the `crossTo()` function.\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L186-L195\n\n##### Recommendation\nWe recommend adding the following check:\n```solidity=\nIAlgebraEternalVirtualPool virtualPool = \n    IAlgebraEternalVirtualPool(_getCurrentVirtualPool(key.pool));\nif (incentive.virtualPoolAddress != \n    address(virtualPool)) revert anotherFarmingIsActive();\n```\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#2-the-reward-distributor-can-send-funds-to-an-unattached-pool",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The creation of the incentive with zero rewards blocks the pool's incentive system",
        "content": "##### Description\nIt's possible to create an incentive with 0 rewards using `AlgebraEternalFarming.createEternalFarming()`:\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L103.\nLater `AlgebraEternalFarming._getIncentiveByKey()` will revert for such incentives:\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L418.\nSo, it will be impossible to call `AlgebraEternalFarming.deactivateIncentive()`, `AlgebraEternalFarming.decreaseRewardsAmount()`, or `AlgebraEternalFarming.addRewards()`. So, the pool will be blocked from the creation of any incentive. If there are some bonus rewards for this incentive, they will be stuck forever.\n##### Recommendation\nWe recommend adding a require clause for non-zero rewards in `AlgebraEternalFarming.createEternalFarming()`.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#3-the-creation-of-the-incentive-with-zero-rewards-blocks-the-pools-incentive-system",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unsynchronized positions in `NonFungiblePositionManager` and `AlgebraEternalFarming` can be exploited for receiving unfair rewards",
        "content": "##### Description\n\nIf `FarmingCenter._updatePosition` reverts internally, `NonFungiblePositionManager` ignores that revert here: https://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/periphery/contracts/NonfungiblePositionManager.sol#L369 leading to unsynchronized positions between the actual position and the farming position. The `_updatePosition` function consists of sequential calls to the `exitFarming` and `enterFarming` functions within the `AlgebraEternalFarming` contract https://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/FarmingCenter.sol#L94. While the `exitFarming` function does not possess explicit revert statements, the `enterFarming` function can revert here: https://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L385. These reverts prevent the creation of farming positions in detached or deactivated farmings. Consequently, if a pool is detached, every call to `NonFungiblePositionManager.decreaseLiquidity` will revert within the `FarmingCenter._updatePosition` function. As a result, the actual liquidity of the position in the pool will decrease, but the liquidity in the farming position will remain unchanged, allowing the `tokenId` owner to continue collecting higher rewards than deserved.\n\nFurthermore, this vulnerability can be exploited by users who can find a way to manually detach the pool from its incentive. Consider the following scenario:\n\n* The exploiter obtains a flashloan from an external project\n* The exploiter mints a position in the pool using loaned tokens and enters farming\n* The exploiter detaches the pool\n* The exploiter decreases liquidity of the position to the minimum possible causing desynchronization in `AlgebraEternalFarming` which retains the liquidity of the flahsloaned tokens.\n* The exploiter repays the flashloan\n\nIn this scenario, the exploiter can collect rewards without maintaining an actual position.\n\n##### Recommendation\nWe recommend implementing the forced exit from the farming position in cases when a revert occurs within the call of `NonFungiblePositionManager` here: https://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/periphery/contracts/NonfungiblePositionManager.sol#L369, if feasible, to prevent unsynchronized farming positions.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#4-unsynchronized-positions-in-nonfungiblepositionmanager-and-algebraeternalfarming-can-be-exploited-for-receiving-unfair-rewards",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Virtual pools detached from the corresponding `AlgebraPool` result in an inconsistent state",
        "content": "##### Description\nIn cases where `AlgebraPool` connected to `VirtualAlgebraPool` catches a revert during a call to the `crossTo` function, the pool will reset its `activeIncentive` parameter to the 0 address here: https://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/core/contracts/base/SwapCalculation.sol#L210.\nSubsequently, the virtual pool enters a state where it is not `deactivated`, its `rewardRates` remain non-zero, and the detached pool no longer updates subsequent price changes. As a result, current liquidity providers continue to collect rewards based on the \"frozen\" price present in the pool at the moment of detachment.\n\n##### Recommendation\nWe recommend updating `rewardRates` for the pool to 0 and setting the `deactivated` state to `true` during the detachment process to prevent the accumulation of rewards based on outdated prices.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#5-virtual-pools-detached-from-the-corresponding-algebrapool-result-in-an-inconsistent-state",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An incorrect sequence of calls can lead to a revert",
        "content": "##### Description\nGetting reserves before applying new rewards can lead to a revert on a call of the `decreaseRewardsAmount()` function.\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L161\n\n##### Recommendation\nWe recommend calling `distributeRewards()` before getting reserves of the farming.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#1-an-incorrect-sequence-of-calls-can-lead-to-a-revert",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Rates can be updated for a deactivated farming",
        "content": "##### Description\nThere is no check that the incentive maker can't set non-zero rates for a deactivated pool.\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L198-L202\n\n##### Recommendation\nWe recommend adding a check that the farming was deactivated and this case allows setting only zero rates.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#2-rates-can-be-updated-for-a-deactivated-farming",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Initialization of the `virtualPool` should be made earlier",
        "content": "##### Description\n`virtualPool` is currently initialized after using it in the check.\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L398\n\n##### Recommendation\nWe recommend initializing `virtualPool` at the beginning of the function.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#3-initialization-of-the-virtualpool-should-be-made-earlier",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Admin can drain all rewards from all incentives",
        "content": "##### Description\n\n`AlgebraEternalFarming.decreaseRewardsAmount()` sends rewards to the address of admin:\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L172.\nIt creates the danger of a rugpull and reduces the trust in the incentive system.\n\n##### Recommendation\nWe recommend changing the logic of rewards refunds. An incentive for specific farming should be controlled by a registered address for this incentive.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#4-admin-can-drain-all-rewards-from-all-incentives",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unused variables",
        "content": "##### Description\nSeveral storage variables can be removed:\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/FarmingCenter.sol#L21\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/libraries/VirtualTickManagement.sol#L23\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/EternalVirtualPool.sol#L18.\n\n##### Recommendation\nWe recommend removing these variables from storage.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#1-unused-variables",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Events missing",
        "content": "##### Description\nSeveral functions should emit an event for better UX in possible integrations:\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L186-L195\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L198-L202.\n\n##### Recommendation\nWe recommend emitting events after these function calls.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#2-events-missing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unchecked calculations can be dangerous in some places",
        "content": "##### Description\nThere are several places where it is better to not use unchecked calculations:\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L327-L332\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L160-L168.\n\n##### Recommendation\nWe recommend not using unchecked calculations in these places.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#3-unchecked-calculations-can-be-dangerous-in-some-places",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "If a user transfers NFT, they can lose rewards",
        "content": "##### Description\nIf the user transfer NFT before calling `collectRewards`, they will lose accrued rewards\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/FarmingCenter.sol#L113-L115.\n\n##### Recommendation\nWe recommend adding a check to the transfer function that rewards were collected before the transfer.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#4-if-a-user-transfers-nft-they-can-lose-rewards",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`EternalVirtualPool._distributeRewards()` has an unnecessary parameter",
        "content": "##### Description\nInternal function `EternalVirtualPool._distributeRewards()` uses the `currentTimestamp` parameter:\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/EternalVirtualPool.sol#L208.\n\n##### Recommendation\nWe recommend using `uint32(block.timestamp)` directly in the function.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#5-eternalvirtualpool_distributerewards-has-an-unnecessary-parameter",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An unnecessary allowed caller in `EternalVirtualPool.crossTo()`",
        "content": "##### Description\n`EternalVirtualPool.crossTo()` is allowed to be called by `farmingCenterAddress` but it's never called from the farming center:\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/EternalVirtualPool.sol#L103.\n\n##### Recommendation\nWe recommend removing `farmingCenterAddress` from allowed callers.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#6-an-unnecessary-allowed-caller-in-eternalvirtualpoolcrossto",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An unnecessary incentive storage change",
        "content": "##### Description\n`AlgebraEternalFarming._enterFarming()` marks the incentive as deactivated in the storage and after that reverts in case of the virtual pool address desynchronization:\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L386.\nBut the storage changes are not saved in case of a revert.\n\n##### Recommendation\nWe recommend reverting without storage changes.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#7-an-unnecessary-incentive-storage-change",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`INCENTIVE_MAKER` can create an incentive for any IAlgebraPool",
        "content": "##### Description\n`INCENTIVE_MAKER` can create an incentive for any `IAlgebraPool`, not only for the ones created by the factory:\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L103.\nIt can be used in some complicated attacks by `INCENTIVE_MAKER`. \n\n##### Recommendation\nWe recommend checking the pool address if it's created by the factory.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#8-incentive_maker-can-create-an-incentive-for-any-ialgebrapool",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Anyone can call `AlgebraEternalFarming.addRewards()`",
        "content": "##### Description\n`AlgebraEternalFarming.addRewards()` can be called by any address:\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L186.\nSo, anyone can manipulate the size of the total rewards. It can be used in some complicated attacks.\n\n##### Recommendation\nWe recommend implementing a whitelist for addresses that can add rewards.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#9-anyone-can-call-algebraeternalfarmingaddrewards",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An incorrect (misspelled) word in the comment",
        "content": "##### Description\nAt line https://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/libraries/VirtualTickManagement.sol#L134 a misspelled word is used. \n\n##### Recommendation\nWe recommend changing `if` to `of`.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#10-an-incorrect-misspelled-word-in-the-comment",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An unnecessary type cast",
        "content": "##### Description\nAt line https://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L99 variable `factory` is cast to the `IAlgebraFactory` type, but it already has the `IAlgebraFactory` type by definition - https://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L52.\n\n##### Recommendation\nWe recommend removing unnecessary cast operations.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#11-an-unnecessary-type-cast",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The detached `Incentive` cannot be deactivated manually",
        "content": "##### Description\nIf the virtual pool is detached from its corresponding algebra pool, then it is impossible for the incentive manager to manually change its status to the `deactivated` state due to this check: https://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L143.\n\n##### Recommendation\nWe recommend modifying the specified expression to \n```solidity\nif (incentive.virtualPoolAddress == address(0)) ...\n```\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#12-the-detached-incentive-cannot-be-deactivated-manually",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "A redundant call to `_updatePositionInVirtualPool` in the `_updatePosition` function",
        "content": "##### Description\nThe call to `_updatePositionInVirtualPool` here \nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L263 can be replaced with the `distributeRewards` call since the`liquidityDelta` argument is set to 0 at that point.\n\n##### Recommendation\nWe recommend changing the `_updatePositionInVirtualPool` call in the specified line to `virtualPool.distributeRewards()`.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#13-a-redundant-call-to-_updatepositioninvirtualpool-in-the-_updateposition-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`getInnerRewardsGrowth` can be called for non-existed ticks",
        "content": "##### Description\nThere are no checks in the `getInnerRewardsGrowth` function that `bottomTick` and `topTick` were added to the tick tree.\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/EternalVirtualPool.sol#L64-L67\n\n##### Recommendation\nWe recommend adding checks that ticks were added to restrict external calls with incorrect input parameters.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#14-getinnerrewardsgrowth-can-be-called-for-non-existed-ticks",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The check can be made earlier to save gas",
        "content": "##### Description\nThe liquidity of the position check can be made earlier to save some gas.\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L209\n\n##### Recommendation\nWe recommend checking the liquidity of the position before calling `_enterFarming()`.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#15-the-check-can-be-made-earlier-to-save-gas",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Rebasable tokens cannot be used for rewards",
        "content": "##### Description\nThe current farming design doesn't allow work with rebasable tokens.\n\n##### Recommendation\nWe recommend restricting work with rebasable tokens. This information can be added to the protocol documentation.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#16-rebasable-tokens-cannot-be-used-for-rewards",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Zero checks are missing",
        "content": "##### Description\nThe protocol allows to transfer 0 amount of tokens to the 0 address.\nhttps://github.com/cryptoalgebra/Algebra/blob/7290fad656bfa89db3743c52af631154f6a8a2d5/src/tokenomics/contracts/farmings/AlgebraEternalFarming.sol#L410\n\n##### Recommendation\nWe recommend adding a check that tokens cannot be transferred to the 0 address and farming doesn't try to send 0 tokens.\n",
        "protocol": "Algebra Finance",
        "report_date": "2023-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/README.md#17-zero-checks-are-missing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Algebra%20Finance/Farmings/Algebra%20Farmings%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An incorrect version calculation will lead to a token loss for a user",
        "content": "##### Description\nA token version is calculated incorrectly (the version is in range [10_000:990_000]) which means that a user will lose a token from the current collection and receive a token from another collection (which probably hasn't existed yet).\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/utils/TokenVersionUtil.sol#L23-L24\n\n##### Recommendation\nWe recommend changing the calculation of the token version logic in the `getTokenInfo()` function in the `TokenVersionUtil` library.\n\n\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#1-an-incorrect-version-calculation-will-lead-to-a-token-loss-for-a-user",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "There are no checks that an athlete sent funds to the FantiumClaimingV1 contract",
        "content": "##### Description\nThere are no checks that an athlete has sent tokens to the contract (`amountPaidIn` is not checked). So, users from the collections that are not able to claim funds will be able to claim them from other distributions. It can be extremely dangerous if some of the athletes do not send funds to the contract on time.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L405\n\n##### Recommendation\nWe recommend adding a simple check: `require(distributionEvents[_distributionEventId].amountPaidIn, \"Unable to claim\");`.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#2-there-are-no-checks-that-an-athlete-sent-funds-to-the-fantiumclaimingv1-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An unlimited claim",
        "content": "##### Description\nAn unnecessary check was implemented instead of updating the mapping here:\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L456-L458 \nThis allows an unlimited claim for a user, so anybody with an NFT could drain the contract.\n\n##### Recommendation\nWe recommend adding a change from `==` to `=`.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#3-an-unlimited-claim",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "A possible transfer of funds of another athlete",
        "content": "##### Description\nThere is no check that an athlete has already transferred funds to the contract here: https://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L624-L652 \nIt means that the manager by mistake can transfer the funds of another athlete to the athlete that asked to close their distribution.\n\n##### Recommendation\nWe recommend adding a simple check: `require(distributionEvents[_distributionEventId].amountPaidIn, \"Unable to close\");`.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#4-a-possible-transfer-of-funds-of-another-athlete",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Some distribution parameters cannot be updated after funds sending",
        "content": "##### Description\nThe updating of `tournamentDistributionAmount`, `otherDistributionAmount` and `collectionIds` could lead to the situation when some users would be unable to claim their funds, because the funds had already been claimed by other users.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L300-L302\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L315\n\n##### Recommendation\nWe recommend adding the following check: `require(!distributionEvents[_distributionEventId].amountPaidIn, \"Cannot update parameters\");`.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#1-some-distribution-parameters-cannot-be-updated-after-funds-sending",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Some tokens could be left on the contract",
        "content": "##### Description\nThe manager can update the token address before all tokens were distributed among fans. This can block some tokens on the contract and fans can receive tokens from other distributions.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L614\n\n##### Recommendation\nWe recommend adding a check that the transferred tokens were distributed or closed by athletes.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#2-some-tokens-could-be-left-on-the-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "TransferFrom from `address(this)` will not work for most of the tokens",
        "content": "##### Description\nHere `transferFrom(address(this),...)` is used which will not work with most of the tokens without calling `approve`.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L647-L651\n\n##### Recommendation\nWe recommend using `SafeTransfer` instead of `TransferFrom`.\n\n\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#3-transferfrom-from-addressthis-will-not-work-for-most-of-the-tokens",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Not enough checks for collections shares",
        "content": "##### Description\nThere are not enough checks on the collections shares (tournament and others) which could lead to an unfair distribution of rewards for users. If `sum(tournamentTokenShare1e7_i) > 1e7 * tournamentBPS / 10_000` , then not all users will be able to claim rewards.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L225-L232\n\n##### Recommendation\nWe recommend adding two checks:\n`sum(tournamentTokenShare1e7_i) <= 1e7 * tournamentBPS / 10_000`\n`sum(otherTokenShare1e7_i) <= 1e7 * otherBPS / 10_000`.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#4-not-enough-checks-for-collections-shares",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`_athleteSecondarySalesBPS` and `_fantiumSecondarySalesBPS` should be restricted",
        "content": "##### Description\n`_athleteSecondarySalesBPS` and `_fantiumSecondarySalesBPS` should be restricted because they will be used in other contracts to calculate royalties with base point = 1 / 10_000, so if `_athleteSecondarySalesBPS + _fantiumSecondarySalesBPS > 10_000`, the royalty will be > 100%. Due to this all transactions with royalty payments will revert.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L526-L527\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L544-L545\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L658-L659\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L752-L753\n\n##### Recommendation\nWe recommend adding the following check: `_athleteSecondarySalesBPS + _fantiumSecondarySalesBPS <= 10_000`.\n\n\n\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#5-_athletesecondarysalesbps-and-_fantiumsecondarysalesbps-should-be-restricted",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`maxInvocations` should be limited",
        "content": "##### Description\nTokenId contains collactionId, versionId and tokenNumber. `maxInvocations` is a parameter that determines the max tokenNumber. Due to using versionId, tokenNumber should be < 10_000, otherwise the versionId logic would be broken.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L528\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L691\n\n##### Recommendation\nWe recommend adding the following check: `maxInvocations < 10_000`.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#6-maxinvocations-should-be-limited",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`trustedForwarder` can be used to impersonate any account or contract",
        "content": "##### Description\nThere is an overriden `_msgSender()` function https://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L993 which allows the `trustedForwarder` address owner to specify any address being used as `sender`. This function is used at some of the key parts of the protocol. For example, in the `upgradeTokenVersion` function - https://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L790. Someone's address and allowance can also be used during mint - https://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L350. In case `trustedForwarder` is compromised, it can lead to the funds loss.\n\n##### Recommendation\nWe recommend introducing a multisig wallet on the `trustedForwarder` account or disabling the usage of the `_msgSender()` function on the key parts of the protocol.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#7-trustedforwarder-can-be-used-to-impersonate-any-account-or-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An incorrect expression inside `require` leads to a revert",
        "content": "##### Description\nThere is a `closeDistribution` function - https://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L624. It is used by the protocol manager to close a distribution event and transfer the remaining funds to the athlete. But the first require here https://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L632 uses an assignment operator instead of a logic operator. It always assigns a false `closed` parameter on a distribution event and uses `false` as a `require` argument that leads to an unconditional revert. There is also a second `require` check https://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L636 which uses an incorrect operator too.\n\n##### Recommendation\nWe recommend using a logic operator == inside the mentioned `require` statements.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#8-an-incorrect-expression-inside-require-leads-to-a-revert",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Not checking the ERC20 transfer result on depositing funds by an athlete",
        "content": "##### Description\nThere is an `addDistributionAmount` function which transfers funds from an athlete to the protocol. It uses the `transferFrom` function here - https://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L277. If `payoutToken` which returns false/true instead of reverting on an unsuccessful transfer would be used there, then an athlete would be able to mark the event as `amountPaidIn` without depositing any tokens.\n\n##### Recommendation\nWe recommend using `safeTranferFrom` from the OpenZeppelin `safeERC20` implementation.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#9-not-checking-the-erc20-transfer-result-on-depositing-funds-by-an-athlete",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Funds sent by an athlete to a closed distribution are impossible to return",
        "content": "##### Description\nIt's possible for an athlete to send funds to a closed distribution with `FantiumClaimingV1.addDistributionAmount()` if they were not sent before (https://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L253). After that it will be impossible to return them to the athlete (it's possible to call`FantiumClaimingV1.closeDistribution()` only for non-closed distributions). For example, it can happen if the incorrect distribution was created by the manager, the manager closed the distribution and recreated it. And by mistake the athlete called `FantiumClaimingV1.addDistributionAmount()` with an id of the closed one.\n\n##### Recommendation\nIt's recommended to add a check to `FantiumClaimingV1.addDistributionAmount()` that the distribution is not closed.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#10-funds-sent-by-an-athlete-to-a-closed-distribution-are-impossible-to-return",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Updating a token version can cause a jump of tokens between collections",
        "content": "##### Description\nOne collection can store only 1_000_000 token ids and one version can store maximum 10_000 of token ids that means a token version can be updated only 100 times. Moreover, updating the token version the 100th time will cause a jump of this token to the next collections.\n\n##### Recommendation\nWe recommend expanding the number of updates for one token without limiting further the `maxInvocation` parameter in one collection and adding a check that `tokenVersionUpgrade` doesn't jump between collections [here](https://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L812).\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#11-updating-a-token-version-can-cause-a-jump-of-tokens-between-collections",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Inconsistent shares upgrade",
        "content": "##### Description\nAfter shares update in the NFT contract https://github.com/FantiumAG/smart-contracts/blob/c622b4c35132167bacc22cf76656d80715edb5fd/contracts/FantiumNFTV3.sol#L638-L640 `tournamentDistributionAmount` and `otherDistributionAmount` should be updated for all distributions for the specific collection, otherwise, there will be inconsistency in the calculations of the amount for the claim.\n\n##### Recommendation\nWe recommend saving the share value in the distribution event and using it in the calculations of the claim amount.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#12-inconsistent-shares-upgrade",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An incorrect check",
        "content": "##### Description\nThere is an incorrect check in the `updateDistribtionTotalEarningsAmounts()` function https://github.com/FantiumAG/smart-contracts/blob/c622b4c35132167bacc22cf76656d80715edb5fd/contracts/claiming/FantiumClaimingV1.sol#L326-L327. Instead of a check for `_totalTournamentEarnings` and `_totalOtherEarnings` there should be a check for `tournamentDistributionAmount` and `otherDistributionAmount` after calling the `triggerClaimingSnapshot` function. Otherwise, the manager could reduce `tournamentDistributionAmount` and `otherDistributionAmount` by mistake and block the distribution (the athlete will not be able to add tokens and will also close the distribution).\n\n##### Recommendation\nWe recommend adding a check for `tournamentDistributionAmount` and `otherDistributionAmount` after calling the `triggerClaimingSnapshot` function. Also, the same check should be added to the `updateDistributionEventCollectionIds` function.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#13-an-incorrect-check",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "It's possible to top up a closed distribution",
        "content": "##### Description\nIf the manager calls by mistake `updateDistribtionTotalEarningsAmounts()` or `updateDistributionEventCollectionIds()` for a closed distribution, it will be topped up using the athlete's funds. These funds will be stuck because it's impossible to close the already closed distribution again.\nhttps://github.com/FantiumAG/smart-contracts/blob/b4acd978e25289becc640f75eb5921e760b83720/contracts/claiming/FantiumClaimingV1.sol#L318\nhttps://github.com/FantiumAG/smart-contracts/blob/b4acd978e25289becc640f75eb5921e760b83720/contracts/claiming/FantiumClaimingV1.sol#L342\n\n##### Recommendation\nWe recommend adding a check to `updateDistribtionTotalEarningsAmounts()` and `updateDistributionEventCollectionIds()`:\n`require(!distributionEvents[_id].closed, \"FantiumClaimingV1: distribution already closed\");`.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#14-its-possible-to-top-up-a-closed-distribution",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Distribution parameters shouldn't be updated after the first claim",
        "content": "##### Description\nIf the athlete/manager decides to update the parameters of the distribution event after the tokens have been sent from the claiming contract, it may lead to an unequal distribution of tokens among users. This outcome is inherent in the design. For example, updating the collection IDs while the claiming process is in progress implies that an individual from the previous collection could claim the rewards for themselves and expend some funds from the distribution. Consequently, someone from the new collection may be unable to claim rewards. Updating the `distributionTotalEarningAmounts`signifies that a person who has already claimed rewards might receive lower rewards than those who claimed them later.\n\n##### Recommendation\nWe recommend restricting changes in distribution events and calls to `takeClaimingSnapshot` after the first claim.\n\n\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#15-distribution-parameters-shouldnt-be-updated-after-the-first-claim",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect event emitting",
        "content": "##### Description\nHere https://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L386 the event should be `emit Mint(_to, tokenId + i);`.\n\n##### Recommendation\nWe recommend changing the event to the `emit Mint(_to, tokenId + i);`.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#1-incorrect-event-emitting",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect input data could break the collection",
        "content": "##### Description\nHere https://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L524-L525 the `_athletePrimarySalesBPS <= 10_000` check should be added. If `_athletePrimarySalesBPS` is > 10_000, then the collection mint would revert because of the underflow.\n\n##### Recommendation\nWe recommend adding the following check: `_athletePrimarySalesBPS <= 10_000`.\n\n\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#2-incorrect-input-data-could-break-the-collection",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unsafe transfer",
        "content": "##### Description\nSome of the tokens do not revert on an unsuccessful transfer. We recommend using the OZ safeTrasnfer method instead of a basic transfer method.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L409-L413\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L417-L421\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L591\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L595\n\n##### Recommendation\nWe recommend using the OpenZeppelin safeTransfer library.\n\n\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#3-unsafe-transfer",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`nextCollectionId` should be limited",
        "content": "##### Description\nDue to unnecessary checks on tokenId in claiming, contract `nextCollectionId` should be limited. Otherwise, claiming functionality for tokens of collection with an id >= 100_000 will revert.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L522\n\n##### Recommendation\nWe recommend adding the following check: `nextCollectionId < 1_000_000`.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#4-nextcollectionid-should-be-limited",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Collection shares should be limited",
        "content": "##### Description\nShares cannot be > 1e7, otherwise claiming will always revert.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L547-L553\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L694-L701\n\n##### Recommendation\nWe recommend adding the following check:\n`_tournamentTokenShare1e7 <= 1e7 && _otherTokenShare1e7 <= 1e7`.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#5-collection-shares-should-be-limited",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`maxInvocations` cannot be reduced during an update",
        "content": "##### Description\n`maxInvocations` cannot be reduced during an update because it will lead to insolvency in the protocol.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L691\n\n##### Recommendation\nWe recommend adding the following check:\n`_maxInvocations > collections[_collectionId].maxInvocations`.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#6-maxinvocations-cannot-be-reduced-during-an-update",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Modifier  `onlyValidCollectionId()` is missing",
        "content": "##### Description\nModifier  `onlyValidCollectionId()` should be added here:\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L748-L749\n\n##### Recommendation\nWe recommend adding the `onlyValidCollectionId()` modifier.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#7-modifier-onlyvalidcollectionid-is-missing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Distribution logic is too flexible",
        "content": "##### Description\nNow, the data to calculate the amount for a claim is distributed between the NFT and Claiming contracts. The current architecture may lead to the incorrect distribution of tokens among token holders due to a mistake while updating some collection parameters (e.g. `otherTotalBPS` and `tournamentTotalBPS` should be equal among all collections that are set for distribution; also, there should be a complex check for the collections share to guarantee a fair distribution of rewards among token holders).\n\n##### Recommendation\nWe recommend improving the code, so it would still be working according to the desired buiseness logic, but it would minimize the risk of mistakes during the collection parameters update. We recommend implementing the steps below:\n1. `tournamentBPS` and `otherBPS` should be moved from the NFT contract to the Claiming contract.\n2. Two additional checks should be added while setting up a distribution event:\nCheck 1:\n```solidity=\nuint256 a = _tournamentDistributionAmount * 10_000 / tournamentBPS;\nuint256 b = a * sum(collection_i_maxInvocations \n              * collection_i_tournamentShare / 1e7);\nrequire(b == _tournamentDistributionAmount);\n```\n\nCheck 2:\n```solidity=\nuint256 a = _otherDistributionAmount * 10_000 / otherBPS;\nuint256 b = a * sum(collection_i_maxInvocations \n              * collection_i_otherShare / 1e7);\nrequire(b == _otherDistributionAmount);\n```\n\n3. The `maxInvocations` parameter cannot be updated during the active distribution for the collection.\n4. `collection_i_otherShare` and `collection_i_tournamentShare` should be saved in the distribution event, so these parameters could be seamlessly updated in a collection.\n\nAlso, Check 1 and Check 2 should be used in both `updateDistributionEventAmount()` functions in the Claiming contract.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#8-distribution-logic-is-too-flexible",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`fantiumFeeBPS` should be restricted",
        "content": "##### Description\n`fantiumFeeBPS` should be <= 10_000, otherwise a claim call will always revert.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L242\n\n##### Recommendation\nWe recommend adding the following check: `fantiumFeeBPS <= 10_000`.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#9-fantiumfeebps-should-be-restricted",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An unsafe transfer",
        "content": "##### Description\nSome of the tokens do not revert on failed `transferFrom`. Also, there are some tokens with a fee on transfer, so the real transferred balance should be checked via `balanceOf()`, otherwise it could lead to funds insolvency.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L277-L281\n\n##### Recommendation\nWe recommend using the `safeTransfer` library and also adding a check that an exact amount of tokens was transferred to the contract.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#10-an-unsafe-transfer",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Check for the collection existence is missing",
        "content": "##### Description\nThere is no check that the collection exists.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L315\n\n##### Recommendation\nWe recommend adding a check that the collection exists.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#11-check-for-the-collection-existence-is-missing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible division by zero",
        "content": "##### Description\nThere are not enough checks to guarantee there will be no division by zero.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L520\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L527\n\n##### Recommendation\nWe recommend adding a check that if `tournamentTotalBPS == 0`, then `tournamentClaim = 0` and the same check for `otherTotalBPS == 0`.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#12-possible-division-by-zero",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Distribution closing shouldn't be allowed during the active distribution",
        "content": "##### Description\nThere are no checks that the distribution ended in the closing function.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L624-L631\n\n##### Recommendation\nWe recommend adding a check that the distribution can be closed only when `block.timestamp > closeTime`.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#13-distribution-closing-shouldnt-be-allowed-during-the-active-distribution",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The collection existence check is missing",
        "content": "##### Description\nThere is no check that the collection exists.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/utils/FantiumUserManager.sol#L202\n\n##### Recommendation\nWe recommend adding a check that the collection exists.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#14-the-collection-existence-check-is-missing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Variable shadowing",
        "content": "##### Description\nThere is a `trustedForwarder` variable being set inside the `initialize` function - https://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L199. The function parameter has the same length as a state variable. In fact, the state variable value doesn't change.\n\n##### Recommendation\nWe recommend changing the function parameter name to `_trustedForwarder`.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#15-variable-shadowing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The NFT contract allows multiple ways to avoid KYC",
        "content": "##### Description\n\nThe KYC system for NFT minting does not work. Some easy ways:\n1) `FantiumNFTV3.batchMintTo()` checks that `msg.sender` is KYCed but allows specifying `to` who will receive the minted NFT. So, the true NFT receiver is not KYCed.\n- https://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L325-L388\n3) NFT is transferable. So, a KYCed account can buy an NFT and transfer it to anyone.\n\n##### Recommendation\n\nWe recommend making necessary changes for the KYC system or removing it.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#16-the-nft-contract-allows-multiple-ways-to-avoid-kyc",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Hardcoded values for amounts of ERC20 tokens",
        "content": "##### Description\n[Here](https://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L220), the value of 10 billion payout tokens is hardcoded as $10_000_000_000_000_000, which is equal to 10 billion multiplied by 10^6. If the `payoutToken` is changed in the future with a different `decimals` value, then the contract will need to be redeployed with a new hardcoded value.\n\n##### Recommendation\nWe recommend using `ERC20(payoutToken).decimals()` to obtain the decimal multiplier instead of a hardcoded value for more flexibility.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#17-hardcoded-values-for-amounts-of-erc20-tokens",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "A manager could transfer funds to the Claiming contract instead of the athlete",
        "content": "##### Description\nA manager could transfer funds to the Claiming contract instead of the athlete here https://github.com/FantiumAG/smart-contracts/blob/c622b4c35132167bacc22cf76656d80715edb5fd/contracts/claiming/FantiumClaimingV1.sol#L303.\n\n##### Recommendation\nWe recommend using the athlete's address instead of `_msgSender()`.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#18-a-manager-could-transfer-funds-to-the-claiming-contract-instead-of-the-athlete",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Claiming could be blocked",
        "content": "##### Description\nUsers that were able to claim before the manager calls this function https://github.com/FantiumAG/smart-contracts/blob/c622b4c35132167bacc22cf76656d80715edb5fd/contracts/claiming/FantiumClaimingV1.sol#L316-L337 will have to wait until the athlete transfers tokens.\n\n##### Recommendation\nWe recommend calling `addDistributionAmount` in the `updateDistribtionTotalEarningsAmounts()` and `updateDistributionEventCollectionIds` functions.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#19-claiming-could-be-blocked",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The check can be manipulated",
        "content": "##### Description\nA platform manager can by mistake update shares in the NFT contract and call `takeClaimingSnapshot` which will lead to the situation where the athlete should add more funds to the distribution before closing it https://github.com/FantiumAG/smart-contracts/blob/c622b4c35132167bacc22cf76656d80715edb5fd/contracts/claiming/FantiumClaimingV1.sol#L754. \n\n##### Recommendation\nWe recommend changing the `closeDistribution` function.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#20-the-check-can-be-manipulated",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect work with decimals",
        "content": "##### Description\n`DistributionEvent.totalTournamentEarnings` and `DistributionEvent.totalOtherEarnings` are stored for the current token's decimals (https://github.com/FantiumAG/smart-contracts/blob/c622b4c35132167bacc22cf76656d80715edb5fd/contracts/claiming/FantiumClaimingV1.sol#L63). If the new token is set with an other number of decimals after the distribution is created, these variables will contain incorrect values. Therefore, `DistributionEvent.tournamentDistributionAmount` and `DistributionEvent.otherDistributionAmount` will contain incorrect values as well (https://github.com/FantiumAG/smart-contracts/blob/c622b4c35132167bacc22cf76656d80715edb5fd/contracts/claiming/FantiumClaimingV1.sol#L698). This will lead to an incorrect amount of distributed funds.\n\n##### Recommendation\nWe recommend storing `totalTournamentEarnings` and `totalOtherEarnings` without decimals. In such cases `amountPaidIn`, `tournamentDistributionAmount`, and `otherDistributionAmount` should be stored without decimals too.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#21-incorrect-work-with-decimals",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary check reverts function call.",
        "content": "##### Description\nIt's impossible to call `updateDistributionEventCollectionIds()` or `updateDistribtionTotalEarningsAmounts()` if `tournamentDistributionAmount`+`otherDistributionAmount` stays the same. `topUpDistributionEvent()` reverts if it's not needed to transfer additional funds from the athlete's address. \nhttps://github.com/FantiumAG/smart-contracts/blob/b4acd978e25289becc640f75eb5921e760b83720/contracts/claiming/FantiumClaimingV1.sol#L536\nSo, `updateDistributionEventCollectionIds()` and `updateDistribtionTotalEarningsAmounts()` revert too in such cases. But the manager may want to change these parameters while the total distribution amount stays the same. For example, they want to change the collections' order, from one collection to another with identical parameters. Or they want to set another ratio between tournamentEarnings and otherEarnings.\n\n##### Recommendation\nWe recommend removing a check `payInAmount > 0` from `topUpDistributionEvent()`.\n\n\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#22-unnecessary-check-reverts-function-call",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Anyone can block the payout token by changing its amount by 1 wei",
        "content": "##### Description\nThere is a check in `updatePayoutToken()` that the balance should be 0.\nhttps://github.com/FantiumAG/smart-contracts/blob/b4acd978e25289becc640f75eb5921e760b83720/contracts/claiming/FantiumClaimingV1.sol#L749\nSo, anyone can send 1 wei to the balance and make it impossible to change the payout token.\n\n##### Recommendation\nWe recommend removing a zero balance check from `updatePayoutToken()`. Now it's not required because the token address is stored in the snapshot.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#23-anyone-can-block-the-payout-token-by-changing-its-amount-by-1-wei",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "A missed requirement",
        "content": "##### Description\nAlthough there is a check in the `takeClaimingSnapshot` function (https://github.com/FantiumAG/smart-contracts/blob/b4acd978e25289becc640f75eb5921e760b83720/contracts/claiming/FantiumClaimingV1.sol#L686), it is more crucial to include it in the `updateDistributionEventCollectionIds()` function (https://github.com/FantiumAG/smart-contracts/blob/b4acd978e25289becc640f75eb5921e760b83720/contracts/claiming/FantiumClaimingV1.sol#L354). Implementing this check makes the previous check unnecessary, as it becomes impossible to set an empty collectionIds array for the distribution event.\n\n##### Recommendation\nWe recommend adding the check `distributionEvents[_distributionEventId].collectionIds.length > 0` to the `updateDistributionEventCollectionIds()` function.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#24-a-missed-requirement",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`takeClaimingSnapshot()` call will lead to an inconsistent state",
        "content": "##### Description\nThis function can block the ongoing distribution event until the funds are paid or the event parameters are returned back.\nhttps://github.com/FantiumAG/smart-contracts/blob/b4acd978e25289becc640f75eb5921e760b83720/contracts/claiming/FantiumClaimingV1.sol#L689\n\n##### Recommendation\nWe recommend removing this function or adding a `topUpDistributionEvent()` call at the end of the function.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#25-takeclaimingsnapshot-call-will-lead-to-an-inconsistent-state",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible incorrect event emitting",
        "content": "##### Description\nThere are no checks whether an address was previously kyced or not, so it is possible that events will be emited > 1.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L229\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L240\n\n##### Recommendation\nWe recommend adding a check that a user doesn't have kyc or was already removed from kyc.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#1-possible-incorrect-event-emitting",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "A function can be called with `amount == 0`",
        "content": "##### Description\nA function can be called with `amount == 0`.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L325-L329\n\n##### Recommendation\nWe recommend adding an `amount > 0`  check.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#2-a-function-can-be-called-with-amount-0",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Minting insolvency",
        "content": "##### Description\nIt is better to use require, because some integrations could break with the current logic.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L331\n\n##### Recommendation\nWe recommend using require to restrict the function calling with `amount > 10`.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#3-minting-insolvency",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary checks",
        "content": "##### Description\nThere are some checks that are unnecessary, so they can be removed.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L349-L353\n\n##### Recommendation\nWe recommend removing these checks.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#4-unnecessary-checks",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "A zero address check",
        "content": "##### Description\nSome tokens could be lost because the address is set to zero.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L543\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L241\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/utils/FantiumUserManager.sol#L79-L80\n\n##### Recommendation\nWe recommend adding a check that the address is not zero.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#5-a-zero-address-check",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "A front-run risk",
        "content": "##### Description\nIt is possible to buy NFTs cheaper before the price update.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L692\n\n##### Recommendation\nWe recommend using a private transactions pool for the price updating.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#6-a-front-run-risk",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An unchecked timestamp",
        "content": "##### Description\nThere are not enough timestamp checks.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L719\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L536\n\n##### Recommendation\nWe recommend adding checks to make sure that a new timestamp cannot be less than the current timestamp (block.timestamp).\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#7-an-unchecked-timestamp",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Events missing",
        "content": "##### Description\nThere are missing events for the important variables update.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L826\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L841\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L977\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L607\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L614\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L621\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L647-L651\n\n##### Recommendation\nWe recommend adding events emitting on these parameters update.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#8-events-missing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Bad UX on claiming",
        "content": "##### Description\nAfter claiming a user will lose all approvals on their tokens which can be inconvenient.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L803\n\n##### Recommendation\nWe recommend adding information for users that they will lose approvals on their tokens after claiming.\n\n\n\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#9-bad-ux-on-claiming",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An inconvenient token update",
        "content": "##### Description\nAfter the token update each collection price should be updated.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L841\n\n##### Recommendation\nWe recommend using only tokens with the same price.\n\n\n\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#10-an-inconvenient-token-update",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Initialization front-running",
        "content": "##### Description\nIt is possible to front-run initialization of the Claiming contract.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L135-L150\n\n##### Recommendation\nWe recommend checking that the Claiming contract was initialized correctly before setting its address to the NFT contract.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#11-initialization-front-running",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No `forwarder` address check",
        "content": "##### Description\nThere are no checks on the `forwarder` address in the initialize function.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L160-L162\n\n##### Recommendation\nWe recommend adding a check for the `forwarder` address.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#12-no-forwarder-address-check",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Bad work with decimals",
        "content": "##### Description\n6 decimals are hardcoded in the Claiming contract which can lead to incorrect work with token amounts in the future.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L218-L220\n\n##### Recommendation\nWe recommend adjusting work with decimals to make it more flexible.\n\n\n\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#13-bad-work-with-decimals",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An unnecessary parameter",
        "content": "##### Description\n`_amountWithDecimals` is unnecessary in the `addDistributionAmount()` function.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L262-L269\n\n##### Recommendation\nWe recommend using `distributionEvents[_distributionEventId].tournamentDistributionAmount + distributionEvents[_distributionEventId].otherDistributionAmount` instead.\n\n\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#14-an-unnecessary-parameter",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unused logic",
        "content": "##### Description\nThere is a lot of unused logic in the Manager contract.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/utils/FantiumUserManager.sol#L95-L140\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/utils/FantiumUserManager.sol#L185-L242\n\n##### Recommendation\nWe recommend removing unused logic.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#15-unused-logic",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unchecked range for time",
        "content": "##### Description\nThere are not enough checks for `_startTime` and `_closeTime` in the Claiming contract.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L208-L211\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L352-L353\n\n##### Recommendation\nWe recommend adding a check that `_startTime > block.timestamp`, also a new `_startTime` cannot be less than the previous `_startTime`.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#16-unchecked-range-for-time",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary checks",
        "content": "##### Description\nThere are several unnecessary checks.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L408-L412\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L636-L639\n\n##### Recommendation\nWe recommend removing unnecessary checks.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#17-unnecessary-checks",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Not checking the length on `_addresses` and `_increaseAllocations`",
        "content": "##### Description\nAt line https://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L262 the `batchAllowlist` function is defined. It takes two arrays as an argument and then loops over them. It is expected that two arrays would have the same length as they contain corresponding data. But their lengths aren't compared.\n\n##### Recommendation\nWe recommend comparing that the arrays have the same lengths.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#18-not-checking-the-length-on-_addresses-and-_increaseallocations",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary casting to `uint256`",
        "content": "##### Description\nUnnecessary casts were spotted here - https://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L580 and here - https://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/FantiumNFTV3.sol#L462.\n\n##### Recommendation\nIt's not recommended to cast to `uint256` there, as arguments have the `uint256` types themselves.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#19-unnecessary-casting-to-uint256",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`onlyManager()` and `onlyRole(PLATFORM_MANAGER_ROLE)` have the same logic",
        "content": "##### Description\nThere are some places where the `onlyManager()` modifier is used - https://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L201 and `onlyRole(PLATFORM_MANAGER_ROLE)` - https://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L298. Those modifiers have the same logic. There is no need to use both of them.\n\n##### Recommendation\nWe recommend coming to a one type of modifier when checking that the user is the protocol manager.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#20-onlymanager-and-onlyroleplatform_manager_role-have-the-same-logic",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Equation can be simplified",
        "content": "##### Description\nThe calculation of the token collection can be simplified.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/utils/TokenVersionUtil.sol#L21-L22\n\n##### Recommendation\nWe recommend changing the calculation to `uint256 collectionOfToken = _tokenId /ONE_MILLION;`.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#21-equation-can-be-simplified",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Bad name for the function",
        "content": "##### Description\nTh function name was copypasted from the previous function.\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L306-L309\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L338-L342\n\n##### Recommendation\nWe recommend changing the function name.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#22-bad-name-for-the-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "A function can be optimized",
        "content": "##### Description\nThe function can be optimized in two places:\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L548-L560\nhttps://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L553-L558.\n\n##### Recommendation\nWe recommend adding `if(!tokenNrClaimed)` before the loop and `break` inside `if` in the loop.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#23-a-function-can-be-optimized",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Bad pause management",
        "content": "##### Description\nPause management is very inconvenient right now, because all manager functions pause with the user functions which blocks the manager from making changes in the contract.\n\n##### Recommendation\nWe recommend rebuilding pause management and giving to the manager the ability to change some important parameters when the contract is paused.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#24-bad-pause-management",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "A limit of the distribution amount as one billion is not correct",
        "content": "##### Description\nFantiumClaimingNFTV1 has these lines:\n- https://github.com/FantiumAG/smart-contracts/blob/a2d126453c1105028f12277b8f342d2cdbf01a77/contracts/claiming/FantiumClaimingV1.sol#L216-L222.\nThe comments state that it should \"check if the amount is less than a billion\".\nBy the way, it compares with number `10_000_000_000_000_000`, which is in fact ten billion with 6 decimals.\n\n##### Recommendation\nWe recommend updating either the comparison or the comment to adjust to true designed limitations.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#25-a-limit-of-the-distribution-amount-as-one-billion-is-not-correct",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Version calculation can be simplified",
        "content": "##### Description\nToken's version calculation can be simplified. Now it's calculated as \n`((_tokenId % ONE_MILLION) - (_tokenId % TEN_THOUSAND)) / TEN_THOUSAND` (https://github.com/FantiumAG/smart-contracts/blob/c622b4c35132167bacc22cf76656d80715edb5fd/contracts/utils/TokenVersionUtil.sol#L22). But it's equal to `(_tokenId % ONE_MILLION) / TEN_THOUSAND`.\n\n##### Recommendation\nWe recommend simplifying the version calculation.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#26-version-calculation-can-be-simplified",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An unnecessary internal function onlyRole modifier",
        "content": "##### Description\nThe internal function `FantiumClaimingV1.triggerClaimingSnapshot()` has a `onlyRole(PLATFORM_MANAGER_ROLE)` modifier (https://github.com/FantiumAG/smart-contracts/blob/c622b4c35132167bacc22cf76656d80715edb5fd/contracts/claiming/FantiumClaimingV1.sol#L665). This function can't be called from outside, so any role modifier is unnecessary. Also, every function calling `triggerClaimingSnapshot()` already has this modifier.\n\n##### Recommendation\nWe recommend removing this modifier.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#27-an-unnecessary-internal-function-onlyrole-modifier",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`payOutToken` and `payoutToken` variables differ only in one symbol.",
        "content": "##### Description\nIt's easy to make a mistake using variables `payOutToken` and `payoutToken`. It's better to use another name for the local variable.\n\n##### Recommendation\nWe recommend using another name for `payOutToken`.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#28-payouttoken-and-payouttoken-variables-differ-only-in-one-symbol",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Functions `topUpDistributionEvent()` and `addDistributionAmount()` have duplicated functionality.",
        "content": "##### Description\nFunctions `topUpDistributionEvent()` and `addDistributionAmount()` have duplicated functionality.\n\n##### Recommendation\nWe recommend taking out the logic to one function.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#29-functions-topupdistributionevent-and-adddistributionamount-have-duplicated-functionality",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The `maxInvocations` parameter check",
        "content": "##### Description\nThe FantiumNFTV3 contract allows to set off the `maxInvocations` parameter for collection and change its value in the future. Current checks allow not more than 9999 tokens (`maxInvocations < 10000`) (Max token id inside one token version would be 9998).\n\n##### Recommendation\nWe recommend using a non-strict (<=) check instead of a strict one (<).\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#30-the-maxinvocations-parameter-check",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An unnecessary check",
        "content": "##### Description\nThere is an unnecessary check inside the `claim` function. It compares `closeTime` with a 0 value despite the fact that such value cannot ever be set to that parameter.\n\n##### Recommendation\nWe recommend removing that check.\n",
        "protocol": "Fantium",
        "report_date": "2023-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/README.md#31-an-unnecessary-check",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium%20v2/Fantium%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Double-approval attack by malicious owner",
        "content": "##### Description\n\nPending transactions have the `_approvalCount` counter.\n\nThe `_approvalCount` for each transaction is simply incremented by 1 each time an owner approves it. However, when the owners are reconfigured using the `configureOwners()` function, the `_approvalCount` value for valid transactions remains positive. This can lead to a scenario where the minority of owners can execute a transaction.\n\n- https://github.com/cloudwalk/brlc-multisig/blob/b5d6c2b6273162d5666d48649890b15a113df7a7/contracts/base/MultiSigWalletBase.sol#L345\n- https://github.com/cloudwalk/brlc-multisig/blob/b5d6c2b6273162d5666d48649890b15a113df7a7/contracts/base/MultiSigWalletBase.sol#L370\n\nFor example, in a wallet requiring the 2/3 of approvals, a malicious owner can create a transaction to withdraw all funds and approve it. They can then claim their account has been hacked and ask the other owners to change their account address (using `configureOwners()`). After the address change, the malicious owner can approve the previously created transaction again reaching the minimum required approvals=2 and execute the transaction.\n\n##### Recommendation\n\nWe recommend removing the counter and checking approvals in `_execute()` by iterating through `_approvalStatus()` using current owners.\n\nLike here in Gnosis:\n- https://github.com/gnosis/MultiSigWallet/blob/90639984c960d281bed3e0a5d56dd4adcb9407c4/contracts/MultiSigWallet.sol#L267-L279.\n\n",
        "protocol": "CloudWalk",
        "report_date": "2023-04-27",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/CloudWalk/README.md#1-double-approval-attack-by-malicious-owner",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/CloudWalk/CloudWalk%20Multisig%20Wallet%20Audit%20Report.pdf"
    },
    {
        "title": "`_execute` allows you to execute unsuccessful tasks in the future",
        "content": "##### Description\n\nIf the transaction is unsuccessful, then a revert will occur in the code (https://github.com/cloudwalk/brlc-multisig/blob/b5d6c2b6273162d5666d48649890b15a113df7a7/contracts/base/MultiSigWalletBase.sol#L378):\n\n```\n(bool success, bytes memory data) = transaction.to.call{ \n    value: transaction.value \n}(transaction.data);\nif (!success) {\n    revert InternalTransactionFailed(data);\n}\n```\n\nHowever, if a condition allows the transaction to be executed later, it will be completed as success. This is especially dangerous for:\n- `expirationTime` as `365 days`\n- various swaps with a slippage\n- `configureOwners` method and others. \n\n##### Recommendation\nWe recommend disallowing to use the transaction after `revert`, because the permission to execute remains with this transaction.\n\n",
        "protocol": "CloudWalk",
        "report_date": "2023-04-27",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/CloudWalk/README.md#1-_execute-allows-you-to-execute-unsuccessful-tasks-in-the-future",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/CloudWalk/CloudWalk%20Multisig%20Wallet%20Audit%20Report.pdf"
    },
    {
        "title": "A transaction doesn't have the sequence information",
        "content": "##### Description\n\nIn case of multiple transactions are approved any owner is able to choose the sequense of transactions. In some cases this owner can extract additional benefits from choosing the ordering.\n\nIn addition, transactions allow only one target call per transaction - it may be not enough for DeFi interactions. Complex DeFi interactions require making a few approved transactions, so benefits from sequencing can arise.\n\n- https://github.com/cloudwalk/brlc-multisig/blob/b5d6c2b6273162d5666d48649890b15a113df7a7/contracts/base/IMultiSigWallet.sol#L11-L18\n- https://github.com/cloudwalk/brlc-multisig/blob/b5d6c2b6273162d5666d48649890b15a113df7a7/contracts/base/MultiSigWalletBase.sol#L378\n\n##### Recommendation\n\nWe recommend adding the nonce information in transactions and allowing a list of targets.\n",
        "protocol": "CloudWalk",
        "report_date": "2023-04-27",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/CloudWalk/README.md#2-a-transaction-doesnt-have-the-sequence-information",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/CloudWalk/CloudWalk%20Multisig%20Wallet%20Audit%20Report.pdf"
    },
    {
        "title": "`WalletUpgradable` initialization is risky",
        "content": "##### Description\n\nThe current initialization of an upgradable wallet includes multiple steps, where a wallet proxy is owned by some external admin. The admin has to transfer proxy ownership directly to the wallet to finalize the initialization.\n\n##### Recommendation\n\nWe recommend applying the same factory-pattern for wallets as well in order to guarantee correct finalized initialization.\n\nAlso one of the solutions is to use `UUPSUpgradeable` with the correct setting `_authorizeUpgrade()` method via `onlySelfCall`.\n\n",
        "protocol": "CloudWalk",
        "report_date": "2023-04-27",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/CloudWalk/README.md#1-walletupgradable-initialization-is-risky",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/CloudWalk/CloudWalk%20Multisig%20Wallet%20Audit%20Report.pdf"
    },
    {
        "title": "`Wallet._configureExpirationTime()` allows setting low values, it's likely for the transactions to be frozen",
        "content": "##### Description\n\n`_expirationTime` should be long enough to make a transaction.\nIf it is low or mistakenly set to zero - transactions will be hard to execute.\n- https://github.com/cloudwalk/brlc-multisig/blob/b5d6c2b6273162d5666d48649890b15a113df7a7/contracts/base/MultiSigWalletBase.sol#L314\n\n\n##### Recommendation\n\nWe recommend setting a range for `_expirationTime` with minimum and maximum amounts.\n\n",
        "protocol": "CloudWalk",
        "report_date": "2023-04-27",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/CloudWalk/README.md#1-wallet_configureexpirationtime-allows-setting-low-values-its-likely-for-the-transactions-to-be-frozen",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/CloudWalk/CloudWalk%20Multisig%20Wallet%20Audit%20Report.pdf"
    },
    {
        "title": "Transfer ownership in two steps",
        "content": "##### Description\nIn the current implementation, the `configureOwners()` function immediately replaces the old owners with the new ones. However, this can lead to a permanent contract lock if it turns out that not all new owners actually control the provided addresses. A safer approach would be to implement a two-step process for changing owners, where the final owner replacement only occurs after all new owners have confirmed their ownership of the specified addresses.\n\n- https://github.com/cloudwalk/brlc-multisig/blob/b5d6c2b6273162d5666d48649890b15a113df7a7/contracts/base/MultiSigWalletBase.sol#L190\n\n##### Recommendation\nIt is recommended to implement a two-step owner replacement process. Instead of immediately replacing the old owners, the function should first require new owners to confirm their ownership of the specified addresses. Only after all new owners have successfully confirmed their ownership, should the final owner replacement take place. This approach reduces the risk of a contract lock due to incorrect or inaccessible owner addresses.\n",
        "protocol": "CloudWalk",
        "report_date": "2023-04-27",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/CloudWalk/README.md#2-transfer-ownership-in-two-steps",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/CloudWalk/CloudWalk%20Multisig%20Wallet%20Audit%20Report.pdf"
    },
    {
        "title": "Transaction exposure",
        "content": "##### Description\nIn the current implementation, even when `_cooldownTime` is set to 0, users are unable to collect all required approvals and submit a transaction to the private mempool at once. As a result, large trading transactions are visible in the contract state in advance, since the owners must first submit the full transaction data and then approve it through separate transactions. This makes these transactions vulnerable to griefing or profit reduction, as other parties can extract profit by observing the pending transactions and acting accordingly.\n\n- https://github.com/cloudwalk/brlc-multisig/blob/b5d6c2b6273162d5666d48649890b15a113df7a7/contracts/base/MultiSigWalletBase.sol#L316\n\n##### Recommendation\n\nConsider implementing a hidden transaction approach, where instead of storing the full transaction data in the contract storage, only the hash of the transaction is stored. This way, the transaction details remain hidden until the transaction is executed. Once the required number of owners have provided valid signatures for the hashed transaction, the transaction can be executed with the actual transaction data provided during execution. This approach adds an extra layer of privacy and security for large trading transactions.\n",
        "protocol": "CloudWalk",
        "report_date": "2023-04-27",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/CloudWalk/README.md#3-transaction-exposure",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/CloudWalk/CloudWalk%20Multisig%20Wallet%20Audit%20Report.pdf"
    },
    {
        "title": "Inability to cancel transactions with long expiration times after owner replacement",
        "content": "##### Description\nIn the current implementation, when owners are replaced, transactions with the previously set long `_expirationTime` values continue to remain in the list of pending transactions. New owners are unable to cancel these transactions, potentially allowing malicious transactions to be executed in the future. This poses a security risk, as new owners may not have the desired control over pending transactions submitted by previous owners.\n\n- https://github.com/cloudwalk/brlc-multisig/blob/b5d6c2b6273162d5666d48649890b15a113df7a7/contracts/base/MultiSigWalletBase.sol#L314\n\nNote, that the `revoke()` function cannot help in that case, because it only revokes a single approval of a specific owner and cannot revoke old approvals if the owners are changed.\n\n- https://github.com/cloudwalk/brlc-multisig/blob/b5d6c2b6273162d5666d48649890b15a113df7a7/contracts/base/MultiSigWalletBase.sol#L387\n\n##### Recommendation\n\nTo address this vulnerability, implement a mechanism to either automatically cancel or invalidate all pending transactions when owners are replaced. Alternatively, allow new owners to cancel or reject transactions, providing them with the necessary control over the contract's pending transactions. This will help prevent the execution of unwanted or malicious transactions submitted by the previous owners and ensure that only transactions approved by the current set of owners are executed.\n\n",
        "protocol": "CloudWalk",
        "report_date": "2023-04-27",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/CloudWalk/README.md#4-inability-to-cancel-transactions-with-long-expiration-times-after-owner-replacement",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/CloudWalk/CloudWalk%20Multisig%20Wallet%20Audit%20Report.pdf"
    },
    {
        "title": "The Oracle can lock reward distribution",
        "content": "##### Description\nIf Oracle updates become unavailable for some reasons, the rewards cannot be distributed.\n\n##### Recommendation\nIt is recommended to introduce a function that can distribute rewards without data from the Oracle.\n\n",
        "protocol": "P2P.org",
        "report_date": "2023-04-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/P2P.org/ETH2%20Depositor%20&%20ETH%20Staking%20Fee%20Distributor%20(v.2)/README.md#1-the-oracle-can-lock-reward-distribution",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/P2P.org/ETH2%20Depositor%20&%20ETH%20Staking%20Fee%20Distributor%20(v.2)/ETH2%20Depositor%20&%20ETH%20Staking%20Fee%20Distributor%20Security%20Audit%20Report%20(v.2).pdf"
    },
    {
        "title": "Front-running for the `bid()` method",
        "content": "##### Description\n\nThe `bid()` transaction (https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/Auction.sol#L105) with a slightly higher bid can be sent right before the end of an auction.\n\nThe winner can be the one who bids a unit more at the last moment. Every bid transaction can be front-run or back-run. Thus,  a legitimate bidder can be prevented from making a proper bid.\n\n##### Recommendation\nWe recommended adding a specific step of an auction and taking a bid in `resolveAuction` from the previous block to avoid front-running.\n\n",
        "protocol": "Clearpool",
        "report_date": "2023-03-31",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/README.md#1-front-running-for-the-bid-method",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/Clearpool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Rejected auction is always in default state",
        "content": "##### Description\n\nAfter the auction has been rejected, there is no way for the owner or user to close the pool. So, in `PoolFactory.marketPools`, `PoolFactory.pools` this pool (with default status and rejected auction) will be there for infinity.\n\n```\n// start some auction\n...\nawait auction.resolveAuction(pool.address, false);\n\nawait increaseTime(MUCH_TIME);\n\n// try to close pool after Auction (calls from owner)\n// await pool.allowWithdrawalAfterNoAuction(); \u2014 revert\n// await pool.close(); \u2014 revert\n```\n\n##### Recommendation\nWe recommend adding the description of this state to the whitepaper or adding a conditional to close the pool:\n- https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/pool/PoolBase.sol#L180. \n",
        "protocol": "Clearpool",
        "report_date": "2023-03-31",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/README.md#2-rejected-auction-is-always-in-default-state",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/Clearpool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Protect CPOOLs in PoolFactory",
        "content": "##### Description\n\nThe rewards, which will be paid to the user, are at the factory. \n\n`Sweep` allows to withdraw CPOOL tokens and block the possibility of claiming by users.\n\n- https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/PoolFactory.sol#L393\n\n##### Recommendation\nWe recommended protecting CPOOL to avoid sweeping.\n",
        "protocol": "Clearpool",
        "report_date": "2023-03-31",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/README.md#3-protect-cpools-in-poolfactory",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/Clearpool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Infinite Block Auction",
        "content": "##### Description\n\nThe owner may not call `resolveAuction` (https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/Auction.sol#L139):\n- to block `lastBid` of a user on the `Auction` contract and there is no mechanism to bypass that;\n- to prevent the pool's users from getting an insurance or bid after the auction;\n- to manipulate the market.\n\n##### Recommendation\nWe recommended allowing users to call `resolveAuction` if enough time has passed.\n",
        "protocol": "Clearpool",
        "report_date": "2023-03-31",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/README.md#4-infinite-block-auction",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/Clearpool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Double-Adding Pool Vulnerability",
        "content": "##### Description\n\nThe [`PoolFactory.initializeExistingPoolsByMarket()`](https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/PoolFactory.sol#L214) function may add a pool to the `marketPools` array more than once if the function is called multiple times. This can occur if the function is called by mistake.\n\nThe [`closePool()`](https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/PoolFactory.sol#L402) function is unable to remove more than one instance of the same pool from the `marketPools` array and cannot be called twice for the same pool. As a result, the pool will remain in the array misleading users and also consuming gas when the array is iterated through.\n\n##### Recommendation\n\nIn order to fix this vulnerability, the `initializeExistingPoolsByMarket()` function should include an assertion that checks for the existence of the pool in the marketPools array before adding it. This will ensure that the same pool is not added more than once.\n",
        "protocol": "Clearpool",
        "report_date": "2023-03-31",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/README.md#5-double-adding-pool-vulnerability",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/Clearpool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Close active pools via `resolveAuctionWithoutGoverment`",
        "content": "##### Description\n\nIn commit 68820cb61c8e3fa1714be0aca161d9916c8ac9d3 `resolveAuctionWithoutGoverment` is called without a pool and time filtering. These checks can be passed by the user (https://github.com/clearpool-finance/permissionless-protocol/blob/68820cb61c8e3fa1714be0aca161d9916c8ac9d3/contracts/Auction.sol#L266):\n\n```\n# by default currentAuction.tokenId = 0\nrequire(currentAuction.tokenId == 0, \"AC\");\n# by default currentAuction.end = 0\nrequire(block.timestamp >= currentAuction.end, \"ANF\");\n# block.timestamp >= 6 days\nrequire(block.timestamp - currentAuction.end >= 6 days, \"TNP\");\n\n# lastBidder = 0x0, lastBid = 0\n# some erc-20 tokens allow to `transfer(0x0, 0)`\ncurrency.safeTransfer(\n    currentAuction.lastBidder,\n    currentAuction.lastBid\n);\n```\n\nSo, anyone can close an active pool at any time and call (https://github.com/clearpool-finance/permissionless-protocol/blob/68820cb61c8e3fa1714be0aca161d9916c8ac9d3/contracts/Auction.sol#L288):\n```\n...\nauctionInfo[pool].tokenId = type(uint96).max;\n...\nIPoolMaster(pool).processDebtClaim();\n...\n```\n\n##### Recommendation\nWe recommend checking the `currentAuction.end` and `pool` variables.\n\nThere is code that can block this flow (https://github.com/clearpool-finance/permissionless-protocol/blob/68820cb61c8e3fa1714be0aca161d9916c8ac9d3/contracts/Auction.sol#L280):\n```\ncurrency.safeTransfer(\n    currentAuction.lastBidder,\n    currentAuction.lastBid\n);\n```\n\nBut WETH, USDT, etc. can allow to call `transfer(0x0, 0)`.\n\n",
        "protocol": "Clearpool",
        "report_date": "2023-03-31",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/README.md#6-close-active-pools-via-resolveauctionwithoutgoverment",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/Clearpool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Risks of non-complete initialization",
        "content": "##### Description\n\n`PoolFactory.initialize()` is far from being the final initialization.\nIt sets only:\n- `cpool`\n- `staking`\n- `poolBeacon`\n- `interestRateModel`\n- `auction`\n\nBut many of crucial parameters remain not set and require calling a separate function for every parameter.\n- `treasury` - if not set, a reserve token can be transferred to a zero address on pool.proceesAuctionStart(), pool.close()\n- `reserveFactor` - if not set, a pool will work wrong\n- `insuranceFactor` - if not set, a pool will work wrong\n- `warningUtilization` - if not set, a pool will work wrong\n- `provisionalDefaultUtilization` - if not set, a pool will work wrong\n- `warningGracePeriod` - if not set, a pool will work wrong\n- `maxInactivePeriod` - if not set, a pool will work wrong\n- `periodToStartAuction` - if not set, a pool will work wrong\n- `rewardPerSecond` - if not set, cPool token rewards will be set zero, that is ok\n\nIt is not so bad that these parameters are not set during the factory initialization. The problem is that Factory allows createPool() if some of these parameters are not set.\n\n- https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/PoolFactory.sol#L181-201\n\nThis can lead to a situation where a human error causes one of these variables to be undefined, resulting in a new pool being created with incorrect parameters in the `PoolFactory` contract.\n\n##### Recommendation\n\nWe recommend either putting all parameter settings to the initialization function or placing `require(parameter!=0)` for all parameters in _createPool().\n\n",
        "protocol": "Clearpool",
        "report_date": "2023-03-31",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/README.md#1-risks-of-non-complete-initialization",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/Clearpool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Stake is locked for the contract owner in `_createPool()`",
        "content": "##### Description\nThe `_createPool()` method is called from the `createPoolInitial()` and `createPool()` methods which are marked with the `onlyOwner` modifier.\nThus,\n```\ninfo.staker = msg.sender;\ninfo.stakedAmount = staking.lockStake(msg.sender);\n```\nat https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/PoolFactory.sol#L509 uses the owner's address to lock the stake, while it's a manager who is supposed to be staking tokens according to the [whitepaper](https://3929482601-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FhkiSI8bK3ThlypJ3jdEC%2Fuploads%2F6DdJZjkGBW4KgNDGTKny%2FClearpool%20Whitepaper%20v2.2.pdf?alt=media&token=c3b9bf3c-c806-43ea-a47b-b914bf885bed):\n\n> 2.1 Borrower Whitelisting & Credit Evaluation\n> <..>\n> To become whitelisted, the institution must first complete a due diligence, KYC and AML procedure, agree to the Clearpool Terms & Conditions, and stake an amount of CPOOL tokens before a pool can be launched.\n\n##### Recommendation\n\nIf it is not an expected behavior, correct the lines so that the funds were taken from the right staker and this right staker were stored in `info.staker`.\n",
        "protocol": "Clearpool",
        "report_date": "2023-03-31",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/README.md#2-stake-is-locked-for-the-contract-owner-in-_createpool",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/Clearpool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The pool borrower must not be permitted to participate in the auction",
        "content": "##### Description\n\nIn `setWhitelistedBidder` there aren't any checks for `bidder` (https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/Auction.sol#L179).\n\nBut in [whitepaper](https://3929482601-files.gitbook.io/~/files/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FhkiSI8bK3ThlypJ3jdEC%2Fuploads%2F6DdJZjkGBW4KgNDGTKny%2FClearpool%20Whitepaper%20v2.2.pdf?alt=media&token=c3b9bf3c-c806-43ea-a47b-b914bf885bed):\n> 3.3 Auction\n> <..>\n> Bidders can be individuals or institutions but must be whitelisted. Whitelisting is achieved through providing KYC information and by declaring the UBO of the bid. The pool borrower is not permitted to participate in the auction.\n\nIt requires excluding the manager of the pool.\n\n##### Recommendation\n\nAlthough a manager may create a different address, we recommended adding this check to `setWhitelistedBidder`:\n- https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/Auction.sol#L179\n\nOr revising the whitepaper to make this logic more transparent.\n",
        "protocol": "Clearpool",
        "report_date": "2023-03-31",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/README.md#3-the-pool-borrower-must-not-be-permitted-to-participate-in-the-auction",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/Clearpool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unused `flashGovernor` variable",
        "content": "##### Description\nThe [`PoolFactory.flashGovernor`](https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/PoolFactory.sol#L26) variable is not being used in the code and is always zero.\n\n##### Recommendation\n\nRemove the unused field or mark it as obsolete if it's required for maintaining the storage structure.\n",
        "protocol": "Clearpool",
        "report_date": "2023-03-31",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/README.md#1-unused-flashgovernor-variable",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/Clearpool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "PoolFactory functions `setReserveFactor()` and `setInsuranceFactor()` require additional checks",
        "content": "##### Description\n\nTwo versions of these functions found:\n1. in PoolFacrory\n```\nfunction setReserveFactor(uint256 reserveFactor_) external onlyOwner {\n        require(reserveFactor_ <= Decimal.ONE, \"GTO\");\n        reserveFactor = reserveFactor_;\n        emit ReserveFactorSet(reserveFactor_);\n    }\n\nfunction setInsuranceFactor(uint256 insuranceFactor_) external onlyOwner {\n        require(insuranceFactor_ <= Decimal.ONE, \"GTO\");\n        insuranceFactor = insuranceFactor_;\n        emit InsuranceFactorSet(insuranceFactor_);\n    }\n```\n2. in pools (PoolConfuguration.sol)\n```\nfunction setReserveFactor(uint256 reserveFactor_) external onlyGovernor {\n        require(reserveFactor + insuranceFactor <= Decimal.ONE, \"GTO\");\n        reserveFactor = reserveFactor_;\n    }\n\nfunction setInsuranceFactor(uint256 insuranceFactor_)\n        external\n        onlyGovernor\n    {\n        require(reserveFactor + insuranceFactor <= Decimal.ONE, \"GTO\");\n        insuranceFactor = insuranceFactor_;\n    }\n```\nThe version in the pools checks that the sum of two factors is below Decimal.ONE. The factory setters do not check this, so pools can be created where the sum is above Decimal.ONE.\n\n- https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/PoolFactory.sol#L313-325\n\n##### Recommendation\n\nWe recommend that the two functions should be synchronized and adding the following line to the Factory functions.\n```\nrequire(reserveFactor + insuranceFactor <= Decimal.ONE, \"GTO\");\n```\n",
        "protocol": "Clearpool",
        "report_date": "2023-03-31",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/README.md#2-poolfactory-functions-setreservefactor-and-setinsurancefactor-require-additional-checks",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/Clearpool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`warningUtilization` can be above `provisionalDefaultUtilization`",
        "content": "##### Description\n\n`WarningUtilization` is expected to be always below `ProvisionalDefaultUtilization` but setters do not check this.\n```\nfunction setWarningUtilization(uint256 warningUtilization_)\n        external\n        onlyOwner\n    {\n        require(warningUtilization_ <= Decimal.ONE, \"GTO\");\n        warningUtilization = warningUtilization_;\n        emit WarningUtilizationSet(warningUtilization_);\n    }\n\nfunction setProvisionalDefaultUtilization(\n        uint256 provisionalDefaultUtilization_\n    ) external onlyOwner {\n        require(provisionalDefaultUtilization_ <= Decimal.ONE, \"GTO\");\n        provisionalDefaultUtilization = provisionalDefaultUtilization_;\n        emit ProvisionalDefaultUtilizationSet(\n            provisionalDefaultUtilization_\n        );\n    }\n```\n\n- https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/PoolFactory.sol#L329-346\n\n##### Recommendation\nWe recommend adding the necessary comparison invariants in setters. \n",
        "protocol": "Clearpool",
        "report_date": "2023-03-31",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/README.md#3-warningutilization-can-be-above-provisionaldefaultutilization",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/Clearpool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Add an auction resolution event",
        "content": "##### Description\nThe`resolveAuction()`  method at https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/Auction.sol#L139 doesn't emit an event about the auction resolution result.\n\n##### Recommendation\nAdd an event to notify the interested parties about the auction resolution result.\n",
        "protocol": "Clearpool",
        "report_date": "2023-03-31",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/README.md#4-add-an-auction-resolution-event",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/Clearpool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Parameters not validated for zero address",
        "content": "##### Description\nThe methods:\n- `createPoolInitial()` at https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/PoolFactory.sol#L225, \n- `createPool()` at https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/PoolFactory.sol#L238, \n- `transferPool()` at https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/PoolFactory.sol#L246, \n- `setManagerInfo()` at https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/PoolFactory.sol#L268, \n- `setCurrency()` at https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/PoolFactory.sol#L279\n\ndo not validate input for zero address, which allows to add not valid data to the storage.\n\n##### Recommendation\nAdd a zero address validation.\n",
        "protocol": "Clearpool",
        "report_date": "2023-03-31",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/README.md#5-parameters-not-validated-for-zero-address",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/Clearpool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Excessive Centralization",
        "content": "##### Description\nIn the `Auction` and `PoolFactory` contracts, all privileged methods are called by the contract owner.\n\n- https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/PoolFactory.sol\n- https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/Auction.sol\n\n`setPoolAuctionEnd()` can be used by the owner to endlessly extend the auction or to finish it at any moment, for instance, after a certain bid.\n\n##### Recommendation\nIn order to reduce centralization, it may be beneficial to use the OpenZeppelin's `AccessControl` contract to granulate roles. This will allow different roles to be defined and different levels of access to the contract's privileged methods.\n\nThis will enhance the security and decentralization of the contract by allowing multiple parties to have different levels of access and control. It will also make the contract more flexible and adaptable, as different roles can be created and modified as needed.\n",
        "protocol": "Clearpool",
        "report_date": "2023-03-31",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/README.md#6-excessive-centralization",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/Clearpool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possibly unnecessary state change in `processDebtClaim()`",
        "content": "##### Description\nThe `PoolBase.processDebtClaim()` function, which is called when an auction completes, has a line which sets the pool's state to `State.Default` (https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/pool/PoolBase.sol#L238):\n```solidity\n_info.state = State.Default;\n```\n\nHowever, if the pool were in a different state, we would not be able to start an auction in the first place, meaning that this function would not be called. Therefore, this line is unnecessary.\n\n\n##### Recommendation\n\nTo fix this issue, it is recommended to evaluate the conditions under which the `PoolBase.processDebtClaim()` function is called and determine whether the state change to `State.Default` is necessary. If it is not needed, the line of code should be removed to ensure that the state of the pool is not unnecessarily changed and that the function operates correctly.\n",
        "protocol": "Clearpool",
        "report_date": "2023-03-31",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/README.md#7-possibly-unnecessary-state-change-in-processdebtclaim",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/Clearpool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Reentrancy Vulnerability in `bid()`",
        "content": "##### Description\n\nAn attacker who is able to bypass the whitelist and register a pool with an ERC-777 token or a poisoned custom token may be able to exploit the reentrancy vulnerability in the `Auction.bid()` function. This would allow them to drain more funds to their benefit than intended by the contract's logic.\n\nThe attacker could potentially bypass the whitelist through social engineering or other means.\n\n- https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/Auction.sol#L121\n\n##### Recommendation\n\nIn order to fix this vulnerability, it is recommended to use the `nonReentrant` modifier from the OpenZeppelin's `ReentrancyGuard` contract in the `Auction.bid()` function. It is also recommended to add the `nonReentrant` modifier to the `Auction.resolveAuction()` function, just to be on the safe side. This will prevent these functions from being called recursively and will protect against reentrancy attacks.\n",
        "protocol": "Clearpool",
        "report_date": "2023-03-31",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/README.md#8-reentrancy-vulnerability-in-bid",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/Clearpool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Out-of-gas vulnerability in `closePool()`",
        "content": "##### Description\nThe [`closePool()`](https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/PoolFactory.sol#L402) function has a loop over both `pools.length` and `marketPools[market].length`. If these arrays become large enough, the function will stop working and will always return an out-of-gas error.\n\n##### Recommendation\n\nThere are different approaches to solve the problem. One option is to restrict the maximum number of pools that can be added. Another option is to use only mappings instead of arrays.\n",
        "protocol": "Clearpool",
        "report_date": "2023-03-31",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/README.md#9-out-of-gas-vulnerability-in-closepool",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/Clearpool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`PoolFactory.closePool` doesn't reset `stakedAmount`",
        "content": "##### Description\n\nIn `closePool`:\n- https://github.com/clearpool-finance/permissionless-protocol/blob/f1f38c5ba83e2c3a68155042229b04678d9425ce/contracts/PoolFactory.sol#L427\n\nafter unstaking `stakedAmount` won't be reset.\n\n##### Recommendation\n\nAlthough `closePool` calls once, we recommended setting `stakedAmount` as zero:\n```\ninfo.staker = address(0);\ninfo.stakedAmount = 0;\n```\n",
        "protocol": "Clearpool",
        "report_date": "2023-03-31",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/README.md#10-poolfactoryclosepool-doesnt-reset-stakedamount",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/Clearpool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Parameters are not validated in `setPoolAuctionEnd`",
        "content": "##### Description\n\n`setPoolAuctionEnd()` can be used by the owner to endlessly extend the auction or to finish it at any moment, for instance, after a particular bid.\n\n- https://github.com/clearpool-finance/permissionless-protocol/blob/68820cb61c8e3fa1714be0aca161d9916c8ac9d3/contracts/Auction.sol#L396\n\n##### Recommendation\nIt is recommended to add an upper limit for the auction time and forbid decreasing the auction length.\n\n",
        "protocol": "Clearpool",
        "report_date": "2023-03-31",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/README.md#11-parameters-are-not-validated-in-setpoolauctionend",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/Clearpool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The `amount` parameter is not validated in `increaseBid(address pool, uint256 amount)`",
        "content": "##### Description\n\nThe `increaseBid(address pool, uint256 amount)` function doesn't validate `amount`, zero amount can be passed to the function.\n\n##### Recommendation\nWe recommend adding:\n\n```\nrequire(amount > 0, \"\");\n```\n",
        "protocol": "Clearpool",
        "report_date": "2023-03-31",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/README.md#12-the-amount-parameter-is-not-validated-in-increasebidaddress-pool-uint256-amount",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Clearpool/Clearpool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect blacklisting of unsafe calls",
        "content": "##### Description\nAccording to the current design, the users of `Rubic` perform the ERC20 `approve` to the `ERC20Proxy` contract, allowing the ERC20 [tokens to be spent without further confirmations](https://github.com/Cryptorubic/multi-proxy-rubic/blob/8843336c50ca43e5b5bbe970f17e284f63a96763/src/Periphery/ERC20Proxy.sol#L40). It is crucially important to disallow any unauthorized calls to this contract, otherwise the user's ERC20 tokens may be spent by an unauthorized party.\n\nThe `LibSwap` library implements mechanics to perform an arbitrary call to an arbitrary address. By design, calls to `ERC20Proxy` are [blacklisted](https://github.com/Cryptorubic/multi-proxy-rubic/blob/8843336c50ca43e5b5bbe970f17e284f63a96763/src/Libraries/LibSwap.sol#L32). However, the blacklisting is set up in the context of `RubicMultiProxy` and will not work in the context of `Executor`, which is also granted a permission to call `ERC20Proxy` for [`_processSwaps`](https://github.com/Cryptorubic/multi-proxy-rubic/blob/8843336c50ca43e5b5bbe970f17e284f63a96763/src/Periphery/Executor.sol#L174). Therefore, an attacker can force `Executor` to call `ERC20Proxy` (see the Critical.2 finding), perform an unauthorized `transferFrom` and withdraw the ERC20 tokens of any user who gave an ERC20 `approve` to the `Rubic`.\n\n##### Recommendation\nIt is recommended to use more fail-safe practices of managing the ERC20 `approve` as described below in the recommendation for the Medium.1 finding. Additionally, it is advised to fix the blacklist issue for the `LibSwap`.\n\n\n",
        "protocol": "Rubic",
        "report_date": "2023-03-30",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Rubic/README.md#1-incorrect-blacklisting-of-unsafe-calls",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Rubic/Rubic%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Arbitrary calls execution in `Executor` and `GenericCrossChainFacet`",
        "content": "##### Description\nThe `Executor` contract allows the execution of arbitrary calls in the shared context using the `stargate` functionality or directly by calling the [`swapAndExecute`](https://github.com/Cryptorubic/multi-proxy-rubic/blob/8843336c50ca43e5b5bbe970f17e284f63a96763/src/Periphery/Executor.sol#L114) external function.\n\n`GenericCrossChainFacet` also allows the execution of arbitrary calls in the shared context using the [swapAndStartBridgeTokensViaGenericCrossChain](https://github.com/Cryptorubic/multi-proxy-rubic/blob/ba18b51508c17f8dde2b1557bcbc58d48042ce6c/src/Facets/GenericCrossChainFacet.sol#L90). \n\nIt allows an attacker to setup ERC777 hooks, to provoke blacklisting and do something harmful to the `Executor` and the `Diamond` operationality.\n\nExecuting any external calls in the context of the vulnerable contract (`Executor` or `Diamond`) allows an attacker to intercept a transaction of another user and steal ERC777 tokens:\n1. Give an approve to the attacker contract from vulnerable contract for a ERC777 token. \n2. Set a `transferOnReceive` callback that executes the attacker contract after each transfer to the`Executor` or `Diamond` contract.\n3. Some user executes a swap that utilizes the ERC777 token in the end.\n4. The attacker contract using the approve (at step 1) drains the vulnerable contract inside the ERC777 callback implementation function.\n\n##### Recommendation\nIt is recommended to allow list calls from `Executor` similar to implementation at the facet part of the project. Additionaly, it is recommended to allow list bridges in the `GenericCrossChainFacet`.\n\n\n",
        "protocol": "Rubic",
        "report_date": "2023-03-30",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Rubic/README.md#2-arbitrary-calls-execution-in-executor-and-genericcrosschainfacet",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Rubic/Rubic%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unsafe practice of managing a user's ERC20 approve",
        "content": "##### Description\nAs it is stated above in the description of the Critical.1 finding, a user's ERC20 tokens can be spent without the user's confirmation. This bad practice reduces the overall project's security by amplifying the impact of other issues. For example, Critical.1 would have a Low severity, and the Medium.2 would be a no issue, if finding Medium.1 is fixed as recommended.\n\nAs a general architecture recommendation, this finding is described as a separate item of the report.\n##### Recommendation\nIt is recommended that every single spending of the user's ERC20 tokens be explicitly signed by the user.\n\n",
        "protocol": "Rubic",
        "report_date": "2023-03-30",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Rubic/README.md#1-unsafe-practice-of-managing-a-users-erc20-approve",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Rubic/Rubic%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The administrator can modify trusted functionality",
        "content": "##### Description\nThe `DiamondCutFacet` allows the `Owner` to [add a new facet with unaudited code](https://github.com/Cryptorubic/multi-proxy-rubic/blob/8843336c50ca43e5b5bbe970f17e284f63a96763/src/Libraries/LibDiamond.sol#L93). In combination with the Medium.1 finding, it may lead to users' wallets being drained. Additionaly, the `Owner` is allowed to [add a brand new smart contract](https://github.com/Cryptorubic/multi-proxy-rubic/blob/8843336c50ca43e5b5bbe970f17e284f63a96763/src/Periphery/ERC20Proxy.sol#L27) to the list of trusted contracts.\n##### Recommendation\nIt is recommended to resolve the Medium.1 finding in order to minimize the impact of the `Owner`'s actions.\n\n",
        "protocol": "Rubic",
        "report_date": "2023-03-30",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Rubic/README.md#2-the-administrator-can-modify-trusted-functionality",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Rubic/Rubic%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unused logic",
        "content": "##### Description\nModifiers [`noLeftovers`](https://github.com/Cryptorubic/multi-proxy-rubic/blob/8843336c50ca43e5b5bbe970f17e284f63a96763/src/Helpers/SwapperV2.sol#L31) and [`refundExcessNavtive`](https://github.com/Cryptorubic/multi-proxy-rubic/blob/8843336c50ca43e5b5bbe970f17e284f63a96763/src/Helpers/SwapperV2.sol#L115) use balances differences before and after swaps to calculate leftovers but no any token is supposed to be on the balance before a swap. That's why using just balances is more efficient and simple.\n##### Recommendation\nIt is recommended to simplify modifiers and use just balances.\n\n",
        "protocol": "Rubic",
        "report_date": "2023-03-30",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Rubic/README.md#1-unused-logic",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Rubic/Rubic%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Bypassing payment fees through various methods",
        "content": "##### Description\n\nSwapExecutor, a contract responsible for executing token swaps, is vulnerable to multiple methods of bypassing payment fees, allowing an attacker to perform swaps without paying the required fees.\n\nThe first method involves specifying a personal transfer of all tokens in the final swap, leaving only 2 wei of `tokenToTransfer` on the contract to avoid paying fees. This enables the attacker to evade payment and execute swaps at no cost.\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapExecutor.sol#L146\n\nThe second method involves passing a swap-path that ends with a poisonous token created by the attacker. The attacker pays fees in their own token, which is worthless, thus bypassing payment fees.\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapFacade.sol#L35\n\nThe third method involves copying the code of SwapExecutor and removing the payment logic, allowing the attacker to continue using the SwapFacade without paying any fees by passing the custom SwapExecutor to `SwapFacade.swap()`.\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapFacade.sol#L29\n\nOverall, these vulnerabilities allow attackers to perform swaps without paying the required fees, leading to potential financial losses for the SwapExecutor owners.\n\n##### Recommendation\n\nOne way to address the vulnerabilities in SwapExecutor is to take a fixed fee in a fixed token, such as Ether, in SwapFacade.\n",
        "protocol": "Barter DAO",
        "report_date": "2023-03-15",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/README.md#1-bypassing-payment-fees-through-various-methods",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/Barter%20DAO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Hashflow RFQ-integration",
        "content": "##### Description\n\nSince we receive `HashflowQuote` before the call occurred, the information at the time of the transaction may not be up to date. \n\nIn that case, due to this code:\n\n```\nif (amount > quote.maxBaseTokenAmount) {\n    emit AmountExceedsQuote(amount, quote.maxBaseTokenAmount);\n    quote.effectiveBaseTokenAmount = quote.maxBaseTokenAmount;\n} else {\n    quote.effectiveBaseTokenAmount = amount;\n}\n```\n\npart of the money may remain with the `SwapExecutor`.\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/helpers/HashflowHelper.sol#L24\n\n##### Recommendation\n\nWe recommend adding a revert if the input `amount` is not actual.\n",
        "protocol": "Barter DAO",
        "report_date": "2023-03-15",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/README.md#2-hashflow-rfq-integration",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/Barter%20DAO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Swaps through an ERC777 token can lead to DoS of these swaps",
        "content": "##### Description\n\nERC777 tokens allow hooks before and after balance changes.\nTransfer `_from` and `to` can choose the exact receivers of these hooks via `Registry.setInterfaceImplementer()`:\n- [ERC1820Registry](https://etherscan.io/address/0x1820a4B7618BdE71Dce8cdc73aAB6C95905faD24)\n\nAlso, Executor allows anyone to call `executeSwap()` and decide on the following targets and calldata.\n\n1) An attacker uses `executeSwap()` so that Executor calls `ERC1820Registry.setInterfaceImplementer(implementer=attacker)`. \n2) User A swaps an ERC777 token to something with low `minReturn`. It must be at least one ERC777 among the list of tokens in swaps.\n3) Executor receives ERC777 tokens from Facade (hook).\n4) The attacker reverts on the hook.\n\nAs a result, any ERC777 token going through Executor will lead to DoS and swap will revert.\n\nSo, one of the attack flows can be like this:\n1) Attacker uses `executeSwap()` so that Executor calls `ERC1820Registry.setInterfaceImplementer(implementer=attacker)'. \nSo, anytime Executor receives ERC777 tokens, a frontrunner contract will be called.\n2) User A swaps the ERC777 tokens to something with low `minReturn`.\n3) Executor receives the ERC777 tokens from Facade (hook).\n4) Attacker contract enters Executor.executeSwap() and Executor thinks that current ERC777 tokens belong to Attacker. So, he can withdraw these tokens, or swap them to something.\n\nOr at least Attacker can revert when recieving a call, not allowing a swap with this token at all.\n\n##### Recommendation\n\nWe recommend that Facade be the only allowed caller for `SwapExecutor.execureSwap()` with the Reentrancy guard and be sure that `minReturn` is set even for small swaps.\n",
        "protocol": "Barter DAO",
        "report_date": "2023-03-15",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/README.md#3-swaps-through-an-erc777-token-can-lead-to-dos-of-these-swaps",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/Barter%20DAO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Facade allows any unauthorized Executor",
        "content": "##### Description\n\nSwapFacade allows to choose any SwapExecutor address, even not authored by the team. Fees are charged on SwapExecutor. So, it is rational to fork SwapExecutor with zero fees and choose it as an executor for swaps.\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapFacade.sol#L87\n\nSome other possible scenarios:\n- users can choose out date executors\n- users can choose executors with bugs\n\n##### Recommendation\nWe recommend having a list of allowed executors and taking fees on SwapFacade.\n",
        "protocol": "Barter DAO",
        "report_date": "2023-03-15",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/README.md#1-facade-allows-any-unauthorized-executor",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/Barter%20DAO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Anyone can withdraw funds left on `SwapExecutor`",
        "content": "##### Description\n\nFunds left on the `SwapExecutor` can be withdrawn by anyone who specifies a transfer call in the swaps.\n\nThere are multiple reasons why funds may be left on the `SwapExecutor`:\n1. A user may not set the `tokenRatio` to 100% in a swap.\n\n```\nuint256 poolSwapAmount = (balanceToSwap * swap.tokenRatio) / _ONE;\n\n# sum (tokenRatio) > _ONE - is not risky, revert happens\n# sum (tokenRatio) < _ONE - is risky, as some tokens \n          are left not swapped and can be taken by anyone.\n```\n\n2. The `SwapExecutor` may run arbitrary calls to protocols that reward it with additional tokens. The `SwapFacade` only checks the `tokenToTransfer`, and a user may forget to transfer other tokens from the `SwapExecutor` immediately.\n3. If a user transfers tokens to the `SwapExecutor` first and then runs the `SwapFacade.swap()` function in a separate transaction.\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapExecutor.sol#L58\n\n##### Recommendation\nTo address this, a similar approach to that used in CowProtocol could be implemented: allowing only whitelisted managers to execute swaps in SwapExecutor.\n\nIt is also recommended to check that all `tokenRatio` used eventually sum up to 100%. \n",
        "protocol": "Barter DAO",
        "report_date": "2023-03-15",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/README.md#2-anyone-can-withdraw-funds-left-on-swapexecutor",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/Barter%20DAO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "ETH value above limited value can be lost",
        "content": "##### Description\n\nSwapExecutor has the following lines for ETH:\n\n```\nif (value > valueLimit) {\n    value = valueLimit;\n}\n(success, result) = target.call{ value: value }(data);\n```\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapExecutor.sol#L116-L120\n\nSo, only a limited amount will be used if sent ETH is above valueLimit.\nThis ETH will be lost on the contract and anyone can withdraw these exceeded amounts.\n\n##### Recommendation\nWe recommend redesigning valueLimit purpose so that no funds are lost in edge situations.\n",
        "protocol": "Barter DAO",
        "report_date": "2023-03-15",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/README.md#3-eth-value-above-limited-value-can-be-lost",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/Barter%20DAO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "A swap with permit can be blocked if a frontrunner swaps using copied permit",
        "content": "##### Description\n\nFacade does not check that msg.sender is the owner of a permit.\nSo, a frontrunner can use permits of other users available from mempool, so that their transactions would revert (as permit are used by the frontrunner).\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapFacade.sol#L58-L64\n\nA user will receive revert and will have to build new calldata, without permit.\n\n##### Recommendation\n\nWe recommend decoding permits to extract their owner, then check that msg.sender is this owner. Some example used by 1inch:\n- https://github.com/1inch/solidity-utils/blob/60fa6eba06f50f2acac5286dea5fb54f206e2434/contracts/libraries/SafeERC20.sol#L158-L245\n\n***",
        "protocol": "Barter DAO",
        "report_date": "2023-03-15",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/README.md#4-a-swap-with-permit-can-be-blocked-if-a-frontrunner-swaps-using-copied-permit",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/Barter%20DAO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unprotected access to `makeCheckpoint()` in SwapGuardV2",
        "content": "##### Description\n\nSwapGuardV2 functions are planned to be used as separate calls in a set of swaps. However, if during the swaps process a hacker manages to get a callback to their own contract (for example, if the victim operates with ERC-777 tokens), the hacker can call public accessible function `makeCheckpoint()` to modify the SwapGuardV2 state so that the `ensureCheckpoint()` function at the victim's end would not work correctly.\n\nhttps://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapGuardV2.sol#L20\n\n##### Recommendation\n\nIt is recommended to revise the approach to using SwapGuardV2. It may be reasonable to leave only one function in SwapGuardV2, which receives a set of tokens, deltas and a callback. The function records the current token balances in memory instead of a storage, then calls the user's callback (which performs swaps), and then checks for changes in the balances.\n",
        "protocol": "Barter DAO",
        "report_date": "2023-03-15",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/README.md#5-unprotected-access-to-makecheckpoint-in-swapguardv2",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/Barter%20DAO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`Ownable` can be upgraded to `Ownable2Step`",
        "content": "##### Description\n\nSwapExecutor uses the `Ownable` functionality:\n\nhttps://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapExecutor.sol#L24\n\nThe `Ownable` contract can be upgraded to Open Zeppelin's `Ownable2Step`:\nhttps://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/access/Ownable2Step.sol\n\n`Ownable2Step` provides added safety due to its securely designed two-step process.\n\n\n##### Recommendation\n\nWe recommend applying `Ownable2Step` instead of `Ownable`.\n\n\n***\n",
        "protocol": "Barter DAO",
        "report_date": "2023-03-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/README.md#1-ownable-can-be-upgraded-to-ownable2step",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/Barter%20DAO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Simplifying `setFeeAndFeeRecipient()` logic for gas optimization",
        "content": "##### Description\n\nThe current implementation manually packs and unpacks the fee and address from a uint256 value, which increases the likelihood of errors and may cause unnecessary gas usage.\n\n* https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapExecutor.sol#L48\n* https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapExecutor.sol#L137\n\n##### Recommendation\n\nTo simplify the logic and optimize gas usage, it's recommended to store the fee and address separately in the contract's state using two separate variables:\n```soliditiy\nuint160 feeAddress;\nuint96 fee;\n```\n\nBoth variables will fit into a single storage slot. This will also allow more efficient retrieval of the fee-related data.\n\n***\n",
        "protocol": "Barter DAO",
        "report_date": "2023-03-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/README.md#2-simplifying-setfeeandfeerecipient-logic-for-gas-optimization",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/Barter%20DAO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Missing zero-checks",
        "content": "##### Description\n\nThere are no zero checks for `recipient` and `minReturn`:\n* https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapFacade.sol#L32\n* https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapFacade.sol#L33\n\nSome programs may pass zero values for some arguments by default. A user may not notice this behaviour and lose funds.\n\n##### Recommendation\n\nIt is recommended to add requirements which check that the `recipient` and `minReturn` are not zero.\n\n***\n",
        "protocol": "Barter DAO",
        "report_date": "2023-03-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/README.md#3-missing-zero-checks",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/Barter%20DAO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "SwapGuardV2 has multiple problems",
        "content": "##### Description\n\n1. Contracts that use SwapGuardV2 together with Facade+Executor are out of scope\n2. All functions are public and anyone can makeCheckpoint()\n3. This contract will not work with native ETH.\n4. allowedLoss adds up with tokens having different decimals. Or tokensPrices must at least include decimals\n5. Lengths of tokens, tokenPrices and balanceChanges are not checked to be the same\n6. All checkpoints are written to storage, no need if it is used in one transaction\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapGuardV2.sol#L20-L58\n\n##### Recommendation\n\nWe recommend using more efficient ways to check profitability of swaps.\n",
        "protocol": "Barter DAO",
        "report_date": "2023-03-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/README.md#4-swapguardv2-has-multiple-problems",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/Barter%20DAO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Protection against accidential ETH sendings does not work",
        "content": "##### Description\n\nBoth Facade and Executor inherit ContractOnlyEthRecipient.sol with the following code.\n\n```\n/**\n * @title ContractOnlyEthRecipient\n * @notice Base contract that rejects any direct ethereum deposits. \n This is a failsafe against users who can accidentaly send ether\n */\nabstract contract ContractOnlyEthRecipient {\n    receive() external payable {\n        // solhint-disable-next-line avoid-tx-origin\n        if (msg.sender == tx.origin) {\n            revert DirectEthDepositIsForbidden();\n        }\n    }\n}\n```\n\nIn fact, only Executor needs this inheritance, as it can receive ETH from external exchanges.\nBut Facade should only receive ETH as msg.value at swap().\n\nAlso, in the comments developers stated that it is against accidential ETH sendings.\nBy the way, it still allows to receive accidential ETH from users as contracts (like user wallets). Moreover, any accidential ETH on balances are bad (can be stolen), so it is better to remove options to receive accidential money when it\u2019s possible.\n\n##### Recommendation\n\nWe recommend removing `recieve()` for `SwapFacade` and `SwapGuardV2`.\n\n***\n",
        "protocol": "Barter DAO",
        "report_date": "2023-03-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/README.md#5-protection-against-accidential-eth-sendings-does-not-work",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/Barter%20DAO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Not effective depositETH() and withdrawETH()",
        "content": "##### Description\n\n`depositETH()` and `withdrawETH()` are inherited and make calls to WETH.\n\nIt is used to swap between native ETH and WETH. But the implementation makes Executor call itself (external call), send ETH itself.\n\nThis step is useless and can be dropped.\n\n```\nfunction depositWeth(uint256 amount) external payable {\n    if (amount != msg.value) {\n        revert EthValueAmountMismatch();\n    }\n    weth.deposit{value: amount}();\n}\n\nfunction withdrawWeth(uint256 amount) external {\n    weth.withdraw(amount);\n}\n```\n\n##### Recommendation\n\nWe recommend removing these functions and use WETH as target directly.\n\n***\n",
        "protocol": "Barter DAO",
        "report_date": "2023-03-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/README.md#6-not-effective-depositeth-and-withdraweth",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/Barter%20DAO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Use `encodeCall`",
        "content": "##### Description\n\n`abi.encodeCall` is a safer way to avoid mistakes during compilation. The compiler checks that the types of args are compatible with a call.\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/helpers/UniswapV2Helper.sol#L31\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/helpers/HashflowHelper.sol#L30\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/helpers/DssPsmHelper.sol#L31\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/helpers/DodoV1Helper.sol#L22\n\n##### Recommendation\n\nWe recommend changing `encodeWithSelector` to `encodeCall`.\n\n***\n",
        "protocol": "Barter DAO",
        "report_date": "2023-03-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/README.md#7-use-encodecall",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/Barter%20DAO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Missing caller verification in `uniswapV3SwapCallback()`",
        "content": "##### Description\n\nThe `uniswapV3SwapCallback()` function in the `IUniswapV3SwapCallback` interface, which is part of the Uniswap v3 protocol, is used to handle the results of a swap. However, the function in `UniswapV3Executor` does not include any caller verification, which can lead to potential vulnerabilities.\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/features/UniswapV3Executor.sol#L20\n\n##### Recommendation\n\nThe uniswap team recommends checking that the caller of the `uniswapV3SwapCallback()` is a `UniswapV3Pool` deployed by the canonical `UniswapV3Factory`:\n- https://github.com/Uniswap/v3-core/blob/main/contracts/interfaces/callback/IUniswapV3SwapCallback.sol\n\nNote that this increases the amount of gas used.\n\n\n***\n",
        "protocol": "Barter DAO",
        "report_date": "2023-03-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/README.md#8-missing-caller-verification-in-uniswapv3swapcallback",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/Barter%20DAO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Funds stuck in `SwapFacade` cannot be withdrawn",
        "content": "##### Description\n\nERC-20 token funds cannot be withdrawn from SwapFacade if a user accidentally sends tokens to the SwapFacade contract instead of SwapExecutor.\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapFacade.sol#L16\n\n##### Recommendation\n\nIt is recommended to add a `sweep(token) onlyOwner` function with the onlyOwner modifier. This function will allow the owner of the contract to sweep any funds that are stuck in the contract and transfer them to a designated account. This will provide a safety net for users who accidentally send funds to the contract, preventing their funds from being lost or stolen.\n\n***\n",
        "protocol": "Barter DAO",
        "report_date": "2023-03-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/README.md#9-funds-stuck-in-swapfacade-cannot-be-withdrawn",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/Barter%20DAO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "A potential overflow due to unsafe math",
        "content": "##### Description\nIn `SwapExecutor` this line `uint256 poolSwapAmount = (balanceToSwap * swap.tokenRatio) / _ONE` allows making overflow.\n\nExample (https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapExecutor.sol#L73):\n```\nuint256 poolSwapAmount = (balanceToSwap * swap.tokenRatio) / _ONE;\n```\n\n##### Recommendation\n\nWe recommend removing unsafe math from critical functions.\n",
        "protocol": "Barter DAO",
        "report_date": "2023-03-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/README.md#10-a-potential-overflow-due-to-unsafe-math",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/Barter%20DAO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Use `UniswapV2Router02` to avoid duplication of code",
        "content": "##### Description\n\n`UniswapV2Helper` duplicates the existing code of `UniswapV2Router` from the official Uniswap repo.\n\n- https://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/helpers/UniswapV2Helper.sol#L18\n\n##### Recommendation\n\nWe recommend using the existing functionality to avoid potential mistakes.\n",
        "protocol": "Barter DAO",
        "report_date": "2023-03-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/README.md#11-use-uniswapv2router02-to-avoid-duplication-of-code",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/Barter%20DAO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`SwapFacade.swap()` gas optimisations",
        "content": "##### Description\n\nThe logic in `SwapFacade.swap()` can be simplified to always call the `_permit()`.\n\nThe logic at lines 59-73\nhttps://github.com/BarterLab/argon/blob/22239aaccdbb78d4aa7ac5c4d0859a9b31c0fc00/contracts/SwapFacade.sol#L63\n```solidity\n uint256 currentBalance = sourceToken.balanceOf(address(executor));\nif (currentBalance < amount)\n{\n    if (permit.length > 0) {\n        _permit(address(sourceToken), permit);\n    }\n    uint256 approveAmount = sourceToken.allowance(\n        msg.sender,\n        address(this)\n    );\n    if (approveAmount < amount) {\n        revert NotEnoughApprovedFundsForSwap(approveAmount, amount);\n    }\n    sourceToken.safeTransferFrom(msg.sender, address(executor), amount);\n}\n```\n\ncan be simplified down to just two lines (always call `_permit()`):\n\n```solidity\n_permit(address(sourceToken), permit);\nsourceToken.safeTransferFrom(msg.sender, address(executor), amount);\n```\n\nNote that the 1inch `_permit()` is already checking `permit.length` and does nothing in case it is zero:\n```solidity\ncontract Permitable {\n    error BadPermitLength();\n\n    function _permit(address token, bytes calldata permit) \n    internal virtual {\n        if (permit.length > 0) {\n            bool success;\n            if (permit.length == 32 * 7) {\n                // solhint-disable-next-line avoid-low-level-calls\n                (success,) = token.call(\n                    abi.encodePacked(IERC20Permit.permit.selector, permit)\n                );\n            } else if (permit.length == 32 * 8) {\n                // solhint-disable-next-line avoid-low-level-calls\n                (success,) = token.call(\n                    abi.encodePacked(IDaiLikePermit.permit.selector, permit)\n                );\n            } else {\n                revert BadPermitLength();\n            }\n            if (!success) {\n                RevertReasonForwarder.reRevert();\n            }\n        }\n    }\n}\n```\n\n##### Recommendation\n\nIt is recommended to remove unnecessary conditions to save gas.\n\n***\n\n",
        "protocol": "Barter DAO",
        "report_date": "2023-03-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/README.md#12-swapfacadeswap-gas-optimisations",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Barter%20DAO/Barter%20DAO/Barter%20DAO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Destruction of the EnsoWallet implementation contract",
        "content": "##### Description\nAn attacker can make a direct call (not via proxy) to [EnsoWallet.initialize()](https://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/EnsoWallet.sol#L24) and execute the SELFDESTRUCT opcode or specify themself as EXECUTOR and gain the ability to execute SELFDESTRUCT later. Consequently, the current implementation contract will be destroyed, and all users' wallet functionality will be inaccessible until the core upgrade. The worst case occurs if an attack happens after EnsoBeacon.renounceAdministration(), and all users' funds will be frozen.\n##### Recommendation\nWe recommend disallowing direct calls to EnsoWallet.initialize().\n\n\n",
        "protocol": "Enso Finance",
        "report_date": "2023-02-21",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/README.md#1-destruction-of-the-ensowallet-implementation-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/Enso%20Wallet%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Front-run attack on the deployment of EnsoWalletFactory",
        "content": "##### Description\nAn attacker can place their transactions between the deployment of the EnsoWalletFactory implementation and [EnsoWalletFactory.initialize()](https://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/EnsoWalletFactory.sol#L26) to specify themself as the contract owner and make an upgrade of the EnsoWalletFactory to the modified one. The modified factory contract may implement backdoor functionality to gain control of the deployed user wallets.\n\n##### Recommendation\nWe recommend improving the code of the upgradeable proxy to disallow the gain of ownership by arbitrary accounts or at least improve the deployment process in order to implement deployment and initialization in a single transaction.\n\n\n",
        "protocol": "Enso Finance",
        "report_date": "2023-02-21",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/README.md#2-front-run-attack-on-the-deployment-of-ensowalletfactory",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/Enso%20Wallet%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "EXECUTOR has a full write access to the wallet storage",
        "content": "##### Description\nEXECUTOR has a write access to any storage slots vie the executeShortcut function and delegatecall to a specially crafted library. This allows to trigger\ntransfer/renounce of the OWNER address and other unintended actions.\nhttps://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/EnsoWallet.sol#L57\n##### Recommendation\nWe recommend implementing an access control for the DELEGATECALL, i.e. a whitelist of permitted libraries.\n\n\n",
        "protocol": "Enso Finance",
        "report_date": "2023-02-21",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/README.md#1-executor-has-a-full-write-access-to-the-wallet-storage",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/Enso%20Wallet%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Admin can bypass the upgrade delay by `setDelay`",
        "content": "##### Description\nThe contract implements a special flow to upgrade the wallet core with delay, but the admin can force an immediate upgrade by reducing the delay using setDelay().\nhttps://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/EnsoBeacon.sol#L208\n\nThis will deprive users of the ability to check implementations before applying.\n\n##### Recommendation\nWe recommend improving the upgrade delay flow.\n\n\n",
        "protocol": "Enso Finance",
        "report_date": "2023-02-21",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/README.md#2-admin-can-bypass-the-upgrade-delay-by-setdelay",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/Enso%20Wallet%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Admin can bypass the upgrade delay by `delegate` and `emergencyUpgrade`",
        "content": "##### Description\nThe admin can bypass the upgrade delay flow and immediately change the address of the wallet core by following the sequence:\n- `transferDelegation` (to a new `delegate` account, controlled by the admin)\n- `acceptDelegation` (from the `delegate` account)\n- `upgradeFallback` (from the admin account)\n- `emegrencyUpgrade` (from the `delegate` account)\n##### Recommendation\nWe recommend improving the upgrade delay flow.\n\n\n",
        "protocol": "Enso Finance",
        "report_date": "2023-02-21",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/README.md#3-admin-can-bypass-the-upgrade-delay-by-delegate-and-emergencyupgrade",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/Enso%20Wallet%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Conflicting flow of pending `upgradeFactory` and `setFactory`",
        "content": "##### Description\nCalling [`finalizeUpgrade`](https://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/EnsoBeacon.sol#L74) after `setFactory` can cause unexpected behavior.\n##### Recommendation\nWe recommend improving the upgrade delayflow.\n\n\n",
        "protocol": "Enso Finance",
        "report_date": "2023-02-21",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/README.md#1-conflicting-flow-of-pending-upgradefactory-and-setfactory",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/Enso%20Wallet%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Insufficient event emitting",
        "content": "##### Description\nIn some edge cases it may be not so easy to obtain the wallet owner address and address of the factory that created it.\n##### Recommendation\nWe recommend adding the wallet owner and the factory address to the [`Deployed` event](https://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/EnsoWalletFactory.sol#L90).\n\n\n",
        "protocol": "Enso Finance",
        "report_date": "2023-02-21",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/README.md#2-insufficient-event-emitting",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/Enso%20Wallet%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potential hash collisions for constants",
        "content": "##### Description\n[The constants for the access roles `OWNER_ROLE` and `EXECUTOR_ROLE`](https://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/access/Roles.sol#L5)\nare vulnerable to potential hash collisions.\n##### Recommendation\nAlthough, we currently can't find any attack vector for this issue, we recommend improving the security of the constants by decreasing it by `-1` just like it is [implemented here](https://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/access/Ownable.sol#L11).\n\n\n",
        "protocol": "Enso Finance",
        "report_date": "2023-02-21",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/README.md#3-potential-hash-collisions-for-constants",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/Enso%20Wallet%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Null checks",
        "content": "##### Description\nSome parameters have no null checks:\n- https://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/EnsoBeacon.sol#L201\n- https://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/EnsoBeacon.sol#L123\n- https://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/access/AccessController.sol#L21\n##### Recommendation\nWe recommend adding a null check for `newFactory`, `newImplementation` and `account`.\n\n\n",
        "protocol": "Enso Finance",
        "report_date": "2023-02-21",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/README.md#4-null-checks",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/Enso%20Wallet%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Using ```memory``` instead of ```calldata```",
        "content": "##### Description\nUsing ```memory``` instead of ```calldata``` for input arrays in external functions:\nhttps://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/wallet/MinimalWallet.sol#L45\nhttps://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/wallet/MinimalWallet.sol#L84\nhttps://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/wallet/MinimalWallet.sol#L101\nhttps://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/wallet/MinimalWallet.sol#L112\nhttps://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/wallet/MinimalWallet.sol#L121\nhttps://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/wallet/MinimalWallet.sol#L145\nhttps://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/wallet/MinimalWallet.sol#L155\nhttps://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/wallet/MinimalWallet.sol#L165\n##### Recommendation\nWe recommend replacing ```memory``` by ```calldata```.\n\n\n",
        "protocol": "Enso Finance",
        "report_date": "2023-02-21",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/README.md#5-using-memory-instead-of-calldata",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/Enso%20Wallet%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Spelling mistakes",
        "content": "##### Description\nSome texts have spelling mistakes:\n1) `balanceAdderess` -> `balanceAddress`\n   https://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/helpers/EnsoShortcutsHelpers.sol#L14\n2) `renounes` -> `renouns`\n   https://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/EnsoBeacon.sol#L147\n3) `alway` -> `always`\n   https://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/EnsoBeacon.sol#L179\n4) `indetify` -> `identify`\n   https://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/EnsoWalletFactory.sol#L43\n   https://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/EnsoWalletFactory.sol#L79\n5) `implemenation` -> `implementation`\n   https://github.com/EnsoFinance/shortcuts-contracts/blob/4902e55608f975f73772310955444110b1cfc4fc/contracts/EnsoBeacon.sol#L67\n##### Recommendation\nWe recommend correcting the mistakes.\n\n\n",
        "protocol": "Enso Finance",
        "report_date": "2023-02-21",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/README.md#6-spelling-mistakes",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/Enso%20Wallet%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unchecked timelock delay",
        "content": "##### Description\nThe administrator can inadvertently (i.e. using millisecond timestamp notation) setup a timelock delay that is too long. This may cause an unacceptably long delay (i.e. a two-year delay instead of a seven-day delay).\n##### Recommendation\nWe recommend disallowing unintended long delays by limiting the maximum delay of the timelock with some reasonable value.\n\n\n",
        "protocol": "Enso Finance",
        "report_date": "2023-02-21",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/README.md#7-unchecked-timelock-delay",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/Enso%20Wallet%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Passing the `return data` by the EVM state",
        "content": "##### Description\n[`execTransactionFromModuleReturnData`](https://github.com/EnsoFinance/shortcuts-contracts/blob/951a4a247165f4209bceb6deb628a4970bf3f6da/contracts/wallet/ModuleManager.sol#L45) is using `returndatasize` and `returndatacopy` in the assumption that virtual function `_executeCall` is preserving the result of the corresponding external call at the EVM state. As for the audited commit, this assumption is correct. However, the implementation of the virtual `_executeCall` function may become more complex during a past codebase development, and this assumption may break the contract logic later.\n##### Recommendation\nIt is recommended to avoid using the EVM state as a method of passing values outside of a single solidity function, especially if the values are passed between functions located in different source files.\n\n\n",
        "protocol": "Enso Finance",
        "report_date": "2023-02-21",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/README.md#8-passing-the-return-data-by-the-evm-state",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Enso%20Wallet/Enso%20Wallet%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Contract works with non-existent collections and tokens",
        "content": "##### Description\n1. View methods (`getRoyalties()`, `tokenURI()`) work with non-existent collections.\n\nIn this example, incorrect royalty is returned for a non-existent collection:\n```\nawait nftContract.getRoyalties(0);\n# returns:\nrecipients: [\n    '0x3C44CdDdB6a900fa2b585dd299e03d12FA4293BC',\n    '0x0000000000000000000000000000000000000000'\n]\nbps: [\n    BigNumber { value: \"250\" }, \n    BigNumber { value: \"0\" }\n]\n```\n\n2. Athletes and Platform Manager can change parameters for non-existent collections. For example, function `updateCollectionAthleteAddress` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L308).\n\n3. A user can try to mint non-existent collections for free via `FantiumMinterV1.mint()` if `maxInvocations` is set. (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumMinterV1.sol#L241)\n\n##### Recommendation\nWe recommend checking the existing `collectionId` and `tokenId`. An example of classical implementation:\n```\nrequire(_exists(tokenId), \"Nonexistent token\");\n# or\nfunction tokenURI(uint256 tokenId) public view virtual override\nreturns (string memory) {\n    _requireMinted(tokenId);\n    ...\n}\n```",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#1-contract-works-with-non-existent-collections-and-tokens",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Undefined behavior for `mint`",
        "content": "##### Description\n\nIn `FantiumMinterV1.mint()`, param `_to` is intended to be `_to Address to be the minted token's owner`. It's wrong because the final mint will be for `msg.sender` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumMinterV1.sol#L269).\n\n```\n# athlete -> 0x90F79bf6EB2c4f870365E785982E1f101E93b906\n# fan -> 0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65\nawait minterContract.connect(fan).mint(athlete.address, 1, \n{ value: 100000000000000 });\nconsole.log(\"ownerOf -> \", await nftContract.ownerOf(1000000)); \n# print fan -> 0x15d34AAf54267DB7D7c367839AAf71A00a2C6A65\n```\n\n##### Recommendation\n\nWe recommend changing it: `fantiumNFTContract.mintTo(_to, thisTokenId);`\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#2-undefined-behavior-for-mint",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An intruder can block any users",
        "content": "##### Description\n\n`FantiumMinterV1.mint()` allows passing `_to`, which is not validated.\n\nAfter this line (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumMinterV1.sol#L266), we can change the permit of some users. In a common way we need to have the `onlyPlatformManager` permission for this action.\n\n##### Recommendation\n\nWe recommend that you rethink the logic of `allowList`.\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#3-an-intruder-can-block-any-users",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`FantiumNFTV1._owners` shadows `ERC721Upgradeable._owners`",
        "content": "##### Description\n\nFantiumNFTV1 `mapping(uint256 => address) internal _owners` shadows ERC721Upgradeable `mapping(uint256 => address) private _owners`.\n\nThus, the `exists()` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L245-L248) function will not work correctly:\n```solidity\nfunction exists(uint256 _tokenId) public view returns (bool) {\n    return _owners[_tokenId] != address(0);\n}\n```\n\n##### Recommendation\n\n1. Remove the FantiumNFTV1 `mapping(uint256 => address) internal _owners` line. \n2. Use the `ERC721Upgradeable.ownerOf()` method.\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#4-fantiumnftv1_owners-shadows-erc721upgradeable_owners",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Insufficient role isolation",
        "content": "##### Description\n\nRoles are not sufficiently isolated:\n1. `DEFAULT_ADMIN_ROLE` is allowed to run any operations on the contracts.\n2. By default, this and other roles are all assigned to a deployer.\n\nThis increases the surface for social engineering attacks.\n\n##### Recommendation\n\n`DEFAULT_ADMIN_ROLE` should be used to grant roles only and nothing else. The deployer may have this role, but they should not be granted any other roles.\n\n- https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L121,\n- https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L130,\n- https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumMinterV1.sol#L61,\n- https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumMinterV1.sol#L71,\n- https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumMinterV1.sol#L211,\n- https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumMinterV1.sol#L221\n\nIt creates confusion between a role that is supposed to manage the technical side of the contract and the role of the platform manager responsible for the business logic consistency. This creates difficulties in role management and has the potential to introduce errors related to the functionality permitted to each role.\n\nThus, it is recommended to remove these lines in [FantiumNFTV1](https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L18):\n```solidity\n_grantRole(PLATFORM_MANAGER_ROLE, msg.sender);\n...\n_grantRole(UPGRADER_ROLE, msg.sender);\n...\nhasRole(DEFAULT_ADMIN_ROLE, msg.sender),\n...\nhasRole(DEFAULT_ADMIN_ROLE, msg.sender),    \n```\n\nAlso, remove the lines in [FantiumMinterV1](https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumMinterV1.sol#L96-L98):\n```solidity\nhasRole(DEFAULT_ADMIN_ROLE, msg.sender),\n...\nhasRole(DEFAULT_ADMIN_ROLE, msg.sender),\n...\n_grantRole(KYC_MANAGER_ROLE, msg.sender);\n_grantRole(PLATFORM_MANAGER_ROLE, msg.sender);\n_grantRole(UPGRADER_ROLE, msg.sender);\n```",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#1-insufficient-role-isolation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Insufficient constraint checks",
        "content": "##### Description\n\nInsufficient constraint checks increase the human error probability: a platform manager may enter incorrect data and break the contract logic. \n\n`addCollection()` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L266):\n* no zero address check for `athleteAddress`\n* no constraint checks for `athletePrimarySalesPercentage`, `athleteSecondarySalesPercentage`\n\nNo check for the `collectionId` existence:\n* `updateCollectionName` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L297)\n* `updateCollectionAthleteAddress` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L308)\n* `toggleCollectionIsPaused` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L319)\n* `updateCollectionPrice` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L330)\n* `updateCollectionMaxInvocations` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L342)\n* `updateCollectionTier` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L353)\n* `updateCollectionBaseURI` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L366)\n* `updateCollectionAthleteName` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L378)\n* `updateCollectionAthletePrimaryMarketRoyaltyPercentage` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L397)\n* `updateCollectionAthleteSecondaryMarketRoyaltyPercentage` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L422)\n\nNo check `maxInvocations < ONE_MILLION` check:\n* `updateCollectionMaxInvocations` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L342)\n\nNo zero address check:\n* `updateCollectionAthleteAddress` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L308)\n* `updateFantiumPrimarySaleAddress` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L467)\n* `updateFantiumSecondarySaleAddress` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L479)\n* `updateFantiumMinterAddress` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L508)\n* `updateFantiumNFTAddress` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumMinterV1.sol#L322)\n\n`updateTiers` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L493):\n* no check for `_priceInWei > 0`\n* no check for `_maxInvocations < ONE_MILLION`\n\n`fantiumPrimarySalesAddress` in `getPrimaryRevenueSplits()` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L600) may be zero. Consider setting it to a non-zero address in the contract's initializer so it is never zero.\n\n##### Recommendation\n\nIt is recommended to add all necessary checks.\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#2-insufficient-constraint-checks",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "DefaultOperatorFiltererUpgradeable initializer is not called",
        "content": "##### Description\n*FantiumNFTV1* class inherits *DefaultOperatorFiltererUpgradeable* but it's initializer is not called together with other base classes initializers in the `initialize()` method at https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L168.\nDue to this, the full functionality related to OperatorFilterRegistry becomes unavailable.\n##### Recommendation\nWe recommend adding the `DefaultOperatorFilterer_init()` call to *FantiumNFTV1* initializer.",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#3-defaultoperatorfiltererupgradeable-initializer-is-not-called",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unsafe Math",
        "content": "##### Description\n\nIn the project, unvalidated params with unsafe math are used. For example, it's dangerous logic (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L620):\n```\nunchecked {\n    // fantiumRevenue_ is always <=25, so guaranteed to never underflow\n    collectionFunds = _price - athleteRevenue_;\n}\n```\n\nIn this case, `collection.athletePrimarySalesPercentage`, `_price`, `_collectionId` are not validated fully.\n\n##### Recommendation\n\nWe recommend using only safe math for all operations in the project.\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#4-unsafe-math",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Use `transfer` instead of `call`",
        "content": "##### Description\n\nIf the project work with other contracts is not implied, then the `transfer` method is safer (this forwards 2300 gas).\n\n##### Recommendation\n\nWe recommend using `transfer` to avoid potential re-entrancy.\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#5-use-transfer-instead-of-call",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Broken `operatorFilterRegistry` may lead to DOS",
        "content": "##### Description\n\nIf the `operatorFilterRegistry` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/openseaFilterUpgradeable/OperatorFiltererUpgradeable.sol#L10) is broken and reverts on every transaction, then all transfers with `modifier onlyAllowedOperator` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/openseaFilterUpgradeable/OperatorFiltererUpgradeable.sol#L32) will be locked.\n\n##### Recommendation\n\nIt is recommended to allow the platform manager to update `operatorFilterRegistry` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/openseaFilterUpgradeable/OperatorFiltererUpgradeable.sol#L10).\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#6-broken-operatorfilterregistry-may-lead-to-dos",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Wrong conditions in `mint`",
        "content": "##### Description\n\nWrong conditions in `mint` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumMinterV1.sol#L200):\n```solidity\nif (\n    !hasRole(PLATFORM_MANAGER_ROLE, msg.sender) ||\n    !hasRole(DEFAULT_ADMIN_ROLE, msg.sender)\n) {\n    require(isAddressKYCed(msg.sender), \"Address not KYCed\");\n}\nIFantiumNFT.Collection memory collection = fantiumNFTContract\n    .getCollection(_collectionId);\n// sender must be on allow list or Admin or Manager \n// if the collection is paused\nif (\n    !hasRole(PLATFORM_MANAGER_ROLE, msg.sender) &&\n    !hasRole(DEFAULT_ADMIN_ROLE, msg.sender)\n) {\n    require(\n        !collection.paused ||\n            isAddressOnAllowList(_collectionId, msg.sender),\n        \"Purchases are paused and not on allow list\"\n    );\n}\n```\n\n##### Recommendation\n\nThe correct (but not the optimal) form is to use the \"&&\" operator:\n```solidity\nif (\n    !hasRole(PLATFORM_MANAGER_ROLE, msg.sender) &&\n    !hasRole(DEFAULT_ADMIN_ROLE, msg.sender)\n)\n```\n\n**But the best way would be to restrict privileges and disallow unnecessary access altogether:**\n```solidity\nrequire(isAddressKYCed(msg.sender), \"Address not KYCed\");\nIFantiumNFT.Collection memory collection = fantiumNFTContract\n    .getCollection(_collectionId);\n    \nrequire(!collection.paused, \"Purchases are paused\");\n```\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#7-wrong-conditions-in-mint",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Multiple issues when migrating to new fantiumNFTContractAddress",
        "content": "##### Description\nFantiumMinterV1 allows setting a new fantiumNFTContractAddress with updateFantiumNFTAddress(). It only changes the address stored but does not affect other scenarios.\n\n1) The new fantiumNFTContractAddress will have an empty `tokenId` and `collections` sold, allowing minting NFTs with the same `tokenId`.\n2) Mapping `collectionIdToAllowList` remains unchanged, thus the old allowlist for old collections will be active for new collections.\n3) Minting on the old contract will be frozen.\n\nWhen a new fantiumNFTContractAddress is set, it will be possible.\nWhen `FantiumMinterV1` changes its `fantiumNFTContractAddress`, its stored mapping `collectionIdToAllowList` remains unchanged. \n\n- https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumMinterV1.sol#L322-L329\n\n##### Recommendation\n\nThe general recommendation is to update code on scenarios of migration to the new FantiumNFTV1. We assume some possible steps are as follows:\n\n- store the allowlist at `FantiumNFTV1` only\n- remove migration functionality at all\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#8-multiple-issues-when-migrating-to-new-fantiumnftcontractaddress",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "maxInvocation limits in two contracts are not synchronized",
        "content": "##### Description\nFantiumMinterV1 imply that maxInvocation for collection is limited by 1 mln. But multiple setter functions in FantiumNFTV1 allow maxinvocation for collections being above 1 mln.\n\n- https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L346\n- https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L493-L505\n\n##### Recommendation\n\nFor every function that modifies `maxInvocation`, we recommend checking that it is limited by 1 mln.\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#9-maxinvocation-limits-in-two-contracts-are-not-synchronized",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Likely mistake in roles allowed to mint()",
        "content": "##### Description\nAt FantiumMinterV1 function mint() has the following lines:\n\n```\n// sender must be KYCed or Admin or Manager\n        if (\n            !hasRole(PLATFORM_MANAGER_ROLE, msg.sender) ||\n            !hasRole(DEFAULT_ADMIN_ROLE, msg.sender)\n        ) {\n            require(isAddressKYCed(msg.sender), \"Address not KYCed\");\n        }\n```\n\nmsg.sender is required to be KYCed, except for the case when it has both a PlatfromManager and DefaultManager role.\nBut the comment states that `sender must be KYCed or Admin or Manager`.\nThus, it is not expected in this function that it will revert in case when PlatformManager calls without the DefaultAdmin role (or DefaultAdmin without the PlatformManager role).\n\n- https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumMinterV1.sol#L210-L230\n\n##### Recommendation\n\nAs the expected behavior is likely written in the comments, we recommend changing `||` to `&&` in the line above. It will correlate with the following lines of code where the same requires checking with `&&`.\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#10-likely-mistake-in-roles-allowed-to-mint",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Frontrun can create alternative NFT markets when price goes up",
        "content": "##### Description\nFantiumNFTV1 allows upgrading the price of NFTs. When the price for a collection is set higher by calling updateCollectionPrice(), an attacker can front-run this price increase, buy many NFT tokens, and arrange secondary markets for these tokens. The price can be lower than the one set after updateCollectionPrice().\n\n##### Recommendation\n\nThe issue is hard to mitigate. One of the options is to introduce workflow when a caller pauses minting before calling updateCollectionPrice().\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#11-frontrun-can-create-alternative-nft-markets-when-price-goes-up",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Every `priceInWei` in collections requires updating after `updatePaymentToken`",
        "content": "##### Description\n\nIn commit https://github.com/metaxu-art/fantium-smart-contracts/commit/e79ed7dddabc482c56f7828bd9a8725fbbeca2f5 a new method will update the payment method (https://github.com/metaxu-art/fantium-smart-contracts/blob/e79ed7dddabc482c56f7828bd9a8725fbbeca2f5/contracts/FantiumNFTV1.sol#L717).\n```\nfunction updatePaymentToken(\n    address _address\n) external onlyRole(PLATFORM_MANAGER_ROLE) {\n    require(_address != address(0));\n    erc20PaymentToken = _address;\n}\n```\n\nTokens have different decimals, so after calling `updatePaymentToken` it will be necessary to update the price for each collection.\n\n##### Recommendation\n\nWe recommend updating `erc20PaymentToken` to check that the decimals have not changed. Otherwise, you will have to update each price as it corresponds to the previous token.\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#12-every-priceinwei-in-collections-requires-updating-after-updatepaymenttoken",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Use general safeTransferFrom",
        "content": "##### Description\n\nIn commit e79ed7dddabc482c56f7828bd9a8725fbbeca2f5, it is required to check the success of the transfer at the following lines:\n- https://github.com/metaxu-art/fantium-smart-contracts/blob/e79ed7dddabc482c56f7828bd9a8725fbbeca2f5/contracts/FantiumNFTV1.sol#L372\n- https://github.com/metaxu-art/fantium-smart-contracts/blob/e79ed7dddabc482c56f7828bd9a8725fbbeca2f5/contracts/FantiumNFTV1.sol#L380.\n\n##### Recommendation\n\nIt is recommended to always use the `safeTransferFrom()` function when sending tokens.\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#13-use-general-safetransferfrom",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Support additional EIPs",
        "content": "##### Description\n\nThe project uses `EIP2981`.  For example, `FantiumNFTV1` cannot support this EIP via the `supportsInterface` view method.\n\n```\n# In supportsInterface\ninterfaceId == type(IEIP2981).interfaceId\ninterfaceId == type(IEIP2981RoyaltyOverride).interfaceId\n```\n\n##### Recommendation\nWe recommend adding supported EIPs in the `supportsInterface` method if needed.\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#1-support-additional-eips",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No additional information via events",
        "content": "##### Description\n\nThese events do not contain all information about the update:\n- `PlatformUpdated` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L90)\n- `CollectionUpdated` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L86)\n\nAnd for method there is no event:\n- `updateTiers` https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L493\n\n##### Recommendation\nWe recommend adding more event info for user convenience.\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#2-no-additional-information-via-events",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Duplicate variables",
        "content": "##### Description\n\nThe FantiumMinterV1 variables `fantiumNFTContract` and `fantiumNFTContractAddress` duplicate each other.\n\n##### Recommendation\n\nIt is recommended to remove either `fantiumNFTContract` or `fantiumNFTContractAddress` to save gas.\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#3-duplicate-variables",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Duplicate assignments",
        "content": "##### Description\n\nThere are duplicate lines: \n* https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L281\n* https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L283\n\n##### Recommendation\nIt is recommended to remove one of the lines to save gas.\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#4-duplicate-assignments",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An athlete cannot update their address",
        "content": "##### Description\n\nAn athlete cannot update their address in `updateCollectionAthleteAddress()` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L308).\n\n##### Recommendation\n\nIt is recommended to check if this behavior is intended.\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#5-an-athlete-cannot-update-their-address",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Variables not used",
        "content": "##### Description\n\nThe FantiumNFTV1 contract does not use variables:\n\n- `KYC_Manager`\n- `FIELD_FANTIUM_PRIMARY_MARKET_ROYALTY_PERCENTAGE`\n- `tierSet`\n\nLines:\n\n- https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L37\n- https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L45\n- https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L33\n\n##### Recommendation\n\nWe recommend removing these variables.\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#6-variables-not-used",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "ERC-1155 multi-token standard is not used",
        "content": "##### Description\n\nERC-1155 is a smart contract interface that can represent and control any number of fungible and non-fungible token types. In this way, the ERC-1155 token can do the same functions as an [ERC-20](https://ethereum.org/en/developers/docs/standards/tokens/erc-20/) and [ERC-721](https://ethereum.org/en/developers/docs/standards/tokens/erc-721/) token, and even both at the same time. And best of all, improving the functionality of both standards, making it more efficient, and correcting obvious implementation errors on the ERC-20 and ERC-721 standards.\n\nThe ERC-1155 token is described fully in [EIP-1155](https://eips.ethereum.org/EIPS/eip-1155).\n\n\n##### Recommendation\n\nIt is recommended to take note of the [EIP-1155](https://eips.ethereum.org/EIPS/eip-1155) multi-token standard: it can be used for NFT collections.\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#7-erc-1155-multi-token-standard-is-not-used",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`operatorFilterRegistry` cannot be updated",
        "content": "##### Description\n\nThe `operatorFilterRegistry` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/openseaFilterUpgradeable/OperatorFiltererUpgradeable.sol#L10) constant cannot be updated:\n```solidity\nIOperatorFilterRegistry constant operatorFilterRegistry =\n    IOperatorFilterRegistry(0x000000000000AAeB6D7670E522A718067333cd4E);\n```\n\n##### Recommendation\n\nIt is recommended to set `operatorFilterRegistry` in the initializer or in the constructor and also add a method to update the variable. \n\nThe update method must allow setting the variable to zero: this allows replacing the `code.length` (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/openseaFilterUpgradeable/OperatorFiltererUpgradeable.sol#L34) check in the `onlyAllowedOperator` modifier to a zero address check.\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#8-operatorfilterregistry-cannot-be-updated",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unsynchronized roles in two contracts, likely not designed",
        "content": "##### Description\nTwo contracts share the same roles and likely expect them to be the same.\n`FantiumNFTV1` may expect that a function with modifiers onlyPlatformManager() and onlyAthlete() is allowed for the same `PLATFORM_MANAGER_ROLE`, as the `PLATFORM_MANAGER_ROLE` is allowed to mint NFT tokens - but this `PLATFORM_MANAGER_ROLE` is stored at FantiumMinterV1 and can be different.\n\n- https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumMinterV1.sol#L25-L28\n- https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L37-L40\n\n##### Recommendation\n\nIf roles are expected to have the same addresses on both contracts, it is recommended to consider one single storage for roles OR remove doubled roles OR implement different role namings.\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#9-unsynchronized-roles-in-two-contracts-likely-not-designed",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "NFT Pause is limited",
        "content": "##### Description\nThe FantiumNFTV1 pause for collections blocks only new mintings. In addition, the address at allowedList still can mint.\n\nTransfers remain allowed. So the scenario is possible when `toggleCollectionIsPaused()` is front run, and NFT can be traded on secondary markets as transfers are still allowed.\n\n- https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L323\n\n##### Recommendation\n\nConsider renaming the pause to `isMintAllowed` or add a transfer pausing if it is required by the pause design.\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#10-nft-pause-is-limited",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Tier information upgrading flow likely not designed",
        "content": "##### Description\nWe outline that updating Tiers in `tiers` with dedicated functions do not change tier information stored at Collections in `collections`.\n\nIn addition, collection parameters related to tiers can be easily changed and thus deviate from predefined Tier stores at `tiers`. \n\n- https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L493-L505\n\n##### Recommendation\n\nWe recommend either removing Tiers at all or removing allowance to modify Tier information in collections.\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#11-tier-information-upgrading-flow-likely-not-designed",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Current collectionIdToAllowList likely has practical limits",
        "content": "##### Description\n`allowList` is checked when `mint()` happens at `FantiumMinterV1`. It always sets false for an address (buyer). But if it is true, it allows only one mint for an address when a collection is paused. This behavior is strange and likely not to be designed.\n\n- https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumMinterV1.sol#L225-L266\n\n##### Recommendation\n\nWe recommend designing a more clear flow for `collectionIdToAllowList` and its behavior during pauses. By the way, we assume that the current `collectionIdToAllowList` behaves as designed and no code modification is needed.\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#12-current-collectionidtoallowlist-likely-has-practical-limits",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The addCollection() function can be made external",
        "content": "##### Description\nThe `addCollection()` function at (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L272) is defined as public. As the function is not used for calls from smart contracts, it can be made external to save gas.\n##### Recommendation\nWe recommend making the `addCollection()` function external.",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#13-the-addcollection-function-can-be-made-external",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The field baseURI might not be initialized",
        "content": "##### Description\nThe `tokenURI()` method uses the *baseURI* field at (https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L236) which is meant to be initialized by the `updateBaseURI()` method. It is not verified whether the method was called during the contract initialization. This can result in an incorrect output of URI address in case collectionURI was not initialized.\n##### Recommendation\nWe recommend checking whether the baseURI field was initialized before using it.",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#14-the-field-baseuri-might-not-be-initialized",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Redundant check for zero address in the mintTo() function",
        "content": "##### Description\n\nThe check is redundant as the check on the next line at https://github.com/metaxu-art/fantium-smart-contracts/blob/cb2d97bc30c40321991fe5ab8fc798babba1610f/contracts/FantiumNFTV1.sol#L208\n```\nrequire(fantiumMinterAddress != address(0), \"Fantium Minter not set\");\n```\n\n##### Recommendation\nWe recommend removing the redundant check to save gas.",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#15-redundant-check-for-zero-address-in-the-mintto-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "New allocation mechanics for `allowList` can be bypassed when allocation is updated",
        "content": "##### Description\n\nFix in commit https://github.com/metaxu-art/fantium-smart-contracts/commit/fdb089fa02c36560645f5ae7a3ab06d63f37ee1f introduced a new data type for `allowList`. Now it is a mapping storing the allocation for a user in a collection:\n`mapping(uint256 => mapping(address => uint256)) public collectionIdToAllowList`\n\nAllocation is the number of tokens allowed to the mint for an address. Also, two new functions set these allocations:\n`function addAddressToAllowListWithAllocation(uint256 _collectionId,address _address,uint256 _allocation`\n`function reduceAllowListAllocation(uint256 _collectionId,address _address,bool _completely)`\n\nThese two functions can be bypassed in some scenarios:\n1) `addAddressToAllowListWithAllocation()` is a setter that can be used to increase or decrease the allocation. When for example, the allocation is updated from 5 to 10, the address can front-run the update, buy 5 NFTs, wait for the update confirmation and buy an additional 10 NFTs as it is a newly updated allocation. Thus, the allocation update allows us to bypass of allocation limits and purchase additional NFTs.\n2) The same thing for `reduceAllowListAllocation()`. But it can only be exploited when `_completely` is used. The impact here is limited as the worst scenario allows purchasing the previous allocation before the update.\n\nIn addition, `reduceAllowListAllocation()` decreases the allocation by one point per call. For instance, it can be costly to decrease the allocation from 20 to 5.\n\n##### Recommendation\n\nWe recommend removing setters and implementing `increase`/`decrease` mechanics.\n\n1) it is better if `addAddressToAllowListWithAllocation` increments the allocations like:\n```\ncollectionIdToAllowList[_collectionId][_address] += _allocationAdded\n```\n\n2) it is better if `reduceAllowListAllocation` does the same thing when decreasing:\n\n```\ncollectionIdToAllowList[_collectionId][_address] -= _allocationReduced\n```\n",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#16-new-allocation-mechanics-for-allowlist-can-be-bypassed-when-allocation-is-updated",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Optimize gas",
        "content": "##### Description\n\nIn commit https://github.com/metaxu-art/fantium-smart-contracts/commit/e79ed7dddabc482c56f7828bd9a8725fbbeca2f5 the check is redundant:\n- https://github.com/metaxu-art/fantium-smart-contracts/blob/e79ed7dddabc482c56f7828bd9a8725fbbeca2f5/contracts/FantiumNFTV1.sol#L316\n\n```\nrequire(\n    IERC20(erc20PaymentToken).allowance(msg.sender, address(this)) >=\n        collection.priceInWei,\n    \"ERC20 allowance too low\"\n);\n```\n\nThis check is optional, `transferFrom` will revert if approval is absent.\n\n##### Recommendation\nWe recommend removing the redundant check to save gas.",
        "protocol": "Fantium",
        "report_date": "2023-01-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/README.md#17-optimize-gas",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Fantium/Fantium/Fantium%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possibility of the ownership transfer to an uncontrolled address",
        "content": "##### Description\nThe [transfer of the ownership](https://github.com/p2p-org/eth-staking-fee-distributor-contracts/blob/4bac8f636d7ba14244612bcfb9e85f338feba6e3/contracts/access/Ownable.sol#L47) can be performed to an arbitrary account whether or not it is controlled by the current authority.\nAfter the transfer to an uncontrolled account, the ownership will be lost.\n##### Recommendation\nWe recommend using a two-step ownership transfer procedure, including the confirmation (accept) of the ownership transfer.",
        "protocol": "P2P.org",
        "report_date": "2022-12-29",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/P2P.org/ETH2%20Depositor%20&%20ETH%20Staking%20Fee%20Distributor%20(v.1)/README.md#1-possibility-of-the-ownership-transfer-to-an-uncontrolled-address",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/P2P.org/ETH2%20Depositor%20&%20ETH%20Staking%20Fee%20Distributor%20(v.1)/P2P.org_ETH2%20Depositor%20&%20ETH%20Staking%20Fee%20Distributor%20Smart%20Contracts%20Audit%20Report.pdf"
    },
    {
        "title": "Ether stuck in the `FeeDistributor`",
        "content": "##### Description\nIf one of the fee receivers can't accept ether (i.e the transaction will revert or consume too much gas), no ether can be [withdrawn](https://github.com/p2p-org/eth-staking-fee-distributor-contracts/blob/4bac8f636d7ba14244612bcfb9e85f338feba6e3/contracts/feeDistributor/FeeDistributor.sol#L231).\nAlthough a new instance can be redeployed, some ether may stuck in the recent instance.\n##### Recommendation\nWe recommend implementing the functionality to migrate from a stuck `FeeDistributor` instance to a new one.",
        "protocol": "P2P.org",
        "report_date": "2022-12-29",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/P2P.org/ETH2%20Depositor%20&%20ETH%20Staking%20Fee%20Distributor%20(v.1)/README.md#2-ether-stuck-in-the-feedistributor",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/P2P.org/ETH2%20Depositor%20&%20ETH%20Staking%20Fee%20Distributor%20(v.1)/P2P.org_ETH2%20Depositor%20&%20ETH%20Staking%20Fee%20Distributor%20Smart%20Contracts%20Audit%20Report.pdf"
    },
    {
        "title": "The depositContract variable does not have the optimal type",
        "content": "##### Description\nThe `depositContract` variable is initialized only in the constructor and not changed any more. \nhttps://github.com/p2p-org/p2p-eth2-depositor/blob/main/src/P2pEth2Depositor.sol#L15\nThe current variable type (mutable) is designed for variables that are supposed to be changed during lifecycle. \nReading such variables consumes more gas than reading immutable variables.\n##### Recommendation\nWe recommend adding the immutable keyword to the `depositContract` variable.",
        "protocol": "P2P.org",
        "report_date": "2022-12-29",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/P2P.org/ETH2%20Depositor%20&%20ETH%20Staking%20Fee%20Distributor%20(v.1)/README.md#1-the-depositcontract-variable-does-not-have-the-optimal-type",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/P2P.org/ETH2%20Depositor%20&%20ETH%20Staking%20Fee%20Distributor%20(v.1)/P2P.org_ETH2%20Depositor%20&%20ETH%20Staking%20Fee%20Distributor%20Smart%20Contracts%20Audit%20Report.pdf"
    },
    {
        "title": "Unused ReentrancyGuard contract",
        "content": "##### Description\nAt line \nhttps://github.com/p2p-org/p2p-eth2-depositor/blob/9ad1803294a968e9bc4ce9a24e37b0f312a07d0e/src/P2pEth2Depositor.sol#L10\n`P2pEth2Depositor` inherits `ReentrancyGuard`, but the functions of this contract are not used.\nInheritance of unnecessary code generally increases the likelihood of vulnerabilities.\n##### Recommendation\nWe recommend removing the `ReentrancyGuard` inheritance.",
        "protocol": "P2P.org",
        "report_date": "2022-12-29",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/P2P.org/ETH2%20Depositor%20&%20ETH%20Staking%20Fee%20Distributor%20(v.1)/README.md#2-unused-reentrancyguard-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/P2P.org/ETH2%20Depositor%20&%20ETH%20Staking%20Fee%20Distributor%20(v.1)/P2P.org_ETH2%20Depositor%20&%20ETH%20Staking%20Fee%20Distributor%20Smart%20Contracts%20Audit%20Report.pdf"
    },
    {
        "title": "Excess transformation `IDepositContract` -> `address` -> `IDepositContract`",
        "content": "##### Description\nAt line \nhttps://github.com/p2p-org/p2p-eth2-depositor/blob/9ad1803294a968e9bc4ce9a24e37b0f312a07d0e/src/P2pEth2Depositor.sol#L83\nexcess transformation can be removed.\n\n***\n\n##### Recommendation\nIt is recommended to replace the line with \n```\n    depositContract.deposit{value: collateral}(\n                pubkeys[i],\n                withdrawal_credentials[i],\n                signatures[i],\n                deposit_data_roots[i]\n            );\n```",
        "protocol": "P2P.org",
        "report_date": "2022-12-29",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/P2P.org/ETH2%20Depositor%20&%20ETH%20Staking%20Fee%20Distributor%20(v.1)/README.md#3-excess-transformation-idepositcontract---address---idepositcontract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/P2P.org/ETH2%20Depositor%20&%20ETH%20Staking%20Fee%20Distributor%20(v.1)/P2P.org_ETH2%20Depositor%20&%20ETH%20Staking%20Fee%20Distributor%20Smart%20Contracts%20Audit%20Report.pdf"
    },
    {
        "title": "No null checks for recipient in s_referrerConfig",
        "content": "##### Description\nIf `recipient` in `s_referrerConfig` is a null address, then there is no need to calculate `referrerAmount`, because `referrerAmount` will always be 0.\nAlso, `referrerAmount` will be redundant for `serviceAmount`. Additionaly, we can bypass calling the `sendValue` with zero value and null address.\n\nhttps://github.com/p2p-org/eth-staking-fee-distributor-contracts/blob/4bac8f636d7ba14244612bcfb9e85f338feba6e3/contracts/feeDistributor/FeeDistributor.sol#L256  \nhttps://github.com/p2p-org/eth-staking-fee-distributor-contracts/blob/4bac8f636d7ba14244612bcfb9e85f338feba6e3/contracts/feeDistributor/FeeDistributor.sol#L244  \nhttps://github.com/p2p-org/eth-staking-fee-distributor-contracts/blob/4bac8f636d7ba14244612bcfb9e85f338feba6e3/contracts/feeDistributor/FeeDistributor.sol#L247  \n##### Recommendation\nWe recommend adding a null check for `recipient` in `s_referrerConfig` in the `withdraw` function and update logic for gas saving.",
        "protocol": "P2P.org",
        "report_date": "2022-12-29",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/P2P.org/ETH2%20Depositor%20&%20ETH%20Staking%20Fee%20Distributor%20(v.1)/README.md#4-no-null-checks-for-recipient-in-s_referrerconfig",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/P2P.org/ETH2%20Depositor%20&%20ETH%20Staking%20Fee%20Distributor%20(v.1)/P2P.org_ETH2%20Depositor%20&%20ETH%20Staking%20Fee%20Distributor%20Smart%20Contracts%20Audit%20Report.pdf"
    },
    {
        "title": "Extra inheritance",
        "content": "##### Description\nThe `OrderMixin` contract inherits the `NonceManager` contract, and the `PredicateHelper` contract inherits the `NonceManager` contract. You can remove the `NonceManager` contract from the `OrderMixin` inheritance chain because the `OrderMixin` contract inherits `PredicateHelper` and does not use the `NonceManager` contract code.\n\n***\n\n##### Recommendation\nWe recommend removing the `NonceManager` contract from inheritance for the `OrderMixin` contract.\n\n",
        "protocol": "1inch",
        "report_date": "2022-11-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V5/README.md#1-extra-inheritance",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V5/1inch%20Aggregation%20Router%20V5%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Spelling mistakes",
        "content": "##### Description\nSome texts have spelling mistakes:\n1) `SYBMOL` -> `SYMBOL` (bad input param)\n   https://github.com/1inch/solidity-utils/blob/eec6b523860af5215a8dd196fe3aff3a4d252fc9/contracts/libraries/UniERC20.sol#L62\n2) `signuture` -> `signature`\n   https://github.com/1inch/limit-order-protocol/blob/d8437885744543e3f057e84e1b0a05c4c211c553/contracts/OrderRFQMixin.sol#L98\n\n##### Recommendation\nWe recommend correcting them.\n\n",
        "protocol": "1inch",
        "report_date": "2022-11-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V5/README.md#2-spelling-mistakes",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V5/1inch%20Aggregation%20Router%20V5%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Null check",
        "content": "##### Description\nSome parameters have no null checks:\nhttps://github.com/1inch/1inch-contract/blob/8aa5ec4b4871b1d63bb045ddb78aaf7c5dc84dfa/contracts/AggregationRouterV5.sol#L22\n\n##### Recommendation\nWe recommend adding a null check for `clipperExchange`.\n\n",
        "protocol": "1inch",
        "report_date": "2022-11-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V5/README.md#3-null-check",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V5/1inch%20Aggregation%20Router%20V5%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Reduce gas cost",
        "content": "##### Description\nReduce gas cost for some functions:\nhttps://github.com/1inch/solidity-utils/blob/eec6b523860af5215a8dd196fe3aff3a4d252fc9/contracts/libraries/UniERC20.sol#L99\n\n##### Recommendation\nWe recommend adding `unchecked block` for `len++`.\n\n",
        "protocol": "1inch",
        "report_date": "2022-11-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V5/README.md#4-reduce-gas-cost",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V5/1inch%20Aggregation%20Router%20V5%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Using `camelCase` style for variables",
        "content": "##### Description\nVariable naming can be updated:\n- https://github.com/EnsoFinance/enso-weiroll/tree/9289118113f753d460a97d7c6ee72577e5c3f5eb/contracts/VM.sol#L43 `outdata` by `outData`\n- https://github.com/EnsoFinance/enso-weiroll/tree/9289118113f753d460a97d7c6ee72577e5c3f5eb/contracts/VM.sol#L99 `calleth` by `callEth`\n- https://github.com/EnsoFinance/enso-weiroll/tree/9289118113f753d460a97d7c6ee72577e5c3f5eb/contracts/CommandBuilder.sol#L35 `arglen` by `argLen`\n- https://github.com/EnsoFinance/enso-weiroll/tree/9289118113f753d460a97d7c6ee72577e5c3f5eb/contracts/CommandBuilder.sol#L92 `statevar` by `stateVar`\n- https://github.com/EnsoFinance/enso-weiroll/tree/9289118113f753d460a97d7c6ee72577e5c3f5eb/contracts/CommandBuilder.sol#L119 `argptr` by `argPtr`\n- https://github.com/EnsoFinance/enso-weiroll/tree/9289118113f753d460a97d7c6ee72577e5c3f5eb/contracts/CommandBuilder.sol#L169 `srcidx` by `srcIdx`\n- https://github.com/EnsoFinance/enso-weiroll/tree/9289118113f753d460a97d7c6ee72577e5c3f5eb/contracts/CommandBuilder.sol#L171 `destidx` by `destIdx`\n##### Recommendation\nWe recommend updating the variable naming in favour of code style improvement.\n\n",
        "protocol": "Enso Finance",
        "report_date": "2022-10-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Weiroll/README.md#1-using-camelcase-style-for-variables",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Weiroll/Weiroll%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unused variables",
        "content": "##### Description\nhttps://github.com/EnsoFinance/enso-weiroll/tree/9289118113f753d460a97d7c6ee72577e5c3f5eb/contracts/VM.sol#L22\n##### Recommendation\nWe recommend removing it or describing its functionality.\n",
        "protocol": "Enso Finance",
        "report_date": "2022-10-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Weiroll/README.md#2-unused-variables",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Weiroll/Weiroll%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Merge unchecked blocks",
        "content": "##### Description\nSome `unchecked` blocks can be merged:\n- https://github.com/EnsoFinance/enso-weiroll/tree/9289118113f753d460a97d7c6ee72577e5c3f5eb/contracts/CommandBuilder.sol#L49\n- https://github.com/EnsoFinance/enso-weiroll/tree/9289118113f753d460a97d7c6ee72577e5c3f5eb/contracts/CommandBuilder.sol#L97\n##### Recommendation\nWe recommend merging it in favour of the code readability.\n",
        "protocol": "Enso Finance",
        "report_date": "2022-10-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Weiroll/README.md#3-merge-unchecked-blocks",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Weiroll/Weiroll%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Compiler version (gas saving)",
        "content": "##### Description\nIn solidity code and config specified compiler version `0.8.11`, more modern compiler version can improve gas optimization.\n##### Recommendation\nWe recommend updating it to `0.8.16` for gas saving.\n\n\n",
        "protocol": "Enso Finance",
        "report_date": "2022-10-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Weiroll/README.md#4-compiler-version-gas-saving",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Enso%20Finance/Weiroll/Weiroll%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Set credit limit by pausing the guardian",
        "content": "##### Description\nPausing the guardian can set a new credit limit for users with the credit limit.\nhttps://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/Comptroller.sol#L1313\n##### Recommendation\nWe recommend updating the checks in the \"_setCreditLimit\" function.\n\n",
        "protocol": "Iron Bank",
        "report_date": "2022-09-05",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Iron%20Bank/README.md#1-set-credit-limit-by-pausing-the-guardian",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Iron%20Bank/IronBank%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Exchange rate vulnerability",
        "content": "##### Description\nAn exchange rate bug for new pools and empty pools (without borrowers and suppliers) for CToken contracts without the 'internalCash' variable.\nFlow:\n1. Create cToken\n2. Mint cToken by user1 (1,000,000)\n3. Redeem cToken by user1 (999,999.999999)\n4. Transfer underlying (1,000,000) from user1 to market\n5. Mint cToken by user2 (1,000,000)\n6. Redeem cToken by user1 (user1 receive extra tokens)\n\n##### Recommendation\nWe recommend checking the exchange rate before the first mint or using the 'internalCash' value for all CToken contracts.",
        "protocol": "Iron Bank",
        "report_date": "2022-09-05",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Iron%20Bank/README.md#2-exchange-rate-vulnerability",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Iron%20Bank/IronBank%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Interest rate model update impacts the old time period",
        "content": "##### Description\nAfter an admin changes the interest rate model parameters by using this function\nhttps://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/TripleSlopeRateModel.sol#L100\nindexes will be recalculated in the upcoming accrueInterest() function call. But this call applies new interest settings to the previous period of time which is not correct.\n##### Recommendation\nThe interest rate model parameters should be changed just after calling the accrueInterest() function for each asset. It can be done by creating a special service contract.\n\n",
        "protocol": "Iron Bank",
        "report_date": "2022-09-05",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Iron%20Bank/README.md#3-interest-rate-model-update-impacts-the-old-time-period",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Iron%20Bank/IronBank%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "A flashloan will be broken if the USDT fee is more than zero",
        "content": "##### Description\nLet's take a look at the flashloan flow. After doTransferOut a receiver gets `amount - fee`.\nhttps://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CCollateralCapErc20.sol#L217\n\nThen a receiver's `onFlashLoan` function will be called with an incorrect amount. \nhttps://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CCollateralCapErc20.sol#L224\n\nThen doTransferIn will transfer the repayment amount but the contract will receive the repayment `amount - fee`\nhttps://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CCollateralCapErc20.sol#L231 and the`require` check will cause a revert. \nhttps://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CCollateralCapErc20.sol#L235\n\n##### Recommendation\nThe flashloan() function should be rewritten taking into consideration the USDT fee value.\n",
        "protocol": "Iron Bank",
        "report_date": "2022-09-05",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Iron%20Bank/README.md#4-a-flashloan-will-be-broken-if-the-usdt-fee-is-more-than-zero",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Iron%20Bank/IronBank%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Undesired repay and/or liquidation of ex-credit account",
        "content": "##### Description\nIn the IronBank, the `credit` functionality is introduced. An admin can trigger the [`setCreditLimit`](https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/Comptroller.sol#L1302) function to mark some addresses like `credit` for specific `cToken` and set its `credit limit`. Such addresses can borrow a limited by `credit limit` amount of `cToken` without providing any collateral. Additionally, `setCreditLimit` can mark that an address is no longer `credit` and has become an ordinary account that requires collateral.\n\nUnfortunately, after becoming an ordinary account, the ex-credit account will be subject to repay and/or liquidation of its borrowed debt.\n\n##### Recommendation\nAlthough an attack is hard to implement since the `setCreditLimit` function is restricted to the admin, we recommend to disallow changing the state from the credit account to an ordinary account, e.g. by disallowing setting the credit limit less than the currently borrowed amount.\n\n",
        "protocol": "Iron Bank",
        "report_date": "2022-09-05",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Iron%20Bank/README.md#5-undesired-repay-andor-liquidation-of-ex-credit-account",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Iron%20Bank/IronBank%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Typos in descriptions",
        "content": "##### Description\nSeveral typos:\n1. 'occured' instead of 'occurred'\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CTokenInterfaces.sol#L366\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CTokenInterfaces.sol#L412\n2. 'fucntions' instead of 'functions'\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/PriceOracle/PriceOracleProxy.sol#L160\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/PriceOracle/PriceOracleProxyIB.sol#L96\n3. 'supplys' instead of 'supplies'\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/Comptroller.sol#L1144\n4. 'currenlty' instead of 'currently'\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/PriceOracle/PriceOracleProxy.sol#L189\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/PriceOracle/PriceOracleProxyIB.sol#L101\n5. 'settor' instead of 'setter'\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CErc20Delegator.sol#L54\n6. 'accuring' instead of 'accruing'\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CCollateralCapErc20.sol#L556\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CCollateralCapErc20.sol#L595\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CCollateralCapErc20CheckRepay.sol#L557\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CCollateralCapErc20CheckRepay.sol#L596\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CCollateralCapErc20NoInterest.sol#L557\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CCollateralCapErc20NoInterest.sol#L596\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CErc20.sol#L300\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CErc20.sol#L405\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CErc20.sol#L475\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CWrappedNative.sol#L659\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CWrappedNative.sol#L729\n7. 'sieze' instead of 'seize'\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/Comptroller.sol#L595\n8. 'depreacted' instead of 'deprecated'\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/ComptrollerStorage.sol#L100\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/ComptrollerStorage.sol#L104\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/ComptrollerStorage.sol#L108\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/ComptrollerStorage.sol#L112\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/ComptrollerStorage.sol#L116\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/ComptrollerStorage.sol#L120\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/ComptrollerStorage.sol#L136\n9. 'undelrying' instead of 'underlying'\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CToken.sol#L540\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CTokenCheckRepay.sol#L540\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CTokenNoInterest.sol#L569\n10. 'tather' instead of 'rather'\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CToken.sol#L1040\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/CTokenCheckRepay.sol#L1059\n11. 'amnount' instead of 'amount'\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/InterestRateModel.sol#L15\n   https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/InterestRateModel.sol#L28\n\n##### Recommendation\nWe recommend correcting them.\n\n",
        "protocol": "Iron Bank",
        "report_date": "2022-09-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Iron%20Bank/README.md#1-typos-in-descriptions",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Iron%20Bank/IronBank%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No null checks for input addresses",
        "content": "##### Description\nSome code lacks a check for null address:\nadmin: https://github.com/ibdotxyz/compound-protocol/blob/8cd45803b48552e344e22be280c9e1c03ec8644a/contracts/PriceOracle/PriceOracleProxyIB.sol#L157\n\n##### Recommendation\nWe recommend adding null checks.\n\n",
        "protocol": "Iron Bank",
        "report_date": "2022-09-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Iron%20Bank/README.md#2-no-null-checks-for-input-addresses",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Iron%20Bank/IronBank%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "It is possible to vote during the objection time if the proposal was rejected",
        "content": "##### Description\nAt line https://github.com/lidofinance/aragon-apps/blob/7e5cd1961697a1bc514bfebdeab08a296e51d700/apps/voting/contracts/Voting.sol#L192 during the objection time, the `vote()` function checks if the vote is `no`, if the vote is open for objection and if the voter has balance. But there is no check wether the vote was rejected or not. So it is possible to vote `no` for a proposal even if it was rejected during the voting time.\n\n##### Recommendation\nIt is recommended to add a check if the vote was rejected.\n",
        "protocol": "Lido",
        "report_date": "2022-06-20",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Two-Phase%20Voting/README.md#1-it-is-possible-to-vote-during-the-objection-time-if-the-proposal-was-rejected",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Two-Phase%20Voting/Lido%20Two-Phase%20Voting%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Using unsuitable visibility modifier",
        "content": "##### Description\nThe visibility of the `canObject()` function at  line https://github.com/lidofinance/aragon-apps/blob/7e5cd1961697a1bc514bfebdeab08a296e51d700/apps/voting/contracts/Voting.sol#L267 which is not called internally from the same contract should be changed to `external` to save gas.\n\n##### Recommendation\nIt is recommended to change `public` to `external`.\n",
        "protocol": "Lido",
        "report_date": "2022-06-20",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Two-Phase%20Voting/README.md#1-using-unsuitable-visibility-modifier",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Two-Phase%20Voting/Lido%20Two-Phase%20Voting%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The vote is open for objection during the main voting time",
        "content": "##### Description\nAt line https://github.com/lidofinance/aragon-apps/blob/7e5cd1961697a1bc514bfebdeab08a296e51d700/apps/voting/contracts/Voting.sol#L475\nthe `_isVoteOpenForObjection()` function returns `true` during the main voting time. It can be potentially misleading in functions `canObject()` and `getVote()` at the following lines:\n- https://github.com/lidofinance/aragon-apps/blob/7e5cd1961697a1bc514bfebdeab08a296e51d700/apps/voting/contracts/Voting.sol#L267\n- https://github.com/lidofinance/aragon-apps/blob/7e5cd1961697a1bc514bfebdeab08a296e51d700/apps/voting/contracts/Voting.sol#L316.\n\n##### Recommendation\nIt is recommended to change the  `_isVoteOpenForObjection()` function to return `true` only during the objection time or to rename the function to better indicate its purpose.\n",
        "protocol": "Lido",
        "report_date": "2022-06-20",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Two-Phase%20Voting/README.md#2-the-vote-is-open-for-objection-during-the-main-voting-time",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Two-Phase%20Voting/Lido%20Two-Phase%20Voting%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Double check of the `_supports` variable",
        "content": "##### Description\nAt line https://github.com/lidofinance/aragon-apps/blob/7e5cd1961697a1bc514bfebdeab08a296e51d700/apps/voting/contracts/Voting.sol#L374-L380 there is a double check of variable `_supports`.\n\nThe assignment at line https://github.com/lidofinance/aragon-apps/blob/7e5cd1961697a1bc514bfebdeab08a296e51d700/apps/voting/contracts/Voting.sol#L380 can be moved inside the if-else statement to save gas. Additionally, the if-else statement is more readable than a ternary operator.\n\n##### Recommendation\nIt is recommended to change to:\n```solidity\nif (_supports) {\n    vote_.yea = vote_.yea.add(voterStake);\n    vote_.voters[_voter] = VoterState.Yea;\n} else {\n    vote_.nay = vote_.nay.add(voterStake);\n    vote_.voters[_voter] = VoterState.Nay;\n}\n```\n",
        "protocol": "Lido",
        "report_date": "2022-06-20",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Two-Phase%20Voting/README.md#3-double-check-of-the-_supports-variable",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Two-Phase%20Voting/Lido%20Two-Phase%20Voting%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary check",
        "content": "##### Description\nAt line https://github.com/lidofinance/aragon-apps/blob/7e5cd1961697a1bc514bfebdeab08a296e51d700/apps/voting/contracts/Voting.sol#L423 the check is unnecessary since the check at line https://github.com/lidofinance/aragon-apps/blob/7e5cd1961697a1bc514bfebdeab08a296e51d700/apps/voting/contracts/Voting.sol#L428 returns `true` if the vote is open during the voting time. The vote cannot be executed until the end of the objection time.\n\n##### Recommendation\nRemove this check or refactor the `_isVoteOpen()` and `_isVoteOpenForObjection()` logic.\n",
        "protocol": "Lido",
        "report_date": "2022-06-20",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Two-Phase%20Voting/README.md#4-unnecessary-check",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Two-Phase%20Voting/Lido%20Two-Phase%20Voting%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Gas optimization using `vote_.yea`",
        "content": "##### Description\nAt line https://github.com/lidofinance/aragon-apps/blob/7e5cd1961697a1bc514bfebdeab08a296e51d700/apps/voting/contracts/Voting.sol#L433-L440 it is possible to save gas by reading `vote_.yea` into a memory variable.\n\n##### Recommendation\nFor example:\n```solidity\nuint256 voteYea = vote_.yea;\nuint256 totalVotes = voteYea.add(vote_.nay);\nif (!_isValuePct(voteYea, totalVotes, vote_.supportRequiredPct)) {\n    return false;\n}\n// Has min quorum?\nif (!_isValuePct(voteYea, vote_.votingPower, vote_.minAcceptQuorumPct)) {\n    return false;\n}\n```\n",
        "protocol": "Lido",
        "report_date": "2022-06-20",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Two-Phase%20Voting/README.md#5-gas-optimization-using-vote_yea",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Two-Phase%20Voting/Lido%20Two-Phase%20Voting%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "A malicious voter can potentially block a vote",
        "content": "##### Description\nAt line https://github.com/lidofinance/aragon-apps/blob/7e5cd1961697a1bc514bfebdeab08a296e51d700/apps/voting/contracts/Voting.sol#L368 a voter can change their vote.\nThe malicious voter can initially vote `yes` misleading other users about their intention, then change their vote to `no` at the last moment potentially blocking the proposal.\n\n##### Recommendation\nIt is recommended to check to prevent the last-minute `no` attacks against proposals.\n",
        "protocol": "Lido",
        "report_date": "2022-06-20",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Two-Phase%20Voting/README.md#6-a-malicious-voter-can-potentially-block-a-vote",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Two-Phase%20Voting/Lido%20Two-Phase%20Voting%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Confusing naming can lead to vulnerabilities in the future code edits",
        "content": "##### Description\n\nA voting passes two stages: \n1. Vote is open for yeas and nays\n2. Vote is open for nays only\n\nTo check for those stages these methods are used:\n1. `_isVoteOpen`, `_canVote`, `canVote`\n2. `_isVoteOpenForObjection`, `_canObject`, `canObject`\n\nNamings to check that the voting is in the first stage are confusing, because name `_isVoteOpen` doesn't clearly say that it is checking the first stage only and for the second stage of voting it will return `false`. The same thing refers to `canVote()` and `_canVote()`. Their names suggest that they should return `true` for any unfinished voting, while they return `true` only if the voting is in the first stage.\n\nThis confusion may lead to bugs in the future if the contract code base becomes larger and it will become harder to keep in mind that the behavior of some methods differs from what their name seems to imply.\n\nThere are already cases of the incorrect use of methods in the code:\nhttps://github.com/lidofinance/aragon-apps/blob/7e5cd1961697a1bc514bfebdeab08a296e51d700/apps/voting/contracts/Voting.sol#L384\n```solidity\nfunction _vote(uint256 _voteId, bool _supports, address _voter) internal {\n  ...\n  if (!_isVoteOpen(vote_)) { // objection phase\n  ...\n  emit CastObjection(_voteId, _voter, voterStake);\n}\n```\nIt is obvious that instead of `!_isVoteOpen(vote_)` you should use `_isVoteOpenForObjection(vote_)`. It is not a vulnerability now because in the current context these two lines are interchangeble.\n\nHowever, if in the future the development team decides to add another voting phase, they will have to find and fix all the lines with the incorrect use of methods and if the code base becomes large and the namings would be still confusing it will be easy to miss some line and create a vulnerability.\n\n\n##### Recommendation\n\nChange method names to be more clear about what they really do. For example, instead of `_isVoteOpen` you could use `_isVoteOpenFirstStage`. And instead of `_canVote` you could use `_canVoteFirstStage`.\n\nThe `canVote` method is a public method so it may be better to keep its name for API compatibility. But perhabs it should be marked as deprecated in the code comments and another,`canVoteFirstStage` method should be added.\n",
        "protocol": "Lido",
        "report_date": "2022-06-20",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Two-Phase%20Voting/README.md#7-confusing-naming-can-lead-to-vulnerabilities-in-the-future-code-edits",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Two-Phase%20Voting/Lido%20Two-Phase%20Voting%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Missed NatSpec parameters descriptions for public methods",
        "content": "##### Description\nhttps://github.com/lidofinance/aragon-apps/blob/7e5cd1961697a1bc514bfebdeab08a296e51d700/apps/voting/contracts/Voting.sol#L234\nhttps://github.com/lidofinance/aragon-apps/blob/7e5cd1961697a1bc514bfebdeab08a296e51d700/apps/voting/contracts/Voting.sol#L247\nhttps://github.com/lidofinance/aragon-apps/blob/7e5cd1961697a1bc514bfebdeab08a296e51d700/apps/voting/contracts/Voting.sol#L257\nhttps://github.com/lidofinance/aragon-apps/blob/7e5cd1961697a1bc514bfebdeab08a296e51d700/apps/voting/contracts/Voting.sol#L267\nhttps://github.com/lidofinance/aragon-apps/blob/7e5cd1961697a1bc514bfebdeab08a296e51d700/apps/voting/contracts/Voting.sol#L324\n\n##### Recommendation\nWe recommend adding descriptions for the mentioned public methods parameters.\n",
        "protocol": "Lido",
        "report_date": "2022-06-20",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Two-Phase%20Voting/README.md#8-missed-natspec-parameters-descriptions-for-public-methods",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Two-Phase%20Voting/Lido%20Two-Phase%20Voting%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The \"last-minute\" vote problem still persists for vote objection",
        "content": "##### Description\nThe problem with the \"last-minute\" vote in this scheme is not fully mitigated, because a possibility of a vote to be denied at the last moment still persists. An attacker can object and deny the voting at the last moment like it could be done with the previous version of voting.\n\n##### Recommendation\nShould be simply acknowledged by the Lido team.\n",
        "protocol": "Lido",
        "report_date": "2022-06-20",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Two-Phase%20Voting/README.md#9-the-last-minute-vote-problem-still-persists-for-vote-objection",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Two-Phase%20Voting/Lido%20Two-Phase%20Voting%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Reward tokens may be frozen in `FarmingPool`",
        "content": "##### Description\nhttps://github.com/1inch/farming/blob/7a007ec7784cca2899889e99e46cf06d5788a7d9/contracts/accounting/FarmAccounting.sol#L19\nFarmed tokens amount is calculated when a farm duration > 0, so if the distributor starts farming with duration 0, nobody will farm and, starting the next farming, won't save prev farming rewards because a contract accounts only unfinished prev farming, but in this case the farming with duration 0 finishes immediately.\nhttps://github.com/1inch/farming/blob/7a007ec7784cca2899889e99e46cf06d5788a7d9/contracts/accounting/FarmAccounting.sol#L28\n##### Recommendation\nWe recommend not to allow farming with 0 duration.\n\n***\n",
        "protocol": "1inch",
        "report_date": "2022-06-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Farming/README.md#1-reward-tokens-may-be-frozen-in-farmingpool",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Farming/1Inch%20Farming%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Actual transferred amount may differ than expected",
        "content": "##### Description\nSome ERC20 tokens, for example, USDT, have fees on transfer. It may affect reward accounting on farming, a farm contract may receive fewer tokens than expected and start farming with an expected amount of rewards, which will lead to insufficiency of liquidity for rewards. Also in the`FarmingPool` contract the `deposit` and `withdraw` functions may work incorrectly. \nhttps://github.com/1inch/farming/blob/7a007ec7784cca2899889e99e46cf06d5788a7d9/contracts/Farm.sol#L41-L43, \nhttps://github.com/1inch/farming/blob/7a007ec7784cca2899889e99e46cf06d5788a7d9/contracts/FarmingPool.sol#L48-L50\n##### Recommendation\nWe recommend starting farming/deposit in `FarmingPool`/withdraw in `FarmingPool` with the actual transferred amount and return an actual deposited/withdrawn/claimed amount.\n",
        "protocol": "1inch",
        "report_date": "2022-06-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Farming/README.md#2-actual-transferred-amount-may-differ-than-expected",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Farming/1Inch%20Farming%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Rebasable as reward tokens breaks logic",
        "content": "##### Description\nWith rebasable reward tokens, the calculation of farmed rewards will be incorrect because it relies on a strict amount of distributed tokens while the underlying reward balance will float. \nhttps://github.com/1inch/farming/blob/7a007ec7784cca2899889e99e46cf06d5788a7d9/contracts/accounting/FarmAccounting.sol#L21\n##### Recommendation\nWe recommend warning developers not to use rebasable tokens as reward tokens.\n",
        "protocol": "1inch",
        "report_date": "2022-06-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Farming/README.md#3-rebasable-as-reward-tokens-breaks-logic",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Farming/1Inch%20Farming%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible arithmetic overflow",
        "content": "##### Description\nAt the line https://github.com/1inch/farming/blob/7a007ec7784cca2899889e99e46cf06d5788a7d9/contracts/accounting/UserAccounting.sol#L29 the number with the type `int256` is converted to the number with the type `uint256`. The number is taken with a minus sign.\nBut before that, there is no check that the number is less than 0.\nIf we take a small positive value and apply the transformation `uint256(-amount)` to it, we get a very large value due to arithmetic overflow.\nFor example, if you take number `1000`, then after conversion you get value` 115792089237316195423570985008687907853269984665640564039457584007913129638936`.\n\n##### Recommendation\nBefore line 29 you need to check if the value of the variable is not less than 0.\n If the value of the variable is positive, then do not do the conversion.\n\n",
        "protocol": "1inch",
        "report_date": "2022-06-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Farming/README.md#1-possible-arithmetic-overflow",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Farming/1Inch%20Farming%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Gas overflow during iteration (DoS)",
        "content": "##### Description\nEach iteration of the cycle requires a gas flow.\nA moment may come when more gas is required than it is allocated to record one block. In this case, all iterations of the loop will fail.\nAffected lines:\n- https://github.com/1inch/farming/blob/7a007ec7784cca2899889e99e46cf06d5788a7d9/contracts/ERC20Farmable.sol#L70\n- https://github.com/1inch/farming/blob/7a007ec7784cca2899889e99e46cf06d5788a7d9/contracts/ERC20Farmable.sol#L117\n- https://github.com/1inch/farming/blob/7a007ec7784cca2899889e99e46cf06d5788a7d9/contracts/ERC20Farmable.sol#L121\n- https://github.com/1inch/farming/blob/7a007ec7784cca2899889e99e46cf06d5788a7d9/contracts/ERC20Farmable.sol#L137\n##### Recommendation\nIt is recommended to add a check for the maximum possible number of elements of the arrays.\n\n***\n",
        "protocol": "1inch",
        "report_date": "2022-06-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Farming/README.md#2-gas-overflow-during-iteration-dos",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Farming/1Inch%20Farming%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Zero Token",
        "content": "##### Description\nThere is no address checking for tokens params in constructor:\nhttps://github.com/1inch/farming/blob/7a007ec7784cca2899889e99e46cf06d5788a7d9/contracts/FarmingPool.sol#L35-L36\n##### Recommendation\nIt is recommended to add a check for non-zero address.\n\n***\n",
        "protocol": "1inch",
        "report_date": "2022-06-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Farming/README.md#3-zero-token",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Farming/1Inch%20Farming%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Using \"magic\" numbers",
        "content": "##### Description\nThe use in the source code of some unknown where taken values impairs its understanding.\nAt the lines\n- https://github.com/1inch/farming/blob/7a007ec7784cca2899889e99e46cf06d5788a7d9/contracts/accounting/FarmAccounting.sol#L21\n- https://github.com/1inch/farming/blob/7a007ec7784cca2899889e99e46cf06d5788a7d9/contracts/accounting/FarmAccounting.sol#L29\n- https://github.com/1inch/farming/blob/7a007ec7784cca2899889e99e46cf06d5788a7d9/contracts/accounting/UserAccounting.sol#L29\nthe value is `1e18`.\n##### Recommendation\nIt is recommended that you create constants with meaningful names to use numeric values.\n\n***\n",
        "protocol": "1inch",
        "report_date": "2022-06-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Farming/README.md#1-using-magic-numbers",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Farming/1Inch%20Farming%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "It is possible to block tokens on the balance of the contract",
        "content": "##### Description\nAt the line https://github.com/1inch/farming/blob/7a007ec7784cca2899889e99e46cf06d5788a7d9/contracts/FarmingPool.sol#L48 `rewardsToken` is transferred to the balance of the contract.\nBut there is no functionality to return tokens in case of an emergency or if not all users call the `claim()` function.\n##### Recommendation\nIt is necessary to add functionality for the possibility of withdrawing the remaining tokens from the balance of the contract.\n\n***\n",
        "protocol": "1inch",
        "report_date": "2022-06-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Farming/README.md#2-it-is-possible-to-block-tokens-on-the-balance-of-the-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Farming/1Inch%20Farming%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Missed events",
        "content": "##### Description\nThere are missed events for claim, deposit, withdraw, join/quit farming.\nhttps://github.com/1inch/farming/blob/7a007ec7784cca2899889e99e46cf06d5788a7d9/contracts/FarmingPool.sol#L66\nhttps://github.com/1inch/farming/blob/7a007ec7784cca2899889e99e46cf06d5788a7d9/contracts/FarmingPool.sol#L72\nhttps://github.com/1inch/farming/blob/7a007ec7784cca2899889e99e46cf06d5788a7d9/contracts/FarmingPool.sol#L78\nhttps://github.com/1inch/farming/blob/7a007ec7784cca2899889e99e46cf06d5788a7d9/contracts/ERC20Farmable.sol#L58\nhttps://github.com/1inch/farming/blob/7a007ec7784cca2899889e99e46cf06d5788a7d9/contracts/ERC20Farmable.sol#L75\nhttps://github.com/1inch/farming/blob/7a007ec7784cca2899889e99e46cf06d5788a7d9/contracts/ERC20Farmable.sol#L93\n##### Recommendation\nWe recommend emitting the events above.\n\n***\n",
        "protocol": "1inch",
        "report_date": "2022-06-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Farming/README.md#3-missed-events",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Farming/1Inch%20Farming%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Opportunity to add bufferedETH without submitting to LIDO",
        "content": "##### Description\nIt is possible to send ETH to the `LidoMevTxFeeVault` contract and when the oracle reports contract sends ETH to LIDO, which will be used to rewards, it may fluctuate the price of lido shares.\nhttps://github.com/lidofinance/lido-dao/blob/801d3e854efb33ff33a59fe51187e187047a6be2/contracts/0.8.9/LidoMevTxFeeVault.sol#L79\n##### Recommendation\nWe recommend that the `LidoMevTxFreeVault` contract should receive ETH only from authorized addresses or the `withdrawRewards()` function should have limits.\n",
        "protocol": "Lido",
        "report_date": "2022-05-24",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/README.md#1-opportunity-to-add-bufferedeth-without-submitting-to-lido",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/Lido%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Extra function",
        "content": "##### Description\nAt lines\nhttps://github.com/lidofinance/lido-dao/blob/801d3e854efb33ff33a59fe51187e187047a6be2/contracts/0.4.24/Lido.sol#L139-L142\nand at lines\nhttps://github.com/lidofinance/lido-dao/blob/801d3e854efb33ff33a59fe51187e187047a6be2/contracts/0.4.24/Lido.sol#L158-L165\nsimilar actions are performed.\nBut in one case there is a change in the `TOTAL_MEV_TX_FEE_COLLECTED_POSITION` variable, and in the other case there is none.\nOne of these functions is redundant.\n##### Recommendation\nNeed to remove the redundant feature.",
        "protocol": "Lido",
        "report_date": "2022-05-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/README.md#1-extra-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/Lido%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No validation of the address parameter value in the contract constructor",
        "content": "##### Description\nThe variable is assigned the value of the constructor input parameter. But this parameter is not checked before this. If the value turns out to be zero, then it will be necessary to redeploy the contract, since there is no other functionality to set this variable.\nAt line \nhttps://github.com/lidofinance/lido-dao/blob/801d3e854efb33ff33a59fe51187e187047a6be2/contracts/0.8.9/LidoMevTxFeeVault.sol#L72 \nthe `TREASURY` variable is set to the value of the `_treasury` input parameter.\n##### Recommendation\nIt is necessary to add a check of the input parameter to zero before initializing the variable.",
        "protocol": "Lido",
        "report_date": "2022-05-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/README.md#2-no-validation-of-the-address-parameter-value-in-the-contract-constructor",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/Lido%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Max oracle members amount is actually lower",
        "content": "##### Description\nMax members are 255 instead of 256 which may affect the quorum:\nhttps://github.com/lidofinance/lido-dao/blob/801d3e854efb33ff33a59fe51187e187047a6be2/contracts/0.4.24/oracle/LidoOracle.sol#L432\n##### Recommendation\nThe check needs to be corrected.",
        "protocol": "Lido",
        "report_date": "2022-05-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/README.md#3-max-oracle-members-amount-is-actually-lower",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/Lido%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "There is no recovery option for ERC721",
        "content": "##### Description\nThe `transferToVault()` function doesn't support ERC721 tokens: \nhttps://github.com/lidofinance/lido-dao/blob/801d3e854efb33ff33a59fe51187e187047a6be2/contracts/0.4.24/Lido.sol#L356\n##### Recommendation\nIt is necessary to add another function to recover ERC721.",
        "protocol": "Lido",
        "report_date": "2022-05-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/README.md#4-there-is-no-recovery-option-for-erc721",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/Lido%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect event",
        "content": "##### Description\nIn case of cover, `stETH` doesn't burn \nhttps://github.com/lidofinance/lido-dao/blob/801d3e854efb33ff33a59fe51187e187047a6be2/contracts/0.4.24/StETH.sol#L461\n##### Recommendation\nIt is necessary to exclude the `stETH` amount from the event.",
        "protocol": "Lido",
        "report_date": "2022-05-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/README.md#5-incorrect-event",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/Lido%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "There is no recovery for excess `stETH`",
        "content": "##### Description\nIt is possible to transfer `stETH` to `wstETH` so it will be frozen in the contract. \nhttps://github.com/lidofinance/lido-dao/blob/801d3e854efb33ff33a59fe51187e187047a6be2/contracts/0.6.12/WstETH.sol#L28-L118\n##### Recommendation\nIt is necessary to add a function to recover excess `stETH` and keep the wrapped shares amount.",
        "protocol": "Lido",
        "report_date": "2022-05-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/README.md#6-there-is-no-recovery-for-excess-steth",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/Lido%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Callback verification",
        "content": "##### Description\nBy mistake a callback which has no implementation of the`processLidoOracleReport()` method can be added at the line:\nhttps://github.com/lidofinance/lido-dao/blob/801d3e854efb33ff33a59fe51187e187047a6be2/contracts/0.8.9/OrderedCallbacksArray.sol#L60\nIn case you set the `IBeaconReportReceiver`  address, the  execution of the following lines will be reverted.\nhttps://github.com/lidofinance/lido-dao/blob/801d3e854efb33ff33a59fe51187e187047a6be2/contracts/0.4.24/oracle/LidoOracle.sol#L644\n##### Recommendation\nIt is necessary to add verification of the existing `processLidoOracleReport()` method in callback or callbacks should be double-checked before adding.\nSee this standard: https://eips.ethereum.org/EIPS/eip-165.",
        "protocol": "Lido",
        "report_date": "2022-05-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/README.md#7-callback-verification",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/Lido%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No check before initialization",
        "content": "##### Description\nAt the lines\nhttps://github.com/lidofinance/lido-dao/blob/801d3e854efb33ff33a59fe51187e187047a6be2/contracts/0.4.24/Lido.sol#L339-L340\nIf the value of variable `mevRewards` is equal to 0, then the initialization of variable `BUFFERED_ETHER_POSITION` will still be performed. This will also require gas consumption.\n##### Recommendation\nIt is recommended to add a check before initialization.",
        "protocol": "Lido",
        "report_date": "2022-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/README.md#1-no-check-before-initialization",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/Lido%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No comparison with previous value",
        "content": "##### Description\nAt line\nhttps://github.com/lidofinance/lido-dao/blob/801d3e854efb33ff33a59fe51187e187047a6be2/contracts/0.8.9/DepositSecurityModule.sol#L204\nthe variable is initialized. But if the new value is equal to the old value, the excess gas will be wasted.\n##### Recommendation\nIt is recommended to add a check before initializing the variable.",
        "protocol": "Lido",
        "report_date": "2022-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/README.md#2-no-comparison-with-previous-value",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/Lido%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "A comment about the node operator count",
        "content": "##### Description\nThere is a comment about the node operator count but there is no functionality related to it at the line:\nhttps://github.com/lidofinance/lido-dao/blob/801d3e854efb33ff33a59fe51187e187047a6be2/contracts/0.4.24/nos/NodeOperatorsRegistry.sol#L23\nOnly manual moderating is available.\n##### Recommendation\nIt is recommended to add a check for the maximum number of operators when adding new ones.",
        "protocol": "Lido",
        "report_date": "2022-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/README.md#3-a-comment-about-the-node-operator-count",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/Lido%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Not all params are there at the comment",
        "content": "##### Description\nAfter line\nhttps://github.com/lidofinance/lido-dao/blob/801d3e854efb33ff33a59fe51187e187047a6be2/contracts/0.4.24/Lido.sol#L97\na description of the two parameters `_treasury` and `_insuranceFund` must be added.\n##### Recommendation\nIt is recommended to fix the code.",
        "protocol": "Lido",
        "report_date": "2022-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/README.md#4-not-all-params-are-there-at-the-comment",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/Lido%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Code inconsistency",
        "content": "##### Description\nThe address above is not cast to address \nhttps://github.com/lidofinance/lido-dao/blob/801d3e854efb33ff33a59fe51187e187047a6be2/contracts/0.4.24/Lido.sol#L111.\n##### Recommendation\nIt is recommended to fix the code.",
        "protocol": "Lido",
        "report_date": "2022-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/README.md#5-code-inconsistency",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/Lido%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Typo mistake",
        "content": "##### Description\nIt should be `stored` \nhttps://github.com/lidofinance/lido-dao/blob/801d3e854efb33ff33a59fe51187e187047a6be2/contracts/0.4.24/oracle/LidoOracle.sol#L78\n##### Recommendation\nIt is recommended to fix the code.",
        "protocol": "Lido",
        "report_date": "2022-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/README.md#6-typo-mistake",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/Lido%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Using `transferShares()` is possible",
        "content": "##### Description\nTransfer can be made via `transferShares()`: \nhttps://github.com/lidofinance/lido-dao/blob/801d3e854efb33ff33a59fe51187e187047a6be2/contracts/0.6.12/WstETH.sol#L73\n##### Recommendation\nIt is recommended to fix the code.",
        "protocol": "Lido",
        "report_date": "2022-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/README.md#7-using-transfershares-is-possible",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20Protocol/Lido%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Spoofed initial deposits in `SexPartners.sol` and `LpDepositor.sol`",
        "content": "##### Description\nThe **initial** deposit of NFT is vulnerable to a spoofing attack.\nThe attacker can directly call `onERC721Received` and supply NFT id that was not actually transferred/not owned by the attacker. It may cause a contract malfunction, including contract unusability or incorrect calculation of the rewards. A contract malfunction cannot be fixed without a contract replacement.\n\nPlease note, this attack can only affect a contract at the initial stage, before the initial deposit was made. Spoofing attempts for any deposits except the initial deposit will be reverted or will not change the state of the contract. Thus a contract at the production stage (after the initial deposit) is not vulnerable anymore.\n\n\nLocation of the affected code:\n- https://github.com/solidex-fantom/solidex/blob/8b420ed8bed4b714695d51de2a0f82e38a72e1b2/contracts/SexPartners.sol#L95\n- https://github.com/solidex-fantom/solidex/blob/8b420ed8bed4b714695d51de2a0f82e38a72e1b2/contracts/LpDepositor.sol#L351\n##### Recommendation\nAlthough an attack can be easily detected and mitigated by redeploying of the contracts, we recommend to add explicit checks for the known attack vector.\n",
        "protocol": "Solidex",
        "report_date": "2022-03-21",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Solidex/Solidex/README.md#1-spoofed-initial-deposits-in-sexpartnerssol-and-lpdepositorsol",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Solidex/Solidex/Solidex-Security-Audit-Report.pdf"
    },
    {
        "title": "Possible blocking of the contract",
        "content": "##### Description\nAt the line \nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.8.9/DepositSecurityModule.sol#L123 \ninitializes the `owner` variable without checking the new value of the variable.\nIf the value of the variable is equal to zero, then the following functions will stop working:\n`setOwner()`, `setNodeOperatorsRegistry()`, `setPauseIntentValidityPeriodBlocks()`, `setMaxDeposits()`,\n`setMinDepositBlockDistance()`, `setGuardianQuorum()`, `addGuardian()`, `addGuardians()`, `removeGuardian()`, `unpauseDeposits()`.\n##### Recommendation\nIt is necessary to add a check for the value of the `newValue` variable to zero before initializing the `owner` variable.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#1-possible-blocking-of-the-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Fix gas cost ETH transfer",
        "content": "##### Description\nETH sending at this line \nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/Lido.sol#L301 \nuses 2300 gas amount, but gas price can be vary and it is possible that in future it may exceed gas limit.\n##### Recommendation\nWe recommend sending ETH via call.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#2-fix-gas-cost-eth-transfer",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "It is required to redo the logic of working with quorum",
        "content": "##### Description\nAt the following lines there is the value of the `quorum` variable changed:\n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.8.9/DepositSecurityModule.sol#L265  when adding one guardian\n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.8.9/DepositSecurityModule.sol#L278  when adding multiple guardians\n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.8.9/DepositSecurityModule.sol#L265  when removing one guardian\n\nThere may even be such a situation that the next such action will set the quorum value equal to `1`.\nIn this case, it is possible for the `depositBufferedEther()` function to work with the signature of only one guardian.\nThis disagrees with the documentation https://github.com/lidofinance/lido-improvement-proposals/blob/develop/LIPS/lip-5.md:\n\"To make a deposit, we propose to collect a quorum of 2/3 of the signatures of the committee members\".\nCurrently, the value of the `quorum` variable is not associated with the value of the `guardians` variable.\nWe recommend doing the following:\n- remove the ability to change the variable that affects the quorum when changing the number of guardians\n- instead of the `quorum` variable, use the percentage of the number of elements in the `guardians` array\n- add a lower bound for the percentage of quorum members and the minimum number of guardians\n##### Recommendation\nIt is necessary to redo the logic of work with quorum counting.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#1-it-is-required-to-redo-the-logic-of-working-with-quorum",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Gas overflow during iteration (DoS)",
        "content": "##### Description\nEach iteration of the cycle requires a gas flow.\nA moment may come when more gas is required than it is allocated to record one block. In this case, all iterations of the loop will fail.\nAffected lines:\n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/nos/NodeOperatorsRegistry.sol#L214-L221\n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/Lido.sol#L616-L624\n##### Recommendation\nIt is recommended to limit the number of loop iterations.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#2-gas-overflow-during-iteration-dos",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unused keys trimming doesn't remove keys and signatures from storage",
        "content": "##### Description\nThis function \nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/nos/NodeOperatorsRegistry.sol#L212 \nleave keys data in storage. \nIt may be dangerous.\n##### Recommendation\nWe recommend to remove properly.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#3-unused-keys-trimming-doesnt-remove-keys-and-signatures-from-storage",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible blocking of work with buffered ETH",
        "content": "##### Description\nAt the lines \nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/nos/NodeOperatorsRegistry.sol#L252-L262 there's a function `addSigningKeysOperatorBH()`.\nThis function can be called from any address of operators `[_operator_id].rewardAddress`.\nCalling this function increments the value of `KEYS_OP_INDEX_POSITION`. And the current value of `KEYS_OP_INDEX_POSITION` is used here:\nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.8.9/DepositSecurityModule.sol#L413-L414.\nThus, any operator (and inactive too) can block the operation of `depositBufferedEther()`.\nHowever, it is safe to do the same with the `addSigningKeys()` function, which can only be called by special users.\n##### Recommendation\nIt is necessary to add a restriction on the call to the `addSigningKeysOperatorBH()` function or remove it from the source code altogether.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#4-possible-blocking-of-work-with-buffered-eth",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Superfluous actions when the function is called again",
        "content": "##### Description\nAt the lines \nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.8.9/DepositSecurityModule.sol#L336-L356 there's a call to the `pauseDeposits()` function to set the value of the `paused` variable to `true`.\nNow this function will be executed if the value of the `paused` variable is already set to `true`.\nSuch actions will lead to unnecessary gas consumption.\n##### Recommendation\nIt is necessary to roll back the transaction if the value of the `paused` variable is already set to `true`.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#5-superfluous-actions-when-the-function-is-called-again",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary actions",
        "content": "##### Description\nAt the lines \nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/nos/NodeOperatorsRegistry.sol#L141-L157 there's a call to the `setNodeOperatorActive()` function to set the value of the `operators[_id].active` variable to `_active`.\nHowever, if the value of the variable does not change, you do not need to make a call to the `_increaseKeysOpIndex()` function and record the `NodeOperatorActiveSet` event.\nBefore line 145, add the following check:\n```\n    require(operators[_id].active != _active, \"SAME_VALUE\");\n```\nAnd it will be necessary to remove the use of the `if` operator on line 146.   \n\nAt the line  \nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/nos/NodeOperatorsRegistry.sol#L166 you need to add a check like this:\n```\n    require(operators[_id].name != _name, \"SAME_VALUE\");\n```\n\nAt the line \nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/nos/NodeOperatorsRegistry.sol#L178 you need to add a check like this:\n```\n    require(operators[_id].rewardAddress != _rewardAddress, \"SAME_VALUE\");\n```\n\nAt the line \nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/nos/NodeOperatorsRegistry.sol#L189 you need to add a check like this:\n```\n    require(operators[_id].stakingLimit != _stakingLimit, \"SAME_VALUE\");\n```\n\n##### Recommendation\nThe source code needs to be changed.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#6-unnecessary-actions",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Guardian zero address check",
        "content": "##### Description\nIt is possible to add guardian with zero address \nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.8.9/DepositSecurityModule.sol#L281.\n##### Recommendation\nIt is recommended to add zero address check\n```solidity\nrequire(addr != address(0), \"guardian zero address\");\n```",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#7-guardian-zero-address-check",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Variable without visibility modifier",
        "content": "##### Description\nVariable [`guardianIndicesOneBased` hasn't visibiltity modifier](https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.8.9/DepositSecurityModule.sol#L61). It is not clear which visibility modifier is default.\n##### Recommendation\nIt is recommended to set visibility to `internal`\n```solidity\n    mapping(address => uint256) internal guardianIndicesOneBased; // 1-based\n```",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#8-variable-without-visibility-modifier",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Hardcoded `MAX_BPS`",
        "content": "##### Description\n`MAX_BPS` is hardcoded here: \nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/Lido.sol#L189, \nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/Lido.sol#L582, \nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/Lido.sol#L593, \nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/Lido.sol#L599, \nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/Lido.sol#L654, \nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/Lido.sol#L681. \nIt is not safe if it may be changed.\n##### Recommendation\nIt is recommended to store `MAX_BPS` as variable.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#9-hardcoded-max_bps",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible `uint256` overflow",
        "content": "##### Description\nThere may be `uint256` overflow \n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/nos/NodeOperatorsRegistry.sol#L287, \n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/nos/NodeOperatorsRegistry.sol#L311.\n##### Recommendation\nIt is recommended to use SafeMath.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#10-possible-uint256-overflow",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary staking limit decrease",
        "content": "##### Description\nIs not clear why staking limit should be decreased to index \nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/nos/NodeOperatorsRegistry.sol#L627 \nIf we remove key at index 0 then we will have all keys of this node operator to be used.\n##### Recommendation\nIt is recommended to not decrease staking limit.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#11-unnecessary-staking-limit-decrease",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Using unchecked address",
        "content": "##### Description\nAt the lines:\nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.8.9/DepositSecurityModule.sol#L77\nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.8.9/DepositSecurityModule.sol#L78\naddress is not checked before using.\n##### Recommendation\nIt is recommended to check address for zeros.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#12-using-unchecked-address",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An event is omitted",
        "content": "##### Description\nThere are omitted events at the lines:\n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.8.9/DepositSecurityModule.sol#L425\n\n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/Lido.sol#L283\n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/Lido.sol#L406\n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/Lido.sol#L415\n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/Lido.sol#L424\n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/Lido.sol#L429\n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/Lido.sol#L434\n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/Lido.sol#L546\n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/Lido.sol#L656\n##### Recommendation\nIt is recommended to add events.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#13-an-event-is-omitted",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Can use the constant",
        "content": "##### Description\nAt the line\nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/nos/NodeOperatorsRegistry.sol#L42 there's a constant `UINT64_MAX` defined.\nAt the line\nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/nos/NodeOperatorsRegistry.sol#L554 can use this constant.\n##### Recommendation\nIt is recommended to refactor your source code.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#1-can-use-the-constant",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Extra code",
        "content": "##### Description\nAt the lines in regular methods: \n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/nos/NodeOperatorsRegistry.sol#L541 \n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/nos/NodeOperatorsRegistry.sol#L566 \n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/nos/NodeOperatorsRegistry.sol#L646\nchecks are made for the constant `PUBKEY_LENGTH`.\n\nAt the lines in regular methods: \n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/nos/NodeOperatorsRegistry.sol#L567 \n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/nos/NodeOperatorsRegistry.sol#L647 \n- https://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/nos/NodeOperatorsRegistry.sol#L646\nchecks are made for the constant `SIGNATURE_LENGTH`.\n\nIt is correct to do these checks before initializing constants.\n##### Recommendation\nIt is recommended to remove the extra code. This will save gas.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#2-extra-code",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Extra initialization",
        "content": "##### Description\nAt the lines in the constructor \nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.8.9/DepositSecurityModule.sol#L98-L99 \ninitialization of variables is done.\nBut initially the variables already have these values.\n##### Recommendation\nIt is recommended to remove the extra code.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#3-extra-initialization",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Comment typo error",
        "content": "##### Description\nThis comment is probably incorrect \nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.8.9/DepositSecurityModule.sol#L390. \n##### Recommendation\nIt is recommended to check for non-equal\n```solidity\n     *   6. blockhash(blockNumber) != blockHash\n```",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#4-comment-typo-error",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Storage assigning may be in if statement",
        "content": "##### Description\nThis assigning can be placed in if statement above \nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/nos/NodeOperatorsRegistry.sol#L154.\n##### Recommendation\nIt is recommended to place in if statement above.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#5-storage-assigning-may-be-in-if-statement",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Naming variable mistake",
        "content": "##### Description\nBecause of `_totalRewardShares` not divides for validators but divides for `effectiveStakeTotal` should to rename `perValidatorReward` to `perStakeReward` at `NodeOperatorsRegistry.sol` at line:\nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/nos/NodeOperatorsRegistry.sol#L441\n##### Recommendation\nIt is recommended to rename `perValidatorReward` to `perStakeReward`.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#6-naming-variable-mistake",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Omitted description",
        "content": "##### Description\nThere are no description at `Lido.sol` at `_setTreasury()` function at line:\nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/Lido.sol#L427\nAt `_setInsuranceFund()` at line:\nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/Lido.sol#L432\nAt `_distributeNodeOperatorsReward()` at line:\nhttps://github.com/lidofinance/lido-dao/blob/5b449b740cddfbef5c107505677e6a576e2c2b69/contracts/0.4.24/Lido.sol#L611\n##### Recommendation\nIt is recommended to add description.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/README.md#7-omitted-description",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Deposit%20Security%20Module/Lido%20Deposit%20Security%20Module%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possibility of taking burned shares",
        "content": "##### Description\nWith attack it is possible to take burned shares profit even without taking shares before `processLidoOracleReport()` execution.\nhttps://github.com/lidofinance/lido-dao/blob/ee1991b3bbea2a24b042b0a4433be04301992656/contracts/0.8.9/SelfOwnedStETHBurner.sol#L252\nThis exploit shows how the attack is done:\nhttps://gist.github.com/georgiypetrov/22c0649058a97102e2fd97a1c619a3b3\nIf this is a front-run attack, then it will be the most convenient for the attacker.\n##### Recommendation\nIt is necessary to add a limit on the amount of burned tokens.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/In-protocol%20Coverage/README.md#1-possibility-of-taking-burned-shares",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/In-protocol%20Coverage/Lido%20In-protocol%20%20Coverage%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "There is no processing of the value returned by the function",
        "content": "##### Description\nAt the line\nhttps://github.com/lidofinance/lido-dao/blob/ee1991b3bbea2a24b042b0a4433be04301992656/contracts/0.8.9/SelfOwnedStETHBurner.sol#L228\nthe `transfer()` function returns a boolean variable. But this variable is not processed in any way.\nSimilarly for the line:\nhttps://github.com/lidofinance/lido-dao/blob/ee1991b3bbea2a24b042b0a4433be04301992656/contracts/0.8.9/SelfOwnedStETHBurner.sol#L203.\n##### Recommendation\nIt is necessary to add processing of the values returned by the function.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/In-protocol%20Coverage/README.md#1-there-is-no-processing-of-the-value-returned-by-the-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/In-protocol%20Coverage/Lido%20In-protocol%20%20Coverage%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Extra operation",
        "content": "##### Description\nAt the line\nhttps://github.com/lidofinance/lido-dao/blob/ee1991b3bbea2a24b042b0a4433be04301992656/contracts/0.8.9/SelfOwnedStETHBurner.sol#L223\nchecks the value of the `_token` variable. But if the value of the variable is zero, then the code on line 228 will not be executed.\nSimilarly for the line:\nhttps://github.com/lidofinance/lido-dao/blob/ee1991b3bbea2a24b042b0a4433be04301992656/contracts/0.8.9/SelfOwnedStETHBurner.sol#L239\n##### Recommendation\nIt is necessary to remove redundant operations.",
        "protocol": "Lido",
        "report_date": "2022-02-28",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/In-protocol%20Coverage/README.md#1-extra-operation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/In-protocol%20Coverage/Lido%20In-protocol%20%20Coverage%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Security and sanity check bypass in `MultiCallOptimizedSwapper`",
        "content": "##### Description\nAs well as similar functions, [`execute`](https://github.com/yearn/hardhat-monorepo/blob/ecc0b5147992b34c315e08af170ceb4a5fe071ee/packages/yswaps/contracts/TradeFactory/TradeFactoryExecutor.sol#L126) performs several sanity and security checks:\n- provided swapper is required to be in `_swappers` enumerable set\n- exchange path `tokenIn` and `tokenOut` is required to be enabled for given `strategy`\n- output token amount is required to be greater or equal to provided `minAmountOut`.\n\nHowever, the actual code executed by [`_executeSwap`](https://github.com/yearn/hardhat-monorepo/blob/ecc0b5147992b34c315e08af170ceb4a5fe071ee/packages/yswaps/contracts/swappers/async/MultiCallOptimizedSwapper.sol#L27) is arbitrary and can accidentally or intentionally bypass these checks. Although `MultiCallOptimizedSwapper` can be only invoked by the trusted actor `onlyMechanics`, arbitrary code execution can probably lead to loss of funds in case of accidental bug at off-chain bot. Also, single compromised `Mechanic` account key can lead to \"rug pull\" from all connected strategies.\n##### Recommendation\nWe recommend to disallow execution of arbitrary code and keep the best practice of white-listing of allowed actions and calls, similar to other swappers at `contracts/swappers/async` directory.",
        "protocol": "Yearn Finance",
        "report_date": "2022-02-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/ySwaps/README.md#1-security-and-sanity-check-bypass-in-multicalloptimizedswapper",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/ySwaps/Yearn%20ySwaps%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary and unrestricted `trade()` at `sync/BancorSwapper`",
        "content": "##### Description\n[trade()](https://github.com/yearn/hardhat-monorepo/blob/ecc0b5147992b34c315e08af170ceb4a5fe071ee/packages/yswaps/contracts/swappers/sync/BancorSwapper.sol#L52) function has no use and most likely remains in contract by an accident. However, it is unrestricted and can be called by anyone. \n##### Recommendation\nAlthough we have not found any attack vector for this issue, we recommend to remove this code to improve security.\n",
        "protocol": "Yearn Finance",
        "report_date": "2022-02-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/ySwaps/README.md#2-unnecessary-and-unrestricted-trade-at-syncbancorswapper",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/ySwaps/Yearn%20ySwaps%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incompatibility with fee-on-transfer tokens",
        "content": "##### Description\nSeveral parts of code have assumption that `transferFrom(..., amount)` will result in receiving of exact `amount` of tokens:\n\n- https://github.com/yearn/hardhat-monorepo/blob/ecc0b5147992b34c315e08af170ceb4a5fe071ee/packages/yswaps/contracts/TradeFactory/TradeFactoryExecutor.sol#L82-L88\n- https://github.com/yearn/hardhat-monorepo/blob/ecc0b5147992b34c315e08af170ceb4a5fe071ee/packages/yswaps/contracts/TradeFactory/TradeFactoryExecutor.sol#L111-L117\n\nHowever, actual amount of received tokens can be less for fee-on-transfer tokens.\n##### Recommendation\nFor compatibility with fee-on-transfer tokens we recommend to use `balanceOf` to obtain actual amounts of tokens received by `transferFrom`. ",
        "protocol": "Yearn Finance",
        "report_date": "2022-02-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/ySwaps/README.md#3-incompatibility-with-fee-on-transfer-tokens",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/ySwaps/Yearn%20ySwaps%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect slippage check",
        "content": "##### Description\nCondition in slippage check is logically reversed: \nhttps://github.com/yearn/hardhat-monorepo/blob/ecc0b5147992b34c315e08af170ceb4a5fe071ee/packages/yswaps/contracts/TradeFactory/TradeFactoryExecutor.sol#L150\n##### Recommendation\nNote: this issue was found by the developers\n\n***\n",
        "protocol": "Yearn Finance",
        "report_date": "2022-02-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/ySwaps/README.md#4-incorrect-slippage-check",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/ySwaps/Yearn%20ySwaps%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unrestricted setter in `Machinery` contract",
        "content": "##### Description\nSetter for the mechanics registry [setMechanicsRegistry](https://github.com/yearn/hardhat-monorepo/blob/ecc0b5147992b34c315e08af170ceb4a5fe071ee/packages/contract-utils/contracts/utils/Machinery.sol#L22) has no access restriction. It can cause security breach in inherited contracts that lack security-aware override of `setMechanicsRegistry` function.\n##### Recommendation\nAlthough currently all of the inherited contracts from audited scope override `setMechanicsRegistry` properly, we recommend to prevent accidental inheritance of insecure code by modifying or removing `setMechanicsRegistry` function from `Machinery` contract. Additionally, this contract is most likely has been planned to be `abstract`.",
        "protocol": "Yearn Finance",
        "report_date": "2022-02-28",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/ySwaps/README.md#1-unrestricted-setter-in-machinery-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/ySwaps/Yearn%20ySwaps%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary assembly in `MultiCallOptimizedSwapper.sol`",
        "content": "##### Description\n[MultiCallOptimizer.sol](https://github.com/yearn/hardhat-monorepo/blob/ecc0b5147992b34c315e08af170ceb4a5fe071ee/packages/yswaps/contracts/swappers/async/MultiCallOptimizedSwapper.sol) contract is using assembly most likely for gas optimization purposes. However, this approach does not make significant impact to overall gas usage while it makes the code more complex and unsafe.\n##### Recommendation\nIn favour of readability and safety of code. we recommend to avoid unnecessary usage of assembly in Solidity.",
        "protocol": "Yearn Finance",
        "report_date": "2022-02-28",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/ySwaps/README.md#2-unnecessary-assembly-in-multicalloptimizedswappersol",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/ySwaps/Yearn%20ySwaps%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Variables can be declared as immutable",
        "content": "##### Description\nFollowing variables of both sync and async Bancor swappers can be declared as immutable: `contractRegistry`, `bancorNetworkName` at https://github.com/yearn/hardhat-monorepo/blob/ecc0b5147992b34c315e08af170ceb4a5fe071ee/packages/yswaps/contracts/swappers/async/BancorSwapper.sol#L40-L41 and `contractRegistry`, `bancorNetworkName` at https://github.com/yearn/hardhat-monorepo/blob/ecc0b5147992b34c315e08af170ceb4a5fe071ee/packages/yswaps/contracts/swappers/sync/BancorSwapper.sol#L38-L39\n##### Recommendation\nWe recommend to declare mentioned variables as immutable.\n\n***\n",
        "protocol": "Yearn Finance",
        "report_date": "2022-02-28",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/ySwaps/README.md#3-variables-can-be-declared-as-immutable",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/ySwaps/Yearn%20ySwaps%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Duplicating sanity check",
        "content": "##### Description\nSanity check `maxSlippage != 0` at https://github.com/yearn/hardhat-monorepo/blob/ecc0b5147992b34c315e08af170ceb4a5fe071ee/packages/yswaps/contracts/TradeFactory/TradeFactoryExecutor.sol#L81 duplicates sanity check at https://github.com/yearn/hardhat-monorepo/blob/ecc0b5147992b34c315e08af170ceb4a5fe071ee/packages/yswaps/contracts/swappers/sync/SyncSwapper.sol#L38\n##### Recommendation\nWe recommend to remove redundant check\n",
        "protocol": "Yearn Finance",
        "report_date": "2022-02-28",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/ySwaps/README.md#4-duplicating-sanity-check",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/ySwaps/Yearn%20ySwaps%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Redundant operation on return values",
        "content": "##### Description\nHere are performed some redundant operation on return values of `swapExactTokensForTokens()`:\n- https://github.com/yearn/hardhat-monorepo/blob/ecc0b5147992b34c315e08af170ceb4a5fe071ee/packages/yswaps/contracts/swappers/async/UniswapV2Swapper.sol#L52\n- https://github.com/yearn/hardhat-monorepo/blob/ecc0b5147992b34c315e08af170ceb4a5fe071ee/packages/yswaps/contracts/swappers/sync/UniswapV2AnchorSwapper.sol#L74\n\nIt makes no impact on contract security or perfomance and only noted in favour of graceful code.\n##### Recommendation\nWe recommend to remove redundant operations\n\n***\n",
        "protocol": "Yearn Finance",
        "report_date": "2022-02-28",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/ySwaps/README.md#5-redundant-operation-on-return-values",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/ySwaps/Yearn%20ySwaps%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible underflow",
        "content": "##### Description\nIf a ledger's stake drammaticaly decreases due to rebalance and after that the ledger receives a huge slash, then underflow can occur: https://github.com/mixbytes/lido-dot-ksm/blob/76a10efa5f223c4c613f26794802b8fb9bb188e1/contracts/Lido.sol#L608\n\n##### Recommendation\nWe recommend distributing slashes across all the ledgers.\n",
        "protocol": "Lido",
        "report_date": "2022-02-08",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/README.md#1-possible-underflow",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/LIDO%20KSM%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible overflow on cast to uint",
        "content": "##### Description\nIf `newStake` is a negative number, then overflow can occur: https://github.com/mixbytes/lido-dot-ksm/blob/76a10efa5f223c4c613f26794802b8fb9bb188e1/contracts/Lido.sol#L730\n\n##### Recommendation\nWe recommend checking overall diff in order to exclude such scenarios.\n",
        "protocol": "Lido",
        "report_date": "2022-02-08",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/README.md#2-possible-overflow-on-cast-to-uint",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/LIDO%20KSM%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Public access to all functions",
        "content": "##### Description\nIn contract `Controller` all functions have public access which can be exploited:\nhttps://github.com/mixbytes/lido-dot-ksm/blob/76a10efa5f223c4c613f26794802b8fb9bb188e1/contracts/Controller.sol\n\n##### Recommendation\nWe recommend adding access modificators.\n",
        "protocol": "Lido",
        "report_date": "2022-02-08",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/README.md#1-public-access-to-all-functions",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/LIDO%20KSM%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Controller can be initialized several times",
        "content": "##### Description\nIn contract `Controller` the `initialize` function can be called several times: https://github.com/mixbytes/lido-dot-ksm/blob/76a10efa5f223c4c613f26794802b8fb9bb188e1/contracts/Controller.sol#L140\n\n##### Recommendation\nWe recommend adding the `initializer` modifier.\n",
        "protocol": "Lido",
        "report_date": "2022-02-08",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/README.md#2-controller-can-be-initialized-several-times",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/LIDO%20KSM%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect condition",
        "content": "##### Description\nThe condition is incorrect here that can lead to an infinite loop: https://github.com/mixbytes/lido-dot-ksm/blob/76a10efa5f223c4c613f26794802b8fb9bb188e1/contracts/Lido.sol#L748\n\n##### Recommendation\nWe recommend changing `||` into `&&`.\n",
        "protocol": "Lido",
        "report_date": "2022-02-08",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/README.md#3-incorrect-condition",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/LIDO%20KSM%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible burn of zero shares",
        "content": "##### Description\nDue to rounding errors a user can burn zero shares: https://github.com/mixbytes/lido-dot-ksm/blob/76a10efa5f223c4c613f26794802b8fb9bb188e1/contracts/Lido.sol#L522\n\n##### Recommendation\nWe recommend adding a check so that a user couldn't burn zero shares.\n",
        "protocol": "Lido",
        "report_date": "2022-02-08",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/README.md#4-possible-burn-of-zero-shares",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/LIDO%20KSM%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible division by zero",
        "content": "##### Description\nIn some cases division by zero can take place here:\n- https://github.com/mixbytes/lido-dot-ksm/blob/76a10efa5f223c4c613f26794802b8fb9bb188e1/contracts/Lido.sol#L658\n- https://github.com/mixbytes/lido-dot-ksm/blob/76a10efa5f223c4c613f26794802b8fb9bb188e1/contracts/Lido.sol#L708\n\n##### Recommendation\nWe recommend to set a stake to zero if the overall shares amount is equal to zero.\n",
        "protocol": "Lido",
        "report_date": "2022-02-08",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/README.md#5-possible-division-by-zero",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/LIDO%20KSM%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Insufficient xcKSm balance on `Lido`",
        "content": "##### Description\nIt is possible that `Lido` can have less than `_readyToClaim` : https://github.com/mixbytes/lido-dot-ksm/blob/76a10efa5f223c4c613f26794802b8fb9bb188e1/contracts/Lido.sol#L563\n\n##### Recommendation\nWe recommend to add a requirement that `Lido` would have enough tokens to transfer.\n",
        "protocol": "Lido",
        "report_date": "2022-02-08",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/README.md#5-insufficient-xcksm-balance-on-lido",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/LIDO%20KSM%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible zero balance on `Lido`",
        "content": "##### Description\nIt is possible that `Lido` can have zero balance on reward distribution: https://github.com/mixbytes/lido-dot-ksm/blob/76a10efa5f223c4c613f26794802b8fb9bb188e1/contracts/Lido.sol#L588\n\n##### Recommendation\nWe recommend to add a check for the case when `Lido` has zero balance on reward distribution.\n",
        "protocol": "Lido",
        "report_date": "2022-02-08",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/README.md#6-possible-zero-balance-on-lido",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/LIDO%20KSM%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible underflow",
        "content": "##### Description\nIt is possible that free balance from the report can be less than free balance from the previous era: https://github.com/mixbytes/lido-dot-ksm/blob/76a10efa5f223c4c613f26794802b8fb9bb188e1/contracts/Ledger.sol#L297\n\n##### Recommendation\nWe recommend to add a variable to control which amount should be bonded on the next era.\n",
        "protocol": "Lido",
        "report_date": "2022-02-08",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/README.md#7-possible-underflow",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/LIDO%20KSM%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible free tokens on Ledger",
        "content": "##### Description\nIf someone sends `xcKSM` to Ledger: https://github.com/mixbytes/lido-dot-ksm/blob/76a10efa5f223c4c613f26794802b8fb9bb188e1/contracts/Ledger.sol#L282\n\n##### Recommendation\nWe recommend sendig excess in funds to treasury.\n",
        "protocol": "Lido",
        "report_date": "2022-02-08",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/README.md#1-possible-free-tokens-on-ledger",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/LIDO%20KSM%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Rewards can be lost",
        "content": "##### Description\nIf these addresses have been set to 0, then the rewards can be lost:\nhttps://github.com/mixbytes/lido-dot-ksm/blob/76a10efa5f223c4c613f26794802b8fb9bb188e1/contracts/Lido.sol#L218\nhttps://github.com/mixbytes/lido-dot-ksm/blob/76a10efa5f223c4c613f26794802b8fb9bb188e1/contracts/Lido.sol#L225\nhttps://github.com/mixbytes/lido-dot-ksm/blob/76a10efa5f223c4c613f26794802b8fb9bb188e1/contracts/Lido.sol#L318\nhttps://github.com/mixbytes/lido-dot-ksm/blob/76a10efa5f223c4c613f26794802b8fb9bb188e1/contracts/Lido.sol#L328\n\n##### Recommendation\nWe recommend adding a zero address check.\n",
        "protocol": "Lido",
        "report_date": "2022-02-08",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/README.md#2-rewards-can-be-lost",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/LIDO%20KSM%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unusable variable",
        "content": "##### Description\nThe variable is defined and initialized, but not used in the smart contract:\nhttps://github.com/mixbytes/lido-dot-ksm/blob/76a10efa5f223c4c613f26794802b8fb9bb188e1/contracts/Lido.sol#L201\n\n##### Recommendation\nWe recommend removing this variable.\n",
        "protocol": "Lido",
        "report_date": "2022-02-08",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/README.md#1-unusable-variable",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Lido%20KSM/LIDO%20KSM%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Token Bridging doesn't work with Wormhole fees",
        "content": "##### Description\nLine \n- https://github.com/certusone/wormhole/blob/9bc408ca1912e7000c5c2085215be9d44713028b/ethereum/contracts/bridge/Bridge.sol#L93\nhas a `transferTokens ()` function of type `payable`. In the body of this function, on line 133, a call to the internal \nfunction `logTransfer ()` is made and one of the parameters `msg.value` is passed.\nAt line  \n- https://github.com/certusone/wormhole/blob/9bc408ca1912e7000c5c2085215be9d44713028b/ethereum/contracts/bridge/Bridge.sol#L151\nfrom the `logTransfer()` function, the `publishMessage()` function is called.\nThe `publishMessage()` function of type `payable` on the line:\n- https://github.com/certusone/wormhole/blob/9bc408ca1912e7000c5c2085215be9d44713028b/ethereum/contracts/Implementation.sol#L21\nthe condition for payment of the commission must be met.\n```\n   require(msg.value == messageFee(), \"invalid fee\");\n```\n\nIn the checked contract, at line \n- https://github.com/lidofinance/anchor-collateral-steth/blob/8d52ce72cb42d48dff1851222e3b624c941ddb30/contracts/BridgeConnectorWormhole.vy#L49\na call to the `transferTokens()` function from the `_transfer_asset()` function is made. \nBut there is no `@payable` modifier anywhere and no `msg.value` value handling.\nTherefore, the `_transfer_asset()` function will not work.\nAs a result, the `submit ()` and `collect_rewards ()` functions will not work in the `AnchorVault.vy` contract, \nbecause there is no commission fee for the `Wormhole` system.\n##### Recommendation\nIt is required to add a commission payment for the `Wormhole` system.",
        "protocol": "Lido",
        "report_date": "2022-01-25",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Anchor%20Collateral%20stETH/README.md#1-token-bridging-doesnt-work-with-wormhole-fees",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Anchor%20Collateral%20stETH/Lido%20Anchor%20Collateral%20stETH%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "There is no processing of the value returned by the function.",
        "content": "##### Description\nIn the ERC-20 standard, when processing tokens, if successful, `true` is returned.\nAnd this value should always be checked.\nBut in the audited code, checks are not done.\nThe following lines:\n- https://github.com/lidofinance/anchor-collateral-steth/blob/8d52ce72cb42d48dff1851222e3b624c941ddb30/contracts/AnchorVault.vy#L381\n- https://github.com/lidofinance/anchor-collateral-steth/blob/8d52ce72cb42d48dff1851222e3b624c941ddb30/contracts/AnchorVault.vy#L383\n- https://github.com/lidofinance/anchor-collateral-steth/blob/8d52ce72cb42d48dff1851222e3b624c941ddb30/contracts/AnchorVault.vy#L414\n- https://github.com/lidofinance/anchor-collateral-steth/blob/8d52ce72cb42d48dff1851222e3b624c941ddb30/contracts/AnchorVault.vy#L488\n- https://github.com/lidofinance/anchor-collateral-steth/blob/8d52ce72cb42d48dff1851222e3b624c941ddb30/contracts/RewardsLiquidator.vy#L278 \n- https://github.com/lidofinance/anchor-collateral-steth/blob/8d52ce72cb42d48dff1851222e3b624c941ddb30/contracts/RewardsLiquidator.vy#L321 \n- https://github.com/lidofinance/anchor-collateral-steth/blob/8d52ce72cb42d48dff1851222e3b624c941ddb30/contracts/RewardsLiquidator.vy#L345 \n- https://github.com/lidofinance/anchor-collateral-steth/blob/8d52ce72cb42d48dff1851222e3b624c941ddb30/contracts/BridgeConnectorWormhole.vy#L44 \n##### Recommendation\nIt is recommended to add processing of the value returned by the function.",
        "protocol": "Lido",
        "report_date": "2022-01-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Anchor%20Collateral%20stETH/README.md#1-there-is-no-processing-of-the-value-returned-by-the-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Anchor%20Collateral%20stETH/Lido%20Anchor%20Collateral%20stETH%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No checking value for zero",
        "content": "##### Description\nThere is a possible scenario where collected rewards may be sent to zero address if `rewards_distributor` is uninitialized \nhttps://github.com/lidofinance/anchor-collateral-steth/blob/8d52ce72cb42d48dff1851222e3b624c941ddb30/contracts/AnchorVault.vy#L491\n##### Recommendation\nIt is recommended to check if `rewards_distributor` is uninitialized.",
        "protocol": "Lido",
        "report_date": "2022-01-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Anchor%20Collateral%20stETH/README.md#2-no-checking-value-for-zero",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Anchor%20Collateral%20stETH/Lido%20Anchor%20Collateral%20stETH%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Adjusted stETH return transfer fee may be more expensive than dust amount",
        "content": "##### Description\n`steth_amount - steth_amount_adj` value may be less than `transfer` fee cost. \nhttps://github.com/lidofinance/anchor-collateral-steth/blob/8d52ce72cb42d48dff1851222e3b624c941ddb30/contracts/AnchorVault.vy#L383\nThe same situation is there for the variable `steth_to_sell` at line:\nhttps://github.com/lidofinance/anchor-collateral-steth/blob/8d52ce72cb42d48dff1851222e3b624c941ddb30/contracts/AnchorVault.vy#L488\n##### Recommendation\nIt is recommended to calculate if there is a sufficient difference between the adjusted eth and original amount to return. \nYou can add a check for the minimum value.",
        "protocol": "Lido",
        "report_date": "2022-01-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Anchor%20Collateral%20stETH/README.md#3-adjusted-steth-return-transfer-fee-may-be-more-expensive-than-dust-amount",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Anchor%20Collateral%20stETH/Lido%20Anchor%20Collateral%20stETH%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An unfavorable exchange may occur",
        "content": "##### Description\nAt the lines: \nhttps://github.com/lidofinance/anchor-collateral-steth/blob/8d52ce72cb42d48dff1851222e3b624c941ddb30/contracts/RewardsLiquidator.vy#L306-L308 \nand \nhttps://github.com/lidofinance/anchor-collateral-steth/blob/8d52ce72cb42d48dff1851222e3b624c941ddb30/contracts/RewardsLiquidator.vy#L329-L331 \nif the initial USDC or UST balance + exchanged tokens are bigger than min required swap amount then an unfavorable swap may occur.\nActually, it is safe for the project.\n##### Recommendation\nIt is recommended to calc swapped amount with difference balance from and balance after.\nThis is not a planned behavior that needs to be handled.",
        "protocol": "Lido",
        "report_date": "2022-01-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Anchor%20Collateral%20stETH/README.md#4-an-unfavorable-exchange-may-occur",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Anchor%20Collateral%20stETH/Lido%20Anchor%20Collateral%20stETH%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The function can be decomposed",
        "content": "##### Description\nAt the line\nhttps://github.com/lidofinance/anchor-collateral-steth/blob/8d52ce72cb42d48dff1851222e3b624c941ddb30/contracts/RewardsLiquidator.vy#L262-L357\n`liquidate()` function can be decomposed to three internal functions.\n##### Recommendation\nIt is recommended to make three separate internal functions instead of one long function.",
        "protocol": "Lido",
        "report_date": "2022-01-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Anchor%20Collateral%20stETH/README.md#1-the-function-can-be-decomposed",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Anchor%20Collateral%20stETH/Lido%20Anchor%20Collateral%20stETH%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An unnecessary comment",
        "content": "##### Description\nAt the line \nhttps://github.com/lidofinance/anchor-collateral-steth/blob/8d52ce72cb42d48dff1851222e3b624c941ddb30/contracts/AnchorVault.vy#L164\nthere is an unnecessary comment `# dev: unauthorized`.\n##### Recommendation\nIt is recommended to delete this comment.",
        "protocol": "Lido",
        "report_date": "2022-01-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Anchor%20Collateral%20stETH/README.md#2-an-unnecessary-comment",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Anchor%20Collateral%20stETH/Lido%20Anchor%20Collateral%20stETH%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect calculation of borrowed amount",
        "content": "##### Description\nTotal borrowed amount increases unequally, so total borrowed amount on credit accounts would be less than `totalBorrowed` on a `PoolService` which would lead to incorrect calcultaions for LP of a `PoolService`:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L661\n##### Recommendation\nWe recommend to change calculation of borrowed amount for credit accounts.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#1-incorrect-calculation-of-borrowed-amount",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible remove of necessary adapter",
        "content": "##### Description\nIn case 1 adapter is used for several contracts, then   next lines will break work of these contracts:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditFilter.sol#L190\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditFilter.sol#L217\n##### Recommendation\nWe recommend adding a check, that removed adapter is not used in other contracts.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#1-possible-remove-of-necessary-adapter",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect change of state",
        "content": "##### Description\nChanging state to true is incorrect and must be done via `allowToken()`:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditFilter.sol#L398\n##### Recommendation\nWe recommend allowing changing state only to false.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#2-incorrect-change-of-state",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`creditManager` isn't checked",
        "content": "##### Description\nIt is possible to give unlimited approve to poisoned contract:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/LeverageActions.sol#L222\n##### Recommendation\nWe recommend adding a check that `creditManager` is a system contract.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#3-creditmanager-isnt-checked",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Uncounted fees in USDT",
        "content": "##### Description\nContract can have less than `amountIn` because of fees in transferFrom function in USDT:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/LeverageActions.sol#L232\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/LeverageActions.sol#L324\n##### Recommendation\nWe recommend to call `openCreditAccount` with current contract balance.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#4-uncounted-fees-in-usdt",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible loss of assets by mistake",
        "content": "##### Description\nIf a liquidator calls this function by mistake with the next parameters: `to = address(0), force = true`, then he loses all assets:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L302\n##### Recommendation\nWe recommend adding a check that `to != address(0)`.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#5-possible-loss-of-assets-by-mistake",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Broken account must be deleted",
        "content": "##### Description\nIn case if some tokens cannot be transferred from the account, then this account must be deleted:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L451\n##### Recommendation\nWe recommend to delete account in case some transfers are reverted.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#6-broken-account-must-be-deleted",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible transfer of bad account",
        "content": "##### Description\nUser can have bad account with Hf < 1 but not liquidated yet, and transfer it to another user:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L954\n##### Recommendation\nWe recommend adding approve mechanic, so that account receiver does not receive account that he doesn't want.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#7-possible-transfer-of-bad-account",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary allowance",
        "content": "##### Description\nVault's withdraw function burns shares, so allowance is unnecessary:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/YearnV2.sol#L130\n##### Recommendation\nWe recommend removing providing allowance.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#8-unnecessary-allowance",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect usage of function returned value",
        "content": "##### Description\nVault's withdraw function returns amount of tokens which was transferred, not shares:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/YearnV2.sol#L145\n##### Recommendation\nWe recommend to change function code.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#9-incorrect-usage-of-function-returned-value",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect taking out of `tail` account",
        "content": "##### Description\nIf `creditAccount == tail` then `tail` is not updated properly and this will break the list of accounts:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/AccountFactory.sol#L260\n##### Recommendation\nWe recommend updating `tail` if it was taken out.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#10-incorrect-taking-out-of-tail-account",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect minting",
        "content": "##### Description\nBecause of fees in transferFrom function in USDT, contract would have less than `amount`:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/pool/PoolService.sol#L155\n##### Recommendation\nWe recommend to use balance difference to mint Diesel tokens.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#11-incorrect-minting",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Impossible liquidity removing",
        "content": "##### Description\nIn case all funds were borrowed (big part of funds), users can't return their assets (`amountSent > balanceOf(address(this))`:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/pool/PoolService.sol#L182\n##### Recommendation\nWe recommend adding a function for closing some account to return funds to LP.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#12-impossible-liquidity-removing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Calculation can be incorrect",
        "content": "##### Description\n`expectedLiquidity` contains real balance + pseudo balance from borrowers interest:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/pool/PoolService.sol#L396\n##### Recommendation\nWe recommend adding a function for forcing closing some accounts to pay all balance for LP.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#13-calculation-can-be-incorrect",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Impossible liquidation of broken account",
        "content": "##### Description\nIn case transfer was reverted, then specific token can't be accounted as collateral, and also liquidator must not pay the fee for this token:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L593-L594\n##### Recommendation\nWe recommend not to accumulate `tv` and `tvw` in case transfer was reverted.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#14-impossible-liquidation-of-broken-account",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Using tokens with whitelist function",
        "content": "##### Description\nAt line: https://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L584-L593\n\nThe Gearbox protocol is assumed to use some tokens which have whitelist function ( ex. USDC, USDT) like a collateral. If this token will be blocked off-chain the Liquidates credit account function member of the `CreditManager` contract (https://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L300) will not work correctly because the internal function `_transferAssetsTo()` (https://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L584-L591) returns incorrect return value `totalValue`.\n\n*Example:*\n\n```solidity\nfunction _transferAssetsTo(\n        address creditAccount,\n        address to,\n        bool force\n    ) internal returns (uint256 totalValue, uint256 totalWeightedValue) {\n        totalValue = 0;\n        totalWeightedValue = 0;\n\n        uint256 tokenMask;\n        uint256 enabledTokens = creditFilter.enabledTokens(creditAccount);\n\n        for (uint256 i = 0; i < creditFilter.allowedTokensCount(); i++) {\n            tokenMask = 1 << i;\n            if (enabledTokens & tokenMask > 0) {\n                (\n                    address token,\n                    uint256 amount,\n                    uint256 tv,\n                    uint256 tvw\n                ) = creditFilter.getCreditAccountTokenById(creditAccount, i);\n                if (amount > 1) {\n                    // The condition is met, but the transfer will not occur\n                    // for blocked account\n                    _safeTokenTransfer(\n                        creditAccount,\n                        token,\n                        to,\n                        amount.sub(1),\n                        force\n                    );\n                    // In this case totalValue will not correct\n                    totalValue += tv;\n                    totalWeightedValue += tvw;\n                }\n            }\n        }\n```\n\n##### Recommendation\nUse solution where totalValue will not increase in case of unsuccessful transaction.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#15-using-tokens-with-whitelist-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Looping a linked list",
        "content": "##### Description\nAt the line: https://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/AccountFactory.sol#L40\nthere's a linked list called `_nextCreditAccount`.\nIn this list, the account address refers to the address of the next account. Thus, a chain of addresses linked to each other is formed.\nAt the  lines contracts/core/AccountFactory.sol#L248-L263 there's a `takeOut ()` function. It takes the credit account address from anywhere on the list and attaches it to the credit manager.\nAt the  lines: https://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/AccountFactory.sol#L186-L199\n\nthere's a function `returnCreditAccount ()`. It returns the credit account address in the tail of the `_nextCreditAccount` linked list.\nIn the `takeOut()` function there is no logic for checking and zeroing the link to the next account from the taken account address.\nWhen the taken address is returned to the tail of the list, it will contain the old value of the address. Loop through the list may occur when the function `_countCreditAccountsInStock ()` is used for the line: https://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/AccountFactory.sol#L352-L365.\n\n##### Recommendation\nIt is necessary to zero the next item from the linked list after the https://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/AccountFactory.sol#L260 line:\n```\n _nextCreditAccount[creditAccount] = address(0);\n```",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#16-looping-a-linked-list",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No checking of element properties when returning it to the list",
        "content": "##### Description\nAt the lines: https://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/AccountFactory.sol#L186-L199\nthere's a function `returnCreditAccount ()`. It returns the credit account address in the tail of the `_nextCreditAccount` linked list.\nFor the line: https://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/AccountFactory.sol#L192,\nthe check is made that the value of `since ()` is not equal to `block.number`.\nIf the address has never been registered in an `AccountFactory` it will pass this check too.\nBut this address will not be added to the `creditAccounts` array and the logic of the entire contract will be violated.\n\n##### Recommendation\nIt is necessary to make a code correction at the line contracts/core/AccountFactory.sol#L192:\n```\nICreditAccount(usedAccount).since() != block.number &&\nICreditAccount(usedAccount).since() > 0,\n```",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#17-no-checking-of-element-properties-when-returning-it-to-the-list",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`priceFeeds` can't be changed",
        "content": "##### Description\n`priceFeeds` can't be changed:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/oracles/PriceOracle.sol#L56\n##### Recommendation\nWe recommend adding a function for changing `priceFeeds`.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#1-pricefeeds-cant-be-changed",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Work with incorrect decimals",
        "content": "##### Description\nPrice feed can return price with not 18 decimals:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/oracles/PriceOracle.sol#L56\n##### Recommendation\nWe recommend to check decimals of the `priceFeeds[token]`.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#2-work-with-incorrect-decimals",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary inheritance from `Proxy`",
        "content": "##### Description\nAll functions for `yVault` called from proxy wouldn't work because the storage is not the same:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/integrations/yearn/YearnPriceFeed.sol#L17\n##### Recommendation\nWe recommend removing inheritance from `Proxy`.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#3-unnecessary-inheritance-from-proxy",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect input parameters",
        "content": "##### Description\nInput data is not checked for possible containing of zero addresses:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/integrations/yearn/YearnPriceFeed.sol#L24\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditFilter.sol#L113\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditFilter.sol#L597\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/LeverageActions.sol#L73\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L118\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/CurveV1.sol#L33\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/UniswapV2.sol#L28\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/UniswapV3.sol#L33\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/YearnV2.sol#L35\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/WETHGateway.sol#L85\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/WETHGateway.sol#L203\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/AccountFactory.sol#L298\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/AccountMining.sol#L27\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/ACLTrait.sol#L21\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/DataCompressor.sol#L58\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/ContractsRegister.sol#L36\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/ContractsRegister.sol#L66\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/tokens/GearToken.sol#L104\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/tokens/Vesting.sol#L43\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/pool/PoolService.sol#L102\n##### Recommendation\nWe recommend adding a check that input data is not equal to zero address.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#4-incorrect-input-parameters",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Too many rights for configurator",
        "content": "##### Description\nConfigurator has too many rights and can steal all user's funds:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditFilter.sol\n##### Recommendation\nWe recommend to use DAO for configurator.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#5-too-many-rights-for-configurator",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Length of input arrays not checked",
        "content": "##### Description\nLength of input arrays is not checked:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditFilter.sol#L297\n##### Recommendation\nWe recommend adding a check that lengths of arrays are equal.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#6-length-of-input-arrays-not-checked",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`path` length not checked",
        "content": "##### Description\n`path` length is not checked:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/LeverageActions.sol#L107\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/LeverageActions.sol#L494\n##### Recommendation\nWe recommend adding a check for `path` length.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#7-path-length-not-checked",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`wethGateway` can't be changed",
        "content": "##### Description\n`wethGateway` can't be changed, so in case of redeploy, all contracts must be redeployed too:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L123\n##### Recommendation\nWe recommend adding a function for updating `wethGateway`.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#8-wethgateway-cant-be-changed",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Account can be opened for zero address",
        "content": "##### Description\n`onBehalfOf` can be equal to zero address:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L180\n##### Recommendation\nWe recommend adding a check that `onBehalfOf` is not equal to zero address.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#9-account-can-be-opened-for-zero-address",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Malicious user can pay less to pool",
        "content": "##### Description\nMalicious user can add poisoned pool to `paths[i]` to minimize profits and pay less to pool:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L260\n##### Recommendation\nWe recommend checking the total value of user before transfers.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#10-malicious-user-can-pay-less-to-pool",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Transfer to zero address",
        "content": "##### Description\n`to` can be equal to zero address:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L338\n##### Recommendation\nWe recommend adding a check that `to != address(0)`.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#11-transfer-to-zero-address",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible transfer of 0 funds",
        "content": "##### Description\nFor liquidation `remainingFunds` can be equal to zero:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L434\n##### Recommendation\nWe recommend adding a check that `remainingFunds != 0` before transfer.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#12-possible-transfer-of-0-funds",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Usage of ERC777 token can block liquidation",
        "content": "##### Description\nMalicious user can use ERC777 token callbacks for blocking liquidation:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L433\n##### Recommendation\nWe recommend not to use ERC777 token as underlying token.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#13-usage-of-erc777-token-can-block-liquidation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect require",
        "content": "##### Description\nThe following check is incorrect, because after this function actual borrowed amount of user would be = `borrowedAmount.add(timeDiscountedAmount)`:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L649\n##### Recommendation\nWe recommend adding `timeDiscountedAmount` instead of `amount`.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#14-incorrect-require",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible incorrect setting value for `maxLeverageFactor`",
        "content": "##### Description\n`maxLeverageFactor` can be set to 0:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L722\n##### Recommendation\nWe recommend adding a check that `_maxLeverageFactor > 0`.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#15-possible-incorrect-setting-value-for-maxleveragefactor",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "User can approve any token",
        "content": "##### Description\nUser can approve any token:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L761\n##### Recommendation\nWe recommend adding a check that user can only approve allowable tokens.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#16-user-can-approve-any-token",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect length of input data",
        "content": "##### Description\n`paths.length` can be < `creditFilter.allowedTokensCount()`:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L816\n##### Recommendation\nWe recommend adding a check that arrays have equal lengths.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#17-incorrect-length-of-input-data",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`amount` must be > 1",
        "content": "##### Description\n`amount` must be > 1:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L821\n##### Recommendation\nWe recommend changing the check.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#18-amount-must-be-1",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`paths[i]` length not checked",
        "content": "##### Description\n`paths[i]` length is not checked, so underflow can occur:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L828\n##### Recommendation\nWe recommend checking `paths[i]` length.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#19-pathsi-length-not-checked",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Index not checked",
        "content": "##### Description\nIndex `i` must be less than `N_COINS`:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/CurveV1.sol#L40\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/CurveV1.sol#L58\n##### Recommendation\nWe recommend adding a check that `i < N_COINS`.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#20-index-not-checked",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible reentrancy",
        "content": "##### Description\nIn the following function reentrancy can occur:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/CurveV1.sol#L56\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/UniswapV2.sol#L55\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/UniswapV2.sol#L112\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/UniswapV3.sol#L49\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/UniswapV3.sol#L102\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/UniswapV3.sol#L152\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/UniswapV3.sol#L196\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/YearnV2.sol#L75\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/YearnV2.sol#L126\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/WETHGateway.sol#L107\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/WETHGateway.sol#L128\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/WETHGateway.sol#L159\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/WETHGateway.sol#L181\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/pool/PoolService.sol#L242\n##### Recommendation\nWe recommend to add a `nonReentrant` modificator.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#21-possible-reentrancy",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect parameter passed",
        "content": "##### Description\nCurve swap can return more than `min_dy`:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/CurveV1.sol#L82\n##### Recommendation\nWe recommend to use balance difference as a parameter for the function.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#22-incorrect-parameter-passed",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Function doesn't exist",
        "content": "##### Description\nFunction doesn't exist in Curve pool:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/CurveV1.sol#L100\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/CurveV1.sol#L116\n##### Recommendation\nWe recommend removing this function.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#23-function-doesnt-exist",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect function name",
        "content": "##### Description\nIncorrect function of Uniswap-V2 pool is called:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/UniswapV2.sol#L387\n##### Recommendation\nWe recommend changing the function name.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#24-incorrect-function-name",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`params.path` length not checked",
        "content": "##### Description\n`params.path` length is not checked, so underflow can occur in `_extractTokens()` function:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/UniswapV3.sol#L102\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/UniswapV3.sol#L200\n##### Recommendation\nWe recommend adding a check for the `params.path` length.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#25-paramspath-length-not-checked",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Balance not checked",
        "content": "##### Description\nBalance of `creditAccount` is not checked:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/YearnV2.sol#L83\n##### Recommendation\nWe recommend adding a check that `balanceBefore > 0`.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#26-balance-not-checked",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible assets loss",
        "content": "##### Description\nIf `repayAmount > amount`, this means that Gateway repays credit from its own assets:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/WETHGateway.sol#L191\n##### Recommendation\nWe recommend to call revert in case `repayAmount > amount`.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#27-possible-assets-loss",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`masterCreditAccount` remains uninitialized",
        "content": "##### Description\n`masterCreditAccount` remains uninitialized, so anybody can initialize it:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/AccountFactory.sol#L90\n##### Recommendation\nWe recommend to initialize `masterCreditAccount`.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#28-mastercreditaccount-remains-uninitialized",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Account remains connected to previous credit manager",
        "content": "##### Description\nAfter returning, credit account is still connected to previous credit manager:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/AccountFactory.sol#L196\n##### Recommendation\nWe recommend connecting account to factory after returning.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#29-account-remains-connected-to-previous-credit-manager",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary list initialization",
        "content": "##### Description\nInitialization of `_nextCreditAccount[tail]` if `tail == address(0)` is unnecessary:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/AccountFactory.sol#L241\n##### Recommendation\nWe recommend adding a check for this.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#30-unnecessary-list-initialization",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`head` can't be taken out",
        "content": "##### Description\n`prev` account for head doesn't exist:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/AccountFactory.sol#L257\n##### Recommendation\nWe recommend adding a special check for situation when `creditAccount == head`.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#31-head-cant-be-taken-out",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect update of list",
        "content": "##### Description\nList isn't updated properly:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/AccountFactory.sol#L260\n##### Recommendation\nWe recommend to add `_nextCreditAccount[creditAccount] = address(0);`",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#32-incorrect-update-of-list",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible duplication of data",
        "content": "##### Description\nIf configurator calls function several times, then data duplication is possible:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/AccountFactory.sol#L301\n##### Recommendation\nWe recommend adding a check that only new data is pushed to array.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#33-possible-duplication-of-data",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`merkleProof` length not checked",
        "content": "##### Description\n`merkleProof` length is not checked:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/AccountMining.sol#L64\n##### Recommendation\nWe recommend adding a check that `merkleProof.length > 0`.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#34-merkleproof-length-not-checked",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unable to remove pool or manager",
        "content": "##### Description\nPool or manager can't be removed:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/ContractsRegister.sol#L38\n##### Recommendation\nWe recommend adding functions for removing pools and managers.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#35-unable-to-remove-pool-or-manager",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`signatory` not checked",
        "content": "##### Description\n`signatory` not checked:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/tokens/GearToken.sol#L330\n##### Recommendation\nWe recommend adding a check that correct `signatory` was recovered.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#36-signatory-not-checked",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`delegatee` not checked",
        "content": "##### Description\nIt is possible that `currentDelegate == delegatee`:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/tokens/GearToken.sol#L407\n##### Recommendation\nWe recommend adding a check that `currentDelegate != delegatee`.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#37-delegatee-not-checked",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`expectedLiquidityLimit` can be equal to zero",
        "content": "##### Description\n`expectedLiquidityLimit` can be equal to zero:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/pool/PoolService.sol#L145\n##### Recommendation\nWe recommend to set value to `expectedLiquidityLimit` in constructor.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#38-expectedliquiditylimit-can-be-equal-to-zero",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible overflow can occur",
        "content": "##### Description\nPossible overflow can occur:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/pool/PoolService.sol#L145\n##### Recommendation\nWe recommend using safeMath for `expectedLiquidity() + amount`.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#39-possible-overflow-can-occur",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Transfer of 0 funds",
        "content": "##### Description\nIf `withdrawFee == 0`, then here 0 amount of asset transferred:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/pool/PoolService.sol#L191\n##### Recommendation\nWe recommend adding a check, so 0 funds wouldn't be transferred.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#40-transfer-of-0-funds",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`_timestampLU` can be equal to 0",
        "content": "##### Description\n`_timestampLU` can be equal to 0, for example in constructor:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/pool/PoolService.sol#L209\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/pool/PoolService.sol#L334\n##### Recommendation\nWe recommend checking it and use another calculation for this scenario.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#41-_timestamplu-can-be-equal-to-0",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Forbidden manager never can use pool",
        "content": "##### Description\nIf a credit manager was forbidden, then he can't use the pool and nobody can change it:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/pool/PoolService.sol#L443\n##### Recommendation\nWe recommend adding a function to allow usage of pool to forbidden managers.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#42-forbidden-manager-never-can-use-pool",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Address not checked",
        "content": "##### Description\n`_interestRateModel` can be equal to zero address:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/pool/PoolService.sol#L453\n##### Recommendation\nWe recommend adding necessary checks for model address.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#43-address-not-checked",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible overflow",
        "content": "##### Description\nIf overall amount of tokens on credit account is very big, then overflow can occur:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L593-L594\n##### Recommendation\nWe recommend to use safeMath.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#44-possible-overflow",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "User can't repay with force flag",
        "content": "##### Description\nIf some token was blocked on account, user can't close this account and must wait until account would be liquidated by someone:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L368\n##### Recommendation\nWe recommend adding a parameter for the repay function, so that user can repay account with force flag.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#45-user-cant-repay-with-force-flag",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Add condition",
        "content": "##### Description\nFor the line: https://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditFilter.sol#L159\nin the `allowToken ()` function, the existence of the `token` - `underlyingToken` pair is checked.\nBut it is better to immediately check if the value of this pair is greater than 0:\n```\nrequire(\nIPriceOracle(priceOracle).getLastPrice(token, underlyingToken) > 0, \nErrors.CF_TOKEN_IS_NOT_ALLOWED\n);\n```\n##### Recommendation\nIt is recommended to make corrections to the source code.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#46-add-condition",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Upgradeable `creditManager` params",
        "content": "##### Description\nUpgrade of `creditManager` params may lead to `creditAccount`s liquidation or break dependent protocols logic.\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L705\n##### Recommendation\nWe recommend restricting params changing.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#47-upgradeable-creditmanager-params",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary check",
        "content": "##### Description\nThis check is unnecessary if price is fetched from oracle:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditFilter.sol#L156\n##### Recommendation\nWe recommend removing this check.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#1-unnecessary-check",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary update",
        "content": "##### Description\nIf `contractToAdapter[targetContract] == adapter` , update is unnecessary:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditFilter.sol#L192\n##### Recommendation\nWe recommend adding additional check.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#2-unnecessary-update",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary initialization",
        "content": "##### Description\nNew `uint256` variables are equal to zero by default:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditFilter.sol#L297\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/DataCompressor.sol#L72\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/tokens/GearToken.sol#L107\n##### Recommendation\nWe recommend removing initialization.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#3-unnecessary-initialization",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary print to console",
        "content": "##### Description\nPrint to console can't be used in blockchain:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditFilter.sol#L343\n##### Recommendation\nWe recommend removing print to console.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#4-unnecessary-print-to-console",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "User can receive only ETH",
        "content": "##### Description\nUser can receive only ETH:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditManager.sol#L626\n##### Recommendation\nWe recommend adding a flag, so that users can choose asset for receiving (ETH or wETH).",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#5-user-can-receive-only-eth",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Tokens can be locked on account",
        "content": "##### Description\nSome tokens can be locked on account (for example USDT):\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/credit/CreditAccount.sol\n##### Recommendation\nWe recommend adding a function for transferring locked tokens to treasury, when account isn't used by manager.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#6-tokens-can-be-locked-on-account",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Print to console",
        "content": "##### Description\nThis code was used for testing:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/adapters/UniswapV3.sol#L230\n##### Recommendation\nWe recommend removing these lines.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#7-print-to-console",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary library for user types",
        "content": "##### Description\nUnnecessary library for user types:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/libraries/data/Types.sol\n##### Recommendation\nWe recommend moving each struct to contract where it uses.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#8-unnecessary-library-for-user-types",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`wethAddress` can be const",
        "content": "##### Description\n`wethAddress` can be const because it isn't changing:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/WETHGateway.sol#L31\n##### Recommendation\nWe recommend to set `wethAddress` as a constant.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#9-wethaddress-can-be-const",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary safeMath",
        "content": "##### Description\nsafeMath here is unnecessary:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/WETHGateway.sol#L192\n##### Recommendation\nWe recommend not to use safeMath here.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#10-unnecessary-safemath",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect comment",
        "content": "##### Description\nComment for this variable is incorrect:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/AccountFactory.sol#L54\n##### Recommendation\nWe recommend changing the comment.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#11-incorrect-comment",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Similar functions are used",
        "content": "##### Description\nFunctions with similar logic are used:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/ACL.sol#L28\n##### Recommendation\nWe recommend adding 1 function with bool parameter to set true/false.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#12-similar-functions-are-used",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`merkleRoot` can't be updated",
        "content": "##### Description\n`merkleRoot` can't be updated:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/AccountMining.sol#L28\n##### Recommendation\nWe recommend adding a function for updating `merkleRoot`.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#13-merkleroot-cant-be-updated",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "All functions can be merged",
        "content": "##### Description\nAll functions can be merged into one with `bytes32` parameter:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/AddressProvider.sol\n##### Recommendation\nWe recommend merging all functions into 1 with `bytes32` parameter.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#14-all-functions-can-be-merged",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Visibility not set",
        "content": "##### Description\nVisibility is not set:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/ContractsRegister.sol#L16\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/core/ContractsRegister.sol#L20\n##### Recommendation\nWe recommend to set visibility.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#15-visibility-not-set",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Event not emitting",
        "content": "##### Description\nAfter manager update, event is not emitting:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/tokens/GearToken.sol#L115\n##### Recommendation\nWe recommend to emit events after updating storage variables.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#16-event-not-emitting",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Range for variables not set",
        "content": "##### Description\nRange for variables is not set:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/tokens/Vesting.sol#L45\n##### Recommendation\nWe recommend to add allowable range for variables",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#17-range-for-variables-not-set",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Two variables can be merged",
        "content": "##### Description\n`started` can be merged with `cliffDuration`:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/tokens/Vesting.sol#L46\n##### Recommendation\nWe recommend merging `started` with `cliffDuration` into one variable.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#18-two-variables-can-be-merged",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary setting on each mint",
        "content": "##### Description\nSetting base URI on each mint is unnecessary:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/tokens/GearNFT.sol#L14\n##### Recommendation\nWe recommend moving setting of base URI to constructor.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#19-unnecessary-setting-on-each-mint",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary usage of variable",
        "content": "##### Description\n`withdrawFee = 100 - withdrawMultiplier`, so it is unnecessary to store this variable:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/pool/PoolService.sol#L191\n##### Recommendation\nWe recommend removing `withdrawFee` and send `underlyingTokensAmount.sub(amountSent)`.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#20-unnecessary-usage-of-variable",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Parameters not checked",
        "content": "##### Description\nInput parameters values are not checked:\nhttps://github.com/Gearbox-protocol/gearbox-contracts/blob/0ac33ba87212ce056ac6b6357ad74161d417158a/contracts/pool/LinearInterestRateModel.sol#L46\n##### Recommendation\nWe recommend adding allowable range for each parameter.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#21-parameters-not-checked",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The technical default of liquidity pool",
        "content": "##### Description\nIn some cases, the liquidity providers can do a mass withdraw requests. It may happen on pending protocol changes and so on. However, liquidity can not be withdrawn while it is in use by a credit account. In such case, some liquidity providers may be unable to withdraw their liquidity until credit account releases the liquidity.\n##### Recommendation\nWe recommend implementing a forced liquidation of credit accounts by withdraw request. Certainly, the liquidator should be fined and the borrower should be rewarded on such liquidation.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#22-the-technical-default-of-liquidity-pool",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Undesired side effects of address reusing",
        "content": "##### Description\nA credit account is reusing the same ethereum address for different borrowers. If this address is punished for some reason during activity of one borrower, the other borrower may suffer undesired side effects like having bad debt in protocols like Compound and so on.\n##### Recommendation\nWe recommend to abandon address reusing. One borrower - one ethereum address.",
        "protocol": "GearBox Protocol",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/README.md#23-undesired-side-effects-of-address-reusing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/GearBox%20Protocol/GearBox%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unused \"payable\"",
        "content": "##### Description\nAt line:\nhttps://github.com/tonkers-kuma/strategy-ssb/blob/e49d07a64ea0eb4f5a199c2bf9ea4c8aee2b313f/contracts/Strategy.sol#L133\n##### Recommendation\nWe recommend removing \"payable\".",
        "protocol": "Yearn Finance",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Strategy%20SSB/README.md#1-unused-payable",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Strategy%20SSB/Yearn%20Strategy%20SSB%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unused \"Address\"",
        "content": "##### Description\nAt line:\nhttps://github.com/tonkers-kuma/strategy-ssb/blob/e49d07a64ea0eb4f5a199c2bf9ea4c8aee2b313f/contracts/Strategy.sol#L21\n##### Recommendation\nWe recommend removing \"using Address for address\".",
        "protocol": "Yearn Finance",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Strategy%20SSB/README.md#2-unused-address",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Strategy%20SSB/Yearn%20Strategy%20SSB%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unused internal constant `weth`",
        "content": "##### Description\nThe internal constant `weth` is unused in the contract and inaccessible outside of the contract. Probably it can be removed.\n\nAt line:\nhttps://github.com/tonkers-kuma/strategy-ssb/blob/e49d07a64ea0eb4f5a199c2bf9ea4c8aee2b313f/contracts/Strategy.sol#L24\n##### Recommendation\nWe recommend to remove unused `weth`. ",
        "protocol": "Yearn Finance",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Strategy%20SSB/README.md#3-unused-internal-constant-weth",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Strategy%20SSB/Yearn%20Strategy%20SSB%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`sellRewards()` threshold values",
        "content": "##### Description\nAt lines\nhttps://github.com/tonkers-kuma/strategy-ssb/blob/e49d07a64ea0eb4f5a199c2bf9ea4c8aee2b313f/contracts/Strategy.sol#L295\nhttps://github.com/tonkers-kuma/strategy-ssb/blob/e49d07a64ea0eb4f5a199c2bf9ea4c8aee2b313f/contracts/Strategy.sol#L277 \n\nThe threshold values for selling reward tokens is probably unreasonably lower than gas amount required for token swap operation.\n\n##### Recommendation\nWe recommend to use reasonable threshold for amount of reward tokens.",
        "protocol": "Yearn Finance",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Strategy%20SSB/README.md#4-sellrewards-threshold-values",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Strategy%20SSB/Yearn%20Strategy%20SSB%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Same value is calculated in every loop iteration",
        "content": "##### Description\nValue of `decWant` is persistent during each iteration of loops at https://github.com/tonkers-kuma/strategy-ssb/blob/e49d07a64ea0eb4f5a199c2bf9ea4c8aee2b313f/contracts/Strategy.sol#L276 and at https://github.com/tonkers-kuma/strategy-ssb/blob/e49d07a64ea0eb4f5a199c2bf9ea4c8aee2b313f/contracts/Strategy.sol#L293 and therefore could be calculated outside the loop to save gas.\n##### Recommendation\nWe recommend to calculate value of `decWant` outside of loops in methods `harvestTrigger()` and `sellRewards()`.",
        "protocol": "Yearn Finance",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Strategy%20SSB/README.md#5-same-value-is-calculated-in-every-loop-iteration",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Strategy%20SSB/Yearn%20Strategy%20SSB%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Value of memory variable could be used instead of storage variable",
        "content": "##### Description\nValue of `maxAmountsIn[tokenIndex]` was set to a value of a memory variable `amountIn` at https://github.com/tonkers-kuma/strategy-ssb/blob/e49d07a64ea0eb4f5a199c2bf9ea4c8aee2b313f/contracts/Strategy.sol#L199. Therefore it's more gas-efficient to use value of a memory variable instead of storage varialbe.\n##### Recommendation\nWe recommend to use value of `amountIn` to evaluate if condition.",
        "protocol": "Yearn Finance",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Strategy%20SSB/README.md#6-value-of-memory-variable-could-be-used-instead-of-storage-variable",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Strategy%20SSB/Yearn%20Strategy%20SSB%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Malfunction on managed pools",
        "content": "##### Description\nOnce initialized, the strategy will not proceed further changes in tokens set of balancer pool. However, [pool of managed type](https://docs.balancer.fi/products/balancer-pools/managed-pools) can change its set of tokens. It can lead to undesired behaviour of the strategy. \n##### Recommendation\nWe recommend to perform check that pool is not `managed type` during strategy initialization, or at least describe this requirement.",
        "protocol": "Yearn Finance",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Strategy%20SSB/README.md#7-malfunction-on-managed-pools",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Strategy%20SSB/Yearn%20Strategy%20SSB%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unused `receive()` function",
        "content": "##### Description\nAt line\nhttps://github.com/tonkers-kuma/strategy-ssb/blob/e49d07a64ea0eb4f5a199c2bf9ea4c8aee2b313f/contracts/Strategy.sol#L422\n\nThe contract implements function to receive ether, however, the contract's logic does not implement any further use of ether. Any ether transferred to the contract will be frozen (unaccessible).\n\n##### Recommendation\nWe recommend to disable receiving of ether to the contract.",
        "protocol": "Yearn Finance",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Strategy%20SSB/README.md#8-unused-receive-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Strategy%20SSB/Yearn%20Strategy%20SSB%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Strategy's outstanding debt is not accounted in `adjustPosition()`",
        "content": "##### Description\nArgument `_debtOutstanding` is unused in method `adjustPosition()` at https://github.com/tonkers-kuma/strategy-ssb/blob/e49d07a64ea0eb4f5a199c2bf9ea4c8aee2b313f/contracts/Strategy.sol#L189. As a result, strategy joins pool with `amountIn` of want token that does not account strategy's outstanding debt.\n##### Recommendation\nWe recommend to calculate `amountIn` as following:\n```\nuint256 amountIn = Math.min(maxSingleDeposit, balanceOfWant().sub(_debtOutstanding));\n```",
        "protocol": "Yearn Finance",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Strategy%20SSB/README.md#9-strategys-outstanding-debt-is-not-accounted-in-adjustposition",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Strategy%20SSB/Yearn%20Strategy%20SSB%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`Balancer` LP token is not in `protected tokens` list",
        "content": "##### Description\n`BaseStrategy` implements `sweep()` function that can rescue accidently transferred tokens from being locked at the strategy. Tokens used by the strategy should be protected from being `sweep()`-ed. Such tokens should be enumerated by `protected tokens`. However, `balancer` LP tokens `bpt` are not in the `protected tokens` list https://github.com/tonkers-kuma/strategy-ssb/blob/e49d07a64ea0eb4f5a199c2bf9ea4c8aee2b313f/contracts/Strategy.sol#L262\n##### Recommendation\nWe recommend to add `bpt` token to the `protected tokens`",
        "protocol": "Yearn Finance",
        "report_date": "2021-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Strategy%20SSB/README.md#10-balancer-lp-token-is-not-in-protected-tokens-list",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Strategy%20SSB/Yearn%20Strategy%20SSB%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Withdraw \"with ratio\" without fee via reentrancy",
        "content": "##### Description\nTokens with callback e.g. ERC-777 allow easy reentrancy. \nUsers can exploit reentrancy to withdraw with non-equal proportions without fees when call `withdraw` \nafter the first transfer of [`depositFor`](https://github.com/1inch/fixed-rate-swap/blob/0b5a75e9f56e7d21c290dd28c59dc140dcbcc1d5/contracts/FixedRateSwap.sol#L136) or [`_swap`](https://github.com/1inch/fixed-rate-swap/blob/0b5a75e9f56e7d21c290dd28c59dc140dcbcc1d5/contracts/FixedRateSwap.sol#L321)\n\n##### Recommendation\nWe recommend adding nonReentrant modifier to all external functions.\n",
        "protocol": "1inch",
        "report_date": "2021-11-29",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Fixed%20Rate%20Swap/README.md#1-withdraw-with-ratio-without-fee-via-reentrancy",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Fixed%20Rate%20Swap/1inch%20Fixed%20Rate%20Swap%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Token exchange blocking",
        "content": "##### Description\nThere are two tokens on the balance of the contract.\nThe exchange of token 0 for token 1 is possible when there is token 1 on the contract balance.\nYou can block the exchange functionality if you constantly make a small balance of one of the tokens.\nThis check is on the line:\nhttps://github.com/1inch/fixed-rate-swap/blob/0b5a75e9f56e7d21c290dd28c59dc140dcbcc1d5/contracts/FixedRateSwap.sol#L92   \n\n##### Recommendation\nWe recommend adding an event so that you can record and correct such situations from the outside.\nOr you can automatically transfer tokens from another contract.\n",
        "protocol": "1inch",
        "report_date": "2021-11-29",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Fixed%20Rate%20Swap/README.md#1-token-exchange-blocking",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Fixed%20Rate%20Swap/1inch%20Fixed%20Rate%20Swap%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Duplicate code",
        "content": "##### Description\nDuplicate code, i.e. using the same code structures in several places. Combining these structures will improve your code. The use of duplicate code structures impairs the perception of the program logic and can easily lead to errors in subsequent code edits. Duplicate code violates SOLID (single responsibility, open\u2013closed, Liskov substitution, interface segregation \u0438 dependency inversion) software development principles.\nThe duplicate code is on the following lines:\n- https://github.com/1inch/fixed-rate-swap/blob/0b5a75e9f56e7d21c290dd28c59dc140dcbcc1d5/contracts/FixedRateSwap.sol#L171-L178\n- https://github.com/1inch/fixed-rate-swap/blob/0b5a75e9f56e7d21c290dd28c59dc140dcbcc1d5/contracts/FixedRateSwap.sol#L212-L220\n\n- https://github.com/1inch/fixed-rate-swap/blob/0b5a75e9f56e7d21c290dd28c59dc140dcbcc1d5/contracts/FixedRateSwap.sol#L346-L358\n- https://github.com/1inch/fixed-rate-swap/blob/0b5a75e9f56e7d21c290dd28c59dc140dcbcc1d5/contracts/FixedRateSwap.sol#L388-L400\n\n##### Recommendation\nWe recommend grouping duplicate parts of the source code in a private function.\n",
        "protocol": "1inch",
        "report_date": "2021-11-29",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Fixed%20Rate%20Swap/README.md#1-duplicate-code",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Fixed%20Rate%20Swap/1inch%20Fixed%20Rate%20Swap%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Impossible withdraw for smart contract",
        "content": "##### Description\nIf any smart contract deposits NFT to StakingRewardsV3 it must have `onERC721Received()` function or `withdraw()` will always revert:\nhttps://github.com/keep3r-network/StakingRewardsV3/tree/13ecc6966ae1a413f62224382bfd4d64b1a22351/contracts/StakingRewardsV3-1.sol#L256\n##### Recommendation\nWe recommend to use `transferFrom()` instead of `safeTransferFrom()`.",
        "protocol": "Keep3r.Network",
        "report_date": "2021-11-11",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/README.md#1-impossible-withdraw-for-smart-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/keep3r%20Staking%20Rewards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect update of `totalLiquidity`",
        "content": "##### Description\nIf user calls `deposit()` -> `withdraw()` -> `getReward()` then contract will incorrectly calculate `totalLiquidity` which will lead to incorrect calculations of rewards for users:\nhttps://github.com/keep3r-network/StakingRewardsV3/tree/13ecc6966ae1a413f62224382bfd4d64b1a22351/contracts/StakingRewardsV3-1.sol#L342\n##### Recommendation\nWe recommend to change the logic of `update` modificator, so that`totalLiquidity` would update only if NFT is possessed to this contract.",
        "protocol": "Keep3r.Network",
        "report_date": "2021-11-11",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/README.md#2-incorrect-update-of-totalliquidity",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/keep3r%20Staking%20Rewards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect calculation of `rewardPerLiquidity`",
        "content": "##### Description\nIf the first user deposits NFT after some time from `notify()` call, then `(lastTimeRewardApplicable() - lastUpdateTime)` always will be less than `DURATION` which leads to freezing some funds on the contract:\nhttps://github.com/keep3r-network/StakingRewardsV3/tree/13ecc6966ae1a413f62224382bfd4d64b1a22351/contracts/StakingRewardsV3-1.sol#L156\n##### Recommendation\nWe recommend to change the calculation of `rewardPerLiquidity`.",
        "protocol": "Keep3r.Network",
        "report_date": "2021-11-11",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/README.md#1-incorrect-calculation-of-rewardperliquidity",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/keep3r%20Staking%20Rewards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible ddos attack",
        "content": "##### Description\nMalicious user can front run `withdraw()` function to change the current price in pool, so user can lost all his rewards:\nhttps://github.com/keep3r-network/StakingRewardsV3/tree/13ecc6966ae1a413f62224382bfd4d64b1a22351/contracts/StakingRewardsV3-1.sol#L195\n##### Recommendation\nWe recommend to get an average price for this check.",
        "protocol": "Keep3r.Network",
        "report_date": "2021-11-11",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/README.md#2-possible-ddos-attack",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/keep3r%20Staking%20Rewards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Addresses not checked",
        "content": "##### Description\nInput addresses are not checked:\nhttps://github.com/keep3r-network/StakingRewardsV3/tree/13ecc6966ae1a413f62224382bfd4d64b1a22351/contracts/StakingRewardsV3-1.sol#L139\n##### Recommendation\nWe recommend to add a check that input addresses are not equal to zero address.",
        "protocol": "Keep3r.Network",
        "report_date": "2021-11-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/README.md#1-addresses-not-checked",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/keep3r%20Staking%20Rewards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Impossible situation",
        "content": "##### Description\n`_index >= _length` can't be `true`:\nhttps://github.com/keep3r-network/StakingRewardsV3/tree/13ecc6966ae1a413f62224382bfd4d64b1a22351/contracts/StakingRewardsV3-1.sol#L236\n##### Recommendation\nWe recommend to call `revert` if `_index >= _length` is equal to `true`.",
        "protocol": "Keep3r.Network",
        "report_date": "2021-11-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/README.md#2-impossible-situation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/keep3r%20Staking%20Rewards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`_lastUpdateTime` can be equal to zero",
        "content": "##### Description\n`_lastUpdateTime` can be equal to zero if user deposits NFT before the first call of `notify`:\nhttps://github.com/keep3r-network/StakingRewardsV3/tree/13ecc6966ae1a413f62224382bfd4d64b1a22351/contracts/StakingRewardsV3-1.sol#L337\n##### Recommendation\nWe recommend to add a check that user can't deposit before the first call of `notify`.",
        "protocol": "Keep3r.Network",
        "report_date": "2021-11-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/README.md#3-_lastupdatetime-can-be-equal-to-zero",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/keep3r%20Staking%20Rewards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Input parameters in `notify()` not checked",
        "content": "##### Description\n`notify()` can be called with `amount` equal to zero:\nhttps://github.com/keep3r-network/StakingRewardsV3/blob/13ecc6966ae1a413f62224382bfd4d64b1a22351/contracts/StakingRewardsV3-1.sol#L299\n##### Recommendation\nIt is recommended to add `require(amount > 0, \"Incorrect input data\")` in function `notify()`.",
        "protocol": "Keep3r.Network",
        "report_date": "2021-11-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/README.md#4-input-parameters-in-notify-not-checked",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/keep3r%20Staking%20Rewards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Function not used",
        "content": "##### Description\nFunction `max()` is not used in the contract:\nhttps://github.com/keep3r-network/StakingRewardsV3/tree/13ecc6966ae1a413f62224382bfd4d64b1a22351/contracts/StakingRewardsV3-1.sol#L9\n##### Recommendation\nWe recommend to remove this function.",
        "protocol": "Keep3r.Network",
        "report_date": "2021-11-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/README.md#1-function-not-used",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/keep3r%20Staking%20Rewards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Not enough comments",
        "content": "##### Description\nAll storage variables don't have comments, so it is harder to understand the code:\nhttps://github.com/keep3r-network/StakingRewardsV3/tree/13ecc6966ae1a413f62224382bfd4d64b1a22351/contracts/StakingRewardsV3-1.sol#L99\n##### Recommendation\nWe recommend to add comments for all storage variables.",
        "protocol": "Keep3r.Network",
        "report_date": "2021-11-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/README.md#2-not-enough-comments",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/keep3r%20Staking%20Rewards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Visibility not set",
        "content": "##### Description\nVisibility is not set explicitly for some storage variables:\nhttps://github.com/keep3r-network/StakingRewardsV3/tree/13ecc6966ae1a413f62224382bfd4d64b1a22351/contracts/StakingRewardsV3-1.sol#L102\n##### Recommendation\nWe recommend to explicitly set visibility for all storage variables.",
        "protocol": "Keep3r.Network",
        "report_date": "2021-11-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/README.md#3-visibility-not-set",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/keep3r%20Staking%20Rewards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`nonReentrant` modificator not used",
        "content": "##### Description\nAll functions which can be called by user don't have `nonReentrant` modificator:\nhttps://github.com/keep3r-network/StakingRewardsV3/tree/13ecc6966ae1a413f62224382bfd4d64b1a22351/contracts/StakingRewardsV3-1.sol#L208\n##### Recommendation\nWe recommend to add the `nonReentrant` modificator for each function which can be called by user (`deposit()`, `withdraw()`, `getRewards()`) to increase security of the contract.",
        "protocol": "Keep3r.Network",
        "report_date": "2021-11-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/README.md#4-nonreentrant-modificator-not-used",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/keep3r%20Staking%20Rewards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`require` without message",
        "content": "##### Description\nHere `require` does not use the message, so it is impossible to distinguish them:\nhttps://github.com/keep3r-network/StakingRewardsV3/tree/13ecc6966ae1a413f62224382bfd4d64b1a22351/contracts/StakingRewardsV3-1.sol#L211\nhttps://github.com/keep3r-network/StakingRewardsV3/blob/13ecc6966ae1a413f62224382bfd4d64b1a22351/contracts/StakingRewardsV3-1.sol#L250\nhttps://github.com/keep3r-network/StakingRewardsV3/blob/13ecc6966ae1a413f62224382bfd4d64b1a22351/contracts/StakingRewardsV3-1.sol#L300\n##### Recommendation\nWe recommend to add the message to `require`.",
        "protocol": "Keep3r.Network",
        "report_date": "2021-11-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/README.md#5-require-without-message",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/keep3r%20Staking%20Rewards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Meaningless function",
        "content": "##### Description\nMeaning of this function is unclear, because it only calls `notify()` with weird check of unused parameter:\nhttps://github.com/keep3r-network/StakingRewardsV3/tree/13ecc6966ae1a413f62224382bfd4d64b1a22351/contracts/StakingRewardsV3-1.sol#L294\n##### Recommendation\nWe recommend to remove this function.",
        "protocol": "Keep3r.Network",
        "report_date": "2021-11-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/README.md#6-meaningless-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/keep3r%20Staking%20Rewards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Rewrite `withdraw()` for saving gas",
        "content": "##### Description\nIn `withdraw()` function each call of the `withdraw(_tokens[i])` would trigger call of the `update` modificator:\nhttps://github.com/keep3r-network/StakingRewardsV3/blob/13ecc6966ae1a413f62224382bfd4d64b1a22351/contracts/StakingRewardsV3-1.sol#L287\n##### Recommendation\nIt is recommended to rewrite `withdraw()` function for saving some gas.",
        "protocol": "Keep3r.Network",
        "report_date": "2021-11-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/README.md#7-rewrite-withdraw-for-saving-gas",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/keep3r%20Staking%20Rewards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Changing the contract owner is not possible",
        "content": "##### Description\nThe `owner` parameter has the modificator `immutable` that locks any modifications after `constructor()` is called.\nhttps://github.com/keep3r-network/StakingRewardsV3/blob/13ecc6966ae1a413f62224382bfd4d64b1a22351/contracts/StakingRewardsV3-1.sol#L116\n##### Recommendation\nIt's not necessary, but we recommend to add the owner changing function.",
        "protocol": "Keep3r.Network",
        "report_date": "2021-11-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/README.md#8-changing-the-contract-owner-is-not-possible",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/keep3r%20Staking%20Rewards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Some gas save in `getRewards()` function",
        "content": "##### Description\nInside the loop of the `getRewards` call there is a call of the `getReward` function. This function has `update` modifier that updates state variables every time.\nhttps://github.com/keep3r-network/StakingRewardsV3/blob/13ecc6966ae1a413f62224382bfd4d64b1a22351/contracts/StakingRewardsV3-1.sol#L264\nIt's ok if we make single call `getReward(tokenId)` in transaction, but few calls in the loop will do the same things many times. Actually we need to run this code only once.\n##### Recommendation\nWe recommend to refactor function `getRewards()` for getting away of unnecessary and repeatting state modification in the loop.",
        "protocol": "Keep3r.Network",
        "report_date": "2021-11-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/README.md#9-some-gas-save-in-getrewards-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/keep3r%20Staking%20Rewards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Get rewards on withdraw",
        "content": "##### Description\nUser has to make the second call of `getReward` before or after `withdraw(tokenId)`:\nhttps://github.com/keep3r-network/StakingRewardsV3/blob/13ecc6966ae1a413f62224382bfd4d64b1a22351/contracts/StakingRewardsV3-1.sol#L257\n##### Recommendation\nWe recommend to add `getReward(tokenId)` inside `_withdraw(tokenId)`.",
        "protocol": "Keep3r.Network",
        "report_date": "2021-11-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/README.md#10-get-rewards-on-withdraw",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/keep3r%20Staking%20Rewards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Batch processing in the `collect`",
        "content": "##### Description\nThe smart contract likely owns multiple `tokenIds` which should be `collect`-ed. We can batch that job to save transaction number and gas:\nhttps://github.com/keep3r-network/StakingRewardsV3/blob/13ecc6966ae1a413f62224382bfd4d64b1a22351/contracts/StakingRewardsV3-1.sol#L159\n##### Recommendation\nWe recommend implementing the `collect` function to take array of `tokenId` as an argument.",
        "protocol": "Keep3r.Network",
        "report_date": "2021-11-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/README.md#11-batch-processing-in-the-collect",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Keep3r.Network/keep3r%20Staking%20Rewards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Improper handling of losses in Yearn DAI vault",
        "content": "##### Description\nThe strategy is using another Yearn vault to invest DAI to take profit from it. In some rare conditions, that vault can suffer losses. Such conditions are not properly handled.\n\n1. At the [prepareReturn](https://github.com/therealmonoloco/maker-dai-delegate/blob/97949a51062df956fd0172b7b1c778f66844b634/contracts/Strategy.sol#L303) the strategy is not reporting losses from `DAI yVault` until it is completely unable to conceal. As a result, losses are not fairly distributed between vault users. Some users may suffer unfair penalty on withdraw.\n2. At the [liquidatePosition](https://github.com/therealmonoloco/maker-dai-delegate/blob/97949a51062df956fd0172b7b1c778f66844b634/contracts/Strategy.sol#L407) in some conditions, the strategy can overreport losses while it still has enought assets to complete the liquidation request by rebalancing `DAI` debt/collaterial at the `Maker vault`.\n3. The losses in `DAI yVault` are never fixed, so even newcoming investors will not be able to take a profit until recent losses are compensated. On large losses it can take years to recover.\n##### Recommendation\nIt is recommended to implement manual function to fix losses at `DAI yVault`:\n1. To report losses to the parent vault\n2. To rebalance debt/collaterial at Maker vault to make DAI debt equals to DAI balance available to the strategy\n\nIn some rare conditions, the option to flash-borrow WANT tokens from \"the fixer\" can be required to proceed rebalance during a liquidity shortage.",
        "protocol": "Yearn Finance",
        "report_date": "2021-10-18",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Maker%20Dai%20Delegate/README.md#1-improper-handling-of-losses-in-yearn-dai-vault",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Maker%20Dai%20Delegate/Yearn%20Maker%20Dai%20Delegate%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Strategy migration reverts after Maker liquidation",
        "content": "##### Description\nUnlikely, but possible situation when `Maker` collateral will be liquidated. In this case all operations with collateral will be reverted because the owner would be changed. After the liquidation you can't migrate to a new strategy because `prepareMigration` will be reverted for the above reasons.\n\nhttps://github.com/therealmonoloco/maker-dai-delegate/blob/97949a51062df956fd0172b7b1c778f66844b634/contracts/Strategy.sol#L450\n\n##### Recommendation\nThe `Maker`'s contract does not provide any functionality for getting the collateral's owner by cdpId (for checking that the liquidation didn't happen). That's why you have to cautch all exceptions of transferCdp call by using try/catch functionality in Solidity (0.6 and higher) and check the security modifier error. \n",
        "protocol": "Yearn Finance",
        "report_date": "2021-10-18",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Maker%20Dai%20Delegate/README.md#2-strategy-migration-reverts-after-maker-liquidation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Maker%20Dai%20Delegate/Yearn%20Maker%20Dai%20Delegate%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary assert on immutable variable",
        "content": "##### Description\nAssertion `address(investmentToken) != address(want)` in `_buyInvestmentTokenWithWant` is not necessary during contract execution\n\nhttps://github.com/therealmonoloco/maker-dai-delegate/blob/97949a51062df956fd0172b7b1c778f66844b634/contracts/Strategy.sol#L855\n##### Recommendation\nIt is recommended to make this assertion in `initialize` function",
        "protocol": "Yearn Finance",
        "report_date": "2021-10-18",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Maker%20Dai%20Delegate/README.md#1-unnecessary-assert-on-immutable-variable",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Maker%20Dai%20Delegate/Yearn%20Maker%20Dai%20Delegate%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Gas optimization in `_convertInvestmentTokenToWant`",
        "content": "##### Description\nTwo of three calls to `_convertInvestmentTokenToWant` can be saved at [`estimatedTotalAssets`](https://github.com/therealmonoloco/maker-dai-delegate/blob/97949a51062df956fd0172b7b1c778f66844b634/contracts/Strategy.sol#L282) by regrouping the add/mul operations.\n##### Recommendation\nWe recommend to regroup the add/mul operations.",
        "protocol": "Yearn Finance",
        "report_date": "2021-10-18",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Maker%20Dai%20Delegate/README.md#2-gas-optimization-in-_convertinvestmenttokentowant",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Maker%20Dai%20Delegate/Yearn%20Maker%20Dai%20Delegate%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Decrease in the amount of tokens during exchange due to arithmetic overflow of a variable",
        "content": "##### Description\nAt the lines:\n- https://github.com/1inch/1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/UnoswapV3Router.sol#L166 \u0438 \n- https://github.com/1inch/1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/UnoswapV3Router.sol#L175 \na number with the type `uint256` is converted to a number with the type` int256`. This number is passed in the function parameter and, after conversion, is sent to the `UniswapV3Pool` contract.\nBut, if the value of the number is greater than the maximum value for the type `int256`, an arithmetic overflow will occur.\nThis is demonstrated by the following example: https://gist.github.com/mixbytes-audit/b471cc82105f856d1546ba638de20f4e.\nFor example, if you take the number `57896044618658097711785492504343953926634992332820282019728792003956564819970`, then after the conversion you get the value`-5789604461865809771178549250434395392663499233282028206672879199039`\nWe see a decrease in modulus of the initial value of the variable.\n\n##### Recommendation\nBefore lines 166 and 175, you need to check that the value of the number is less than the maximum value for the type `int256`.\n",
        "protocol": "1inch",
        "report_date": "2021-10-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V4/README.md#1-decrease-in-the-amount-of-tokens-during-exchange-due-to-arithmetic-overflow-of-a-variable",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V4/1Inch%20Aggregation%20Router%20V4%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Increase in the amount of tokens during exchange due to arithmetic overflow of a variable",
        "content": "##### Description\nAt the lines:\n- https://github.com/1inch/1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/UnoswapV3Router.sol#L170 \u0438 \n- https://github.com/1inch/1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/UnoswapV3Router.sol#L179 \nthe number with the type `int256` is converted to the number with the type` uint256`. The number is taken with a minus sign.\nBut before that, there is no check that the number is less than 0.\nIf we take a small positive value and apply the transformation `uint256(-amount)` to it, we get a very large value due to arithmetic overflow.\nThis is demonstrated by the following example https://gist.github.com/mixbytes-audit/b471cc82105f856d1546ba638de20f4e.\nFor example, if you take the number `1000`, then after conversion you get the value` 115792089237316195423570985008687907853269984665640564039457584007913129638936`.\nWe see an increase in the initial value of the variable.\n\n##### Recommendation\nBefore lines 166 and 175, you need to check the value of the variable for being less than 0.\nIf the value of the variable is positive, then do not do the conversion.\n",
        "protocol": "1inch",
        "report_date": "2021-10-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V4/README.md#2-increase-in-the-amount-of-tokens-during-exchange-due-to-arithmetic-overflow-of-a-variable",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V4/1Inch%20Aggregation%20Router%20V4%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No validation of the value of the variable `msg.value`",
        "content": "##### Description\nAt the lines https://github.com/1inch/1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/ClipperRouter.sol#L57-L68 \nprocessing of the input data is done before the exchange procedure.\n`ETH` is not required to work with `WETH` and regular tokens. But the user can inadvertently transfer it.\nIn this case, the user will lose these `ETH`.\nTo prevent this from happening, you need to add checks before lines 60 and 67:\n```solidity=\n require(msg.value == 0, \"CL1IN: wrong msg.value\");\n```\n\n##### Recommendation\nAdditional checks need to be added.\n",
        "protocol": "1inch",
        "report_date": "2021-10-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V4/README.md#3-no-validation-of-the-value-of-the-variable-msgvalue",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V4/1Inch%20Aggregation%20Router%20V4%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "There is no processing of the value returned by the function",
        "content": "##### Description\nWhen working with tokens according to the ERC-20 standard, it is necessary to check the values that return functions.\nIn some places it is not done. This can be seen on the following lines:\n- https://github.com/1inch/1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/ClipperRouter.sol#L58\n- https://github.com/1inch/1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/ClipperRouter.sol#L76\n- https://github.com/1inch/1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/AggregationRouterV4.sol#L152\n- https://github.com/1inch/1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/extensions/RouteWrapperExtension.sol#L36\n\n##### Recommendation\nIt is recommended to add processing of the value returned by the function.\n",
        "protocol": "1inch",
        "report_date": "2021-10-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V4/README.md#1-there-is-no-processing-of-the-value-returned-by-the-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V4/1Inch%20Aggregation%20Router%20V4%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Accessing an interface using the `uint256` type",
        "content": "##### Description\nAt the lines:\n- https://github.com/1inch/1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/UnoswapV3Router.sol#L163 \u0438 \n- https://github.com/1inch/1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/UnoswapV3Router.sol#L172 \nthe `IUniswapV3Pool` interface is called to call the `swap()` function.\nTo work through the interface, the value of the `pool` variable must be of type `address`.\nBut on the line https://github.com/1inch/1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/UnoswapV3Router.sol#L160 this variable is of type `uint256`.\nOther types must be cast to type `address`.\n\n##### Recommendation\nThe source code needs to be corrected.\n",
        "protocol": "1inch",
        "report_date": "2021-10-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V4/README.md#2-accessing-an-interface-using-the-uint256-type",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V4/1Inch%20Aggregation%20Router%20V4%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Zero-address checking",
        "content": "##### Description\nThe `_clipperPool` are assignments in constructor, but not checks to zero-address before:\nhttps://github.com/mixbytes/1inch.github.1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/ClipperRouter.sol#L25\n\n##### Recommendation\nIt is recommended to check  \n```solidity=\n    require(clipperExchange.theExchange() != address(0));\n```\n",
        "protocol": "1inch",
        "report_date": "2021-10-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V4/README.md#3-zero-address-checking",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V4/1Inch%20Aggregation%20Router%20V4%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Invalid function parameter",
        "content": "##### Description\nAt the lines https://github.com/1inch/1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/helpers/Permitable.sol#L16-L39 lines have a function for granting permissions to work with tokens from another address.\nThis function has an `amount` parameter, which is needed to transfer the number of tokens.\nBut on lines 22 and 25, permission is approved without using this parameter.\nThe number of tokens is also passed in the `permit` variable.\nThis logic can lead to errors when working with this function.\n\n##### Recommendation\nIt is recommended to refactor your source code.\n",
        "protocol": "1inch",
        "report_date": "2021-10-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V4/README.md#1-invalid-function-parameter",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V4/1Inch%20Aggregation%20Router%20V4%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The likelihood that anyone can use another approval",
        "content": "##### Description\nAll external functions of the smart contracts `UnoswapRouter`,` UnoswapV3Router` and `ClipperRouter` will be available after the deployment of the smart contract `AggregationRouterV4`.\nThere are functions that exchange tokens. Before this operation it is required that the user gives an approval to the address of the contract for the disposal of his tokens.\nFor example, we see it in this line: \nhttps://github.com/1inch/1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/ClipperRouter.sol#L67.\nBut there is some time between the `approve()` operation and the `swap()` operation. They are not done at the same time.\nIn between these events, an attacker can run the external function `uniswapV3SwapCallback()` located here:\nhttps://github.com/1inch/1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/UnoswapV3Router.sol#L83-L158.\nAs a parameter `calldata`, he can specify the necessary data for transferring tokens to his wallet on lines\nhttps://github.com/1inch/1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/UnoswapV3Router.sol#L148 and\nhttps://github.com/1inch/1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/UnoswapV3Router.sol#L155.\nHere `payer` will be the wallet address of the user who gave the `approve()`, but has not yet performed the data exchange.\n\n##### Recommendation\nIt is recommended to restrict the call of this function only from the Uniswap V3 pool.\n",
        "protocol": "1inch",
        "report_date": "2021-10-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V4/README.md#2-the-likelihood-that-anyone-can-use-another-approval",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V4/1Inch%20Aggregation%20Router%20V4%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The likelihood that anyone can withdraw tokens from the balance of the contract",
        "content": "##### Description\nAll external functions of the smart contracts `UnoswapRouter`,` UnoswapV3Router` and `ClipperRouter` will be available after the deployment of the smart contract `AggregationRouterV4`.\nAt the lines https://github.com/1inch/1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/UnoswapV3Router.sol#L151-L153 have a `rescueFunds()` function. It is needed for the owner of the contract so that he can withdraw any tokens from the balance of the contract.\nThus, it is assumed that there are tokens on the contract balance.\nAn attacker could run the external function `uniswapV3SwapCallback()` located here:\nhttps://github.com/1inch/1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/UnoswapV3Router.sol#L83-L158.\nAs a parameter `calldata`, he can specify the necessary data for transferring tokens to his wallet on lines\nhttps://github.com/1inch/1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/UnoswapV3Router.sol#L146 and\nhttps://github.com/1inch/1inch-contract/blob/93868c483180cf74fc2551568f0396938b3eeaa8/contracts/UnoswapV3Router.sol#L153.\n\n##### Recommendation\nIt is recommended to restrict the call of this function only from the Uniswap V3 pool.\n",
        "protocol": "1inch",
        "report_date": "2021-10-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V4/README.md#3-the-likelihood-that-anyone-can-withdraw-tokens-from-the-balance-of-the-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Aggregation%20Router%20V4/1Inch%20Aggregation%20Router%20V4%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Changing the shared variable can affect previous votes",
        "content": "##### Description\nAt the lines \nhttps://github.com/lidofinance/aragon-apps/blob/8c46da8704d0011c42ece2896dbf4aeee069b84a/apps/voting/contracts/Voting.sol#L126-L133 in the `unsafelyChangeVoteTime()` method is a change in the common for all voting variable `voteTime`.\nChanging this variable will extend or shorten the voting time on existing voting.\nThis will affect the voting results, because the process will not go as planned when creating a vote.\nSo this action is potentially dangerous and may bring the unexpected side effects.\n\n##### Recommendation\nIt is recommended to save the value of the variable `voteTime` in the structure `Vote`. \nThis will be done in the same way as for the `supportRequiredPct` and `minAcceptQuorumPct` variables.",
        "protocol": "Lido",
        "report_date": "2021-10-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Aragon%20Voting/README.md#1-changing-the-shared-variable-can-affect-previous-votes",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Aragon%20Voting/LIDO%20Aragon%20Voting%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect condition",
        "content": "##### Description\nAt the lines \nhttps://github.com/lidofinance/aragon-apps/blob/8c46da8704d0011c42ece2896dbf4aeee069b84a/apps/voting/contracts/Voting.sol#L382-L384 in the function `_canExecute()` condition is made:\n```solidity\n        if (vote_.executed) {\n            return false;\n        }\n```\nAt the lines \nhttps://github.com/lidofinance/aragon-apps/blob/8c46da8704d0011c42ece2896dbf4aeee069b84a/apps/voting/contracts/Voting.sol#L392-L394 in the function `_canExecute()` condition is made:\n```solidity\n        if (_isVoteOpen(vote_)) {\n            return false;\n        }\n```\nThis is equivalent to this code:\n```solidity\n        if (getTimestamp64() < vote_.startDate.add(voteTime) && !vote_.executed) {\n            return false;\n        }\n```\nThus, line 383 returns `false` for `vote_.executed`.\nAnd on line 393 the value `false` is returned with `!vote_.executed`.\n\nOn Lines 271-272 values are written:\n```solidity\n        open = _isVoteOpen(vote_);\n        executed = vote_.executed;\n```\nThis is equivalent to this code:\n```solidity\n        open = getTimestamp64() < vote_.startDate.add(voteTime) && !vote_.executed;\n        executed = vote_.executed;\n```\nSo on line 271 the value `!vote_.executed` is written.\nAnd on line 272 the value `vote_.executed` is written.\n\n##### Recommendation\nIt is recommended to remove the `&&!vote_.executed` check in the `_isVoteOpen()` function.",
        "protocol": "Lido",
        "report_date": "2021-10-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Aragon%20Voting/README.md#1-incorrect-condition",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Aragon%20Voting/LIDO%20Aragon%20Voting%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No variable check in initialize function",
        "content": "##### Description\nThere is no check of the variable in the initialize function at the line\n- https://github.com/lidofinance/aragon-apps/blob/8c46da8704d0011c42ece2896dbf4aeee069b84a/apps/voting/contracts/Voting.sol#L87.\nThe `token` variable is initialized in only one place.\nIf the value of the address variable `token` is equal to zero when the `initialize()` function is executed, then this smart contract will have to be reinstalled.\n\n##### Recommendation\nIt is recommended to add a check.",
        "protocol": "Lido",
        "report_date": "2021-10-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Aragon%20Voting/README.md#2-no-variable-check-in-initialize-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Aragon%20Voting/LIDO%20Aragon%20Voting%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Function parameter not used",
        "content": "##### Description\nAt the line \nhttps://github.com/lidofinance/aragon-apps/blob/8c46da8704d0011c42ece2896dbf4aeee069b84a/apps/voting/contracts/Voting.sol#L211, the `canForward()` function has 2 parameters. But the second parameter has no name and is not used anywhere.\nIn the `IForwarder` interface, the second parameter is called `evmCallScript`.\nThus, in a function from the interface, control must be delegated to the `_sender` address to execute the script.\nBut in fact, in the `Voting` contract, this function does not modify the data, but only outputs a boolean value with the result of checking the rights to create new votes for the address.\nThe second variable is not needed in the `Voting` contract.\n\n##### Recommendation\nIt is recommended to remove the second variable for the `canForward()` function.",
        "protocol": "Lido",
        "report_date": "2021-10-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Aragon%20Voting/README.md#3-function-parameter-not-used",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Aragon%20Voting/LIDO%20Aragon%20Voting%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possibility of gas overuse",
        "content": "##### Description\nAt the lines\n https://github.com/lidofinance/aragon-apps/blob/8c46da8704d0011c42ece2896dbf4aeee069b84a/apps/voting/contracts/Voting.sol#L331-L341\nif `voter` previosly voted `yea` and now voting `yea` again `vote_.yea` calculates twice: first it decreases and then it increases.\nAnd the same case occurs if `voter` previosly voted `nay` and now voting `nay`.\n\n##### Recommendation\nIt is recommended to add checking if `voter` previosly vote equals his curent vote.",
        "protocol": "Lido",
        "report_date": "2021-10-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Aragon%20Voting/README.md#4-possibility-of-gas-overuse",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Aragon%20Voting/LIDO%20Aragon%20Voting%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Duplicate code",
        "content": "##### Description\nAt the lines\n https://github.com/lidofinance/aragon-apps/blob/8c46da8704d0011c42ece2896dbf4aeee069b84a/apps/voting/contracts/Voting.sol#L84-L85 and 88, the variables are checked and initialized in the `initialize()` function.\nLines https://github.com/lidofinance/aragon-apps/blob/8c46da8704d0011c42ece2896dbf4aeee069b84a/apps/voting/contracts/Voting.sol#L101-L103 do the same in the `changeSupportRequiredPct()` function.\nThis duplicate code can be moved into a separate internal function.\n\n##### Recommendation\nIt is recommended to make refactoring of the source code.",
        "protocol": "Lido",
        "report_date": "2021-10-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Aragon%20Voting/README.md#1-duplicate-code",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Aragon%20Voting/LIDO%20Aragon%20Voting%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The source code intended for deployment should not contain `TODO` comments",
        "content": "##### Description\nAt the line \nhttps://github.com/lidofinance/aragon-apps/blob/8c46da8704d0011c42ece2896dbf4aeee069b84a/apps/voting/contracts/Voting.sol#L369 contains a comment with `TODO`.\nBut the deployed code needs to be improved, since it cannot be changed. There is no point in such comments.\n##### Recommendation\nIt is recommended to delete these comment.",
        "protocol": "Lido",
        "report_date": "2021-10-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Aragon%20Voting/README.md#2-the-source-code-intended-for-deployment-should-not-contain-todo-comments",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Aragon%20Voting/LIDO%20Aragon%20Voting%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Using function without any logic",
        "content": "##### Description\nAt `Voting.sol` using empty useless function at\n https://github.com/lidofinance/aragon-apps/blob/8c46da8704d0011c42ece2896dbf4aeee069b84a/apps/voting/contracts/Voting.sol#L191.\n\n##### Recommendation\nIt is recommended to comment it or delete.",
        "protocol": "Lido",
        "report_date": "2021-10-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Aragon%20Voting/README.md#3-using-function-without-any-logic",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Aragon%20Voting/LIDO%20Aragon%20Voting%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Using unsuitable visibility modifier",
        "content": "##### Description\nVisibility of a contract functions at:\n- https://github.com/lidofinance/aragon-apps/blob/8c46da8704d0011c42ece2896dbf4aeee069b84a/apps/voting/contracts/Voting.sol#L200\n- https://github.com/lidofinance/aragon-apps/blob/8c46da8704d0011c42ece2896dbf4aeee069b84a/apps/voting/contracts/Voting.sol#L224\n- https://github.com/lidofinance/aragon-apps/blob/8c46da8704d0011c42ece2896dbf4aeee069b84a/apps/voting/contracts/Voting.sol#L234\n- https://github.com/lidofinance/aragon-apps/blob/8c46da8704d0011c42ece2896dbf4aeee069b84a/apps/voting/contracts/Voting.sol#L252\n- https://github.com/lidofinance/aragon-apps/blob/8c46da8704d0011c42ece2896dbf4aeee069b84a/apps/voting/contracts/Voting.sol#L288\nwhich are not called internally from the same contract should be changed to `external` to save gas.\n\n##### Recommendation\nIt is recommended to change `public` to `external`.",
        "protocol": "Lido",
        "report_date": "2021-10-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Aragon%20Voting/README.md#4-using-unsuitable-visibility-modifier",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Aragon%20Voting/LIDO%20Aragon%20Voting%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No check of the address parameter for zero",
        "content": "##### Description\nAt line https://github.com/lidofinance/1inch-rewards-manager/blob/c2cd9665666deda9452fa9e3461fbf3537413945/contracts/RewardsManager.vy#L66, the `owner` variable is assigned the value of the `_to` parameter. \nBut, if by chance the value of the parameter turns out to be equal to zero, then the work of the following functions will be blocked:\n`set_rewards_period_duration()`, `recover_erc20()`.\n\n##### Recommendation\nIt is recommended to add a check for the variable `_to` for zero before line 66.\n",
        "protocol": "Lido",
        "report_date": "2021-09-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/1inch%20Rewards%20Manager/README.md#1-no-check-of-the-address-parameter-for-zero",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/1inch%20Rewards%20Manager/Lido%201inch%20Rewards%20Manager%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No logging of important events",
        "content": "##### Description\nLogging important actions makes it easier to maintain the project.\nBut in this smart contract it is not done for some important events.\nAt lines https://github.com/lidofinance/1inch-rewards-manager/blob/c2cd9665666deda9452fa9e3461fbf3537413945/contracts/RewardsManager.vy#L100-L120 for the `start_next_rewards_period()` external function this event logging is lacking.\nAt lines https://github.com/lidofinance/1inch-rewards-manager/blob/c2cd9665666deda9452fa9e3461fbf3537413945/contracts/RewardsManager.vy#L124-L131 for the external function `set_rewards_period_duration()` this event is not logged.\n\n##### Recommendation\nIt is recommended to add logging of important events.\n",
        "protocol": "Lido",
        "report_date": "2021-09-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/1inch%20Rewards%20Manager/README.md#2-no-logging-of-important-events",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/1inch%20Rewards%20Manager/Lido%201inch%20Rewards%20Manager%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No setter for the address of the interacting contract",
        "content": "##### Description\nAt line https://github.com/lidofinance/1inch-rewards-manager/blob/c2cd9665666deda9452fa9e3461fbf3537413945/contracts/RewardsManager.vy#L39 the `rewards_contract` variable is described.\nThis is the address of the `FarmingRewards` contract. Now there is no way to change its address. If new functionality is added to this contract, it will be necessary to reinstall the `RewardsManager` contract.\n\n##### Recommendation\nIt is recommended to add a method to change the value of the variable `rewards_contract`.\n",
        "protocol": "Lido",
        "report_date": "2021-09-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/1inch%20Rewards%20Manager/README.md#1-no-setter-for-the-address-of-the-interacting-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/1inch%20Rewards%20Manager/Lido%201inch%20Rewards%20Manager%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Test scripts problem",
        "content": "##### Description\nThis problem is not in the audit scope.\nThe following two tests do not work correctly:\n`test_owner_recovers_erc20_to_own_address` and `test_owner_recovers_erc20_zero_amount`.\n\n##### Recommendation\nIt is recommended to fix the tests.\n",
        "protocol": "Lido",
        "report_date": "2021-09-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/1inch%20Rewards%20Manager/README.md#2-test-scripts-problem",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/1inch%20Rewards%20Manager/Lido%201inch%20Rewards%20Manager%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No reporting on failed claimRewards attempt",
        "content": "##### Description\nWhile a user is in debtors list, any attempt to claim rewards will be [silently ignored](https://github.com/CreamFi/liquidity-mining/blob/e7caa316e8a206b60996c199f26047b388b4ea31/contracts/LiquidityMining.sol#L469).\n##### Recommendation\nIt is recommended to report the user that claim action has been failed because of bad debt.",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-09-20",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Liquidity%20Mining/README.md#1-no-reporting-on-failed-claimrewards-attempt",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Liquidity%20Mining/C.R.E.A.M%20Finance%20Liquidity%20Mining%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible incorrect initialization",
        "content": "##### Description\nIn the following function `_stETH` can be zero address:\nhttps://github.com/lidofinance/lido-dao/tree/ea6fa222004b88e6a24b566a51e5b56b0079272d/contracts/0.6.12/WstETH.sol#L39\n##### Recommendation\nWe recommend to add the following check:\n```solidity=\naddress(_stETH) != address(0), \"wstETH: incorrect address\");\n```",
        "protocol": "Lido",
        "report_date": "2021-09-07",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/WstETH/README.md#1-possible-incorrect-initialization",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/WstETH/Lido%20WstETH%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Working with values equal to zero",
        "content": "##### Description\n`wstETHAmount` or `stETHAmount` potentially can be zero:\nhttps://github.com/lidofinance/lido-dao/tree/ea6fa222004b88e6a24b566a51e5b56b0079272d/contracts/0.6.12/WstETH.sol#L56\nhttps://github.com/lidofinance/lido-dao/tree/ea6fa222004b88e6a24b566a51e5b56b0079272d/contracts/0.6.12/WstETH.sol#L73\n##### Recommendation\nWe recommend to add the following check:\n```solidity=\nrequire(wstETHAmount > 0, \"wstETH: stETH return 0 shares\");\n```",
        "protocol": "Lido",
        "report_date": "2021-09-07",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/WstETH/README.md#2-working-with-values-equal-to-zero",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/WstETH/Lido%20WstETH%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`stETH` can be paused",
        "content": "##### Description\n`stETH` can be paused, so all transfers would revert:\nhttps://github.com/lidofinance/lido-dao/tree/ea6fa222004b88e6a24b566a51e5b56b0079272d/contracts/0.6.12/WstETH.sol#L57\nhttps://github.com/lidofinance/lido-dao/tree/ea6fa222004b88e6a24b566a51e5b56b0079272d/contracts/0.6.12/WstETH.sol#L73\nhttps://github.com/lidofinance/lido-dao/tree/ea6fa222004b88e6a24b566a51e5b56b0079272d/contracts/0.6.12/WstETH.sol#L81\n##### Recommendation\nWe recommend to add the following check (for this check it is necessary to update interface):\n```solidity=\nrequire(!stETH.isStopped(), \"wstETH: transfer stopped\");\n```",
        "protocol": "Lido",
        "report_date": "2021-09-07",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/WstETH/README.md#3-steth-can-be-paused",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/WstETH/Lido%20WstETH%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unchecked returned value",
        "content": "##### Description\nReturned value for `transfer`, `transferFrom` not checked:\nhttps://github.com/lidofinance/lido-dao/tree/ea6fa222004b88e6a24b566a51e5b56b0079272d/contracts/0.6.12/WstETH.sol#L57\nhttps://github.com/lidofinance/lido-dao/tree/ea6fa222004b88e6a24b566a51e5b56b0079272d/contracts/0.6.12/WstETH.sol#L73\n##### Recommendation\nWe recommend to add a check like this:\n```solidity=\nrequire(stETH.transferFrom(msg.sender, address(this), _stETHAmount), \"wstETH: transfer fails\");\n```",
        "protocol": "Lido",
        "report_date": "2021-09-07",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/WstETH/README.md#4-unchecked-returned-value",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/WstETH/Lido%20WstETH%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect burning of shares",
        "content": "##### Description\nBurning of shares for `WstETH` contract from `stETH` contract can lead to block `unwrap` function for users:\nhttps://github.com/lidofinance/lido-dao/tree/ea6fa222004b88e6a24b566a51e5b56b0079272d/contracts/0.6.12/WstETH.sol#L69-L75\n##### Recommendation\nWe recommend to add a check to `Lido` contract, that Burner can't burn shares for `WstETH`.",
        "protocol": "Lido",
        "report_date": "2021-09-07",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/WstETH/README.md#5-incorrect-burning-of-shares",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/WstETH/Lido%20WstETH%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Transactions frontrunning",
        "content": "##### Description\nThe code in this line contains an error in calculation\nin line: https://github.com/1inch/fee-collector/blob/3c2626763fd829500496f15476d5e98fbdf4f574/contracts/FeeCollector.sol#L360\n\n`uint256 returnAmount = amount * tokenBalance / value(erc20);`\n   \nAccording to the formula, it is fixed price for the rest of  tokenBalance or whole amount, not the price for unit.\n\n*Example:\n\nSomeone(something) makes updateReward for 10 WETH - user1\nLet's assume now we have minimal price after a long period of time\n\nCurrent price is 100 Inch for  10 WETH\nuser2 and user3 are atackers\n\nUser4 wants to make a full trade. He wants to buy 10 WETH for 100 1Inch. He wants make a transaction \n\nattacker puts the next transaction before User4\nUser2 updateReward with ~101010 WETH\nthe price is changed\nUser3 trades after User2 ~101010.mul(price) \nUser2 executes trade\nattacker has a profit equal ~1.4 WETH\n\nUser4 got ~8.6 WETH. 1.4 WETH less that expected*\n\n*Example 2\n\nLet's assume, now we have minimal price after a long period of time\nSomeone(something) makes updateReward for 10 WETH - user1\nCurrent price is 100 Inch for  10 WETH\n\nUser2 and User3 want to make partial trade. They want to buy 5 WETH for 50 1Inch. They make a transaction at approximately the same time\n\n\nUser2 trades first and gets 5 WETH and spends ~50 1Inch. OK\nUser3 trades after User 2.5WETH  and spends ~50 Inch.  Not correct\n\nUser1 never gets his 1Inch because User3 or nobody wants to  make this incorrect transaction\n\nIn case User3 makes transaction for 5 WETH and ~spends 100 1Inch, User1 will receive ~2 times more 1Inch than excpected*\n\n##### Recommendation\nImplement correct returnAmount calculation",
        "protocol": "1inch",
        "report_date": "2021-09-06",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Fee%20Collector/README.md#1-transactions-frontrunning",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Fee%20Collector/1Inch%20Fee%20Collector%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Not Possible to buy whole amount when the price is continuously changing",
        "content": "##### Description\nWhen the price is continuously changing it is not possible to set exact amount of token for buying the whole amount because the price is always decreasing and transation will be always reverted because we will have not enough rewarder tokens. \nIn case you set perspective price, you will have the same situation described in \u21161 critical case.\n##### Recommendation\nWe recommend to add functionality which allows us to set exact  `returnAmount` for rewarded token and set restriction for input tokens amount.",
        "protocol": "1inch",
        "report_date": "2021-09-06",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Fee%20Collector/README.md#1-not-possible-to-buy-whole-amount-when-the-price-is-continuously-changing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Fee%20Collector/1Inch%20Fee%20Collector%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Missing natspec documentation",
        "content": "##### Description\nSolidity contracts can use a special form of comments to provide rich documentation for functions, return variables and more. This special form is named the Ethereum Natural Language Specification Format (NatSpec).\n##### Recommendation\nIt is recommended to include natspec documentation and follow the doxygen style including @author, @title, @notice, @dev, @param, @return and make it easier to review and understand your smart contract.",
        "protocol": "1inch",
        "report_date": "2021-09-06",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Fee%20Collector/README.md#1-missing-natspec-documentation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Fee%20Collector/1Inch%20Fee%20Collector%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible events are not emitting",
        "content": "##### Description\nIn the `trade()` function the state of smart contract is changed, but events are not emitted:\nhttps://github.com/1inch/fee-collector/blob/3c2626763fd829500496f15476d5e98fbdf4f574/contracts/FeeCollector.sol#L344\n##### Recommendation\nWe recommend to add emitting events for this function.",
        "protocol": "1inch",
        "report_date": "2021-09-06",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Fee%20Collector/README.md#2-possible-events-are-not-emitting",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Fee%20Collector/1Inch%20Fee%20Collector%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potentially re-entrancy weak code",
        "content": "##### Description\nAt the lines: https://github.com/1inch/fee-collector/blob/3c2626763fd829500496f15476d5e98fbdf4f574/contracts/FeeCollector.sol#L339-L342\nthe state changes inside `_updateReward` which happens AFTER:\n- `erc20.safeTransferFrom()`\nIt makes the method potentially weak for re-entry attack.\n##### Recommendation\nWe recommend to add  ReentrancyGuard modifier.\nor\nIt is recommended to change the order of calls in a common-way, change-state first, then external-call.",
        "protocol": "1inch",
        "report_date": "2021-09-06",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Fee%20Collector/README.md#3-potentially-re-entrancy-weak-code",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Fee%20Collector/1Inch%20Fee%20Collector%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible call for zero address",
        "content": "##### Description\nZero address don't checked in the following function:\nhttps://github.com/1inch/limit-order-protocol/tree/a14bde6a260458de5083cee117d734221e1cbc05/contracts/LimitOrderProtocol.sol#L145\nhttps://github.com/1inch/limit-order-protocol/tree/a14bde6a260458de5083cee117d734221e1cbc05/contracts/LimitOrderProtocol.sol#L349\n##### Recommendation\nWe recommend to add the following check:\n```solidity=\nrequire(targets[i] != address(0), \"LOP: incorrect address\");\n```",
        "protocol": "1inch",
        "report_date": "2021-09-06",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/README.md#1-possible-call-for-zero-address",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/1Inch%20Limit%20Order%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Cancel of already cancelled order",
        "content": "##### Description\nUser can cancel already filled order, so incorrect event would emit:\nhttps://github.com/1inch/limit-order-protocol/tree/a14bde6a260458de5083cee117d734221e1cbc05/contracts/LimitOrderProtocol.sol#L161\n##### Recommendation\nWe recommend to add the following check:\n```solidity=\nrequire(_remaining[orderHash] != 1, \"LOP: already filled\");\n```",
        "protocol": "1inch",
        "report_date": "2021-09-06",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/README.md#2-cancel-of-already-cancelled-order",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/1Inch%20Limit%20Order%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible reentrancy",
        "content": "##### Description\nIn the following function reentrancy can occur:\nhttps://github.com/1inch/limit-order-protocol/tree/a14bde6a260458de5083cee117d734221e1cbc05/contracts/LimitOrderProtocol.sol#L280-L345\n##### Recommendation\nWe recommend to add `nonReentrant` modificator.",
        "protocol": "1inch",
        "report_date": "2021-09-06",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/README.md#3-possible-reentrancy",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/1Inch%20Limit%20Order%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible filling of already filled order",
        "content": "##### Description\nUser can try to fill already filled order by mistake:\nhttps://github.com/1inch/limit-order-protocol/blob/a14bde6a260458de5083cee117d734221e1cbc05/contracts/LimitOrderProtocol.sol#L294\n##### Recommendation\nWe recommend to add the following check:\n```solidity=\nrequire(remainingMakerAmount > 0, \"LOP: already filled\");\n```",
        "protocol": "1inch",
        "report_date": "2021-09-06",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/README.md#4-possible-filling-of-already-filled-order",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/1Inch%20Limit%20Order%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible ddos attack",
        "content": "##### Description\nMalicious maker can block bots for filling order if he calls unbounded operation (infinite loop) in `notifyFillOrder`:\nhttps://github.com/1inch/limit-order-protocol/tree/a14bde6a260458de5083cee117d734221e1cbc05/contracts/LimitOrderProtocol.sol#L338\n##### Recommendation\nWe recommend to use gas limit for this function.",
        "protocol": "1inch",
        "report_date": "2021-09-06",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/README.md#5-possible-ddos-attack",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/1Inch%20Limit%20Order%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect signature can lead to incorrect call",
        "content": "##### Description\nIn the following function, if signature is incorrect and maker is a user, then this function would revert because of static call for user:\nhttps://github.com/1inch/limit-order-protocol/tree/a14bde6a260458de5083cee117d734221e1cbc05/contracts/LimitOrderProtocol.sol#L397\n##### Recommendation\nWe recommend to change function like this:\n```solidity=\nif (signature.length != 65 && signature.length != 64) { ... }\nelse {require(SilentECDSA.recover(orderHash, signature) == maker), \"LOP: incorrect signature\")}\n```",
        "protocol": "1inch",
        "report_date": "2021-09-06",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/README.md#6-incorrect-signature-can-lead-to-incorrect-call",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/1Inch%20Limit%20Order%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unclear check",
        "content": "##### Description\nIf user passes incorrect amount to filling the order, then this function reverts because of static call with zero parameters:\nhttps://github.com/1inch/limit-order-protocol/tree/a14bde6a260458de5083cee117d734221e1cbc05/contracts/LimitOrderProtocol.sol#L441\nhttps://github.com/1inch/limit-order-protocol/tree/a14bde6a260458de5083cee117d734221e1cbc05/contracts/LimitOrderProtocol.sol#L452\n##### Recommendation\nWe recommend to change the function like this:\n```solidity=\nrequire(order.getMakerAmount.length != 0, \"LOP: incorrect amount\");\n```",
        "protocol": "1inch",
        "report_date": "2021-09-06",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/README.md#7-unclear-check",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/1Inch%20Limit%20Order%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unclear field",
        "content": "##### Description\nMeaning of bits in `info` field in `OrderRFQ` structure is unclear:\nhttps://github.com/1inch/limit-order-protocol/tree/a14bde6a260458de5083cee117d734221e1cbc05/contracts/LimitOrderProtocol.sol#L59\n##### Recommendation\nWe recommend to add a comment like this:\n```solidity=\nuint256 info; // unused(128bit) expiration(64bit) slot(56bit) shift(8bit)\n```",
        "protocol": "1inch",
        "report_date": "2021-09-06",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/README.md#1-unclear-field",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/1Inch%20Limit%20Order%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`_MAX_SELECTOR` is too big",
        "content": "##### Description\nSelector with maximum value which used in this contract = uint32(IERC20.transferFrom.selector) + 4:\nhttps://github.com/1inch/limit-order-protocol/tree/a14bde6a260458de5083cee117d734221e1cbc05/contracts/LimitOrderProtocol.sol#L88\n##### Recommendation\nWe recommend to reduce `_MAX_SELECTOR`.",
        "protocol": "1inch",
        "report_date": "2021-09-06",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/README.md#2-_max_selector-is-too-big",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/1Inch%20Limit%20Order%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Syntax inconsistency",
        "content": "##### Description\nRFQ order shift calculation is different:\nhttps://github.com/1inch/limit-order-protocol/tree/a14bde6a260458de5083cee117d734221e1cbc05/contracts/LimitOrderProtocol.sol#L167\nhttps://github.com/1inch/limit-order-protocol/tree/a14bde6a260458de5083cee117d734221e1cbc05/contracts/LimitOrderProtocol.sol#L211\n##### Recommendation\nWe recommend to use the same calculation to increase readability ((orderInfo & 0xff) or (uint8(orderinfo)))",
        "protocol": "1inch",
        "report_date": "2021-09-06",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/README.md#3-syntax-inconsistency",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/1Inch%20Limit%20Order%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect message in require",
        "content": "##### Description\nMessage in require is incorrect:\nhttps://github.com/1inch/limit-order-protocol/tree/a14bde6a260458de5083cee117d734221e1cbc05/contracts/helpers/ERC721Proxy.sol#L15\n##### Recommendation\nWe recommend to change the message in require.",
        "protocol": "1inch",
        "report_date": "2021-09-06",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/README.md#4-incorrect-message-in-require",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/1Inch%20Limit%20Order%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect event field",
        "content": "##### Description\nIn `OrderFilled` event first field should be `taker` https://github.com/1inch/limit-order-protocol/blob/a14bde6a260458de5083cee117d734221e1cbc05/contracts/LimitOrderProtocol.sol#L48\n##### Recommendation\nWe recommend to rename `maker` to `taker`.",
        "protocol": "1inch",
        "report_date": "2021-09-06",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/README.md#5-incorrect-event-field",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/1Inch%20Limit%20Order%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possibility of cancel non-existing orders",
        "content": "##### Description\nUser can cancel any order with `makerAssetData` containing his address at `FROM_INDEX` index https://github.com/1inch/limit-order-protocol/blob/a14bde6a260458de5083cee117d734221e1cbc05/contracts/LimitOrderProtocol.sol#L157-L163\n##### Recommendation\nWe recommend to check order existing.",
        "protocol": "1inch",
        "report_date": "2021-09-06",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/README.md#6-possibility-of-cancel-non-existing-orders",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/1Inch%20Limit%20Order%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "User can deccrease allowance",
        "content": "##### Description\nUser can decrease allowance before fillOrder will be executed\n##### Recommendation\nAdd additional require for checking allowance for user before next lines.\nhttps://github.com/1inch/limit-order-protocol/blob/a14bde6a260458de5083cee117d734221e1cbc05/contracts/LimitOrderProtocol.sol#L206\nhttps://github.com/1inch/limit-order-protocol/blob/a14bde6a260458de5083cee117d734221e1cbc05/contracts/LimitOrderProtocol.sol#L305\nIt saves some gas in this case. Also it possible to add this checking on user side before transaction executing.",
        "protocol": "1inch",
        "report_date": "2021-09-06",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/README.md#7-user-can-deccrease-allowance",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Limit%20Order%20Protocol/1Inch%20Limit%20Order%20Protocol%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Duplicate voting functionality",
        "content": "##### Description\nEVMScriptExecutor has permissions for EasyTrack and Voting contracts to make financial transactions (finance contract). It is possible to create voting in this contracts at the same time. EasyTrack has permissions only for TrustedCaller. In voting contract every token holder able to do it and create Voting with own purposes\nat line https://github.com/lidofinance/easy-track/blob/ec694adb872877db814da960d96ce767ccbdf462/contracts/EvmScriptExecutor.sol#L71\n##### Recommendation\nWe recommend to split up functionality between EasyTrack and Voting contacts",
        "protocol": "Lido",
        "report_date": "2021-09-06",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Easy%20Track/README.md#1-duplicate-voting-functionality",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Easy%20Track/Lido%20Easy%20Track%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Missing address validation",
        "content": "##### Description\nA delegatecall on an callsScript address always returns true if callsScript is non-contract address.\nAt line https://github.com/lidofinance/easy-track/blob/ec694adb872877db814da960d96ce767ccbdf462/contracts/EvmScriptExecutor.sol#L80\n##### Recommendation\nWe recommend making the callsScript address constant or add check that callsScript is contract address in constructor.",
        "protocol": "Lido",
        "report_date": "2021-09-06",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Easy%20Track/README.md#2-missing-address-validation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Easy%20Track/Lido%20Easy%20Track%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No valid params",
        "content": "##### Description\nThere is some admin methods which don't check values:\n* `setMotionDuration` - `_motionDuration` may be too large https://github.com/lidofinance/easy-track/blob/ec694adb872877db814da960d96ce767ccbdf462/contracts/MotionSettings.sol#L23\n* `setMotionsCountLimit` \u2014 `_motionsCountLimit` may be zero https://github.com/lidofinance/easy-track/blob/ec694adb872877db814da960d96ce767ccbdf462/contracts/MotionSettings.sol#L40\nThis allows admin to make an incorrect configuration.\n##### Recommendation\nIf necessary, we recommend to insert additional checks.",
        "protocol": "Lido",
        "report_date": "2021-09-06",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Easy%20Track/README.md#1-no-valid-params",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Easy%20Track/Lido%20Easy%20Track%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Shorted root hash can be brute forced",
        "content": "##### Description\nMalicious user can brute force proof for case `leaf = _keccak128(abi.encodePacked(address(malicious_user), token.balanceOf(address(this))))` because root hash is shorted:\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop128.sol#L95\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop160.sol#L95\n##### Recommendation\nWe recommend to use only 256bit implementation of cumulative merkle drop, because it is a garauntee that hash collision wouldn't appear.",
        "protocol": "1inch",
        "report_date": "2021-08-26",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/README.md#1-shorted-root-hash-can-be-brute-forced",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/1Inch%20Cumulative%20Merkle%20Drop%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible incorrect initialization",
        "content": "##### Description\nIn `CumulativeMerkleDropXXX` constructor `token_` can be zero address:\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop128.sol#L21\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop.sol#L22\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop160.sol#L21\n##### Recommendation\nWe recommend to add the following check:\n```solidity=\nrequire(token_ != address(0), \"CMD: Incorrect address\");\n```",
        "protocol": "1inch",
        "report_date": "2021-08-26",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/README.md#1-possible-incorrect-initialization",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/1Inch%20Cumulative%20Merkle%20Drop%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Owner can set unlimited amount",
        "content": "##### Description\nOwner can set merkle root in which, for his account, allowed amount can be very big:\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop128.sol#L24-L27\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop.sol#L25-L28\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop160.sol#L24-L27\n##### Recommendation\nWe recommend to use multisig wallet for `owner`.",
        "protocol": "1inch",
        "report_date": "2021-08-26",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/README.md#2-owner-can-set-unlimited-amount",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/1Inch%20Cumulative%20Merkle%20Drop%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect change of the root",
        "content": "##### Description\nIn the following function it is possible to update root with the same value:\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop128.sol#L26\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop.sol#L27\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop160.sol#L26\n##### Recommendation\nWe recommend to add the following check:\n```solidity=\nrequire(merkleRoot_ != merkleRoot, \"CMD: Same root\");\n```",
        "protocol": "1inch",
        "report_date": "2021-08-26",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/README.md#3-incorrect-change-of-the-root",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/1Inch%20Cumulative%20Merkle%20Drop%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible work with uninitialized `merkleRoot`",
        "content": "##### Description\nIn the following function it is possible to `merkleRoot == 0`:\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop128.sol#L35\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop.sol#L36\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop160.sol#L36\n##### Recommendation\nWe recommend to add check, that `merkleRoot` was initialized.",
        "protocol": "1inch",
        "report_date": "2021-08-26",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/README.md#4-possible-work-with-uninitialized-merkleroot",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/1Inch%20Cumulative%20Merkle%20Drop%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`merkleProof` can has length == 0",
        "content": "##### Description\nIn the following function it is possible to `merkleProof.length == 0`:\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop128.sol#L39\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop.sol#L40\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop160.sol#L39\n##### Recommendation\nWe recommend to add the check on length of proof (`merkleProof.length == precalculated_value`) and also add following check:\n```solidity=\nrequire(merkleProof.length > 0, \"CMD: Incorrect proof\");\n```",
        "protocol": "1inch",
        "report_date": "2021-08-26",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/README.md#5-merkleproof-can-has-length-0",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/1Inch%20Cumulative%20Merkle%20Drop%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible insufficient balance",
        "content": "##### Description\n`token` balance of the contract can be less than `amount`:\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop128.sol#L48\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop.sol#L49\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop160.sol#L48\n##### Recommendation\nWe recommend to add the following check:\n```solidity=\nrequire(IERC20(token).balanceOf(address(this)) >= amount, \"CMD: Insufficient balance\");\n```",
        "protocol": "1inch",
        "report_date": "2021-08-26",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/README.md#6-possible-insufficient-balance",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/1Inch%20Cumulative%20Merkle%20Drop%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary use of safeMath",
        "content": "##### Description\n`cumulativeAmount` always greater than `preclaimed` because it is checked above:\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop128.sol#L47\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop.sol#L48\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop160.sol#L47\n##### Recommendation\nWe recommend to use uncheked {} math to safe some gas.",
        "protocol": "1inch",
        "report_date": "2021-08-26",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/README.md#1-unnecessary-use-of-safemath",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/1Inch%20Cumulative%20Merkle%20Drop%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Not enough comments",
        "content": "##### Description\nIn the following function many assembly operations are used without comments about their functionality:\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop128.sol#L74-L96\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop.sol#L60-L83\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop160.sol#L74-L96\n##### Recommendation\nWe recommend to add comments for each operation in assembly.",
        "protocol": "1inch",
        "report_date": "2021-08-26",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/README.md#2-not-enough-comments",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/1Inch%20Cumulative%20Merkle%20Drop%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unusable library",
        "content": "##### Description\nMerkleProof library is not used in this contract:\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop.sol#L14\n##### Recommendation\nWe recommend to remove this library from contract.",
        "protocol": "1inch",
        "report_date": "2021-08-26",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/README.md#3-unusable-library",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/1Inch%20Cumulative%20Merkle%20Drop%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect comment",
        "content": "##### Description\nComment for `MerkelRootUpdated` event is copied from `Claimed` event:\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/interfaces/ICumulativeMerkleDrop160.sol#L7\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/interfaces/ICumulativeMerkleDrop128.sol#L7\nhttps://github.com/1inch/cumulative-merkle-drop/tree/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/interfaces/ICumulativeMerkleDrop.sol#L7\n##### Recommendation\nWe recommend to change the comment.",
        "protocol": "1inch",
        "report_date": "2021-08-26",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/README.md#4-incorrect-comment",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/1Inch%20Cumulative%20Merkle%20Drop%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Public access",
        "content": "##### Description\nNext function can be internal:\nhttps://github.com/1inch/cumulative-merkle-drop/blob/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop.sol#L58\nhttps://github.com/1inch/cumulative-merkle-drop/blob/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop128.sol#L72\nhttps://github.com/1inch/cumulative-merkle-drop/blob/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop160.sol#L72\n##### Recommendation\nWe recommend to mark this function as `internal` in every `CumulativeMerkleDropXXX.sol` contract.",
        "protocol": "1inch",
        "report_date": "2021-08-26",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/README.md#5-public-access",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/1Inch%20Cumulative%20Merkle%20Drop%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Non-consistent number formatting",
        "content": "##### Description\nIn `verifyAsm` for 256 and 128 bit versions keccak argument is written in decimal format:\nhttps://github.com/1inch/cumulative-merkle-drop/blob/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop.sol#L78\nhttps://github.com/1inch/cumulative-merkle-drop/blob/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop128.sol#L92\nbut in 160 bit - in hex format\nhttps://github.com/1inch/cumulative-merkle-drop/blob/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop160.sol#L92\nThis fact may confuse readers of this code.\n##### Recommendation\nWe recommend to use single format.",
        "protocol": "1inch",
        "report_date": "2021-08-26",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/README.md#6-non-consistent-number-formatting",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/1Inch%20Cumulative%20Merkle%20Drop%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible gas savings",
        "content": "##### Description\nFunction `verifyAsm` costs a lot of gas, so it's meaningful to place checks before that function. We can place check for `preclaimed < cumulativeAmount`\nhttps://github.com/1inch/cumulative-merkle-drop/blob/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop.sol#L44\nhttps://github.com/1inch/cumulative-merkle-drop/blob/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop128.sol#L43\nhttps://github.com/1inch/cumulative-merkle-drop/blob/96fb63d0cbfea73603e7500961c71e8ab1fb8c10/contracts/CumulativeMerkleDrop160.sol#L43\nalso `amount <= IERC20(token).balanceOf(address(this))`.\n##### Recommendation\nWe recommend to place the following checks above `verifyAsm`:\n```solidity=\nrequire(preclaimed < cumulativeAmount, \"CMD: Nothing to claim\");\nrequire(amount <= IERC20(token).balanceOf(address(this)), \"CMD: Insufficient balance\");\n\n// Verify the merkle proof\nbytes16 leaf = _keccak128(abi.encodePacked(account, cumulativeAmount));\nrequire(verifyAsm(merkleProof, expectedMerkleRoot, leaf), \"CMD: Invalid proof\");\n```",
        "protocol": "1inch",
        "report_date": "2021-08-26",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/README.md#7-possible-gas-savings",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/Cumulative%20Merkle%20Drop/1Inch%20Cumulative%20Merkle%20Drop%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Invalid variable check",
        "content": "##### Description\nThe `_executeTransaction()` function in https://github.com/aave/governance-crosschain-bridges/blob/763ef5da8befff3a129443a3ff4ef7ca4d3bb446/contracts/BridgeExecutorBase.sol#L225 can be called several times from the `execute()` function in https://github.com/aave/governance-crosschain-bridges/blob/763ef5da8befff3a129443a3ff4ef7ca4d3bb446/contracts/BridgeExecutorBase.sol#L58.\nEach time the line https://github.com/aave/governance-crosschain-bridges/blob/763ef5da8befff3a129443a3ff4ef7ca4d3bb446/contracts/BridgeExecutorBase.sol#L248 checks the `value` and `msg.value` variables.\nBut this is not correct, because it is necessary to compare the sum of all values of the array of `values[]` and `msg.value` in the `execute()` function. \n\n##### Recommendation\nIt is recommended to do the correct check of the variable.\n",
        "protocol": "AAVE",
        "report_date": "2021-08-12",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V2/README.md#1-invalid-variable-check",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V2/Aave%20Governance%20Crosschain%20Bridges%20V2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible loss of assets",
        "content": "##### Description\nAt the line https://github.com/aave/governance-crosschain-bridges/blob/763ef5da8befff3a129443a3ff4ef7ca4d3bb446/contracts/BridgeExecutorBase.sol#L253, a call is made to the payable functions with the transfer of assets.\nBut it is not always possible to set the exact amount of an asset when making a transaction. Especially if the number has a lot of numbers after the decimal point.\nIt is convenient to transfer a value with a slightly larger amount of an asset during a transaction. But now there is no functionality in the contract to get the remaining asset back.\nAll additional assets will remain on the balance sheet of the contract. \n\n##### Recommendation\nIt is recommended to add functionality for the ability to withdraw assets from the contract balance.\n",
        "protocol": "AAVE",
        "report_date": "2021-08-12",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V2/README.md#1-possible-loss-of-assets",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V2/Aave%20Governance%20Crosschain%20Bridges%20V2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No check for zero address",
        "content": "##### Description\nAt the line https://github.com/aave/governance-crosschain-bridges/blob/763ef5da8befff3a129443a3ff4ef7ca4d3bb446/contracts/BridgeExecutorBase.sol#L207 is assigned to the variable `targets` of type `address`.\nBut there is no check for the value of this variable. If this variable is equal to zero, the transaction will fail.\n\n##### Recommendation\nIt is recommended to add a check for a zero address.\n",
        "protocol": "AAVE",
        "report_date": "2021-08-12",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V2/README.md#2-no-check-for-zero-address",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V2/Aave%20Governance%20Crosschain%20Bridges%20V2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Extra field in the structure",
        "content": "##### Description\nAt the line https://github.com/aave/governance-crosschain-bridges/blob/763ef5da8befff3a129443a3ff4ef7ca4d3bb446/contracts/BridgeExecutorBase.sol#L206 is assigned to the variable `actionsSet.id` of type `uint256`.\nBut this variable is not used anywhere else. In addition, this variable is duplicated on line https://github.com/aave/governance-crosschain-bridges/blob/763ef5da8befff3a129443a3ff4ef7ca4d3bb446/contracts/BridgeExecutorBase.sol#L205.\nWe will not be able to get the value of the `_actionsSets` variable without knowing the value of `actionsSetId` and there is no need to additionally store the value of `actionsSetId` in a variable of the `ActionsSet` type.\n\n##### Recommendation\nIt is recommended to remove the `id` field on the https://github.com/aave/governance-crosschain-bridges/blob/763ef5da8befff3a129443a3ff4ef7ca4d3bb446/contracts/interfaces/IBridgeExecutor.sol#L9 line from the `ActionsSet` structure.\n",
        "protocol": "AAVE",
        "report_date": "2021-08-12",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V2/README.md#3-extra-field-in-the-structure",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V2/Aave%20Governance%20Crosschain%20Bridges%20V2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "It is desirable to make an access modifier",
        "content": "##### Description\nAt the line https://github.com/aave/governance-crosschain-bridges/blob/763ef5da8befff3a129443a3ff4ef7ca4d3bb446/contracts/ArbitrumBridgeExecutor.sol#L36 uses check: \n`require(msg.sender == _ethereumGovernanceExecutor, 'UNAUTHORIZED_EXECUTOR');`. \nBut the code will be nicer if you use the access modifier:\n\n```solidity\nmodifier onlyEthereumGovernanceExecutor() {\n    require(msg.sender == _ethereumGovernanceExecutor, 'UNAUTHORIZED_EXECUTOR');\n    _;\n}\n```  \n\nAt the line https://github.com/aave/governance-crosschain-bridges/blob/763ef5da8befff3a129443a3ff4ef7ca4d3bb446/contracts/PolygonBridgeExecutor.sol#L36 uses check: \n`require(msg.sender == _fxChild, 'UNAUTHORIZED_CHILD_ORIGIN');`. \nBut the code will be nicer if you use the access modifier:\n\n```solidity\nmodifier onlyFxChild() {\n     require(msg.sender == _fxChild, 'UNAUTHORIZED_CHILD_ORIGIN');\n    _;\n}\n```  \n\n##### Recommendation\nIt is recommended to make access modifiers.\n",
        "protocol": "AAVE",
        "report_date": "2021-08-12",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V2/README.md#1-it-is-desirable-to-make-an-access-modifier",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V2/Aave%20Governance%20Crosschain%20Bridges%20V2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Redo the return value validation",
        "content": "##### Description\nAt the line https://github.com/aave/governance-crosschain-bridges/blob/763ef5da8befff3a129443a3ff4ef7ca4d3bb446/contracts/BridgeExecutorBase.sol#L256 checks the return value of the `success` variable after calling `call() `or `delegatecall()`.\nBut there is no check for the variable `resultData`.\nBoth variables are checked in the `Address` library at https://github.com/OpenZeppelin/openzeppelin-contracts/blob/release-v4.1/contracts/utils/Address.sol#L171-L188.\n\n##### Recommendation\nIt is recommended to modify the check of returned variables in accordance with the library from OpenZeppelin.\n",
        "protocol": "AAVE",
        "report_date": "2021-08-12",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V2/README.md#2-redo-the-return-value-validation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V2/Aave%20Governance%20Crosschain%20Bridges%20V2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Zero values",
        "content": "##### Description\nNo check for zero values at constructor for parameters `stakeToken` https://github.com/aave/incentives-proposal/blob/f6712e33db79210a7ae8106f7cfa1ce2adea8d69/contracts/incentives/StakedTokenIncentivesController.sol#L45 and `emissionManager` https://github.com/aave/incentives-proposal/blob/f6712e33db79210a7ae8106f7cfa1ce2adea8d69/contracts/incentives/DistributionManager.sol#L37\n##### Recommendation\nWe recommend to check for zero values",
        "protocol": "AAVE",
        "report_date": "2021-08-06",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Incentives%20Proposal/README.md#1-zero-values",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Incentives%20Proposal/Aave%20Incentives%20Proposal%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Local variable shadowing",
        "content": "##### Description\nAt the line\n- https://github.com/aave/incentives-proposal/blob/f6712e33db79210a7ae8106f7cfa1ce2adea8d69/contracts/incentives/DistributionManager.sol#L28\nand the lines:\n- https://github.com/aave/incentives-proposal/blob/f6712e33db79210a7ae8106f7cfa1ce2adea8d69/contracts/incentives/StakedTokenIncentivesController.sol#L57\n- https://github.com/aave/incentives-proposal/blob/f6712e33db79210a7ae8106f7cfa1ce2adea8d69/contracts/incentives/StakedTokenIncentivesController.sol#L92\n- https://github.com/aave/incentives-proposal/blob/f6712e33db79210a7ae8106f7cfa1ce2adea8d69/contracts/incentives/StakedTokenIncentivesController.sol#L113\n- https://github.com/aave/incentives-proposal/blob/f6712e33db79210a7ae8106f7cfa1ce2adea8d69/contracts/incentives/StakedTokenIncentivesController.sol#L123\n- https://github.com/aave/incentives-proposal/blob/f6712e33db79210a7ae8106f7cfa1ce2adea8d69/contracts/incentives/StakedTokenIncentivesController.sol#L134\n- https://github.com/aave/incentives-proposal/blob/f6712e33db79210a7ae8106f7cfa1ce2adea8d69/contracts/incentives/StakedTokenIncentivesController.sol#L186\n\ndetection of shadowing using `assets` local variables.\n\n##### Recommendation\nWe recommend renaming the local variables that shadow another component.\n",
        "protocol": "AAVE",
        "report_date": "2021-08-06",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Incentives%20Proposal/README.md#2-local-variable-shadowing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Incentives%20Proposal/Aave%20Incentives%20Proposal%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Balance drain with deposit/withdraw repeat",
        "content": "##### Description\nThe `deposit` and the `withdraw` are using different base value for conversion between vault shares into user deposits. The `withdraw` is based on [liquidity amount plus `free tokens`](https://github.com/mellow-finance/mellow-contracts/blob/702dc5a2a8a6dd70a3faf45838934321cacf4b49/contracts/LiquidityVault.sol#L198), however `deposit` is based on [liquidity amount only](https://github.com/mellow-finance/mellow-contracts/blob/702dc5a2a8a6dd70a3faf45838934321cacf4b49/contracts/LiquidityVault.sol#L126). The attacker can drain vault balance by making deposit/withdraw repeatedly. The exploit is provided.\n\n##### Recommendation\nIt is recommended to make accounting of deposit/withdraw operation properly",
        "protocol": "Mellow Finance",
        "report_date": "2021-07-19",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Mellow%20Finance/README.md#1-balance-drain-with-depositwithdraw-repeat",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Mellow%20Finance/Mellow%20Finance%20SCA.pdf"
    },
    {
        "title": "Possible withdraw unavailiability",
        "content": "##### Description\nThe amount of transferred out tokens are not accounted at the vault state while processing user withdrawals. This will cause attempt to withdraw incorrect (too large) amount and probable almost any withdrawals attempts will be reverted.\n##### Recommendation\nIt is recommended to make accounting of deposit/withdraw operation properly",
        "protocol": "Mellow Finance",
        "report_date": "2021-07-19",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Mellow%20Finance/README.md#1-possible-withdraw-unavailiability",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Mellow%20Finance/Mellow%20Finance%20SCA.pdf"
    },
    {
        "title": "Reversed expression of require() at `commitStrategyParams()`",
        "content": "##### Description\nThis code is requiring to be called **before** specified deadline. However, it should require to be called **after** the deadline.\n```solidity\nrequire(\n    (pendingStrategyParams[strategyId].unlockDate != 0) &&\n        (pendingStrategyParams[strategyId].unlockDate > block.timestamp),\n    \"L\"\n);\n```\n##### Recommendation\nIt is recommended to fix expression",
        "protocol": "Mellow Finance",
        "report_date": "2021-07-19",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Mellow%20Finance/README.md#1-reversed-expression-of-require-at-commitstrategyparams",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Mellow%20Finance/Mellow%20Finance%20SCA.pdf"
    },
    {
        "title": "Unability to withdraw profits from Position Manager",
        "content": "##### Description\nThe call parameters of positionManager.collect() prohibits collecting of profit. Only liquidity value will be collected.\n##### Recommendation\nIt is recommended to not use undesired limitation of amount to be collected",
        "protocol": "Mellow Finance",
        "report_date": "2021-07-19",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Mellow%20Finance/README.md#2-unability-to-withdraw-profits-from-position-manager",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Mellow%20Finance/Mellow%20Finance%20SCA.pdf"
    },
    {
        "title": "collectExitFees, collectPerformanceFees don't check transfer result",
        "content": "##### Description\n`freeTokens` value will be deceased even if token transfer fails\n\nhttps://github.com/mellow-finance/mellow-contracts/blob/702dc5a2a8a6dd70a3faf45838934321cacf4b49/contracts/LiquidityVault.sol#L478\nhttps://github.com/mellow-finance/mellow-contracts/blob/702dc5a2a8a6dd70a3faf45838934321cacf4b49/contracts/LiquidityVault.sol#L483\nhttps://github.com/mellow-finance/mellow-contracts/blob/702dc5a2a8a6dd70a3faf45838934321cacf4b49/contracts/LiquidityVault.sol#L516\nhttps://github.com/mellow-finance/mellow-contracts/blob/702dc5a2a8a6dd70a3faf45838934321cacf4b49/contracts/LiquidityVault.sol#L521\n##### Recommendation\nIt is recommended to use `safeTransfer` instead of `transfer`",
        "protocol": "Mellow Finance",
        "report_date": "2021-07-19",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Mellow%20Finance/README.md#3-collectexitfees-collectperformancefees-dont-check-transfer-result",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Mellow%20Finance/Mellow%20Finance%20SCA.pdf"
    },
    {
        "title": "Inproper copy-paste in `rebalance()`",
        "content": "##### Description\namount1Min value is copy-pasted from previous live without proper modification\nhttps://github.com/mellow-finance/mellow-contracts/blob/ec766bf844db0bce4b4adae63458fc08d02e21af/contracts/LiquidityVault.sol#L433\n\n```solidity\nClosePositionArgs({\n    strategyId: args.strategyId,\n    amount0Min: args.token0MinClose,\n    amount1Min: args.token0MinClose,\n    deadline: args.deadline\n})\n```\n##### Recommendation\nIt is recommended to fix amount1Min value",
        "protocol": "Mellow Finance",
        "report_date": "2021-07-19",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Mellow%20Finance/README.md#4-inproper-copy-paste-in-rebalance",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Mellow%20Finance/Mellow%20Finance%20SCA.pdf"
    },
    {
        "title": "Unused variable",
        "content": "##### Description\nState variable `factory` of `LiquidityVault` is used only during initialization in constructor. It is never used anywhere else in the contract.\n##### Recommendation\nIt is recommended to remove unused variable `factory` declaration and usage in constructor",
        "protocol": "Mellow Finance",
        "report_date": "2021-07-19",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Mellow%20Finance/README.md#1-unused-variable",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Mellow%20Finance/Mellow%20Finance%20SCA.pdf"
    },
    {
        "title": "Use `external` instead of `public` modifier",
        "content": "##### Description\nAt line:\nhttps://github.com/ransonhobbes/stardust/blob/c446b1f12f53fa75ea6c347daee1e15df562a81d/contracts/Treasury.sol#L79\nhttps://github.com/ransonhobbes/stardust/blob/c446b1f12f53fa75ea6c347daee1e15df562a81d/contracts/Treasury.sol#L120\n##### Recommendation\nWe recommend using `external` instead of `public` modifier for `deposit` and `redeem` functions because they are not called internally.",
        "protocol": "Urbit",
        "report_date": "2021-07-19",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Urbit/README.md#1-use-external-instead-of-public-modifier",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Urbit/Urbit%20Stardust%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "User can swap without FEE on small amounts",
        "content": "##### Description\nFixedFeeSwap has a method `_swap()` for exchanging tokens (https://github.com/mixbytes/1inch.github.feeswap/blob/ac5dbd4a5e46f501e0a4a728f1725095b11f3fbd/contracts/FixedFeeSwap.sol#L110-L115). `_swap()` takes a comission (https://github.com/mixbytes/1inch.github.feeswap/blob/ac5dbd4a5e46f501e0a4a728f1725095b11f3fbd/contracts/FixedFeeSwap.sol#L46-L48).\n\nBut there is another way to exchange tokens via `FFS` tokens. Flow:\n```\n// FixedFeeSwap has 1USDC, 1USDT\n\n// 1. User deposits 1USDT token\nawait this.fixedFeeSwap.deposit(ether('0'), ether('1'), { from: userAddress });\n\n// 2. User takes 1FFS tokens\n// 3. User withdraw 1FFS\nawait this.fixedFeeSwap.withdraw(ether('1'), { from: userAddress });\n\n// 4. User swapped part of USDT to USDC\n// USDT: -0.666666666666666\n// USDC: +0.333333333333334\n```\n\nThus, the user is able to exchange tokens without commission.\n\n##### Recommendation\nIf you think that these losses are significant for your business logic, we recommend rewriting the logic of `FixedFeeSwap`. ",
        "protocol": "1inch",
        "report_date": "2021-07-09",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/FixedFeeSwap/README.md#1-user-can-swap-without-fee-on-small-amounts",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/FixedFeeSwap/1Inch%20FixedFeeSwap%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Avoid transfer fee",
        "content": "##### Description\nPotentially, a token (for examle: USDT) can have a transfer fee. For example, there is ERC20 of USDT in `transfer`/`transferFrom`:\n```\nbalances[_to] = balances[_to].add(sendAmount);\nbalances[owner] = balances[owner].add(fee);\nbalances[_from] = balances[_from].sub(_value);\n```\n\nNowadays fee is zero for USDT. But this can change at any moment.\n\nThe `FixedFeeSwap` ignores this fee. For example, there is a next flow:\n1. User call `deposit` and pass 1USDT. `safeTransferFrom` 'll be called by `FixedFeeSwap` (https://github.com/mixbytes/1inch.github.feeswap/blob/ac5dbd4a5e46f501e0a4a728f1725095b11f3fbd/contracts/FixedFeeSwap.sol#L66).\n2. The contract'll get <1USDT (due to fee) but the user'll get 1FFS\n3. 1FFS is more than transferred to contract\n\n##### Recommendation\nWe recommend that you carefully approach the selection of tokens for `FixedFeeSwap`.",
        "protocol": "1inch",
        "report_date": "2021-07-09",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/FixedFeeSwap/README.md#2-avoid-transfer-fee",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/FixedFeeSwap/1Inch%20FixedFeeSwap%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Constants not used",
        "content": "##### Description:\nAt lines:\nhttps://github.com/mixbytes/1inch.github.feeswap/blob/ac5dbd4a5e46f501e0a4a728f1725095b11f3fbd/contracts/FixedFeeSwap.sol#L19-L20\nconstants `_DIRECTION_MASK` and ` _AMOUNT_MASK` are not used in the logic of this contract.\n\n##### Recommendation\nWe recommend removing them. ",
        "protocol": "1inch",
        "report_date": "2021-07-09",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/FixedFeeSwap/README.md#1-constants-not-used",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/FixedFeeSwap/1Inch%20FixedFeeSwap%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Check address is not `FixedFeeSwap`",
        "content": "##### Description\nIn `withdrawFor` and `_swap` there aren't checks for `to` variable:\n1. https://github.com/mixbytes/1inch.github.feeswap/blob/ac5dbd4a5e46f501e0a4a728f1725095b11f3fbd/contracts/FixedFeeSwap.sol#L110\n2. https://github.com/mixbytes/1inch.github.feeswap/blob/ac5dbd4a5e46f501e0a4a728f1725095b11f3fbd/contracts/FixedFeeSwap.sol#L78\n\nIf the user mistakenly specifies the address of the contract, then the funds will be lost forever in the contract.\n\n##### Recommendation\n\nWe recommend to add the next check in `withdrawFor()`, `_swap()`:\n```\nrequire(to != address(this), \"to address cannot be FixedFeeSwap\");\n```",
        "protocol": "1inch",
        "report_date": "2021-07-09",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/FixedFeeSwap/README.md#2-check-address-is-not-fixedfeeswap",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/FixedFeeSwap/1Inch%20FixedFeeSwap%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No validation of the address parameter value in contract constructor",
        "content": "##### Description\nThe variable is assigned the value of the constructor input parameter. But this parameter is not checked before this. If the value turns out to be zero, then it will be necessary to redeploy the contract, since there is no other functionality to set this variable.\n\n* At the line https://github.com/aave/governance-crosschain-bridges/blob/7f56e7ae63f30ba8dcd7ced6a11a34c2eb865a1d/contracts/BridgeExecutorBase.sol#L41 the `_guardian` variable is set to the value of the `guardian` input parameter.\n* At the line https://github.com/aave/governance-crosschain-bridges/blob/7f56e7ae63f30ba8dcd7ced6a11a34c2eb865a1d/contracts/PolygonBridgeExecutor.sol#L21 the `_fxRootSender` variable is set to the value of the `fxRootSender` input parameter.\n* At the line https://github.com/aave/governance-crosschain-bridges/blob/7f56e7ae63f30ba8dcd7ced6a11a34c2eb865a1d/contracts/PolygonBridgeExecutor.sol#L22 the `_fxChild` variable is set to the value of the `fxChild` input parameter.\n* At the line https://github.com/aave/governance-crosschain-bridges/blob/7f56e7ae63f30ba8dcd7ced6a11a34c2eb865a1d/contracts/ArbitrumBridgeExecutor.sol#L18 the `_ethereumGovernanceExecutor` variable is set to the value of the `ethereumGovernanceExecutor` input parameter.\n\n##### Recommendation\nIt is necessary to add a check of the input parameter to zero before initializing the variables.\n",
        "protocol": "AAVE",
        "report_date": "2021-06-17",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V1/README.md#1-no-validation-of-the-address-parameter-value-in-contract-constructor",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V1/Governance%20Crosschain%20Bridges%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Missing validation on relation",
        "content": "##### Description\nAt the lines https://github.com/aave/governance-crosschain-bridges/blob/7f56e7ae63f30ba8dcd7ced6a11a34c2eb865a1d/contracts/BridgeExecutorBase.sol#L34-L39 are working with the variables `minimumDelay` and `maximumDelay`. But nowhere is there a comparison of these variables with each other.\n\n##### Recommendation\nIt is recommended to add a check for comparing the values of variables between each other.\n",
        "protocol": "AAVE",
        "report_date": "2021-06-17",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V1/README.md#2-missing-validation-on-relation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V1/Governance%20Crosschain%20Bridges%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The value is assigned to a variable, but not used",
        "content": "##### Description\nAt the line https://github.com/aave/governance-crosschain-bridges/blob/7f56e7ae63f30ba8dcd7ced6a11a34c2eb865a1d/contracts/BridgeExecutorBase.sol#L202 sets the variable `_queuedActions[actionHash]` to `true` when tasks are queued.\nAt the line https://github.com/aave/governance-crosschain-bridges/blob/7f56e7ae63f30ba8dcd7ced6a11a34c2eb865a1d/contracts/BridgeExecutorBase.sol#L269 sets the variable `_queuedActions[actionHash]` to `false` to cancel the job.\nBut when executed on line https://github.com/aave/governance-crosschain-bridges/blob/7f56e7ae63f30ba8dcd7ced6a11a34c2eb865a1d/contracts/BridgeExecutorBase.sol#L235, no validation is made for the `_queuedActions[actionHash]` variable.\n\n##### Recommendation\nIt is recommended to add a check for the value of the `_queuedActions[actionHash]` variable before executing `delegatecall` and` call`.\n",
        "protocol": "AAVE",
        "report_date": "2021-06-17",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V1/README.md#3-the-value-is-assigned-to-a-variable-but-not-used",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V1/Governance%20Crosschain%20Bridges%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Caching the value will improve the code",
        "content": "##### Description\nAt the lines https://github.com/aave/governance-crosschain-bridges/blob/7f56e7ae63f30ba8dcd7ced6a11a34c2eb865a1d/contracts/BridgeExecutorBase.sol#L176-L183\nthe calculation of the same value is used many times. But the value of `targets.length` is easier to calculate only once at the very beginning and store it in a variable.\nThen work with this variable.\n\n##### Recommendation\nIt is recommended to optimize the code to use the cached value of the variable.\n",
        "protocol": "AAVE",
        "report_date": "2021-06-17",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V1/README.md#1-caching-the-value-will-improve-the-code",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V1/Governance%20Crosschain%20Bridges%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Confusing variable name",
        "content": "##### Description\nAt the line https://github.com/aave/governance-crosschain-bridges/blob/7f56e7ae63f30ba8dcd7ced6a11a34c2eb865a1d/contracts/BridgeExecutorBase.sol#L124, the function is called `getActionsSetState()`. But it is very difficult to understand when in one word there are two different concepts of `get` and` set` at once.\nFor example, the name `getCurrentState()` will be much clearer.\n\n##### Recommendation\nIt is recommended to rename this variable.\n",
        "protocol": "AAVE",
        "report_date": "2021-06-17",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V1/README.md#2-confusing-variable-name",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V1/Governance%20Crosschain%20Bridges%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Extra parameter for the method",
        "content": "##### Description\nAt the line https://github.com/aave/governance-crosschain-bridges/blob/9fd0609a2e14d546885f76211961f251d2e15cb9/contracts/PolygonBridgeExecutor.sol#L35, when calling the `processMessageFromRoot()` method, the `stateId` parameter is passed.\nBut then this variable is not used anywhere in the method.\n\n##### Recommendation\nIt is recommended to remove the unused parameter.\n",
        "protocol": "AAVE",
        "report_date": "2021-06-17",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V3/README.md#1-extra-parameter-for-the-method",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V3/Governance%20Crosschain%20Bridges%20V3%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Missing zero address check in constructor",
        "content": "##### Description\nAt the line https://github.com/aave/governance-crosschain-bridges/blob/9fd0609a2e14d546885f76211961f251d2e15cb9/contracts/BridgeExecutorBase.sol#L44\nmissing validation `_guardian` for zero address. It is important because contract has no tool to change `_guardian`.\n\n##### Recommendation\nIt is recommended to add zero address validation.\n",
        "protocol": "AAVE",
        "report_date": "2021-06-17",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V3/README.md#2-missing-zero-address-check-in-constructor",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V3/Governance%20Crosschain%20Bridges%20V3%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Immutable variable in access modifier",
        "content": "##### Description\nAt the line https://github.com/aave/governance-crosschain-bridges/blob/9fd0609a2e14d546885f76211961f251d2e15cb9/contracts/BridgeExecutorBase.sol#L22 used the `_guardian` variable in the access modifier. But it is initialized only once in the constructor and there is no other functionality to change. This can lead to unavailability to use `cancel()` method.\n\n##### Recommendation\nIt is recommended to add tool to change `_guardian` variable.\n",
        "protocol": "AAVE",
        "report_date": "2021-06-17",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V3/README.md#3-immutable-variable-in-access-modifier",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V3/Governance%20Crosschain%20Bridges%20V3%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No validation of the address variable during initialization",
        "content": "##### Description\nAt the lines \nhttps://github.com/aave/governance-crosschain-bridges/blob/9fd0609a2e14d546885f76211961f251d2e15cb9/contracts/PolygonBridgeExecutor.sol#L61\nand\nhttps://github.com/aave/governance-crosschain-bridges/blob/9fd0609a2e14d546885f76211961f251d2e15cb9/contracts/PolygonBridgeExecutor.sol#70\nchanges variables without validations on same addresses and zero address.\n\n##### Recommendation\nIt is recommended to add validation on same addresses and zero addresses:\n\nhttps://github.com/aave/governance-crosschain-bridges/blob/9fd0609a2e14d546885f76211961f251d2e15cb9/contracts/PolygonBridgeExecutor.sol#L61\n```solidity=\nrequire((fxRootSender != _fxRootSender) && (fxRootSender != address(0x0)));\n```\nhttps://github.com/aave/governance-crosschain-bridges/blob/9fd0609a2e14d546885f76211961f251d2e15cb9/contracts/PolygonBridgeExecutor.sol#L70\n```solidity=\nrequire((fxChild != _fxChild) && (fxChild != address(0x0)));\n```\n",
        "protocol": "AAVE",
        "report_date": "2021-06-17",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V3/README.md#1-no-validation-of-the-address-variable-during-initialization",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V3/Governance%20Crosschain%20Bridges%20V3%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Inappropriate documentation for the `receiveFunds()` function",
        "content": "##### Description\nAt the line\nhttps://github.com/aave/governance-crosschain-bridges/blob/9fd0609a2e14d546885f76211961f251d2e15cb9/contracts/BridgeExecutorBase.sol#L122\ndocumentation tag `@inheritdoc` references interface `IBridgeExecutor`, but the interface does not contain a function that is overridden by this function.\n\n##### Recommendation\nIt is recommended to add data to `IBridgeExecutor`.\n",
        "protocol": "AAVE",
        "report_date": "2021-06-17",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V3/README.md#2-inappropriate-documentation-for-the-receivefunds-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V3/Governance%20Crosschain%20Bridges%20V3%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Bad use of a variable",
        "content": "##### Description\nAt the line https://github.com/aave/governance-crosschain-bridges/blob/9fd0609a2e14d546885f76211961f251d2e15cb9/contracts/PolygonBridgeExecutor.sol#L39, when calling the `processMessageFromRoot()` method, the values of the `rootMessageSender` parameter and the private variable` _fxRootSender` are compared.\nIt would be logical to use this functionality if the value of the private variable `_fxRootSender` is unknown to anyone.\nBut due to the existence of the `getFxRootSender()` function, any user can read the value of the `_fxRootSender` variable.\nThis variable is not used anywhere else in the method. And it is not used in other functions either.\nIt can be assumed that this variable is only needed for additional validation when calling the `processMessageFromRoot ()` method.\nBut it is more correct to do this check before calling the `processMessageFromRoot()` method.\n\n##### Recommendation\nIt is recommended to transfer the `fxRootSender` variable from the https://github.com/aave/governance-crosschain-bridges/blob/9fd0609a2e14d546885f76211961f251d2e15cb9/contracts/PolygonBridgeExecutor.sol contract to the https://github.com/aave/governance-crosschain-bridges/blob/9fd0609a2e14d546885f76211961f251d2e15cb9/contracts/dependencies/polygonDependencies/fxportal/FxChild.sol contract.\nIn this case, the logic of using this variable will be clear.\n",
        "protocol": "AAVE",
        "report_date": "2021-06-17",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V3/README.md#3-bad-use-of-a-variable",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/Governance%20Crosschain%20Bridges%20V3/Governance%20Crosschain%20Bridges%20V3%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible assets loss",
        "content": "##### Description\nIn the current version of protocol, user can lose money if accidentally sends tx to proxy with `msg.value>0`:\nhttps://github.com/lidofinance/steth-price-feed/blob/459495f07c97d04f6e3839e7a3b32acfcade22ad/contracts/PriceFeedProxy.sol\n##### Recommendation\nWe know that in the future the smart contract under proxy possibly would have some logic with receiving/withdrawing assets but as now it is not supported we recommend to override `_beforeFallback` like this:\n```solidity=\nfunction _beforeFallback() internal override { \n    if (msg.value > 0) {\n        require(IsReceivingAllowed, \"Sending wei not allowed\");\n    }\n}\n```",
        "protocol": "Lido",
        "report_date": "2021-06-10",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Feed/README.md#1-possible-assets-loss",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Feed/Lido%20stETH%20Price%20Feed%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible admin control loss",
        "content": "##### Description\nIn the current version of protocol, admin can set address of a new admin to zero, which means that nobody can call admin functions after that:\nhttps://github.com/lidofinance/steth-price-feed/blob/459495f07c97d04f6e3839e7a3b32acfcade22ad/contracts/PriceFeedProxy.sol#L106\nhttps://github.com/lidofinance/steth-price-feed/blob/459495f07c97d04f6e3839e7a3b32acfcade22ad/contracts/StEthPriceFeed.vy#L151\n##### Recommendation\nWe recommend to add simple check:\n```solidity=\nrequire(newAdmin != 0, \"Incorrect admin address\");\n```",
        "protocol": "Lido",
        "report_date": "2021-06-10",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Feed/README.md#2-possible-admin-control-loss",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Feed/Lido%20stETH%20Price%20Feed%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect input parameters",
        "content": "##### Description\nIn the function for calculating price, relative difference `old` argument can be zero:\nhttps://github.com/lidofinance/steth-price-feed/blob/459495f07c97d04f6e3839e7a3b32acfcade22ad/contracts/StEthPriceFeed.vy#L58\n##### Recommendation\nWe recommend to add simple check:\n```python=\nassert old > 0, \"oracle price not init\"\n```",
        "protocol": "Lido",
        "report_date": "2021-06-10",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Feed/README.md#3-incorrect-input-parameters",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Feed/Lido%20stETH%20Price%20Feed%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Bad range for price change",
        "content": "##### Description\nIn the current version of feed smart contract, it is possible to set 100% (for assets with the same price it is very big range) allowed range for price change:\nhttps://github.com/lidofinance/steth-price-feed/blob/459495f07c97d04f6e3839e7a3b32acfcade22ad/contracts/StEthPriceFeed.vy#L162\n##### Recommendation\nWe recommend to change max allowed difference to `1000`.",
        "protocol": "Lido",
        "report_date": "2021-06-10",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Feed/README.md#4-bad-range-for-price-change",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Feed/Lido%20stETH%20Price%20Feed%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary payable modificator",
        "content": "##### Description\nIn the current version proxy constructor can receive assets, but does not use it anywhere:\nhttps://github.com/lidofinance/steth-price-feed/blob/459495f07c97d04f6e3839e7a3b32acfcade22ad/contracts/PriceFeedProxy.sol#L57\n##### Recommendation\nWe recommend to remove `payable` modificator.",
        "protocol": "Lido",
        "report_date": "2021-06-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Feed/README.md#1-unnecessary-payable-modificator",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Feed/Lido%20stETH%20Price%20Feed%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary check in constructor",
        "content": "##### Description\nIn the current version, proxy constructor contains unnecessary check:\nhttps://github.com/lidofinance/steth-price-feed/blob/459495f07c97d04f6e3839e7a3b32acfcade22ad/contracts/PriceFeedProxy.sol#L69\n##### Recommendation\nWe recommend to remove this check.",
        "protocol": "Lido",
        "report_date": "2021-06-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Feed/README.md#2-unnecessary-check-in-constructor",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Feed/Lido%20stETH%20Price%20Feed%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible incorrect initialization",
        "content": "##### Description\nIn the current version of feed contract, `initialize` function can be invoked only once and it can be done by anybody:\nhttps://github.com/lidofinance/steth-price-feed/blob/459495f07c97d04f6e3839e7a3b32acfcade22ad/contracts/StEthPriceFeed.vy#L31\n##### Recommendation\nWe recommend to deploy feed and proxy contracts in adjacent tx.",
        "protocol": "Lido",
        "report_date": "2021-06-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Feed/README.md#3-possible-incorrect-initialization",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Feed/Lido%20stETH%20Price%20Feed%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Events not emitting",
        "content": "##### Description\nIn the current version of feed contract after change of some storage variables events not emitting:\nhttps://github.com/lidofinance/steth-price-feed/blob/459495f07c97d04f6e3839e7a3b32acfcade22ad/contracts/StEthPriceFeed.vy#L117\nhttps://github.com/lidofinance/steth-price-feed/blob/459495f07c97d04f6e3839e7a3b32acfcade22ad/contracts/StEthPriceFeed.vy#L144\nhttps://github.com/lidofinance/steth-price-feed/blob/459495f07c97d04f6e3839e7a3b32acfcade22ad/contracts/StEthPriceFeed.vy#L155\n##### Recommendation\nWe recommend to add events and emit them in functions `update_safe_price`, `set_admin` and `set_max_safe_price_difference`.",
        "protocol": "Lido",
        "report_date": "2021-06-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Feed/README.md#4-events-not-emitting",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Feed/Lido%20stETH%20Price%20Feed%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No checks timestamp in `_update_safe_price`",
        "content": "##### Description\nCurrently `_update_safe_price` method (https://github.com/lidofinance/steth-price-feed/blob/459495f07c97d04f6e3839e7a3b32acfcade22ad/contracts/StEthPriceFeed.vy#L100) ignores information about `self.safe_price_timestamp`. So the intruder may manipulate with `safe_price_value` in one transaction.\n##### Recommendation\nWe recommend to add some minimum diff for `safe_price_timestamp`.",
        "protocol": "Lido",
        "report_date": "2021-06-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Feed/README.md#5-no-checks-timestamp-in-_update_safe_price",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Feed/Lido%20stETH%20Price%20Feed%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Storage collisions between implementation versions",
        "content": "##### Description\nIn future, if a developer changes order or types of variables in a new logic contract, it may be broken. More information about Storage Collisions you can find [here](https://docs.openzeppelin.com/upgrades-plugins/1.x/proxies#unstructured-storage-proxie).\n##### Recommendation\nWe recommend to add comment in the code of a logic contract about this collisions. ",
        "protocol": "Lido",
        "report_date": "2021-06-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Feed/README.md#6-storage-collisions-between-implementation-versions",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Feed/Lido%20stETH%20Price%20Feed%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Useless/insecure pause functionality into SpiritFactory",
        "content": "##### Description\nThe SpiritFactory contains implementation to pause / to lock swap operations. https://github.com/Layer3Org/spiritswap-core/blob/a23463f87fd3c7633e97fab5e8124b4499e1519e/SpiritFactory.sol#L499 However, that lock status is ignored inside PancakePair and can be easyly avoided by an attacker.\n##### Recommendation\nPlease note that PancakePair `swap()` function has unrestricted access. Any swap-related restrictions should be implemented inside the PancakePair instead of the other contracts. Depending on what is actually required, we recommend to move implementation of pause/lock into PancakePair or to remove it and save the gas.\n",
        "protocol": "SpiritSwap",
        "report_date": "2021-06-08",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/SpiritSwap/README.md#1-uselessinsecure-pause-functionality-into-spiritfactory",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/SpiritSwap/SpiritSwap-Core%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Function getMultiplier() can be restricted to \"pure\"",
        "content": "##### Description\nAt the line\nhttps://github.com/Layer3Org/spiritswap-core/blob/a23463f87fd3c7633e97fab5e8124b4499e1519e/SPIRITMasterChef.sol#L1251\nthe \"view\" modifier is used for function restriction, but when a function does not read any storage data, it's recommended to use \"pure\" modificator instead of \"view\".\n\n##### Recommendation\nUse \"pure\" modificator or inline function.",
        "protocol": "SpiritSwap",
        "report_date": "2021-06-08",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/SpiritSwap/README.md#1-function-getmultiplier-can-be-restricted-to-pure",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/SpiritSwap/SpiritSwap-Core%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "getReserves() contains unused function call",
        "content": "##### Description\nThis function \nhttps://github.com/Layer3Org/spiritswap-core/blob/a23463f87fd3c7633e97fab5e8124b4499e1519e/SpiritRouter.sol#L274\nhas unused pairFor() call\n##### Recommendation\nWe recommend to remove line 274",
        "protocol": "SpiritSwap",
        "report_date": "2021-06-08",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/SpiritSwap/README.md#2-getreserves-contains-unused-function-call",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/SpiritSwap/SpiritSwap-Core%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unsafe fee recipient addresses transition",
        "content": "##### Description\nThe setter functions of fee and developer fee address https://github.com/Layer3Org/spiritswap-core/blob/a23463f87fd3c7633e97fab5e8124b4499e1519e/SPIRITMasterChef.sol#L1360 does not do any check on new address. If a wrong address is accidentally used, there is no way to fix it anymore.\n##### Recommendation\nWe recommend to transfer ownership and fee addresses into two steps: approve by the old address and accept by a new address.",
        "protocol": "SpiritSwap",
        "report_date": "2021-06-08",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/SpiritSwap/README.md#3-unsafe-fee-recipient-addresses-transition",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/SpiritSwap/SpiritSwap-Core%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "YAM protocol incompliance/useless operation for YAM protocol compliance",
        "content": "##### Description\nThe SPIRIT token contains some code pieces for YAM protocol implementation. However, implementation is incomplete, e.g. withdrawal doesn\u2019t move delegation to the recipient.\n##### Recommendation\nWe recommend to complete or to remove YAM compliance implementation depending on whether is YAM implementation actually planned or not.",
        "protocol": "SpiritSwap",
        "report_date": "2021-06-08",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/SpiritSwap/README.md#4-yam-protocol-incomplianceuseless-operation-for-yam-protocol-compliance",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/SpiritSwap/SpiritSwap-Core%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Losses are not taken into account in the strategy",
        "content": "##### Description\nThe withdrawer from vault should incur the losses from liquidation caused by his own withdrawal. However, the [liquidatePosition()](https://github.com/orbxball/liquity-stability-pool/blob/c3fa76af0a4e2d5fd7132b8e24361d5b7439a75d/contracts/Strategy.sol#L307) is ignoring possible trove liquidation. Currenly liquidation will cause revert, but even if not, currently strategy is ignoring the case of trove liquidation. This may lead to improper accounting of user balances and possible locking of vault withdrawals.\n\n##### Recommendation\nIt is recommended to rewrite logic of `liquidatePosition()`  considering the liquidation.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-06-02",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Liquity%20Stability%20Pool/README.md#1-losses-are-not-taken-into-account-in-the-strategy",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Liquity%20Stability%20Pool/Liquity%20stability%20pool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Malfunction of strategy and entire vault on unexpected trove status",
        "content": "##### Description\nA *liquity trove* can be in one of several states: *nonExistent, active, closedByOwner, closedByLiquidation, closedByRedemption*. When the *trove* is in state different than *active*, any call to *ajdustTrove()* will fail. Unfortunately, the strategy does not implement proper handling of trove state. There is some scenarios that will cause trove to be in unexpected state: trove liquidation, full collaterial redemption and trove manual *[closing](https://github.com/orbxball/liquity-stability-pool/blob/c3fa76af0a4e2d5fd7132b8e24361d5b7439a75d/contracts/Strategy.sol#L374)* by priveleged user.\n\nThe [*_deposit()*](https://github.com/orbxball/liquity-stability-pool/blob/c3fa76af0a4e2d5fd7132b8e24361d5b7439a75d/contracts/Strategy.sol#L216) function is expected only two states: *zero* (which is *nonExistent*) and other (which is *active, closedByOwner, closedByLiquidation, closedByRedemption*). However, only *active* state is valid for *[adjustTrove](https://github.com/orbxball/liquity-stability-pool/blob/c3fa76af0a4e2d5fd7132b8e24361d5b7439a75d/contracts/Strategy.sol#L237)*, other three states will cause revert.\n\nThe *[liquidatePosition()](https://github.com/orbxball/liquity-stability-pool/blob/c3fa76af0a4e2d5fd7132b8e24361d5b7439a75d/contracts/Strategy.sol#L307)* function does not handle trove state. When trove is in any state except *active*, *liquidatePosition()* will revert on *[adjustTrove()](https://github.com/orbxball/liquity-stability-pool/blob/c3fa76af0a4e2d5fd7132b8e24361d5b7439a75d/contracts/Strategy.sol#L322)* call. This will break harvest() and withdraw() functions so strategy will become broken and should be manually removed from the vault to prevent blocking of any withdrawal from it.\n\n##### Recommendation\nIt is recommended to handle state of the trove properly.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-06-02",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Liquity%20Stability%20Pool/README.md#2-malfunction-of-strategy-and-entire-vault-on-unexpected-trove-status",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Liquity%20Stability%20Pool/Liquity%20stability%20pool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "There is no check on the result of the function",
        "content": "##### Description\nAccording to the ERC20 standard, the `approve()` function returns a boolean value. But in the contract on lines https://github.com/orbxball/liquity-stability-pool/blob/c3fa76af0a4e2d5fd7132b8e24361d5b7439a75d/contracts/Strategy.sol#L120-L123, after the call to the `_approveAll()` function, this values are not processed.     A situation may arise that a False will return. \n\n##### Recommendation\nIt is recommended to add a check of the return value.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-06-02",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Liquity%20Stability%20Pool/README.md#1-there-is-no-check-on-the-result-of-the-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Liquity%20Stability%20Pool/Liquity%20stability%20pool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The approval value obtained in the constructor may not be enough for the long term of the smart contract",
        "content": "##### Description\nAt line: https://github.com/orbxball/liquity-stability-pool/blob/c3fa76af0a4e2d5fd7132b8e24361d5b7439a75d/contracts/Strategy.sol#L115\nthe smart contract constructor call `_approveAll()` function for different tokens. But in the process of work, the obtained value will only decrease. If this value decreases to zero, then the tokens will remain locked in the contract forever.\n  \n##### Recommendation\nIt is recommended to add a function to increase the value of approvals.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-06-02",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Liquity%20Stability%20Pool/README.md#2-the-approval-value-obtained-in-the-constructor-may-not-be-enough-for-the-long-term-of-the-smart-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Liquity%20Stability%20Pool/Liquity%20stability%20pool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Overreportion of the losses",
        "content": "##### Description\nIn some rare conditions the liquidatePosition may report that all requested liquidity is lost even if no losses are actually suffered. Such liquidation may occur during harvest() and do a major overreporting to the vault and break its accounting. As no losses are suffered actually, this state can be fixed by migrating to a \"fixing\" strategy. However, the vault accounting will be invalid until manual interaction of the vault governance, and the vault shares will be underpriced.\n\n##### Recommendation\nTo fix overreporting\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-06-02",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Liquity%20Stability%20Pool/README.md#3-overreportion-of-the-losses",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Liquity%20Stability%20Pool/Liquity%20stability%20pool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unused variable",
        "content": "##### Description\nVariable [`_weth`](https://github.com/orbxball/liquity-stability-pool/blob/c3fa76af0a4e2d5fd7132b8e24361d5b7439a75d/contracts/Strategy.sol#L386) is unused.\n##### Recommendation\nIt is recommended to remove variable.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-06-02",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Liquity%20Stability%20Pool/README.md#1-unused-variable",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Liquity%20Stability%20Pool/Liquity%20stability%20pool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Repeated `provideToSP`",
        "content": "##### Description\n\n`spool.provideToSP` is executing in any condition https://github.com/orbxball/liquity-stability-pool/blob/c3fa76af0a4e2d5fd7132b8e24361d5b7439a75d/contracts/Strategy.sol#L234-L238\n\n##### Recommendation\nPut [line](https://github.com/orbxball/liquity-stability-pool/blob/c3fa76af0a4e2d5fd7132b8e24361d5b7439a75d/contracts/Strategy.sol#L234) out of if-else statement.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-06-02",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Liquity%20Stability%20Pool/README.md#2-repeated-providetosp",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Liquity%20Stability%20Pool/Liquity%20stability%20pool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary check in initialization",
        "content": "##### Description\nConstructor of the proxy contains unnecessary check:\nhttps://github.com/lidofinance/withdrawals-manager-stub/blob/c41292ed9c3be765d06c4249b9f2ad4d427b84bf/contracts/WithdrawalsManagerProxy.sol#L70\n##### Recommendation\nWe recommend to delete this check.",
        "protocol": "Lido",
        "report_date": "2021-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Withdrawals%20Manager%20Stub/README.md#1-unnecessary-check-in-initialization",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/Withdrawals%20Manager%20Stub/Lido%20Withdrawals%20Manager%20Stub%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "\"Sandwich attack\" on user withdrawal",
        "content": "##### Description\nIn some rare conditions, the strategy is using AMM DEX to [swap SNX to SUSD](https://github.com/jmonteer/yearnV2-strat-SNX-staking/blob/91b839df4a350d80cb583795bccafe0836fdb732/contracts/Strategy.sol#L348) inside of the user-handled transaction. This is vulnerable to the \"sandwich attack\".\n\n##### Recommendation\nAlthough vulnerability conditions are rare and hard to exploit, it is recommended to protect AMM DEX swap operations with slippage technique.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-05-24",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/SNX/README.md#1-sandwich-attack-on-user-withdrawal",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/SNX/SNX%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The approval value obtained in the constructor may not be enough for the long term of the smart contract",
        "content": "##### Description\nAt lines: https://github.com/jmonteer/yearnV2-strat-SNX-staking/blob/91b839df4a350d80cb583795bccafe0836fdb732/contracts/Strategy.sol#L79-L85\nthe smart contract constructor call `safeApproveA()` functions for different tokens. But in the process of work, the obtained value will only decrease. If this value decreases to zero, then the tokens will remain locked in the contract forever.\n  \n##### Recommendation\nIt is recommended to add a function to increase the value of approvals.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-05-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/SNX/README.md#1-the-approval-value-obtained-in-the-constructor-may-not-be-enough-for-the-long-term-of-the-smart-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/SNX/SNX%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Default max_loss on underlying vault",
        "content": "##### Description\nAt line: https://github.com/jmonteer/yearnV2-strat-SNX-staking/blob/91b839df4a350d80cb583795bccafe0836fdb732/contracts/Strategy.sol#L512  the `withdrawFromSUSDVault()` function is not specifying max_loss parameter. This can lead to unavailability of withdrawals.\n\n##### Recommendation\nTo implement function to change max_loss parameter by strategist.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-05-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/SNX/README.md#2-default-max_loss-on-underlying-vault",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/SNX/SNX%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Handling losses from underlying vault",
        "content": "##### Description\nThe underlying SUSD vault may suffer a permanent loss. This will lead to a loss of corresponding SNX. However, such loss is not fairly distributed across vault users. On the first withdrawals no loss will be reported but on a later withdrawal attempts the strategy will report major losses to any users.\n\n##### Recommendation\nTo implement some mechanics to fairly redistribute a losses.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-05-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/SNX/README.md#3-handling-losses-from-underlying-vault",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/SNX/SNX%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Probably incorrect using of `safeApprove`",
        "content": "##### Description\nAt line https://github.com/jmonteer/yearnV2-strat-SNX-staking/blob/91b839df4a350d80cb583795bccafe0836fdb732/contracts/Strategy.sol#L129 we see the single `safeApprove` without setting to zero. \n\n##### Recommendation\nSet approvement to zero before new approving\n```solidity\nIERC20(susd).safeApprove(address(newSusdVault), 0);\n```",
        "protocol": "Yearn Finance",
        "report_date": "2021-05-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/SNX/README.md#4-probably-incorrect-using-of-safeapprove",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/SNX/SNX%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Protected tokens",
        "content": "##### Description\nAt line: https://github.com/jmonteer/yearnV2-strat-SNX-staking/blob/91b839df4a350d80cb583795bccafe0836fdb732/contracts/Strategy.sol#L470-L475 we can't see any protected tokens. \n\n##### Recommendation\nWe recommended to add protected tokens in the array.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-05-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/SNX/README.md#5-protected-tokens",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/SNX/SNX%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Excessive  Gas usage",
        "content": "##### Description\nSecond method `_unlockedWant()` call at line https://github.com/jmonteer/yearnV2-strat-SNX-staking/blob/91b839df4a350d80cb583795bccafe0836fdb732/contracts/Strategy.sol#L260 is redundant and cost extra Gas. \nAlso, every access to synthetix  invokes `resolver()` to get Synthetix router. This value is static and doesn't require\ndynamic call. \n\n##### Recommendation\nIt is recommended to put second  `_unlockedWant` call under preceding `if` block after `reduceLockedCollateral` L255.\n\nIt is recomended to replace method `resolver` with variable (see [synthetix README](https://github.com/Synthetixio/synthetix/blob/develop/README.md)).\n```\n  constructor(IAddressResolver _snxResolver) public {\n    synthetixResolver = _snxResolver;\n  }\n```",
        "protocol": "Yearn Finance",
        "report_date": "2021-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/SNX/README.md#1-excessive-gas-usage",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/SNX/SNX%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Require without message",
        "content": "##### Description\nIn the following function if revert occurs then user doesn't receive any information:\nhttps://github.com/jmonteer/yearnV2-strat-SNX-staking/blob/91b839df4a350d80cb583795bccafe0836fdb732/contracts/Strategy.sol#L100\n\n##### Recommendation\nWe recommend to add message to require.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/SNX/README.md#2-require-without-message",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/SNX/SNX%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible gas saving",
        "content": "##### Description\nFunction `estimatedProfit` used only here https://github.com/jmonteer/yearnV2-strat-SNX-staking/blob/91b839df4a350d80cb583795bccafe0836fdb732/contracts/Strategy.sol#L148, contains conversion [`sUSDToWant`](https://github.com/jmonteer/yearnV2-strat-SNX-staking/blob/91b839df4a350d80cb583795bccafe0836fdb732/contracts/Strategy.sol#L566). Probably this conversion is redundant, it is possible to return `estimatedProfit` in `sUSD` and convert to want with `sUSD` balances at https://github.com/jmonteer/yearnV2-strat-SNX-staking/blob/91b839df4a350d80cb583795bccafe0836fdb732/contracts/Strategy.sol#L149, in this case, we will save one call to `_exchangeRates`.\n  \n##### Recommendation\nRename `estimatedProfit` to `estimatedProfitInSusd` and return it in `sUSD` and move `estimatedProfit` into `sUSDToWant`.\n```solidity\nbalanceOfWant().add(\n    sUSDToWant(\n        balanceOfSusdInVault().add(balanceOfSusd()).add(estimatedProfitInSusd())\n    )\n);\n```",
        "protocol": "Yearn Finance",
        "report_date": "2021-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/SNX/README.md#3-possible-gas-saving",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/SNX/SNX%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary gas usage",
        "content": "##### Description\nAt line: https://github.com/jmonteer/yearnV2-strat-SNX-staking/blob/91b839df4a350d80cb583795bccafe0836fdb732/contracts/Strategy.sol#L252 we see the row\n`uint256 unlockedWant = _unlockedWant();` and the same at line https://github.com/jmonteer/yearnV2-strat-SNX-staking/blob/91b839df4a350d80cb583795bccafe0836fdb732/contracts/Strategy.sol#L260. It is redundant.\n\n##### Recommendation\nMove refresh unlockedWand value into previous if() block.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-05-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/SNX/README.md#4-unnecessary-gas-usage",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/SNX/SNX%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Block header incorrect input",
        "content": "##### Description\nIn the function for extracting data from block header tx can fail without any information in case of incorrect input:\nhttps://github.com/lidofinance/curve-merkle-oracle/blob/ae093b308999a564ed3f23d52c6c5dce946dbfa7/contracts/StateProofVerifier.sol#L65\n\n##### Recommendation\nWe recommend to add following check:\n```solidity=\nrequire(headerFields.length > 11, \"INCORRECT_HEADER\");\n```\n",
        "protocol": "Lido",
        "report_date": "2021-05-14",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Oracle/README.md#1-block-header-incorrect-input",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Oracle/Lido%20stETH%20price%20oracle%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Possible zero price for token",
        "content": "##### Description\nIn the new version of the oracle smart contract, the price for stETH = 0 until user calls the `submitState` function:\nhttps://github.com/lidofinance/curve-merkle-oracle/blob/ae093b308999a564ed3f23d52c6c5dce946dbfa7/contracts/StableSwapStateOracle.sol#L268\n\n##### Recommendation\nWe recommend to add following check:\n```solidity=\nrequire(stethPrice > 0, \"PRICE_NOT_INITIALIZED\");\n```\n",
        "protocol": "Lido",
        "report_date": "2021-05-14",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Oracle/README.md#2-possible-zero-price-for-token",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Oracle/Lido%20stETH%20price%20oracle%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Require without message",
        "content": "##### Description\nIn the following functions if revert occurs then user won't receive any information:\nhttps://github.com/lidofinance/curve-merkle-oracle/blob/ae093b308999a564ed3f23d52c6c5dce946dbfa7/contracts/StateProofVerifier.sol#L100\nhttps://github.com/lidofinance/curve-merkle-oracle/blob/ae093b308999a564ed3f23d52c6c5dce946dbfa7/contracts/StableSwapStateOracle.sol#L466\nhttps://github.com/lidofinance/curve-merkle-oracle/blob/ae093b308999a564ed3f23d52c6c5dce946dbfa7/contracts/StableSwapStateOracle.sol#L474\n\n##### Recommendation\nWe recommend to add message to require.\n",
        "protocol": "Lido",
        "report_date": "2021-05-14",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Oracle/README.md#1-require-without-message",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Oracle/Lido%20stETH%20price%20oracle%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Bad comment for hash generation",
        "content": "##### Description\nIt is impossible to check constant hash via following comment:\nhttps://github.com/lidofinance/curve-merkle-oracle/blob/ae093b308999a564ed3f23d52c6c5dce946dbfa7/contracts/StableSwapStateOracle.sol#L95\n\n##### Recommendation\nWe recommend to add more detailed comment.\n",
        "protocol": "Lido",
        "report_date": "2021-05-14",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Oracle/README.md#2-bad-comment-for-hash-generation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Oracle/Lido%20stETH%20price%20oracle%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Gas saving in price calculation",
        "content": "##### Description\nIn the function for calculating price, you can save gas when calculating the variables `S_` and` c` in case if `i=1`, `j=0`, `N_COINS=2`:\nhttps://github.com/lidofinance/curve-merkle-oracle/blob/ae093b308999a564ed3f23d52c6c5dce946dbfa7/contracts/StableSwapPriceHelper.vy#L63-L72\n\n##### Recommendation\nWe recommendto calculate variables using following formula:\n```vyper=\nS_ = x\nc = D * D / (x * N_COINS)\n```\n",
        "protocol": "Lido",
        "report_date": "2021-05-14",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Oracle/README.md#3-gas-saving-in-price-calculation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Oracle/Lido%20stETH%20price%20oracle%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Gas saving when copying memory",
        "content": "##### Description\nIn the function for copy memory when `len % WORD_SIZE == 0` it is possible to save some gas by adding simple check:\nhttps://github.com/hamdiallam/Solidity-RLP/blob/4fa53119e6dd7c4a950586e21b6068cd9520a649/contracts/RLPReader.sol#L350-L355\n\n##### Recommendation\nWe recommend to add following check:\n```solidity=\nif (len > 0)\n{\n    uint mask = 256 ** (WORD_SIZE - len) - 1;\n    assembly {\n        let srcpart := and(mload(src), not(mask)) // zero out src\n        let destpart := and(mload(dest), mask) // retrieve the bytes\n        mstore(dest, or(destpart, srcpart))\n    }\n}\n```\n",
        "protocol": "Lido",
        "report_date": "2021-05-14",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Oracle/README.md#4-gas-saving-when-copying-memory",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Oracle/Lido%20stETH%20price%20oracle%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Unused variable",
        "content": "##### Description\nFollowing smart contract contains unused variable:\nhttps://github.com/lidofinance/curve-merkle-oracle/blob/ae093b308999a564ed3f23d52c6c5dce946dbfa7/contracts/MerklePatriciaProofVerifier.sol#L37\n##### Recommendation\nWe recommend to remove unused variable.\n",
        "protocol": "Lido",
        "report_date": "2021-05-14",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Oracle/README.md#5-unused-variable",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Lido/stETH%20Price%20Oracle/Lido%20stETH%20price%20oracle%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Losses are not taken into account in the strategy",
        "content": "##### Description\nAt line: https://github.com/orbxball/weth-maker/blob/39cfbee59bcebfce19a5b9ac6f11fb84f3ab7b23/contracts/Strategy.sol#L260 when strategy calls the `liquidatePosition()` function if at this point yvdai have losses we have three branches:\n\n - if `_amountNeeded` > real balance of strategy after all liquidations we got revert (it's not very good, because users can't withdraw their funds);\n - if `_amountNeeded` < real balance of strategy user will withdraw funds, but vault won't consider losses and all losses will be distributed across all users who left after first withdraw;\n - if `yvdai` have losses more than 0.01([default BPS](https://github.com/yearn/yearn-vaults/blob/v0.3.2/contracts/Vault.vy#L928)) `liquidatePosition()` will reverted while [yvdai.withdraw](https://github.com/orbxball/weth-maker/blob/39cfbee59bcebfce19a5b9ac6f11fb84f3ab7b23/contracts/Strategy.sol#L377) (so that means that if yvdai got losses of more than 0.01% any strategies depending on it will be blocked.\n\n\nFixes commentary:\n* Fixed: \n  - Withdrawals from underlying DAI vault with losses can be approved.\n  - Withdrawals on failed to liquidate will not be reverted.\n* Problem remains: \n  - If the strategy suffer a loss from DAI vault, a bad debt will be formed. This debt is hidden until the vault is trying to liquidate it. So we have a bit unfair distribution of losses between vault users.\n\n##### Recommendation\nIt is recommended to rewrite logic of `liquidatePosition()`  considering the losses.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-05-07",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Weth%20Maker/README.md#1-losses-are-not-taken-into-account-in-the-strategy",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Weth%20Maker/Weth%20Maker%20SCA.pdf"
    },
    {
        "title": "The approval value obtained in the constructor may not be enough for the long term of the smart contract",
        "content": "##### Description\nAt line: https://github.com/orbxball/weth-maker/blob/39cfbee59bcebfce19a5b9ac6f11fb84f3ab7b23/contracts/Strategy.sol#L68 the smart contract constructor calls `_approveAll()` function for different tokens. But in the process of work, the obtained value will only decrease. If this value decreases to zero, then the tokens will remain locked in the contract forever.\n  \n##### Recommendation\nIt is recommended to add a function to increase the value of approvals.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-05-07",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Weth%20Maker/README.md#1-the-approval-value-obtained-in-the-constructor-may-not-be-enough-for-the-long-term-of-the-smart-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Weth%20Maker/Weth%20Maker%20SCA.pdf"
    },
    {
        "title": "There is no check on the result of the function",
        "content": "##### Description\nAccording to the ERC20 standard, the `approve()` function returns a boolean value. But in the contract at lines https://github.com/orbxball/weth-maker/blob/39cfbee59bcebfce19a5b9ac6f11fb84f3ab7b23/contracts/Strategy.sol#L68-L75, after the call to the `_approveAll()` function, this values are not processed. A situation may arise that a False will return. \n\n##### Recommendation\nIt is recommended to add a check of the return value.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-05-07",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Weth%20Maker/README.md#2-there-is-no-check-on-the-result-of-the-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Weth%20Maker/Weth%20Maker%20SCA.pdf"
    },
    {
        "title": "Wrong comparison",
        "content": "##### Description\nAt line: https://github.com/orbxball/weth-maker/blob/39cfbee59bcebfce19a5b9ac6f11fb84f3ab7b23/contracts/Strategy.sol#L217 left operand has unit `1e+6` and the right operand has unit `1e+10`.\n```solidity=\nif (_current > DENOMINATOR.mul(c_safe).mul(1e2)) {//  1e6 > 10000 * 40000 * 1e2 \n    _current = DENOMINATOR.mul(c_safe).mul(1e2);\n\n```\nIn this implementation where `c_safe = 40000;` this code will be ignored.\n\n##### Recommendation\nIt is recommended to change `c_safe` value after deploy.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-05-07",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Weth%20Maker/README.md#3-wrong-comparison",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Weth%20Maker/Weth%20Maker%20SCA.pdf"
    },
    {
        "title": "Using \"magic\" numbers",
        "content": "##### Description\nAt line https://github.com/orbxball/weth-maker/blob/39cfbee59bcebfce19a5b9ac6f11fb84f3ab7b23/contracts/Strategy.sol#L60-L61 use some of unknown variables  impairs its understanding.\n\n##### Recommendation\nIt is recommended that you create variables  with meaningful names for using numeric values or add comments.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-05-07",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Weth%20Maker/README.md#1-using-magic-numbers",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Weth%20Maker/Weth%20Maker%20SCA.pdf"
    },
    {
        "title": "Use constants",
        "content": "##### Description\nAt lines https://github.com/orbxball/weth-maker/blob/39cfbee59bcebfce19a5b9ac6f11fb84f3ab7b23/contracts/Strategy.sol#L32-L41 you may add constants for save gas.\n\n##### Recommendation\nIt is recommended to add constants to hardcoded address variables.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-05-07",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Weth%20Maker/README.md#2-use-constants",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Weth%20Maker/Weth%20Maker%20SCA.pdf"
    },
    {
        "title": "Losses are not taken into account in the strategy",
        "content": "##### Description\nAt line: https://github.com/orbxball/yfi-maker/blob/63af6fcfa536073f00d652f49befd18e429b5500/contracts/Strategy.sol#L264-L277\nthe `liquidatePosition()` function does not take into account the value of the`_loss` variable accounting in `prepareReturn()` function. In this case the `liquidatePosition()` function will always return `_liquidatedAmount = _amountNeeded` excluding losses.\nThis implementation may lead to revert when the Vault call the function `withdraw` function (at line https://github.com/yearn/yearn-vaults/blob/952b767fcd597fac8aa2cf5d023532d150bb9236/contracts/BaseStrategy.sol#L681) by reason of the insufficient balance. \n  \nAlso the withdrawer from vault should incur the losses from liquidation caused by his own withdrawal. However, the [liquidatePosition()](https://github.com/orbxball/yfi-maker/blob/63af6fcfa536073f00d652f49befd18e429b5500/contracts/Strategy.sol#L264) is ignoring any losses from underlying DAI vault. This may lead to improper accounting of user balances and possible locking of vault withdrawals.  \n  \n##### Recommendation\nIt is recommended to rewrite logic of `liquidatePosition()`  considering the losses.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-05-07",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yfi%20Maker/README.md#1-losses-are-not-taken-into-account-in-the-strategy",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yfi%20Maker/Yfi%20Maker%20SCA.pdf"
    },
    {
        "title": "The approval value obtained in the constructor may not be enough for the long term of the smart contract",
        "content": "##### Description\nAt line: https://github.com/orbxball/yfi-maker/blob/63af6fcfa536073f00d652f49befd18e429b5500/contracts/Strategy.sol#L69\nthe smart contract constructor call `_approveAll()` function for different tokens. But in the process of work, the obtained value will only decrease. If this value decreases to zero, then the tokens will remain locked in the contract forever.\n  \n##### Recommendation\nIt is recommended to add a function to increase the value of approvals.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-05-07",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yfi%20Maker/README.md#1-the-approval-value-obtained-in-the-constructor-may-not-be-enough-for-the-long-term-of-the-smart-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yfi%20Maker/Yfi%20Maker%20SCA.pdf"
    },
    {
        "title": "There is no check on the result of the function",
        "content": "##### Description\nAccording to the ERC20 standard, the `approve()` function returns a boolean value. But in the contract on lines https://github.com/orbxball/yfi-maker/blob/63af6fcfa536073f00d652f49befd18e429b5500/contracts/Strategy.sol#L69-L76, after the call to the `_approveAll()` function, this values are not processed. A situation may arise that a False will return. \n\n##### Recommendation\nIt is recomended to add a check of the return value.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-05-07",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yfi%20Maker/README.md#2-there-is-no-check-on-the-result-of-the-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yfi%20Maker/Yfi%20Maker%20SCA.pdf"
    },
    {
        "title": "Using \"magic\" numbers",
        "content": "##### Description\nAt line https://github.com/orbxball/yfi-maker/blob/63af6fcfa536073f00d652f49befd18e429b5500/contracts/Strategy.sol#L61-L62 use some of unknown variables  impairs its understanding.\n\n##### Recommendation\nIt is recommended that you create variables  with meaningful names for using numeric values or add comments.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-05-07",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yfi%20Maker/README.md#1-using-magic-numbers",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yfi%20Maker/Yfi%20Maker%20SCA.pdf"
    },
    {
        "title": "Use constants",
        "content": "##### Description\nAt lines https://github.com/orbxball/yfi-maker/blob/63af6fcfa536073f00d652f49befd18e429b5500/contracts/Strategy.sol#L32-L37 you may add constants for save gas.\n\n##### Recommendation\nIt is recommended to add constanst to hardcoded address variables.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-05-07",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yfi%20Maker/README.md#2-use-constants",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yfi%20Maker/Yfi%20Maker%20SCA.pdf"
    },
    {
        "title": "Incorrect first borrow for user",
        "content": "##### Description\nIn current version of smart contract if user wasn't registered before, but has balance of `CToken > 0`, then borrowing will always fail, until user is registered his collateral.\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/Comptroller.sol#L366\n\n##### Recommendation\nWe recommend to invoke `registerCollateral` function after comptroller added user to market:\n``` solidity=\nError err = addToMarketInternal(CToken(msg.sender), borrower);\nif (err != Error.NO_ERROR) {\n    return uint(err);\n}\nCCollateralCapErc20Interface(msg.sender).registerCollateral(borrower);\n```\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#1-incorrect-first-borrow-for-user",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Possible excess of gas limit",
        "content": "##### Description\nIn following function it is worth to add check of how much gas left.\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/Comptroller.sol#L1266\n\n##### Recommendation\nWe recommend add following check in head of `for` loop:\n```solidity=\nif (gasleft < 40000) { return;}\n```\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#2-possible-excess-of-gas-limit",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Possible incorrect tokens redeeming",
        "content": "##### Description\nIn following function tx can fail if user try redeem incorrect amount of tokens:\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20.sol#L555\n\n##### Recommendation\nWe recommend to add a simple check:\n```solidity=\nrequire(vars.redeemTokens <= accountTokens[redeemer], \"insufficient amount of tokens\");\n```\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#3-possible-incorrect-tokens-redeeming",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Possible flashloan attack",
        "content": "##### Description\nCurrent version of flashloan function gives opportunity to any user to set `exchangeRate = 0`, which can be used in another protocols to steal assets:\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20.sol#L169\n\n##### Recommendation\nWe recommend to transfer tokens to user directly without using `doTransferOut` function.\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#4-possible-flashloan-attack",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Incorrect tokens transfer",
        "content": "##### Description\nTx fail if user tries to send more tokens than he has:\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20.sol#L339\n\n##### Recommendation\nWe recommend to add simple require to save gas for user and give him some information about why tx failed:\n```solidity=\nrequire(accountTokens[src] >= tokens, \"Insufficient balance\");\n```\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#5-incorrect-tokens-transfer",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Allowed zero `mintFresh`",
        "content": "##### Description\nZero `mintFresh` doesn't change the state of supply and collateral tokens. It only consumes gas and emits an \"empty\" event\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20.sol#L476\n\n##### Recommendation\nWe recommend quitting `mintFresh` after checks https://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20.sol#L490\n```solidity=\nif (mintAmount == 0) {\n    return (uint(Error.NO_ERROR), 0);\n}\n```\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#6-allowed-zero-mintfresh",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Allowed zero `borrowFresh` and `repayBorrowFresh`",
        "content": "##### Description\nZero `borrowFresh` and `repayBorrowFresh` don't change the state of borrow balance. They only update borrower `borrowIndex`, consume gas and emit an \"empty\" event\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CToken.sol#L437\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CToken.sol#L541\n\n##### Recommendation\nWe recommend quitting `borrowFresh` and `repayBorrowFresh`after checks https://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CToken.sol#L453\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CToken.sol#L552\n```solidity=\nif (borrowAmount == 0) {\n    accountBorrows[borrower].interestIndex = borrowIndex;\n    return (uint(Error.NO_ERROR), 0);\n}\n```\n```solidity=\nif (repayAmount == 0) {\n    accountBorrows[borrower].interestIndex = borrowIndex;\n    return (uint(Error.NO_ERROR), 0);\n}\n```\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#7-allowed-zero-borrowfresh-and-repayborrowfresh",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Allowed zero `redeemFresh`",
        "content": "##### Description\n`redeemTokensIn` and `redeemAmountIn` may be both zero: https://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20.sol#L559\n\n##### Recommendation\nAdd a check:\n- append existing require\n```solidity=\nrequire(redeemTokensIn == 0 && redeemAmountIn > 0 ||\nredeemAmountIn == 0 && redeemTokensIn > 0, \"one of redeemTokensIn or redeemAmountIn must be zero\");\n```\n- or quit function if both are zero\n```solidity=\nif (redeemTokensIn == 0 && redeemAmountIn == 0) {\n    return uint(Error.NO_ERROR);\n}\n```\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#8-allowed-zero-redeemfresh",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Allowed zero `seizeInternal`",
        "content": "##### Description\nZero `seizeInternal` doesn't change the state of supply and collateral tokens. It only consumes gas and emits an \"empty\" event\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20.sol#L654\n\n##### Recommendation\nWe recommend quitting `seizeInternal` after checks https://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20.sol#L669\n```solidity=\nif (seizeTokens == 0) {\n    return uint(Error.NO_ERROR);\n}\n```\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#9-allowed-zero-seizeinternal",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Allowed zero `flashLoan`",
        "content": "##### Description\nZero `flashLoan` doesn't earn fees. It only consumes gas and emits an \"empty\" event\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20.sol#L160\n\n##### Recommendation\nWe recommend adding a check in `flashLoan`\n```solidity=\nrequire(amount > 0, \"flashLoan amount should be greater than zero\");\n```\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#10-allowed-zero-flashloan",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Possible gas saving",
        "content": "##### Description\nIn following function another variable can be used to save little gas and not to invoke `address` function.\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/Comptroller.sol#L183\n\n##### Recommendation\nUse variable `cTokenAddress`\n```solidity=\nMarket storage marketToExit = markets[cTokenAddress];\n```\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#1-possible-gas-saving",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Remove unused functions",
        "content": "##### Description\nIn current version of smart contract there are some functions which are not currently used.\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/Comptroller.sol#L273\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/Comptroller.sol#L410\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/Comptroller.sol#L459\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/Comptroller.sol#L526\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/Comptroller.sol#L591\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/Comptroller.sol#L644\n\n##### Recommendation\nWe recommend to remove these functions to save gas on deployment.\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#2-remove-unused-functions",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Gas saving in copying storage variable",
        "content": "##### Description\nIn following function simple check can be added to save gas:\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/Comptroller.sol#L213\n\n##### Recommendation\nWe recommend to add following check:\n```solidity=\nif (assetIndex != storedList.length - 1){\n    storedList[assetIndex] = storedList[storedList.length - 1];\n}\n```",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#3-gas-saving-in-copying-storage-variable",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Possible gas saving",
        "content": "##### Description\nIn following function adding of return value can save some gas\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/Comptroller.sol#L1303\n\n##### Recommendation\nWe recommend to change function as follows:\n```solidity=\nfunction _setCompSpeeds(address[] memory cTokens, uint[] memory speeds) public {\n    ...\n    uint res = 3;\n    if (speeds[i] > 0) {\n        res = _initCompState(cTokens[i]);\n    }\n    CToken cToken = CToken(cTokens[i]);\n    Exp memory borrowIndex = Exp({mantissa: cToken.borrowIndex()});\n    if (res == 3)\n    {\n        updateCompSupplyIndex(address(cToken));\n        updateCompBorrowIndex(address(cToken), borrowIndex);\n    }\n    if (res == 1)\n    {\n        updateCompSupplyIndex(address(cToken));\n    }\n    if (res == 2)\n    {\n        updateCompBorrowIndex(address(cToken), borrowIndex);\n    }\n    ...\n}\nfunction _initCompState(address cToken) internal returns (uint) {\n    uint res = 0;\n    if (compSupplyState[cToken].index == 0 && compSupplyState[cToken].block == 0) {\n        res = 1;\n        compSupplyState[cToken] = CompMarketState({\n            index: compInitialIndex,\n            block: safe32(getBlockNumber(), \"block number exceeds 32 bits\")\n        });\n    }\n\n    if (compBorrowState[cToken].index == 0 && compBorrowState[cToken].block == 0) {\n        res = res + 2;\n        compBorrowState[cToken] = CompMarketState({\n            index: compInitialIndex,\n            block: safe32(getBlockNumber(), \"block number exceeds 32 bits\")\n        });\n    }\n    return res;\n}\n```\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#4-possible-gas-saving",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Pure function definition",
        "content": "##### Description\nFollowing function can be marked `pure`:\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/Comptroller.sol#L1350\n\n##### Recommendation\nWe recommend to mark this function `pure` to save gas.\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#5-pure-function-definition",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Unnecessary usage of safe calculations",
        "content": "##### Description\nIn the following function simple substraction can be used to save gas:\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20.sol#L353\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20.sol#L594\n\n##### Recommendation\nWe recommend using simple substraction:\n```solidity=\ncollateralTokens = tokens - bufferTokens;\n```\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#6-unnecessary-usage-of-safe-calculations",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Unnecessary calculation of variable",
        "content": "##### Description\nIn the following function calculation of `allowanceNew` can be moved inside `if` block to save gas:\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20.sol#L379\n\n##### Recommendation\nWe recommend to move variable into `if` block:\n```solidity=\nif (startingAllowance != uint(-1)) {\n    uint allowanceNew = sub_(startingAllowance, tokens);\n    transferAllowances[src][spender] = allowanceNew;\n}\n```\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#7-unnecessary-calculation-of-variable",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Move redeem hook",
        "content": "##### Description\nIn the following function security hook can be moved to save some gas for user:\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20.sol#L639\n\n##### Recommendation\nWe recommend moved function like this:\n```solidity=\nfunction redeemFresh(address payable redeemer, uint redeemTokensIn, uint redeemAmountIn) internal returns (uint) {\n    ...\n    comptroller.redeemVerify(address(this), redeemer, vars.redeemAmount, vars.redeemTokens);\n    \n    uint bufferTokens = sub_(accountTokens[redeemer], accountCollateralTokens[redeemer]);\n    ...\n}\n```\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#8-move-redeem-hook",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Possible liquidity lost",
        "content": "##### Description\nRandom user can lose tokens if he invokes following function:\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20.sol#L127\n\n##### Recommendation\nWe recommend to add following check:\n```solidity=\nrequire(msg.sender == admin, \"only admin can add reserves\");\n```\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#9-possible-liquidity-lost",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Necessary initialization",
        "content": "##### Description\nIf `closeFactorMantissa` not initialized then all borrow liquidation always fail:\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/Comptroller.sol#L869\n\n##### Recommendation\nWe recommend to initialize `closeFactorMantissa` in constructor.\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#10-necessary-initialization",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Cap initialization",
        "content": "##### Description\nIf `collateralCap` is initialized after smart contract has accumulated assets >` collateralCap`, then users will not be able to increase their collateral for particular market:\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20.sol#L135\n\n##### Recommendation\nWe recommend to initialize `collateralCap` in `initialize` function.\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#11-cap-initialization",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Unreachable code in `getCTokenBalanceInternal`",
        "content": "##### Description\nAffecting variable `accountTokens[account]` always makes `isCollateralTokenInit[account]` true, so `accountCollateralTokens[account]` will be returned. Otherwise balance is 0\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20.sol#L408\n\n##### Recommendation\nWe recommend to remove unreachable part\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#12-unreachable-code-in-getctokenbalanceinternal",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Unlimited `liquidationIncentiveMantissa` and `closeFactorMantissa`",
        "content": "##### Description\nThere are max and min limits for `liquidationIncentiveMantissa` and `closeFactorMantissa` in `ComptrollerG1.sol` but not in `Comptroller.sol`\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/ComptrollerG1.sol#L83-L96\n\n##### Recommendation\nWe recommend adding limits and checks\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/Comptroller.sol#L78\n```solidity=\n// closeFactorMantissa must be strictly greater than this value\nuint constant closeFactorMinMantissa = 5e16; // 0.05\n\n// closeFactorMantissa must not exceed this value\nuint constant closeFactorMaxMantissa = 9e17; // 0.9\n\n// liquidationIncentiveMantissa must be no less than this value\nuint constant liquidationIncentiveMinMantissa = mantissaOne;\n\n// liquidationIncentiveMantissa must be no greater than this value\nuint constant liquidationIncentiveMaxMantissa = 15e17; // 1.5\n```\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/Comptroller.sol#L930\n```solidity=\nExp memory newLiquidationIncentive = Exp({mantissa: newLiquidationIncentiveMantissa});\nExp memory minLiquidationIncentive = Exp({mantissa: liquidationIncentiveMinMantissa});\nif (lessThanExp(newLiquidationIncentive, minLiquidationIncentive)) {\n    return fail(Error.INVALID_LIQUIDATION_INCENTIVE, FailureInfo.SET_LIQUIDATION_INCENTIVE_VALIDATION);\n}\n\nExp memory maxLiquidationIncentive = Exp({mantissa: liquidationIncentiveMaxMantissa});\nif (lessThanExp(maxLiquidationIncentive, newLiquidationIncentive)) {\n    return fail(Error.INVALID_LIQUIDATION_INCENTIVE, FailureInfo.SET_LIQUIDATION_INCENTIVE_VALIDATION);\n}\n```\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/Comptroller.sol#L869\n```solidity=\nExp memory newCloseFactorExp = Exp({mantissa: newCloseFactorMantissa});\nExp memory lowLimit = Exp({mantissa: closeFactorMinMantissa});\nif (lessThanOrEqualExp(newCloseFactorExp, lowLimit)) {\n    return fail(Error.INVALID_CLOSE_FACTOR, FailureInfo.SET_CLOSE_FACTOR_VALIDATION);\n}\n\nExp memory highLimit = Exp({mantissa: closeFactorMaxMantissa});\nif (lessThanExp(highLimit, newCloseFactorExp)) {\n    return fail(Error.INVALID_CLOSE_FACTOR, FailureInfo.SET_CLOSE_FACTOR_VALIDATION);\n}\n```",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#13-unlimited-liquidationincentivemantissa-and-closefactormantissa",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "New market borrow or supply cap may block borrowing or minting",
        "content": "##### Description\nIf market borrow balance or supply already exceeds new cap when setting it may block borrowing or minting for market\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/Comptroller.sol#L1005\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/Comptroller.sol#L1025\n\n##### Recommendation\nWe recommend adding comments about it in the code\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#14-new-market-borrow-or-supply-cap-may-block-borrowing-or-minting",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Unused values/statements in functions",
        "content": "##### Description\nIn `Comptroller.sol` at lines\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/Comptroller.sol#L239\n\nhttps://github.com/CreamFi/compound-protocol/blob/8432602ff43052b7f316426c3880eb6ab086a92d/contracts/Comptroller.sol#L323\n`minter`, `cToken` and `redeemer` values are unused\nIn `CCollateralCapErc20Delegate.sol` at line  https://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20Delegate.sol#L22\nthe `data` value is initialized but never used\nat line\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20Delegate.sol#L25\nthe `if` statement will never be executed\n\n##### Recommendation\nIt is recommended to remove redundant code to avoid confusion and increase clarity and readability of the code \n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#15-unused-valuesstatements-in-functions",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Unused functions wrapped in commentaries",
        "content": "##### Description\nIn `Comptroller.sol` at line https://github.com/CreamFi/compound-protocol/blob/8432602ff43052b7f316426c3880eb6ab086a92d/contracts/Comptroller.sol#L323\n`CCollateralCapErc20.sol` at lines  https://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20.sol#L398\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20.sol#L689\nhttps://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20.sol#L536\n\nfunctions are stated in commentaries, but unused\n\n##### Recommendation\nWe recommend to remove these unnecessary commentaries to improve clarity and readability of the code\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#16-unused-functions-wrapped-in-commentaries",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Explicit statement of `uint256` values",
        "content": "##### Description\n\nIn `CCollateralCapErc20.sol`, `CTokenInterfaces.sol`, `Comptroller.sol`, `ComptrollerStorage.sol` all instances of `uint` values are not stated as `uint256` explicitly\n\n##### Recommendation\nWe recommend to expicitly state `uint` values as `uint256` to increase clarity and readability of the code\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#17-explicit-statement-of-uint256-values",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Unclear commentary",
        "content": "##### Description\nAt line https://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20.sol#L552 the `@param` comment states that only one of `redeemTokensIn` or `redeemAmountIn` values may be non-zero, however, it may be confusing to acknowledge\n\n##### Recommendation\nIt is recommended to rewrite the comment to explicitly state that `redeemTokensIn` and`redeemAmountIn` can both be zero values at the same time\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#18-unclear-commentary",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Possible value truncation issues",
        "content": "##### Description\nIn `CCollateralCapErc20.sol` at line https://github.com/CreamFi/compound-protocol/blob/23a4ae93adc70334553f5a83429a4e967c1eefaa/contracts/CCollateralCapErc20.sol#L513 the `div_ScalarByExpTruncate()` may round the result down to the next nearest integer if it is calculated to be a non-integer number of cToken units, sufficiently small loans may be affected, however, the loss should never be more than one indivisible unit of a token used\n\n##### Recommendation\nThis is a relatively unavoidable error which appears due to to EVM operation result. It should be acknowledged by suppliers with extremely small amount of tokens\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-05-04",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/README.md#19-possible-value-truncation-issues",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Compound%20Protocol/Compound%20Protocol%20SCA.pdf"
    },
    {
        "title": "Deposit will be unavailable if lending pool address will be updated by AAVE",
        "content": "##### Description\nAt line https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/55b4d3b03845b7b71b24b50baa30823b3e42ebcf/contracts/GenericLender/GenericAave.sol#L132 the `deposit` function assumes recent approval of token transfer. However, the  `safeApprove()` is called once during contract initialization(https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/55b4d3b03845b7b71b24b50baa30823b3e42ebcf/contracts/GenericLender/GenericAave.sol#L49) and possible changes of lending pool address is not tracked properly. If lending pool address is updated by AAVE, the `deposit()` will be unavailable/reverted until contract replacement.\n\n##### Recommendation\nCall `safeApprove()` on demand before calling `deposit()` on lending pool.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-04-23",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender%20Aave/README.md#1-deposit-will-be-unavailable-if-lending-pool-address-will-be-updated-by-aave",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender%20Aave/GenericAave%20SCA.pdf"
    },
    {
        "title": "The approval value obtained in the `_initialize()` function  may not be enough for the long term of the smart contract",
        "content": "##### Description\nSmart contracts call `safeApprove()` function for different tokens. But in the process of work, the obtained value will only decrease. If this value decreases to zero, then the tokens will remain locked in the contract forever.\nIt is at the following lines:\n- https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/55b4d3b03845b7b71b24b50baa30823b3e42ebcf/contracts/GenericLender/GenericAave.sol#L49\n  \n##### Recommendation\nIt is recommended to add a function to increase the value of approvals.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-04-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender%20Aave/README.md#1-the-approval-value-obtained-in-the-_initialize-function-may-not-be-enough-for-the-long-term-of-the-smart-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender%20Aave/GenericAave%20SCA.pdf"
    },
    {
        "title": "Anyone can perform any arbitrary calls on behalf of `VoterProxy`",
        "content": "##### Description\nFunction `deposit` in `VoterProxy` defined at https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/VoterProxy.sol#L60 accepts call from anyone with any `_token` and `_gauge`, so anyone can craft calldata and make call on behalf of `VoterProxy`. That could lead to undesired behavior, e.g user's funds locked in contract or authorization violation. Also deposit can be called for `_gauge` and `_token` which are not compatible.\nMoreover for now anyone can allow spending tokens from contract balance for any third-party account by calling deposit for target token with evil gauge.\n\n##### Recommendation\nWe strictly recommend to whitelist `_gauge` and `_token`. And also check that `_token` and `_gauge` are compatible(check that ```ICurveGauge(_gauge).withdraw(_amount)``` returns right `_token`)\n",
        "protocol": "Convex Platform",
        "report_date": "2021-04-19",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/README.md#1-anyone-can-perform-any-arbitrary-calls-on-behalf-of-voterproxy",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/Convex%20Platform%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unstable gauge version check",
        "content": "##### Description\n`ShashFactory` contract have gauge version check based on call probes defined at https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/StashFactory.sol#L51-L61, that approach is very dangerous in case of new version added to curve. E.g if curve will add new version of gauge that have `rewarded_token()` or `reward_tokens(uint256)` and with different behavior, then version checker will wrongly classify version and allow to create stash with invalid version. That can lead to broken logic.\n\n##### Recommendation\nWe recommend to use another approach to check version, e.g whitelisting gauges. Curve have only around ~40 gauges.\n",
        "protocol": "Convex Platform",
        "report_date": "2021-04-19",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/README.md#1-unstable-gauge-version-check",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/Convex%20Platform%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Wrong logic in `withdrawAll`",
        "content": "##### Description\nAt the moment `withdrawAll` counts balance as: `balanceOfPool(_gauge)` (https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/VoterProxy.sol#L92)\n\nCorrect logic should be: `balanceOfPool(_gauge).add(IERC20(_token).balanceOf(address(this)))`.\n\nThe `withdrawAll` method is used by `shutdownSystem` so potentially some tokens could remain in the contract.\n\n##### Recommendation\nIt is recommended to count amount of tokens as `balanceOfPool(_gauge).add(IERC20(_token).balanceOf(address(this)))`.\n",
        "protocol": "Convex Platform",
        "report_date": "2021-04-19",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/README.md#2-wrong-logic-in-withdrawall",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/Convex%20Platform%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Zero gauge could be added via `addPool`",
        "content": "##### Description\nIn `addPool` defined at https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/Booster.sol#L160 there is no check for `_gauge` variable. For example during this call\n```soldity\nbooster.addPool(threeCrvSwap, \"0x0000000000000000000000000000000000000000\", 0)\n```\n\nGauge will be found because `get_gauges` returns array like `[address1, address2, 0x0, 0x0, ...]`. Intruder can call some errors in `Booster` logic.\n\nIt's major because at the moment `StashFactory` call `address(0x0).call.value(0)(data)` (https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/StashFactory.sol#L53) and due to specific of EVM there is `true`.\n\n##### Recommendation\nWe recommend to add some checks for `_gauge` variable.\n",
        "protocol": "Convex Platform",
        "report_date": "2021-04-19",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/README.md#3-zero-gauge-could-be-added-via-addpool",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/Convex%20Platform%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Inconsistent minted and deposited LP tokens amount",
        "content": "##### Description\nFunction `deposit` in `Booster` defined at https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/Booster.sol#L275 allows to deposit curve pools LP token and mint wrapped convex tokens with 1:1 proportions. However minted tokens amount for user can be different from deposited LP tokens amount:\n - At line https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/Booster.sol#L278 contract accepts `_amount` LP tokens \n - At line https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/Booster.sol#L265 contract deposit `bal` tokens to gauge\n - `bal != _amount` if before user deposit someone send LP token directly to `Booster` contract, so here we got that amount of deposited tokens to gauge not equal to LP tokens amount deposited to `Booster`\n\n##### Recommendation\nWe recommend to pass actual deposited `_amount` to `sendTokensToGauge` function and use it as amount of tokens for depositing to gauge.\n",
        "protocol": "Convex Platform",
        "report_date": "2021-04-19",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/README.md#1-inconsistent-minted-and-deposited-lp-tokens-amount",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/Convex%20Platform%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`voteDelegate` can perform any arbitrary calls on behalf of `VoterProxy`",
        "content": "##### Description\nFunction `vote` in `VoterProxy` defined at https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/VoterProxy.sol#L130 accepts call from `voteDelegate` through `Booster` contract and can call any arbitrary contract on behalf of `VoterProxy`. Since `VoterProxy` is main contract that holds users money it's highly risked to allow arbitrary contracts calls.\n\n##### Recommendation\nWe strictly recommend to whitelist `_votingAddress`\n",
        "protocol": "Convex Platform",
        "report_date": "2021-04-19",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/README.md#2-votedelegate-can-perform-any-arbitrary-calls-on-behalf-of-voterproxy",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/Convex%20Platform%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Insecure privileges for `Owner`",
        "content": "##### Description\nOwner can change factories in `setFactories` (https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/Booster.sol#L95):\n```solidity\nrewardFactory = _rfactory;\nstashFactory = _sfactory;\ntokenFactory = _tfactory;\n```\n\nVia front-running attack `owner` can change these addresses before calling `addPool`.\n\n##### Recommendation\nWe recommend to construct this contracts in Booster and create mechanism of migrations directly in factories.\n",
        "protocol": "Convex Platform",
        "report_date": "2021-04-19",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/README.md#3-insecure-privileges-for-owner",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/Convex%20Platform%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Call `earmarkRewards` after shutdown",
        "content": "##### Description\nLine is commented in method `earmarkRewards` defined at https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/Booster.sol#L434:\n```solidity\n// require(!isShutdown,\"shutdown\");\n```\n\nHowever if system is shutdowned the transaction would be reverted because stash has no access to `VoterProxy`.\n\n##### Recommendation\nIt is recommended to uncomment this line. \n",
        "protocol": "Convex Platform",
        "report_date": "2021-04-19",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/README.md#4-call-earmarkrewards-after-shutdown",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/Convex%20Platform%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Missed `safeApprove`",
        "content": "##### Description\n`Booster` uses `approve` method (https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/Booster.sol#L288):\n```solidity\nIERC20(token).approve(rewardContract, _amount);\n```\nIt's better to use `safeApprove`.\n\n##### Recommendation\nIt is recommended to use `safeApprove`.\n",
        "protocol": "Convex Platform",
        "report_date": "2021-04-19",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/README.md#5-missed-safeapprove",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/Convex%20Platform%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Cache `poolInfo` in memory to save gas",
        "content": "##### Description\nIn function `deposit` of `Booster` contract defined at https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/Booster.sol#L275 there are several reads of `poolInfo` struct fields, so it's better to cache `poolInfo` structure in memory to save some gas on reading.\n\n##### Recommendation\nWe suggest to cache `poolInfo` in memory\n",
        "protocol": "Convex Platform",
        "report_date": "2021-04-19",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/README.md#1-cache-poolinfo-in-memory-to-save-gas",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/Convex%20Platform%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Check user balance at beginning to save gas",
        "content": "##### Description\nFunction `_withdraw` defined at line https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/Booster.sol#L309 needs to burn wrapper tokens and back LP tokens to user, for now in case if user have to sufficient wrapped tokens ```ITokenMinter(token).burn(_from,_amount)``` at line https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/Booster.sol#L329 will revert transaction. In that case user will pay gas for whole operations before, so we recommend to check user's balance at the very beginning of the functions to save gas on negative scenario.\n\n##### Recommendation\nWe recommend to check user's balance at beginning of the function\n",
        "protocol": "Convex Platform",
        "report_date": "2021-04-19",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/README.md#2-check-user-balance-at-beginning-to-save-gas",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/Convex%20Platform%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Remove unrelevant commentaries",
        "content": "##### Description\nAt lines:\n - https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/Booster.sol#L345\n - https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/Booster.sol#L441\n - https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/Booster.sol#L119\n - etc \n\nthere are commentaries which are not really relevant\n\n##### Recommendation\nWe recommend to remove unneeded comments\n",
        "protocol": "Convex Platform",
        "report_date": "2021-04-19",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/README.md#3-remove-unrelevant-commentaries",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/Convex%20Platform%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Reduce amount of code duplication",
        "content": "##### Description\nContracts:\n - https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/BaseRewardPool.sol\n - https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/ManagedRewardPool.sol\n - https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/VirtualBalanceRewardPool.sol\n - https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/cCrvRewardPool.sol\n - https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/cvxRewardPool.sol\n\nhave a lot of intersections in terms of code duplication, so it's bad practice because it makes easier to introduce bug and makes code more complex\n\n##### Recommendation\nWe recommend to reduce duplication using contracts inheritance\n",
        "protocol": "Convex Platform",
        "report_date": "2021-04-19",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/README.md#4-reduce-amount-of-code-duplication",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/Convex%20Platform%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Confusing naming of subjects",
        "content": "##### Description\nAt several places there are confusing naming, e.g:\n - https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/VoterProxy.sol#L23 `operator` is `Booster`\n - https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/Booster.sol#L62 `staker` is `VoterProxy`\n - etc\n\nit's always better to have strict, unambiguous and transparent naming, same things should have same names through whole project to make project more readable and simpler.\n\n##### Recommendation\nWe recommend use unambiguous naming in whole project.\n",
        "protocol": "Convex Platform",
        "report_date": "2021-04-19",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/README.md#5-confusing-naming-of-subjects",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/Convex%20Platform%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Confusing interfaces",
        "content": "##### Description\nThere are a lot of interfaces in file https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/Interfaces.sol, some of that interfaces used in project and sometimes it's not clear what interface is internal(interface of project contract) and what interface is external(e.g curve's one)\n\n##### Recommendation\nWe recommend to separate external\\internal interfaces. And also recommend to keep widely used structure and naming of interfaces: contract interface should have all public methods and should be name should be like I{contract name}.sol. And interfaces should be located at 'interface' directory.\n",
        "protocol": "Convex Platform",
        "report_date": "2021-04-19",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/README.md#6-confusing-interfaces",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/Convex%20Platform%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Saving gas while `platformFee` transferring",
        "content": "##### Description\nIf `platformFee` is zero then it will call empty `safeTransfer`.\n\nAt the moment there is only one condition at line https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/Booster.sol#L405:\n```soldity\ntreasury != address(0) && treasury != address(this)\n```\n\n##### Recommendation\nWe recommend to add `platformFee > 0`.\n",
        "protocol": "Convex Platform",
        "report_date": "2021-04-19",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/README.md#7-saving-gas-while-platformfee-transferring",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/Convex%20Platform%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Check if system shutdowned in `addPool`",
        "content": "##### Description\nMethod `addPool` defined at https://github.com/convex-eth/platform/blob/754d9e700693246275b613e895b4044b63ce9ed5/contracts/contracts/Booster.sol#L160 doesn't have checks for `isShutdown`.\n\n##### Recommendation\nWe recommend to prevent `addPool` when system is shutdown.\n",
        "protocol": "Convex Platform",
        "report_date": "2021-04-19",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/README.md#8-check-if-system-shutdowned-in-addpool",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Convex%20Platform/Convex%20Platform%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Variables used but not declared",
        "content": "##### Description\nAt this lines:\nhttps://github.com/orbxball/curve-voter-proxy/blob/78c92e4ffc0f76651914565744a3607d0248d254/contracts/Strategy.sol#L226-L227\nhttps://github.com/orbxball/curve-voter-proxy/blob/78c92e4ffc0f76651914565744a3607d0248d254/contracts/Strategy.sol#L230\nhttps://github.com/orbxball/curve-voter-proxy/blob/78c92e4ffc0f76651914565744a3607d0248d254/contracts/Strategy.sol#L287\nthe Strategy using address type variables such as `curve`, `gauge`, `reward` and `target` but there is no initialization procedure of these variables. \n\n##### Recommendation\nIt is recommended to initialize your local variables at declaration. \n",
        "protocol": "Yearn Finance",
        "report_date": "2021-04-15",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Curve%20Voter%20Proxy/README.md#1-variables-used-but-not-declared",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Curve%20Voter%20Proxy/Curve-voter-proxy%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Events are probably missing",
        "content": "##### Description:\nAt the line https://github.com/orbxball/curve-voter-proxy/blob/78c92e4ffc0f76651914565744a3607d0248d254/contracts/Strategy.sol#L157 in method `setKeepCRV()` should probably emit an event `newKeepCRV`.\nAt the line https://github.com/orbxball/curve-voter-proxy/blob/78c92e4ffc0f76651914565744a3607d0248d254/contracts/Strategy.sol#L165 in method `switchDex()` should probably emit an event `newDex`.\n\n\n##### Recommendation\nIt is recommended to create new events.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-04-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Curve%20Voter%20Proxy/README.md#1-events-are-probably-missing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Curve%20Voter%20Proxy/Curve-voter-proxy%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unobvious exchange on Uniswap",
        "content": "##### Description\nAt the lines:\n- https://github.com/orbxball/curve-voter-proxy/blob/78c92e4ffc0f76651914565744a3607d0248d254/contracts/Strategy.sol#L263\n- https://github.com/orbxball/curve-voter-proxy/blob/78c92e4ffc0f76651914565744a3607d0248d254/contracts/Strategy.sol#L278\nare not clear why if `_crv > 0`, should be called `swapExactTokensForTokens` of `dex` (which can be address of UniSwap or SushiSwap), but when `_reward > 0`, the same call is made for `uniswap`.\n\n##### Recommendation\nIf this is done on purpose, an explanation is needed. It is recommended to make an explanation.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-04-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Curve%20Voter%20Proxy/README.md#2-unobvious-exchange-on-uniswap",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Curve%20Voter%20Proxy/Curve-voter-proxy%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Code smell",
        "content": "##### Description\nAt the lines https://github.com/orbxball/curve-voter-proxy/blob/78c92e4ffc0f76651914565744a3607d0248d254/contracts/Strategy.sol#L239-L300\n\ncode has several problems at once.\n- Too long function. The function takes 61 lines. It is difficult to understand.\n- In one place collected various logic. It is recommended to split into separate methods. For example, lines from 249 to 264 is the function `checkCrv()`, and the lines from 268 to 279 are the `checkReward()` function.\n- Duplication code. Lines 255-256, 270-271, 283-284, 289-290 can be combined to call one function with parameters.\n\n\n##### Recommendation\nIt is recommended to make a refactoring source code.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-04-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Curve%20Voter%20Proxy/README.md#3-code-smell",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Curve%20Voter%20Proxy/Curve-voter-proxy%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect use of a library function",
        "content": "##### Description\nAt the lines \n- https://github.com/yearn/yearn-vaults/tree/e390c2a6b2ba6e2ecc8f3a72a1ea4adfabd17544/contracts/BaseWrapper.sol#L117\n- https://github.com/yearn/yearn-vaults/tree/e390c2a6b2ba6e2ecc8f3a72a1ea4adfabd17544/contracts/BaseWrapper.sol#L198\nuse the `safeApprove()` function from the `SafeERC20` library.\nBut before giving permission for a certain amount of tokens, you first need to zero this value.\nNow the `safeApprove()` function is called only once with a specific value.\nAfter the first call, everything will work, but after the second call, the function will be blocked. \n\n##### Recommendation\nIt is necessary to make a correct call to the `safeApprove()` function:\n```\n  token.safeApprove(addressValue, 0);\n  token.safeApprove(addressValue, amount);\n``` \n",
        "protocol": "Yearn Finance",
        "report_date": "2021-04-09",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Vaults%20V3/README.md#1-incorrect-use-of-a-library-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Vaults%20V3/Yearn%20Vaults%20v.3%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Outdated `_cachedVaults` after `registry` changing",
        "content": "##### Description\nEach `registry` has own `vaults` variable. It is possible that new `registry` contains different set of Vaults. In `allVaults` function we always copy old `_cachedVaults` https://github.com/yearn/yearn-vaults/blob/e390c2a6b2ba6e2ecc8f3a72a1ea4adfabd17544/contracts/BaseWrapper.sol#L71-73. \n\nThe cache is updated with `allVaults` produce https://github.com/yearn/yearn-vaults/blob/e390c2a6b2ba6e2ecc8f3a72a1ea4adfabd17544/contracts/BaseWrapper.sol#L148-149.\n\nSo we will never update `_cachedVaults` prefix part.\n\n##### Recommendation\nIt is recommended to update all elements of the `_cachedVaults` array in the `setRegistry()` function.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-04-09",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Vaults%20V3/README.md#2-outdated-_cachedvaults-after-registry-changing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Vaults%20V3/Yearn%20Vaults%20v.3%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Gas overflow during iteration (DoS)",
        "content": "##### Description\nEach iteration of the cycle requires a gas flow.\nA moment may come when more gas is required than it is allocated to record one block. In this case, all iterations of the loop will fail.\n\nAt the lines \nhttps://github.com/yearn/yearn-vaults/blob/e390c2a6b2ba6e2ecc8f3a72a1ea4adfabd17544/contracts/yToken.sol#L107\nhttps://github.com/yearn/yearn-vaults/blob/e390c2a6b2ba6e2ecc8f3a72a1ea4adfabd17544/contracts/yToken.sol#L154\nhttps://github.com/yearn/yearn-vaults/blob/e390c2a6b2ba6e2ecc8f3a72a1ea4adfabd17544/contracts/BaseWrapper.sol#L151\n\nfor the `vaults` address array is not checked for its length. In iterations, data is written to the blockchain, which requires gas consumption. The contract has logic for adding new elements to the `vaults` array, but no logic for removing them.\n\n##### Recommendation\nIt is recommended adding a check for the maximum possible number of elements of the arrays.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-04-09",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Vaults%20V3/README.md#1-gas-overflow-during-iteration-dos",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Vaults%20V3/Yearn%20Vaults%20v.3%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No validation of the address parameter value in contract constructor",
        "content": "##### Description\nThe variable is assigned the value of the constructor input parameter. But this parameter is not checked before this. If the value turns out to be zero, then it will be necessary redeploy the contract, since there is no other functionality to set this variable.\n\n- At the line https://github.com/yearn/yearn-vaults/tree/e390c2a6b2ba6e2ecc8f3a72a1ea4adfabd17544/contracts/BaseWrapper.sol#L45 the `token` variable is set to the value of the `_token` input parameter.\n\n##### Recommendation\nIt is necessary to add a check of the input parameter to zero before initializing the variables.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-04-09",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Vaults%20V3/README.md#2-no-validation-of-the-address-parameter-value-in-contract-constructor",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Vaults%20V3/Yearn%20Vaults%20v.3%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No response check after function call to transfer tokens",
        "content": "##### Description\nAccording to the ERC-20 standard, the token transfer functions return a boolean variable.\nIt is necessary to process the function response after the token transfer.\nBut now there is no such functionality on the following lines:\n- https://github.com/yearn/yearn-vaults/tree/e390c2a6b2ba6e2ecc8f3a72a1ea4adfabd17544/contracts/BaseWrapper.sol#L137\n- https://github.com/yearn/yearn-vaults/tree/e390c2a6b2ba6e2ecc8f3a72a1ea4adfabd17544/contracts/BaseWrapper.sol#L171\n\n##### Recommendation\nIt is recommended to add a return value check after the token transfer.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-04-09",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Vaults%20V3/README.md#3-no-response-check-after-function-call-to-transfer-tokens",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Vaults%20V3/Yearn%20Vaults%20v.3%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Check for a zero input value",
        "content": "##### Description\nAt the line https://github.com/yearn/yearn-vaults/blob/e390c2a6b2ba6e2ecc8f3a72a1ea4adfabd17544/contracts/BaseWrapper.sol#L50  there is no check for a zero input value in method `setRegistry()`.\n\n##### Recommendation\nIt is necessary to add a check of the input parameter to zero before initializing the variables.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-04-09",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Vaults%20V3/README.md#4-check-for-a-zero-input-value",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Vaults%20V3/Yearn%20Vaults%20v.3%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "An attack like `Reentrancy` is possible",
        "content": "##### Description\nAt the line https://github.com/yearn/yearn-vaults/tree/e390c2a6b2ba6e2ecc8f3a72a1ea4adfabd17544/contracts/yToken.sol#L186\nthe sending of the entire ETH that is on the balance sheet of the contract is made.\nBut the sender can be a smart contract in which the function for receiving ETH calls the function `withdrawETH()` in the contract.\nIn this case, the behavior of the contract will differ from what is expected.\n\n##### Recommendation\nWhen calling the `withdrawETH()` function, it is recommended to use the `nonReentrant` access modifier from the contract:\nhttps://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/security/ReentrancyGuard.sol.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-04-09",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Vaults%20V3/README.md#5-an-attack-like-reentrancy-is-possible",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Vaults%20V3/Yearn%20Vaults%20v.3%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Event is probably missing",
        "content": "##### Description:\nAt the line https://github.com/yearn/yearn-vaults/tree/e390c2a6b2ba6e2ecc8f3a72a1ea4adfabd17544/contracts/BaseWrapper.sol#L50 in method `setRegistry()` should probably emit an event `SetRegistry`.\nAt the line https://github.com/yearn/yearn-vaults/tree/e390c2a6b2ba6e2ecc8f3a72a1ea4adfabd17544/contracts/BaseWrapper.sol#L104 in method `_deposit()` should probably emit an event `Deposit`.\nAt the line https://github.com/yearn/yearn-vaults/tree/e390c2a6b2ba6e2ecc8f3a72a1ea4adfabd17544/contracts/BaseWrapper.sol#L140 in method `_withdraw()` should probably emit an event `Withdraw`.\nAt the line https://github.com/yearn/yearn-vaults/tree/e390c2a6b2ba6e2ecc8f3a72a1ea4adfabd17544/contracts/BaseWrapper.sol#L218 in method `_migrate()` should probably emit an event `Migrate`.\n\nAt the line https://github.com/yearn/yearn-vaults/tree/e390c2a6b2ba6e2ecc8f3a72a1ea4adfabd17544/contracts/Registry.vy#L304 in method `setBanksy()` should probably emit an event `SetBanksy`.\n\nAt the line https://github.com/yearn/yearn-vaults/blob/e390c2a6b2ba6e2ecc8f3a72a1ea4adfabd17544/contracts/yToken.sol#L171 in method `depositETH()` should probably emit an event `DepositETH`.\nAt the line https://github.com/yearn/yearn-vaults/blob/e390c2a6b2ba6e2ecc8f3a72a1ea4adfabd17544/contracts/yToken.sol#L180 in method `withdrawETH` should probably emit an event `WithdrawETH`.\n\n\n##### Recommendation\nIt is recommended to create new events.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-04-09",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Vaults%20V3/README.md#1-event-is-probably-missing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Vaults%20V3/Yearn%20Vaults%20v.3%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The name of the function does not correspond to the logic of work",
        "content": "##### Description:\nAt the line https://github.com/yearn/yearn-vaults/tree/e390c2a6b2ba6e2ecc8f3a72a1ea4adfabd17544/contracts/Registry.vy#L316 in method `setBanksy()` should probably emit an event `SetBanksy`.\nLine 316 has a function called `tagVault()`. This is the name for the function for reading the value of a variable.\nBut in this function, a new value of the variable is being set.\nThe name of the function does not correspond to the logic of work.\n\n##### Recommendation\nIt is recommended to name the function `setTagVault()`.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-04-09",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Vaults%20V3/README.md#2-the-name-of-the-function-does-not-correspond-to-the-logic-of-work",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yearn%20Vaults%20V3/Yearn%20Vaults%20v.3%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Correct migration",
        "content": "##### Description\nIn constructor, rights are granted to spend tokens, which should be canceled when migrating the strategy.\n- https://github.com/andy8052/yveCRV-vault/blob/6706b9ad45e71ee9014454419f229adfa6409f1d/contracts/Strategy.sol#L171\n\n##### Recommendation\nIt is recommended to add in function `prepareMigration()`:\n```solidity\n    IERC20(crv).safeApprove(address(want), 0);\n    IERC20(usdc).safeApprove(sushiswap, 0);\n    \n    IyveCRV(address(want)).claim();\n    want.safeTransfer(_newStrategy, want.balanceOf(address(this)));\n    \n    IERC20(usdc).safeTransfer(_newStrategy, IERC20(usdc).balanceOf(address(this)));\n    \n    want.safeApprove(vault, 0);\n    vault.approve(rewards, 0);\n```",
        "protocol": "Yearn Finance",
        "report_date": "2021-04-06",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yveCRV/README.md#1-correct-migration",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yveCRV/yveCRV-vault%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Missed token",
        "content": "##### Description\nAt the line: https://github.com/andy8052/yveCRV-vault/blob/6706b9ad45e71ee9014454419f229adfa6409f1d/contracts/Strategy.sol#L266-L277\nThe function `protectedTokens()` is used for removing tokens from this Strategy that are not the type of tokens managed by this Strategy. This may be used in case of accidentally sending the wrong kind of token to this Strategy.This will  fail if an attempt is made to sweep `want`, or any tokens that are protected by this Strategy. But in this implementation the `yveCrv` token is not protected.\n\n##### Recommendation\nIt is recommended to replace `want` token for  `yveCrv` in the `protected[]` array.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-04-06",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yveCRV/README.md#1-missed-token",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yveCRV/yveCRV-vault%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "The approval value obtained in the constructor may not be enough for the long term of the smart contract",
        "content": "##### Description\nSmart contracts call `safeApprove()` functions for different tokens. But in the process of work, the obtained value will only decrease. If this value decreases to zero, then the tokens will remain locked in the contract forever.\nIt is at the following lines:\n- https://github.com/andy8052/yveCRV-vault/blob/6706b9ad45e71ee9014454419f229adfa6409f1d/contracts/Strategy.sol#L96-L97\n  \n##### Recommendation\nIt is recommended to add a function to increase the value of approvals.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-04-06",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yveCRV/README.md#2-the-approval-value-obtained-in-the-constructor-may-not-be-enough-for-the-long-term-of-the-smart-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yveCRV/yveCRV-vault%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "There is no input parameter processing in the method",
        "content": "##### Description\nAt the lines:\n- https://github.com/andy8052/yveCRV-vault/blob/6706b9ad45e71ee9014454419f229adfa6409f1d/contracts/Strategy.sol#L151\nthe `adjustPosition()` method has an input variable `_debtOutstanding`.\nBut there is no processing of this variable in the body of the function.\n  \n##### Recommendation\nIt is recommended to either add handling to the variable or remove this variable.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-04-06",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yveCRV/README.md#1-there-is-no-input-parameter-processing-in-the-method",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yveCRV/yveCRV-vault%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Event is probably missing",
        "content": "##### Description:\nAt the lines: https://github.com/andy8052/yveCRV-vault/blob/6706b9ad45e71ee9014454419f229adfa6409f1d/contracts/Strategy.sol#L259\nin method `setBuffer` should probably emit an event `SetBuffer`.\n\n\n##### Recommendation\nIt is recommended to create new event.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-04-06",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yveCRV/README.md#2-event-is-probably-missing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/yveCRV/yveCRV-vault%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Reward sniffing",
        "content": "##### Description\nUser can deposit-withdraw tokens several times (at the same transaction), causing reward sniffing.\nThe emulation of this behavior is presented below:\n```python\ndef main():\n    deployer = accounts[0]\n    workerOwner = accounts[1]\n    \n    escrow = deployer.deploy(StakingEscrowMock)\n    escrow.setAllTokens(9000)\n\n    token = deployer.deploy(EasyToken, 1000_000)\n    stacking = deployer.deploy(PoolingStakingContractV2)\n    workerFraction = 1\n    stacking.initialize(workerFraction, token, escrow, workerOwner, {'from': deployer})\n    stacking.enableDeposit({'from': deployer})\n\n    user1 = accounts[2]\n    user2 = accounts[3]\n    deployer.transfer(stacking, 6000)\n    token.mint(user1, 1000_000)\n    token.mint(user2, 1000_000)\n\n    token.approve(stacking, 100_000, {'from': user1})\n    stacking.depositTokens(100_000, {'from': user1})\n    \n    for _ in range(100):\n        token.approve(stacking, 100, {'from': user2})\n        stacking.depositTokens(100, {'from': user2})\n        stacking.withdrawAll({'from': user2})\n    \n    user1_balance = token.balanceOf(user1)\n    user2_balance = token.balanceOf(user2)\n    stacking_balance = token.balanceOf(stacking)\n\n    print(\"user1_balance\", user1_balance)\n    print(\"user2_balance\", user2_balance)\n    print(\"stacking_balance\", stacking_balance)\n\n    stacking.withdrawAll({'from': user1})  # >>>> ERROR HERE <<<<\n```\n##### Recommendation\nMay be add a check in withdrawAll function to requre deposit DISABLED?\n",
        "protocol": "NuCypher",
        "report_date": "2021-03-25",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/README.md#1-reward-sniffing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/NuCypher%20PoolingStakingContractV2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Reentry in `withdrawAll`",
        "content": "##### Description\nMalicious token/workerOwner may have a reentry callback to the contract here\n\nhttps://github.com/nucypher/nucypher/blob/main/nucypher/blockchain/eth/sol/source/contracts/staking_contracts/PoolingStakingContractV2.sol#L236\n\nbut the state of the contract changes here\n\nhttps://github.com/nucypher/nucypher/blob/main/nucypher/blockchain/eth/sol/source/contracts/staking_contracts/PoolingStakingContractV2.sol#L247\nit allows to use reentry.\n\n##### Recommendation\nPut transfers as the last statements of the method.\n",
        "protocol": "NuCypher",
        "report_date": "2021-03-25",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/README.md#1-reentry-in-withdrawall",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/NuCypher%20PoolingStakingContractV2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Lack of docs",
        "content": "##### Description\nThe purpose of the contract and the way it will work is not clear from the code.\nAlso the logic with accumulated `getCumulativeReward` and `totalWithdrawnReward` must be described in the code as well as the typical scenario of the contract usage.\n\n##### Recommendation\nAdd comprehensive docstrings.\n",
        "protocol": "NuCypher",
        "report_date": "2021-03-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/README.md#1-lack-of-docs",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/NuCypher%20PoolingStakingContractV2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Reentry causing events misordering",
        "content": "##### Description\nAt lines:\n- https://github.com/nucypher/nucypher/blob/main/nucypher/blockchain/eth/sol/source/contracts/staking_contracts/PoolingStakingContractV2.sol#L105\n- https://github.com/nucypher/nucypher/blob/main/nucypher/blockchain/eth/sol/source/contracts/staking_contracts/PoolingStakingContractV2.sol#L192\n- https://github.com/nucypher/nucypher/blob/main/nucypher/blockchain/eth/sol/source/contracts/staking_contracts/PoolingStakingContractV2.sol#L211\n- https://github.com/nucypher/nucypher/blob/main/nucypher/blockchain/eth/sol/source/contracts/staking_contracts/PoolingStakingContractV2.sol#L236\n- https://github.com/nucypher/nucypher/blob/main/nucypher/blockchain/eth/sol/source/contracts/staking_contracts/PoolingStakingContractV2.sol#L249\n- https://github.com/nucypher/nucypher/blob/main/nucypher/blockchain/eth/sol/source/contracts/staking_contracts/PoolingStakingContractV2.sol#L255\n- https://github.com/nucypher/nucypher/blob/main/nucypher/blockchain/eth/sol/source/contracts/staking_contracts/PoolingStakingContractV2.sol#L287\n\n##### Recommendation\nPlace the `transfer` on the last line of the method.\n",
        "protocol": "NuCypher",
        "report_date": "2021-03-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/README.md#2-reentry-causing-events-misordering",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/NuCypher%20PoolingStakingContractV2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Deflation tokens support",
        "content": "##### Description\nIt might be never known that after calling `transfer(value)` the token will really increase someone's balance by `value`, some deflation tokens \"burn\" some value on every transfer call. So the only way to know it is explicitly checking balance of the tokens' owner after transfer.\n\n##### Recommendation\nAdd deflation tokens support or explicitly specify in docstring that deflation tokens are not supported.\n",
        "protocol": "NuCypher",
        "report_date": "2021-03-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/README.md#3-deflation-tokens-support",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/NuCypher%20PoolingStakingContractV2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Use different tokens as deposit and rewards",
        "content": "##### Description\nIt's a common practice to split deposit tokens and rewards tokens into 2 different types of tokens because it's safer and user can always withdraw his deposit.\nAlso, attacks on rewards would not affect the deposit itself.\n\n##### Recommendation\nWe recommend to split tokens.\n",
        "protocol": "NuCypher",
        "report_date": "2021-03-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/README.md#1-use-different-tokens-as-deposit-and-rewards",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/NuCypher%20PoolingStakingContractV2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Uninformative names of an event and a function",
        "content": "##### Description\nAt the lines:\n- https://github.com/nucypher/nucypher/blob/main/nucypher/blockchain/eth/sol/source/contracts/staking_contracts/PoolingStakingContractV2.sol#L28\n- https://github.com/nucypher/nucypher/blob/main/nucypher/blockchain/eth/sol/source/contracts/staking_contracts/PoolingStakingContractV2.sol#L152\n##### Recommendation\nMake the names more informative (E.g. `DepositIsEnabledSet` and `getAvailableDelegatorReward`[to avoid double naming])\n",
        "protocol": "NuCypher",
        "report_date": "2021-03-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/README.md#2-uninformative-names-of-an-event-and-a-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/NuCypher%20PoolingStakingContractV2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Rough BASIS_FRACTION",
        "content": "##### Description\nAt the line https://github.com/nucypher/nucypher/blob/main/nucypher/blockchain/eth/sol/source/contracts/staking_contracts/PoolingStakingContractV2.sol#L37\n`BASIS_FRACTION = 100` is too rough.\n\n##### Recommendation\nIt would be better to set it to 10000 or even more to increase accuracy.\n",
        "protocol": "NuCypher",
        "report_date": "2021-03-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/README.md#3-rough-basis_fraction",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/NuCypher%20PoolingStakingContractV2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Const `workerOwner`",
        "content": "##### Description\nhttps://github.com/nucypher/nucypher/blob/main/nucypher/blockchain/eth/sol/source/contracts/staking_contracts/PoolingStakingContractV2.sol#L40\nIt's not clear why `workerOwner` is a `const`.\n\n##### Recommendation\nIf it's not supposed to be transferred, write a comment describing this. \n",
        "protocol": "NuCypher",
        "report_date": "2021-03-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/README.md#4-const-workerowner",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/NuCypher%20PoolingStakingContractV2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Explicit visibility of `workerFraction`",
        "content": "##### Description\nExplicit statements make code more readable.\nhttps://github.com/nucypher/nucypher/blob/main/nucypher/blockchain/eth/sol/source/contracts/staking_contracts/PoolingStakingContractV2.sol#L46\n##### Recommendation\nAdd `public` visibility modifier\n",
        "protocol": "NuCypher",
        "report_date": "2021-03-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/README.md#5-explicit-visibility-of-workerfraction",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/NuCypher%20PoolingStakingContractV2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "External `initialize`",
        "content": "##### Description\nSince it will be called by the end-user only, it's better to use `external` modifier: https://github.com/nucypher/nucypher/blob/main/nucypher/blockchain/eth/sol/source/contracts/staking_contracts/PoolingStakingContractV2.sol#L59\n\n##### Recommendation\nUse `external` modifier\n",
        "protocol": "NuCypher",
        "report_date": "2021-03-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/README.md#6-external-initialize",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/NuCypher%20PoolingStakingContractV2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`getWorkerFraction` is not needed",
        "content": "##### Description\nPublic attributes already have getters\nhttps://github.com/nucypher/nucypher/blob/main/nucypher/blockchain/eth/sol/source/contracts/staking_contracts/PoolingStakingContractV2.sol#L91\n\n##### Recommendation\nRemove the method `getWorkerFraction`.\n",
        "protocol": "NuCypher",
        "report_date": "2021-03-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/README.md#7-getworkerfraction-is-not-needed",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/NuCypher%20PoolingStakingContractV2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Comment required",
        "content": "##### Description\nIt's not intuitive what is happening here\n- https://github.com/nucypher/nucypher/blob/main/nucypher/blockchain/eth/sol/source/contracts/staking_contracts/PoolingStakingContractV2.sol#L116\n- https://github.com/nucypher/nucypher/blob/main/nucypher/blockchain/eth/sol/source/contracts/staking_contracts/PoolingStakingContractV2.sol#L140\n- \n##### Recommendation\nAdd the comment to the code.\n",
        "protocol": "NuCypher",
        "report_date": "2021-03-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/README.md#8-comment-required",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/NuCypher%20PoolingStakingContractV2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Avoid ternary",
        "content": "##### Description\nIf-else statement is more clear way for complex conditions\n- https://github.com/nucypher/nucypher/blob/main/nucypher/blockchain/eth/sol/source/contracts/staking_contracts/PoolingStakingContractV2.sol#L168\n\n##### Recommendation\nUse if-else statement.\n",
        "protocol": "NuCypher",
        "report_date": "2021-03-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/README.md#9-avoid-ternary",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/NuCypher%20PoolingStakingContractV2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Not clear TODO-comment",
        "content": "##### Description\nIt's not clear what is that `TODO` about\nhttps://github.com/nucypher/nucypher/blob/main/nucypher/blockchain/eth/sol/source/contracts/staking_contracts/PoolingStakingContractV2.sol#L226\n\n##### Recommendation\nAdd more details into commentary \n",
        "protocol": "NuCypher",
        "report_date": "2021-03-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/README.md#10-not-clear-todo-comment",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/NuCypher/NuCypher%20PoolingStakingContractV2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Withdrawal from an account exceeding availible assets",
        "content": "##### Description\nThe contractor discovered a code that is potentially susceptible to contract failure due to throw from another contract.\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyDAI.sol#L164\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDC.sol#L164\n\n##### Recommendation\nIt is recommended to add validation which was done in the contract:\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDT.sol#L163\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-03-24",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%203pool/README.md#1-withdrawal-from-an-account-exceeding-availible-assets",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%203pool/Yearn-stablecoins-3pool%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Incorrect transfer of parameter values",
        "content": "##### Description\nAt the lines:\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDC.sol#L222\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDT.sol#L224\nthe parameters are not passed correctly.\n\n\n##### Recommendation\nIt is recommended to fixed it.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-03-24",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%203pool/README.md#2-incorrect-transfer-of-parameter-values",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%203pool/Yearn-stablecoins-3pool%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Forced deposit from an account exceeding available assets",
        "content": "##### Description\nIt is possible get an exception due to throw from another contract while depositing. \n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyDAI.sol#L207\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDC.sol#L207\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDT.sol#L209\n\n##### Recommendation\nIt is recommended to add the following check:\n```solidity\nuint256 _amt = want.balanceOf(address(this));\nif (_amount > _amt) _amount = _amt;\n```",
        "protocol": "Yearn Finance",
        "report_date": "2021-03-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%203pool/README.md#1-forced-deposit-from-an-account-exceeding-available-assets",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%203pool/Yearn-stablecoins-3pool%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Forced withdrawal from an account exceeding available assets",
        "content": "##### Description\nContract potentially can failure due to throw from another contract while withdrawal amount of tokens which exceed available assets.\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyDAI.sol#L217\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDC.sol#L217\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDT.sol#L219\n\n##### Recommendation\nA possible solution would be to add the following check:\n```solidity\nuint256 _bal = IERC20(y3crv).balanceOf(address(this));\nif (_amt > _bal) _amt = _bal;\n```",
        "protocol": "Yearn Finance",
        "report_date": "2021-03-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%203pool/README.md#2-forced-withdrawal-from-an-account-exceeding-available-assets",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%203pool/Yearn-stablecoins-3pool%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "There is no input parameter processing in the method",
        "content": "##### Description\nAt the lines:\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyDAI.sol#L99\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDC.sol#L99\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDT.sol#L99\nthe `adjustPosition()` method has an input variable `_debtOutstanding`.\nBut there is no processing of this variable in the body of the function.\n  \n##### Recommendation\nIt is recommended to either add handling to the variable or remove this variable.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-03-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%203pool/README.md#3-there-is-no-input-parameter-processing-in-the-method",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%203pool/Yearn-stablecoins-3pool%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "The approval value obtained in the constructor may not be enough for the long term of the smart contract",
        "content": "##### Description\nSmart contracts call `safeApprove()` functions for different tokens. But in the process of work, the obtained value will only decrease. If this value decreases to zero, then the tokens will remain locked in the contract forever.\nIt is at the following lines:\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyDAI.sol#L39-L41\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDC.sol#L39-L41\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDT.sol#L39-L41\n  \n##### Recommendation\nIt is recommended to add a function to increase the value of approvals.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-03-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%203pool/README.md#4-the-approval-value-obtained-in-the-constructor-may-not-be-enough-for-the-long-term-of-the-smart-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%203pool/Yearn-stablecoins-3pool%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Possible flashloan attacks",
        "content": "##### Description\nIn current contract some functions can be influenced by flashloan attacks.\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyDAI.sol#L71\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDC.sol#L71\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDT.sol#L71\n\n##### Recommendation\nIt is recommended to check the return value for validity when calling the `balanceOfy3CRVinWant()` function.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-03-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%203pool/README.md#5-possible-flashloan-attacks",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%203pool/Yearn-stablecoins-3pool%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Correct migration",
        "content": "##### Description\nIn constructor, rights are granted to spend tokens, which should be canceled when migrating the strategy.\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyDAI.sol#L175\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDC.sol#L175\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDT.sol#L177\n\n##### Recommendation\nIt is recommended to add in function `prepareMigration()`:\n```solidity\nwant.safeTransfer(_newStrategy, want.balanceOf(address(this)));\nwant.safeApprove(_3pool, 0);\nIERC20(_3crv).safeApprove(y3crv, 0);\nIERC20(_3crv).safeApprove(_3pool, 0);\n```",
        "protocol": "Yearn Finance",
        "report_date": "2021-03-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%203pool/README.md#6-correct-migration",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%203pool/Yearn-stablecoins-3pool%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Event is probably missing",
        "content": "##### Description:\nAt the lines:\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyDAI.sol#L205-L213\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDC.sol#L205-L213\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDT.sol#L207-L215\nin method `forceD()` should probably emit an event `ForceDeposit`.\n\nAt the lines:\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyDAI.sol#L215-L225\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDC.sol#L215-L225\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDT.sol#L217-L227\nin method `forceW()` should probably emit an event `ForceWithdraw`.\n\nAt the lines:\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyDAI.sol#L44-L50\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDC.sol#L44-L50\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDT.sol#L44-L50\nthe methods `setThreshold()` and `setSlip` should probably emit an events: `NewThreshold` and `NewSlip`.\n\nAt the lines:\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyDAI.sol#L197-L203\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDC.sol#L197-L203\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDT.sol#L199-L205\nin method `rebalance()` should probably emit an event `Rebalance`.\n\n##### Recommendation\nIt is recommended to create new events.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-03-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%203pool/README.md#1-event-is-probably-missing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%203pool/Yearn-stablecoins-3pool%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Not informative names of functions and variables",
        "content": "##### Description\nFor the function names `forceD ()` and `forceW ()`, it is not clear what these functions are used for.\nIt is at the following lines:\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyDAI.sol#L205-L225\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDC.sol#L205-L225\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDT.sol#L207-L227\n\nFor the names of the variables `p` and` _p`, it is impossible to understand what these variables are used for.\nIt is on the following lines:\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyDAI.sol#L84-L92\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDC.sol#L84-L92\n- https://github.com/orbxball/stablecoins-3pool/blob/adeb776933c6cb3b8306239cc3357d4c6239a88d/contracts/StrategyUSDT.sol#L84-L92\n\nCorrect names of functions and variables make programs easier to use.\n\n##### Recommendation\nIt is recommended to give correct names to functions and variables.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-03-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%203pool/README.md#2-not-informative-names-of-functions-and-variables",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%203pool/Yearn-stablecoins-3pool%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Use msgSender instead of msg.sender in Event param",
        "content": "##### Description\nSince the contract uses metatransactions everywhere (and uses NativeMetaTransaction), you should always use `msgSender()`\n- https://github.com/RealityCards/RealityCards-Contracts/blob/fd3b713d1a15f92ebc329f85038b76563f1587b8/contracts/RCMarket.sol#L584\n\notherwise the event parameter maybe not correct\n\nlook at the logic at https://github.com/RealityCards/RealityCards-Contracts/blob/fd3b713d1a15f92ebc329f85038b76563f1587b8/contracts/lib/NativeMetaTransaction.sol#L105\n\nBut at https://github.com/RealityCards/RealityCards-Contracts/blob/fd3b713d1a15f92ebc329f85038b76563f1587b8/contracts/RCMarket.sol#L579 the `msgSender()`, so it is used what is not consistent.\n\n##### Recommendation\nIt is recommended to use `msgSender()` in all of `msg.sender` usages (see also: https://medium.com/biconomy/biconomy-supports-native-meta-transactions-243ce52a2a2b).\n",
        "protocol": "Reality Cards",
        "report_date": "2021-03-23",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Reality%20Cards/README.md#1-use-msgsender-instead-of-msgsender-in-event-param",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Reality%20Cards/RealityCards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Check that the address is not zero",
        "content": "##### Description\nThe following lines use address variables. But if the value turns out to be zero, funds will be lost:\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCTreasury.sol#L163\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyMainnet.sol#L70\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyMainnet.sol#L75\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyMainnet.sol#L80\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyMainnet.sol#L85\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyMainnet.sol#L90\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyMainnet.sol#L100\n- https://github.com/RealityCards/RealityCards-Contracts/blob/fd3b713d1a15f92ebc329f85038b76563f1587b8/contracts/bridgeproxies/RCProxyMainnet.sol#L104\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyXdai.sol#L95\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyXdai.sol#L100\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyXdai.sol#L105\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyXdai.sol#L110\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyXdai.sol#L120\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyXdai.sol#L142-L149\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyXdai.sol#L182\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/nfthubs/RCNftHubMainnet.sol#L29\n\n##### Recommendation\nIt is recommended to add a check that address is valid.\n",
        "protocol": "Reality Cards",
        "report_date": "2021-03-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Reality%20Cards/README.md#1-check-that-the-address-is-not-zero",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Reality%20Cards/RealityCards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Use general `safeTransferFrom`",
        "content": "##### Description\nIt is required to check success of transfer. So it is should be handled as in ERC20:\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/nfthubs/RCNftHubXdai.sol#L69\n\n##### Recommendation\nIt is recommended to use the `safeTransferFrom()` method from the ERC20 safe library.\n",
        "protocol": "Reality Cards",
        "report_date": "2021-03-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Reality%20Cards/README.md#2-use-general-safetransferfrom",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Reality%20Cards/RealityCards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Missing the check whether `_timestamps` has an appropriate length",
        "content": "##### Description\nAt the lines \n- https://github.com/RealityCards/RealityCards-Contracts/tree/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCFactory.sol#L312-L313\n- https://github.com/RealityCards/RealityCards-Contracts/tree/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCFactory.sol#L317\n- https://github.com/RealityCards/RealityCards-Contracts/tree/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCFactory.sol#L320\n- https://github.com/RealityCards/RealityCards-Contracts/tree/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCFactory.sol#L352 \nhave operations with elements of the `_timestamps` array. It is possible that the number of transferred elements of the `_timestamps` array will be less than 3. In this case, a reference will be made to a nonexistent array element.\nFor clean code, it is better to avoid this situation and check the length of the array. \n\n##### Recommendation\nIt is recommended to check the number of array elements:\n`require(_timestamps.length < 3, \"Incorrect number of array elements\");`\n",
        "protocol": "Reality Cards",
        "report_date": "2021-03-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Reality%20Cards/README.md#1-missing-the-check-whether-_timestamps-has-an-appropriate-length",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Reality%20Cards/RealityCards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect function name",
        "content": "##### Description\nIn some function `setSomeValue()` the value of boolean variable `someValue` is reversed. But by setting it means setting any value and the value may not even change. It would be more correct to call not \"Set\", but \"Change\". This can be seen on the following lines:\n\n- https://github.com/RealityCards/RealityCards-Contracts/tree/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCFactory.sol#L187 \n- https://github.com/RealityCards/RealityCards-Contracts/tree/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCFactory.sol#L197\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCFactory.sol#L216\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCFactory.sol#L226\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCFactory.sol#L232\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCFactory.sol#L237\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCFactory.sol#L242\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCTreasury.sol#L125\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCTreasury.sol#L130\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyMainnet.sol#L137 \n\n##### Recommendation\nIt is recommended to rename a `setSomeValue()` function to `changeSomeValue()`.\n",
        "protocol": "Reality Cards",
        "report_date": "2021-03-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Reality%20Cards/README.md#2-incorrect-function-name",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Reality%20Cards/RealityCards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Difficult calculation of uint max",
        "content": "##### Description\nSee these lines: \n- https://github.com/RealityCards/RealityCards-Contracts/tree/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCMarket.sol#L29 \n- https://github.com/RealityCards/RealityCards-Contracts/tree/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCMarket.sol#L30\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyMainnet.sol#L91\n\nBoth of this values are worked out by strange way. E.g. 2**256 for uint256 will get 0.\nBut there are simpler ways to calculate the maximum value. For example:\n- `uint256 public constant MAX_UINT256 = uint256(-1);`\n- `uint256 public constant MAX_UINT256 = type(uint256).max;`\n\n##### Recommendation\nIt is recommended to make it clearer.\n",
        "protocol": "Reality Cards",
        "report_date": "2021-03-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Reality%20Cards/README.md#3-difficult-calculation-of-uint-max",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Reality%20Cards/RealityCards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Self-explainable naming",
        "content": "##### Description\n\nIt's good if the name of the variable is absolutely self-explainable.\nFor primitive types (integers) it's good to know what exactly the variable is.\nFor mappings it's better to add key to the name (e.g. userDeposits not just deposits)\n\n- key and value of struct is unclear\nhttps://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCFactory.sol#L38 - mappingOfMarkets\nhttps://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCMarket.sol#L49 - price\n\n- add Percent postfix\nhttps://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCFactory.sol#L46 - minimumPriceIncrease\nhttps://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCMarket.sol#L62 - minimumPriceIncrease\n\n- add DayDivisor postfix\nhttps://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCMarket.sol#L64 - minRentalDivisor\n\n- add weekDivisor postfix\nhttps://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCMarket.sol#L66 - hotPotatoDivisor\n\n- rentCollected postfix\nhttps://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCMarket.sol#L51\nhttps://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCMarket.sol#L53\nhttps://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCMarket.sol#L55\n\n- deposit - https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCTreasury.sol#L23 what is the key?\n\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyXdai.sol#L37 what is the key?\n\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyXdai.sol#L38 what is the key?\n\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyXdai.sol#L39 - must be upper-cased\n\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyXdai.sol#L47 - what is the key?\n\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyXdai.sol#L48 - what is the key?\n\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyXdai.sol#L118 - change amicable to some common word\n\n- https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/bridgeproxies/RCProxyXdai.sol#L50 - the purpose of the value is not clear from the name\n\n##### Recommendation\nIt is recommended to rename variables.\n",
        "protocol": "Reality Cards",
        "report_date": "2021-03-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Reality%20Cards/README.md#4-self-explainable-naming",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Reality%20Cards/RealityCards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Not optimal data type",
        "content": "##### Description\nAt the line https://github.com/RealityCards/RealityCards-Contracts/blob/8c0b05b25a7deef25f98532ae2f8afd4f9a84360/contracts/RCFactory.sol#L42 uses an array. But with the use of structure, the code will become clearer.\n\n##### Recommendation\nIt is recommended to make a structure.\n",
        "protocol": "Reality Cards",
        "report_date": "2021-03-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Reality%20Cards/README.md#5-not-optimal-data-type",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Reality%20Cards/RealityCards%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No check `_amt` value under withdraw",
        "content": "##### Description\nAt the lines:\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyDAIypool.sol#L207\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyTUSDypool.sol#L207\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDCypool.sol#L207\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDTypool.sol#L207\nthere are not valid available balance on the contract. This will lead to the fact that the `_WithDRAWSome()` function will not always work. \n\nAt the lines:\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyDAIypool.sol#L265\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyTUSDypool.sol#L265\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDCypool.sol#L265\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDTypool.sol#L265\nthe same in the `forceW()` function.\n\n##### Recommendation\nIt is recommended to add additional check `_amt` value under withdraw operation:\n```soldity\nif (_amt > _before){ \n    _amt = _before;\n}\n```\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-03-22",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%20Ypool/README.md#1-no-check-_amt-value-under-withdraw",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%20Ypool/Yearn-stablecoins-ypool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "There is no input parameter processing in the method",
        "content": "##### Description\nAt the lines:\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyDAIypool.sol#L112\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyTUSDypool.sol#L112\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDCypool.sol#L112\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDTypool.sol#L112\nthe `adjustPosition()` method has an input variable `_debtOutstanding`.\nBut there is no processing of this variable in the body of the function.\n  \n##### Recommendation\nIt is recommended to either add handling to the variable or remove this variable.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-03-22",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%20Ypool/README.md#1-there-is-no-input-parameter-processing-in-the-method",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%20Ypool/Yearn-stablecoins-ypool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The approval value obtained in the constructor may not be enough for the long term of the smart contract",
        "content": "##### Description\nSmart contracts call `safeApprove()` functions for different tokens. But in the process of work, the obtained value will only decrease. If this value decreases to zero, then the tokens will remain locked in the contract forever.\nIt is at the following lines:\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyDAIypool.sol#L48-L54\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyTUSDypool.sol#L48-L54\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDCypool.sol#L48-L54\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDTypool.sol#L48-L54\n  \n##### Recommendation\nIt is recommended to add a function to increase the value of approvals.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-03-22",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%20Ypool/README.md#2-the-approval-value-obtained-in-the-constructor-may-not-be-enough-for-the-long-term-of-the-smart-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%20Ypool/Yearn-stablecoins-ypool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Not informative names of functions and variables",
        "content": "##### Description\nFor the function names `forceD ()` and `forceW ()`, it is not clear what these functions are used for.\nIt is at the following lines:\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyDAIypool.sol#L250 and https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyDAIypool.sol#L263\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyTUSDypool.sol#L250 and https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyTUSDypool.sol#L263 \n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDCypool.sol#L250 and https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDCypool.sol#L263 \n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDTypool.sol#L250 and https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDTypool.sol#L263 \n\nFor the names of the variables `p` and` _p`, it is impossible to understand what these variables are used for.\nIt is on the following lines:\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyDAIypool.sol#L40 and https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyDAIypool.sol#L98-L105\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyTUSDypool.sol#L40 and https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyTUSDypool.sol#L98-L105 \n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDCypool.sol#L40 and https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDCypool.sol#L98-L105 \n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDTypool.sol#L40 and https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDTypool.sol#L98-L105 \n\nCorrect names of functions and variables make programs easier to use.\n\n##### Recommendation\nIt is recommended to give correct names to functions and variables.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-03-22",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%20Ypool/README.md#1-not-informative-names-of-functions-and-variables",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%20Ypool/Yearn-stablecoins-ypool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Event is probably missing",
        "content": "##### Description:\nAt the lines:\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyDAIypool.sol#L250-L261\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyTUSDypool.sol#L250-L261\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDCypool.sol#L250-L261\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDTypool.sol#L250-L261\nin method `forceD()` should probably emit an event `ForceDeposit`.\n\nAt the lines:\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyDAIypool.sol#L263-L273\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyTUSDypool.sol#L263-L273\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDCypool.sol#L263-L273\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDTypool.sol#L263-L273\nin method `forceW()` should probably emit an event `ForceWithdraw`.\n\nAt the lines:\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyDAIypool.sol#L57-L63\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyTUSDypool.sol#L57-L63\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDCypool.sol#L57-L63\n- https://github.com/orbxball/stablecoins-ypool/blob/5d80af7aeeff9f9b8f6d47d0334d36db3e97e5e4/contracts/StrategyUSDTypool.sol#L57-L63\nthe methods `setThreshold()` and `setSlip` should probably emit the events: `NewThreshold` and `NewSlip`.\n\n##### Recommendation\nIt is recommended to create new events.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-03-22",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%20Ypool/README.md#2-event-is-probably-missing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Stablecoins%20Ypool/Yearn-stablecoins-ypool%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potential `safeApprove` blocking",
        "content": "##### Description\nAt several places, e.g. https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/Investment.sol#L182 contract perform `safeApprove` before uniswap's function call, however in case if uniswap doesn't use full provided allowance that can lead to blocking next `safeApprove` call because `safeApprove` requires zero allowance.\n\nAnother lines with same issue:\n- https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/Market.sol#L248\n- https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/profit/Buyback.sol#L125\n- https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/profit/ProfitSplitter.sol#L195\n- https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/profit/ProfitSplitter.sol#L204\n- https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/profit/UniswapMarketMaker.sol#L116\n- https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/profit/UniswapMarketMaker.sol#L124\n- https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/profit/UniswapMarketMaker.sol#L125\n- https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/profit/UniswapMarketMaker.sol#L151\n- https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/profit/UniswapMarketMaker.sol#L152\n- https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/profit/UniswapMarketMaker.sol#L181\n\n##### Recommendation\nWe recommend to always reset allowance to zero by calling `safeApprove` with `0` amount.\n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#1-potential-safeapprove-blocking",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Wrongly calculated ETH amount to transfer",
        "content": "##### Description\nAt lines https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/profit/ProfitSplitter.sol#L198-L205 contract swaps whole `splitterIncomingBalance` to ETH if `splitterIncomingBalance` insufficient to cover gap between `splitterEthBalance` and `amount`, in other words contract try to get as much as closer to `amount` ETH amount. However as we can see in this block of code contract assigns `amountsOut[1]` to `amount`, it's wrong because we need to assign `splitterEthBalance.add(amountsOut[1])`\n\n##### Recommendation\nWe recommend to assign `splitterEthBalance.add(amountsOut[1])` to `amount` instead of `amountsOut[1]`\n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#2-wrongly-calculated-eth-amount-to-transfer",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potential re-entrancy problem",
        "content": "##### Description\nAt the line https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/profit/ProfitSplitter.sol#L227 contract transfers incoming tokens to `recipient`, however that place can be re-entered in case of callbacks from `incoming` contract.\n\n##### Recommendation\nWe recommend to add re-entrancy guard\n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#3-potential-re-entrancy-problem",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Blocked LP tokens on contract",
        "content": "##### Description\nAt the line https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/profit/UniswapMarketMaker.sol#L85 contract changes `incoming` token to another one, while transferring contract sends all remaining `incoming` tokens to `_recipient`, but contract never check remaining incoming <> support LP tokens on contract side. That tokens cannot be rescued anymore after changing incoming.\n\n##### Recommendation\nWe recommend to remove all liquidity before changing `incoming` token\n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#4-blocked-lp-tokens-on-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Missed depositary check",
        "content": "##### Description\nIn function `buy` defined at https://github.com/bondappetit/bondappetit-protocol/blob/88680691fe8d872c5fc26e9500d19cf7caaa9861/contracts/CollateralMarket.sol#L120 contract exchanges collateral tokens to stable tokens. But in case of wrong `depositary` that code will lead to collateralization disbalance, that is bad even you have manual `depositary` changing mechanism because `issuer` requires exact list of depositaries and transaction wont fail because `rebalance` call is fault tolerance.\n\n##### Recommendation\nWe recommend check depositary\n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#5-missed-depositary-check",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Invalid depositary add/remove logic",
        "content": "##### Description\nAt lines https://github.com/bondappetit/bondappetit-protocol/blob/88680691fe8d872c5fc26e9500d19cf7caaa9861/contracts/depositary/AgregateDepositaryBalanceView.sol#L49, https://github.com/bondappetit/bondappetit-protocol/blob/88680691fe8d872c5fc26e9500d19cf7caaa9861/contracts/depositary/AgregateDepositaryBalanceView.sol#L62 are defined functions to add or remove depositaries, `depositariesIndex` map contains depositary indexes added to `depositaries` array. At line https://github.com/bondappetit/bondappetit-protocol/blob/88680691fe8d872c5fc26e9500d19cf7caaa9861/contracts/depositary/AgregateDepositaryBalanceView.sol#L50 contract requires that `depositariesIndex[depositary] == 0`, that check allow to add already added depositary that have `0` index. Same error at line https://github.com/bondappetit/bondappetit-protocol/blob/88680691fe8d872c5fc26e9500d19cf7caaa9861/contracts/depositary/AgregateDepositaryBalanceView.sol#L64 that don't allow to remove depositary that have index `0`\n\n##### Recommendation\nWe recommend to remaster depositary existing check \n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#6-invalid-depositary-addremove-logic",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Wrongly used `safeApprove`",
        "content": "##### Description\nAt line https://github.com/bondappetit/bondappetit-protocol/blob/88680691fe8d872c5fc26e9500d19cf7caaa9861/contracts/Treasury.sol#L51 contract call `safeApprove` method, however that method fails if account have remaining allowed tokens.\n\n##### Recommendation\nWe suggest to reset approval calling\n```soldity\nERC20(token).safeApprove(recipient, 0);\n```\nbefore setting new approval\n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#7-wrongly-used-safeapprove",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Budget payment blocking",
        "content": "##### Description\nIn `pay` function of `Budget.sol` contract defined at https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/Budget.sol#L109 contract sends ETH to recipients in loop using `transfer` method. As we know `transfer` method limited by 2300 gas, so any single recipient with payable fallback method can block whole `pay` function execution\n\n##### Recommendation\nWe recommend to rework payment scheme to claimable model.\n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#8-budget-payment-blocking",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potential integer overflow",
        "content": "##### Description\nAt the line https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/Investment.sol#L147 contract potentially can catch integer overflow in case if `cumulative.decimals() > 18`. Since `cumulative` token is not predefined contract we should check actual decimals amount\n\n##### Recommendation\nWe recommend add check\n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#1-potential-integer-overflow",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potential div by zero error",
        "content": "##### Description\nAt the line https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/Market.sol#L189 contract can catch div by zero if `cumulativePrice` is zero.\n\n##### Recommendation\nWe recommend add non-zero check\n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#2-potential-div-by-zero-error",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Vesting account duplication",
        "content": "##### Description\nAt the line https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/VestingSplitter.sol#L92 contract change vesting account, however input `accounts` array can contain duplicated accounts.\n\n##### Recommendation\nWe recommend to introduce duplication check\n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#3-vesting-account-duplication",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unchecked vesting contract address",
        "content": "##### Description\nAt the line https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/VestingSplitter.sol#L111 contract accepts vesting contract address, but there is no sanity checks, so anyone can easily ask this contract to call another contract\n\n##### Recommendation\nWe recommend add sanity check for vesting contract address\n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#4-unchecked-vesting-contract-address",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Wrong reward calculation of balance < 100",
        "content": "##### Description\nAt the line https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/VestingSplitter.sol#L126 contract calculate `reward` for account, however that calculation always return zero if `balance < 100`\n\n##### Recommendation\nWe suggest to perform division after multiplication\n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#5-wrong-reward-calculation-of-balance-100",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Missed zero share check",
        "content": "##### Description\nAt the line https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/profit/ProfitSplitter.sol#L139 contract check that total shares sum including new share less or equal that 100, but never check that new share more that zero, so it's possible to add user with zero share.\n\n##### Recommendation\nWe suggest to check that share more than 0.\n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#6-missed-zero-share-check",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potential custodial asset collateral incorrect signatures",
        "content": "##### Description\nThis warning is about absent signature correctness checks in Proof data structure in RealAssetDepositaryBalanceView in here: https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/depositary/RealAssetDepositaryBalanceView.sol#L88.\n\nWhat kind of signatures are these? How do they get formed? Were they formed correctly and how to check that?\n\n##### Recommendation\nIt is recommended to implement additional signature correctness checks, append comments about the nature of those signatures.\n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#7-potential-custodial-asset-collateral-incorrect-signatures",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Mixed `msg.sender` and `_msgSender()`",
        "content": "##### Description\nIn some contracts used directly `msg.sender` instead of `_msgSender()`:\n- https://github.com/bondappetit/bondappetit-protocol/blob/88680691fe8d872c5fc26e9500d19cf7caaa9861/contracts/Staking.sol#L173\n- https://github.com/bondappetit/bondappetit-protocol/blob/88680691fe8d872c5fc26e9500d19cf7caaa9861/contracts/StableToken.sol#L12\n- etc..\n\nsince OZ contract introduce Context based contract, all derived ones should use `_msgSender()`\n\n##### Recommendation\nWe recommend to replace `msg.sender` to `_msgSender()` \n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#8-mixed-msgsender-and-_msgsender",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Too flexible configuration",
        "content": "##### Description\nProvided system have a list of contracts, some of them interact with each others. Contracts have too much implicit restrictions, e.g:\n- [`CollateralMarket.sol`](https://github.com/bondappetit/bondappetit-protocol/blob/88680691fe8d872c5fc26e9500d19cf7caaa9861/contracts/CollateralMarket.sol) requires that depositor should be listed in [`Issuer.sol`](https://github.com/bondappetit/bondappetit-protocol/blob/88680691fe8d872c5fc26e9500d19cf7caaa9861/contracts/Issuer.sol)\n- [`Issuer.sol`](https://github.com/bondappetit/bondappetit-protocol/blob/88680691fe8d872c5fc26e9500d19cf7caaa9861/contracts/Issuer.sol) have methods to change list of depositors, so which means that in case of any changes depositor should be changes in [`CollateralMarket.sol`](https://github.com/bondappetit/bondappetit-protocol/blob/88680691fe8d872c5fc26e9500d19cf7caaa9861/contracts/CollateralMarket.sol) at same time.\n- Some contracts have flexible access list, that can lead to implicit wrong permissions\n\nToo flexible and implicit configuration can lead to modules/contracts inconsistency. Moreover in some cases it could be fatal.\n\n##### Recommendation\nWe suggest to strictly define possible invariants to reduce complexity.\n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#9-too-flexible-configuration",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potentially wrong-sized access control list",
        "content": "##### Description\nThis warning is about access list array being returned of a potentially wrong length in here: https://github.com/bondappetit/bondappetit-protocol/tree/88680691fe8d872c5fc26e9500d19cf7caaa9861/contracts/utils/AccessControl.sol#L44.\n\nIt seems the actual purpose of this particular function is to provide a simple copy of the `allowed` array. It does not seem necessary to create a copy which length is bigger than the initial array.\n\n##### Recommendation\nIt is recommended to provide a simple element-by-element array copy without implicit array size increase.\n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#10-potentially-wrong-sized-access-control-list",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Probably missed input check",
        "content": "##### Description\nIn `transferETH` function of `Budget.sol` contract defined at https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/Budget.sol#L61 contract sends ETH to `recipient` passed via arguments, however it seems `recipient` should be in `recipients` set, so it seems contract should check that before transfer.\n\n##### Recommendation\nWe suggest to add particular check \n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#1-probably-missed-input-check",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unneeded calculations",
        "content": "##### Description\nAt the line https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/Market.sol#L187 contract calculates `product` tokens amount, but line below contract recalculates this variable if `address(productToken) != currency`, so consequently first calculation unneeded because `productDecimals` and `tokenDecimals` are same if `productToken == currency`\n\n##### Recommendation\nWe suggest to replace calculation with assignment `product = payment`\n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#2-unneeded-calculations",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Total shares cache",
        "content": "##### Description\nAt the line https://github.com/bondappetit/bondappetit-protocol/blob/355180f0aca0b29d60d808f761052956b7a3a159/contracts/profit/ProfitSplitter.sol#L126 contract calculate total shares sum, that information used when we adding new account and can be easily cached to save gas.\n\n##### Recommendation\nWe recommend to cache current shares sum.\n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#3-total-shares-cache",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potential collateralization imbalance",
        "content": "##### Description\nIn function `balance` defined at https://github.com/bondappetit/bondappetit-protocol/blob/88680691fe8d872c5fc26e9500d19cf7caaa9861/contracts/depositary/StableTokenDepositaryBalanceView.sol#L81 contract aggregates balances through different tokens, so function return sum of collateral assets. However, as we known price of some stable coins can be changed(especially algorithmic stable coins), so we can't simply calculate sum of tokens to get real assets value.\n\n##### Recommendation\nWe recommend to use oracles to fetch real assets price\n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#4-potential-collateralization-imbalance",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Runtime-configured contract ownership",
        "content": "##### Description\nThis comment is about very implicit runtime-configured contract ownership instead of explicit `Ownable`-alike constructions. Such an architecture makes the ownership deploy configuration-dependent, which is being hard to check after the deployment in comparison to simple code check.\n\n##### Recommendation\nIt is recommended to either switch to the explicit ownership with `Ownable`, or to explicitly describe deployment params and the way to check them for everyone.\n",
        "protocol": "Bond Appetit",
        "report_date": "2021-03-18",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/README.md#5-runtime-configured-contract-ownership",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Bond%20Appetit/BondAppetit%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Excess reserve amount",
        "content": "##### Description\nAt lines https://github.com/CreamFi/compound-protocol/blob/e414160eb8a774140457c885bb099baae528df04/contracts/CCapableErc20.sol#L250-L252 contract increases `internalCash` and `totalReserves` values, but it's so strange that `internalCash` increased by `totalFee` and `totalReserves` increased by `reservesFee` so we totally increased assets amount by `reservesFee + totalFee` however user paid only `totalFee`. It seems there are some uncollateralized `reservesFee`. May be there `totalFee` paid by user should be splitted to `internalCash` and `totalReserves` ?\n\n##### Recommendation\nWe recommend to double check that place \n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-03-12",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Flashloan/README.md#1-excess-reserve-amount",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Flashloan/C.R.E.A.M.%20finance%20flashloan%20Security%20Review%20Report.pdf"
    },
    {
        "title": "Suspicious manipulation of `totalReserves` and `internalCash`",
        "content": "##### Description\nAt the line https://github.com/CreamFi/compound-protocol/blob/e414160eb8a774140457c885bb099baae528df04/contracts/CCapableErc20.sol#L132 contract have `gulp` function that change `totalReserves` and `internalCash` variables. That function can be re-entered from while flashloan execution. For now, in `flashloan` contract captured affected variables and also `accrueInterest` depends on it, to be honest it's really precarious place.\n\n##### Recommendation\nWe recommend to double check this and add re-entrancy guard to `gulp` function\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-03-12",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Flashloan/README.md#1-suspicious-manipulation-of-totalreserves-and-internalcash",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Flashloan/C.R.E.A.M.%20finance%20flashloan%20Security%20Review%20Report.pdf"
    },
    {
        "title": "Magic number used",
        "content": "##### Description\nAt the line https://github.com/CreamFi/compound-protocol/blob/e414160eb8a774140457c885bb099baae528df04/contracts/CCapableErc20.sol#L237 contract uses \"magic number\" `10000` to calculate `totalFee`.\n\n##### Recommendation\nWe recommend to use constant instead or add comments\n",
        "protocol": "C.R.E.A.M. Finance",
        "report_date": "2021-03-12",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Flashloan/README.md#1-magic-number-used",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/C.R.E.A.M.%20Finance/Flashloan/C.R.E.A.M.%20finance%20flashloan%20Security%20Review%20Report.pdf"
    },
    {
        "title": "Error while calculating the value",
        "content": "##### Description\nThe `getPricePerFullShare()` function for a yDAI token contract returns the value multiplied by a factor of 1e18.\nBut it doesn't divided by 1e18:\n- https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/CoverFlashBorrower.sol#L90\n- https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/CoverFlashBorrower.sol#L155\n- https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/CoverFlashBorrower.sol#L182\n  \n##### Recommendation\nIt is recommended to fix the error.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-03-10",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Flashloan/README.md#1-error-while-calculating-the-value",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Flashloan/CoverProtocol_cover-flashloan%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Wrongly used `safeApprove`",
        "content": "##### Description\nAt the line https://github.com/CoverProtocol/cover-flashloan/blob/9cb6561f3d40f870252088d3c16c1eed24a93166/contracts/CoverFlashBorrower.sol#L351 contract call `safeApprove` method, however that method fails if account have remaining allowed tokens.\n\n##### Recommendation\nWe suggest to reset approval calling\n```soldity\nERC20(token).safeApprove(recipient, 0);\n```\nbefore setting new approval\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-03-10",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Flashloan/README.md#2-wrongly-used-safeapprove",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Flashloan/CoverProtocol_cover-flashloan%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "No processing of function execution results",
        "content": "##### Description\nThe https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/CoverFlashBorrower.sol contract uses the `approve ()`, `transferFrom ()` and `transfer ()` functions to transfer tokens. According to the ERC20 standard, functions return boolean variables, but the result is not processed.\nThis can be seen in the following lines:\n- https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/CoverFlashBorrower.sol#L97\n- https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/CoverFlashBorrower.sol#L130\n- https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/CoverFlashBorrower.sol#L143\n- https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/CoverFlashBorrower.sol#L231\n- https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/CoverFlashBorrower.sol#L233\n- https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/CoverFlashBorrower.sol#L235\n- https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/CoverFlashBorrower.sol#L264\n- https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/CoverFlashBorrower.sol#L284\n- https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/CoverFlashBorrower.sol#L286\n- https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/CoverFlashBorrower.sol#L335\n\nAt the same time, the project has a library for safe work with tokens for the ERC20 standard. This library is located here: https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/ERC20/SafeERC20.sol.\n\n##### Recommendation\nFor operations with tokens, use functions from the https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/ERC20/SafeERC20.sol library.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-03-10",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Flashloan/README.md#1-no-processing-of-function-execution-results",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Flashloan/CoverProtocol_cover-flashloan%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Event is probably missing",
        "content": "##### Description:\nAt the line https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/CoverFlashBorrower.sol#L134-L137\n`CoverFlashBorrower`'s method `setFlashLender()` should probably emit an event.\n\n##### Recommendation\nIt is recommended to create event: `NewFlashLender`.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-03-10",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Flashloan/README.md#2-event-is-probably-missing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Flashloan/CoverProtocol_cover-flashloan%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "There is no check for the available amount of tokens",
        "content": "##### Description\nBefore taking an flashloan, you need to make sure that there are enough tokens.\nBut now this check is not being done.\nThe lines: https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/CoverFlashBorrower.sol#L98 and https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/CoverFlashBorrower.sol#L131 need to be checked:\n\n`require (amountDaiNeeded <= flashLender.maxFlashLoan (address (dai)),\" wrong amount of token \");`\n\nAdditional checks keep the source code clean.\nAdditional checks do not require gas consumption when making a transaction.\n\n##### Recommendation\nIt is recommended to add checks for the available amount of tokens\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-03-10",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Flashloan/README.md#3-there-is-no-check-for-the-available-amount-of-tokens",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Flashloan/CoverProtocol_cover-flashloan%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Should return zero. But instead the transaction crashes",
        "content": "##### Description\nFunctions are used to calculate the number of tokens. But in some cases, an arithmetic overflow occurs and the transaction is reverted. This can be avoided by doing a check and returning zero.\n\n- At the line https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/CoverFlashBorrower.sol#L163 should be done like this:\n>`if (amountDaiNeeded + flashFee < daiReceivedFromSwap) {`\n>`            totalCost = 0;`\n>`        } else {`\n>`            totalCost =  amountDaiNeeded - daiReceivedFromSwap + flashFee;`\n>`        }`\n\n- At the line https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/CoverFlashBorrower.sol#L186 should be done like this:\n>`if (daiReceivedFromRedeem < amountDaiNeeded + flashFee) {`\n>`            totalReturn = 0;`\n>`        } else {`\n>`            totalReturn =  daiReceivedFromRedeem - amountDaiNeeded - flashFee;`\n>`        }`\n\n\n##### Recommendation\nIt is recommended to fix the code\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-03-10",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Flashloan/README.md#4-should-return-zero-but-instead-the-transaction-crashes",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Flashloan/CoverProtocol_cover-flashloan%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Using \"magic\" numbers.",
        "content": "##### Description\nThe use in the source code of some unknown where taken values impairs its understanding.\nOn line https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/CoverFlashBorrower.sol#L185 the value is `10000`.\n\n##### Recommendation\nIt is recommended that you create constants with meaningful names for using numeric values.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-03-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Flashloan/README.md#1-using-magic-numbers",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Flashloan/CoverProtocol_cover-flashloan%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Hardcoded addresses.",
        "content": "##### Description\nAt the lines https://github.com/CoverProtocol/cover-flashloan/tree/bea8cd444aa1791a97b2a81078dc887a835f7949/contracts/CoverFlashBorrower.sol#L23-L24\nthe DAI and yDAI addresses is hardcoded. But if the contract deployed to some other testnet it must be different.\n\n##### Recommendation\nIt is recommended to make these addresses as arguments to the initialization method.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-03-10",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Flashloan/README.md#2-hardcoded-addresses",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Flashloan/CoverProtocol_cover-flashloan%20Security%20Audit%20Report%20(merged).pdf"
    },
    {
        "title": "Wrongly increased `participants` amount",
        "content": "##### Description\nAt line https://github.com/tosdis/TosDisFinance/blob/be50dbf8a52a8f919694498bf30394d328d88fbb/StakeMaster/contracts/StakingPool.sol#L120 contract increases participants amount, that happens if `user.amount` is zero, however if user will provide zero `_amountToStake` `participants` also will increased. So somebody can increase `participants` infinitely by calling `stakeTokens` with zero stake.\n\n##### Recommendation\nWe recommend increase `participants` only if `_amountToStake` not zero\n",
        "protocol": "TosDis",
        "report_date": "2021-03-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/TosDis/README.md#1-wrongly-increased-participants-amount",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/TosDis/TosDis%20Smart%20Contract%20Audit.pdf"
    },
    {
        "title": "Potentially differentiating message senders",
        "content": "##### Description\nThis warning is about inconsistent message sender address source (`msg.sender` and `_msgSender()`) usage in here: https://github.com/tosdis/TosDisFinance/tree/be50dbf8a52a8f919694498bf30394d328d88fbb/StakeMaster/contracts/FeeToken.sol#L37, https://github.com/tosdis/TosDisFinance/tree/be50dbf8a52a8f919694498bf30394d328d88fbb/StakeMaster/contracts/FeeToken.sol#L39, https://github.com/tosdis/TosDisFinance/tree/be50dbf8a52a8f919694498bf30394d328d88fbb/StakeMaster/contracts/FeeToken.sol#L40.\n\nThis can lead to the incorrect message sender address choice in case, for example, particular function call was a relayed call or meta-transaction-related call.\n\n##### Recommendation\nIt is recommended to switch to some particular message sender address retrieval method to avoid double-ownership (or misownership). In particular, using `AccessContolList` is better to choose `_mseSender()`.\n",
        "protocol": "TosDis",
        "report_date": "2021-03-01",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/TosDis/README.md#2-potentially-differentiating-message-senders",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/TosDis/TosDis%20Smart%20Contract%20Audit.pdf"
    },
    {
        "title": "Non-explicit multiplier computation checks",
        "content": "##### Description\nThis warning is about potentially faulty implicit checks in `getMultiplier`\nfunction in here: https://github.com/tosdis/TosDisFinance/tree/be50dbf8a52a8f919694498bf30394d328d88fbb/StakeMaster/contracts/StakingPool.sol#L66.\n\nThis function seems to suppose to always return some valid value (even if particular input arguments are not valid), and business logic implicitly supposes that as well. Unfortunately, `getMultiplier` function returns valid value `0` in case `_from` and `_to` arguments are incorrect in relation to `finishBlock` variable, but does not return any valid value in case `_from` and `_to` arguments are incorrect among themselves. This can lead to the business logic implicitly assuming `getMultiplier` functions always returns something valid failure, for example, in here: https://github.com/tosdis/TosDisFinance/tree/be50dbf8a52a8f919694498bf30394d328d88fbb/StakeMaster/contracts/StakingPool.sol#L104.\n\n##### Recommendation\nIt is recommended to either consider `getMultiplier` function returning valid values for every case (`0` for all the incorrect arguments cases for example), or refactor the application logic to support this function unwinding.\n",
        "protocol": "TosDis",
        "report_date": "2021-03-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/TosDis/README.md#1-non-explicit-multiplier-computation-checks",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/TosDis/TosDis%20Smart%20Contract%20Audit.pdf"
    },
    {
        "title": "Keep invariant `burnPercent <= divider`",
        "content": "##### Description\nAccording logic at line https://github.com/tosdis/TosDisFinance/blob/be50dbf8a52a8f919694498bf30394d328d88fbb/StakeMaster/contracts/StakeMaster.sol#L75 `burnPercent` should be less or equal than `divider`, but in contract that invariant never checked\n\n##### Recommendation\nWe recommend add particular check\n",
        "protocol": "TosDis",
        "report_date": "2021-03-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/TosDis/README.md#2-keep-invariant-burnpercent-divider",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/TosDis/TosDis%20Smart%20Contract%20Audit.pdf"
    },
    {
        "title": "Restrict deflationary tokens",
        "content": "##### Description\nAt line https://github.com/tosdis/TosDisFinance/blob/be50dbf8a52a8f919694498bf30394d328d88fbb/StakeMaster/contracts/StakingPool.sol#L124 contract receives token by `safeTransferFrom`, and increases `user.amount` by `_amountToStake`, however that approach doesn't work with deflationary tokens because in that case real received amount will be less than requested. That will break the whole logic of contract if somebody creates pool with deflationary token.\n\n##### Recommendation\nWe recommend to support such tokens or restrict contract usage with them\n",
        "protocol": "TosDis",
        "report_date": "2021-03-01",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/TosDis/README.md#3-restrict-deflationary-tokens",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/TosDis/TosDis%20Smart%20Contract%20Audit.pdf"
    },
    {
        "title": "Misleading docs",
        "content": "##### Description\nThis comment is about misleading documentation mentioning there is a\n`PAUSER_ROLE` (and there is no such a role in this particular case) in here: https://github.com/tosdis/TosDisFinance/tree/be50dbf8a52a8f919694498bf30394d328d88fbb/StakeMaster/contracts/FeeToken.sol#L27.\n\n##### Recommendation\nIt is recommended to remove misleading description.\n",
        "protocol": "TosDis",
        "report_date": "2021-03-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/TosDis/README.md#1-misleading-docs",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/TosDis/TosDis%20Smart%20Contract%20Audit.pdf"
    },
    {
        "title": "Unrestricted emergency withdrawal",
        "content": "##### Description\nThis comment is about unrestricted emergency withdrawal function in here: https://github.com/tosdis/TosDisFinance/tree/be50dbf8a52a8f919694498bf30394d328d88fbb/StakeMaster/contracts/StakingPool.sol#L170 being possible to be called anytime with burning all the rewards being earned. \n\n##### Recommendation\nSince it seems to be fine to make user reponsible to choose, to call the function retrieving staked funds with or without rewards being taken care of, more appropriate solution seems to be to introduce a so-called \"Emergency mode\" (with introducing a function modifier to check if that emergency has happened), initiated by some governance members. Probably only in case of emergency such a reward-burning withdrawal should be available.\n",
        "protocol": "TosDis",
        "report_date": "2021-03-01",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/TosDis/README.md#2-unrestricted-emergency-withdrawal",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/TosDis/TosDis%20Smart%20Contract%20Audit.pdf"
    },
    {
        "title": "Incorrect check of `timeWindow`",
        "content": "##### Description\nAt the line https://github.com/CoverProtocol/cover-core-v2/blob/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/ClaimConfig.sol#L50 there is incorrect check of `_newTimeWindow`\n\n##### Recommendation\nChange to `require(_newTimeWindow >= 3 days, \"CC: window too short\");`\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-02-25",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/README.md#1-incorrect-check-of-timewindow",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/Cover%20Protocol%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Lack of claim validation",
        "content": "##### Description\nAt lines:\n- https://github.com/CoverProtocol/cover-core-v2/blob/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/ClaimManagement.sol#L112\n- https://github.com/CoverProtocol/cover-core-v2/blob/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/ClaimManagement.sol#L145\n- https://github.com/CoverProtocol/cover-core-v2/blob/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/ClaimManagement.sol#L176\n\nthe claim is taken by `_coverPool, _nonce, _index`, however caller may send incorrect indexes to the method.\n\nAt the line https://github.com/CoverProtocol/cover-core-v2/blob/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/ClaimManagement.sol#L114 even the flow with invalid claim will pass the require condition and go to \n```solidity\nclaim.state = ClaimState.Validated;\n_resetCoverPoolClaimFee(_coverPool);\n```\nthis is unexpected behavior and potentially can lead to the contract misfunctioning.\n\n##### Recommendation\nAdd `require(_index < coverPoolClaims[_coverPool][_nonce].length, \"bad indexes\")`\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-02-25",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/README.md#2-lack-of-claim-validation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/Cover%20Protocol%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Lack of `onlyOwner` modifier in `Cover.deploy`",
        "content": "##### Description\nAt https://github.com/CoverProtocol/cover-core-v2/blob/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/Cover.sol#L239 anyone may call deploy. It's not a big thing now (at least in current implementation), but is rather an unexpected permission. Adding of `onlyOwner` modifier will make the code robust.\n\n##### Recommendation\nAdd `onlyOwner` modifier.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-02-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/README.md#1-lack-of-onlyowner-modifier-in-coverdeploy",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/Cover%20Protocol%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Too soft check in `addCover`",
        "content": "##### Description\nAt https://github.com/CoverProtocol/cover-core-v2/blob/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/CoverPool.sol#L123 it's not clear why do we require only `received>0` not `received==_amount`\n\n##### Recommendation\nAdd `require(received==_amount)` or document and argue in code-comments and in the project's docs why it's so relaxed.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-02-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/README.md#2-too-soft-check-in-addcover",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/Cover%20Protocol%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unnecessary getter method",
        "content": "##### Description\nThe method `getCVCList` at https://github.com/CoverProtocol/cover-core-v2/blob/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/ClaimConfig.sol#L91 is not needed because cvcMap is already defined as public attribute and has default getter.\n\n##### Recommendation\nRemove custom getter to save gas and use default one.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-02-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/README.md#3-unnecessary-getter-method",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/Cover%20Protocol%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unused modifier",
        "content": "##### Description\n`CoverPool`'s modifier `onlyGov` defined at line https://github.com/CoverProtocol/cover-core-v2/blob/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/CoverPool.sol#L67 is never used within the contract. In the same time there are methods having requires just within the methods:\n```solidity\nrequire(msg.sender == _factory().governance(), \"CoverPool: caller not governance\");\n```\n\nSeems like the methods should have used the modifier:\n- https://github.com/CoverProtocol/cover-core-v2/tree/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/CoverPool.sol#L207\n- https://github.com/CoverProtocol/cover-core-v2/tree/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/CoverPool.sol#L220\n\n##### Recommendation\nUse the modifier instead of the `require` above.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-02-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/README.md#4-unused-modifier",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/Cover%20Protocol%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Event is probably missing",
        "content": "##### Description\nAt line https://github.com/CoverProtocol/cover-core-v2/tree/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/CoverPoolFactory.sol#L89 `CoverPoolFactory`'s method `updateDeployGasMin` should probably emit an event as well as other methods for update (e.g. `updateCoverPoolImpl` or `updateCoverImpl`, etc.) do.\n\n##### Recommendation\nCreate a suit event and emit the one in the method.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-02-25",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/README.md#5-event-is-probably-missing",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/Cover%20Protocol%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Hard-coded DAI address",
        "content": "##### Description\nAt https://github.com/CoverProtocol/cover-core-v2/blob/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/ClaimConfig.sol#L14 the `DAI` address is hardcoded. But if the contract deployed to some other testnet it must be different.\n\n##### Recommendation\nMake the `DAI` address an argument to init method.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-02-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/README.md#1-hard-coded-dai-address",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/Cover%20Protocol%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Magic hard-coded constants",
        "content": "##### Description\nThere are some magic constants in the middle of the code:\n- https://github.com/CoverProtocol/cover-core-v2/blob/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/ClaimConfig.sol#L50\n- https://github.com/CoverProtocol/cover-core-v2/blob/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/Cover.sol#L218\n- https://github.com/CoverProtocol/cover-core-v2/blob/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/Cover.sol#L282\n\n##### Recommendation\nMake them class-level named constants.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-02-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/README.md#2-magic-hard-coded-constants",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/Cover%20Protocol%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Debateable gas usage",
        "content": "##### Description\nIn the method `removeCVCForPool` at https://github.com/CoverProtocol/cover-core-v2/blob/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/ClaimConfig.sol#L104 the new memory structure is created and then filled with all elements `!= _cvc`. However it's not clear if it is really cheaper than just do.\n```solidity\nfunction removeCVCForPool(address _coverPool, address _cvc, uint256 _cvt_index) public override onlyOwner {\n  require(cvcMap[_coverPool][_cvt_index] == _cvc, \"incorrect index\");\n  cvcMap[_coverPool][_cvt_index] = cvcMap[_coverPool][cvcMap[_coverPool].length-1];\n  delete cvcMap[_coverPool][cvcMap[_coverPool].length--];\n}\n```\n\nAlso at https://github.com/CoverProtocol/cover-core-v2/blob/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/Cover.sol#L134 it's not clear if it is really cheaper than straight-forward approach.\n\n##### Recommendation\nAdd gas performance tests or argue the optimal way as a comment in the code.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-02-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/README.md#3-debateable-gas-usage",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/Cover%20Protocol%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Governance cannot be creator of the contract",
        "content": "##### Description\nAt the line https://github.com/CoverProtocol/cover-core-v2/blob/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/ClaimManagement.sol#L22 it's required that governance may not be creator of the contract. However it's not clear why.\n\n##### Recommendation\nLet the governance be creator of the contract or comment why it should not be like this.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-02-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/README.md#4-governance-cannot-be-creator-of-the-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/Cover%20Protocol%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "if-not-return statements used instead of require",
        "content": "##### Description\nAt https://github.com/CoverProtocol/cover-core-v2/blob/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/Cover.sol#L132 the check does nothing on fail, it just returns. \nThis is not a regular way to do this kind of checks, usually people just write `require` statement. It seems that these if-not-return statements are used to allow multi transactional initialization. It's debateable if it's the best way to do it. And it's better to explicitly document it in the method's docstring and usage.\n\n##### Recommendation\nAdd more comments.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-02-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/README.md#5-if-not-return-statements-used-instead-of-require",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/Cover%20Protocol%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unclear part of code which burns token after redeem",
        "content": "##### Description\nIt's not really clear what is the business logic behind the code-block at https://github.com/CoverProtocol/cover-core-v2/blob/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/Cover.sol#L166\nas far as I understood it just burns unused tokens caused by the rest of division. \n\nThis uncertainty and the fact that it's not obvious (at least for me) what does the block of code do, increases the chance of mistake and makes review harder.\n\n##### Recommendation\nAdd more comments.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-02-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/README.md#6-unclear-part-of-code-which-burns-token-after-redeem",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/Cover%20Protocol%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unclear business logic behind `_futureToken`,  `futureCovTokenMap`, `futureCovTokens`",
        "content": "##### Description\nIt's not really clear what is the business logic behind the usage of `_futureToken`, `futureCovTokenMap`, `futureCovTokens` and the code-block at https://github.com/CoverProtocol/cover-core-v2/blob/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/Cover.sol#L225 as far as I understood it switches to new claim tokens but it's not clear. Also there is no any explanation in the product docs.\n\nThis uncertainty and the fact that it's not obvious (at least for me) what does the block of code do, increases the chance of mistake and makes review harder.\n\n##### Recommendation\nAdd more comments.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-02-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/README.md#7-unclear-business-logic-behind-_futuretoken-futurecovtokenmap-futurecovtokens",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/Cover%20Protocol%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Lack of `require(len>0)` in `_handleLatestFutureToken`",
        "content": "##### Description\nAt https://github.com/CoverProtocol/cover-core-v2/blob/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/Cover.sol#L292 nothing will happen if `futureCovTokens` is empty, it's not revert. However this is unexpected and may cause misfunctioning in callers methods.\n\n##### Recommendation\nUse `require(len>0)` instead of `if` condition\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-02-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/README.md#8-lack-of-requirelen0-in-_handlelatestfuturetoken",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/Cover%20Protocol%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Block timestamp type inconsistency",
        "content": "##### Description\nThis comment is about multiple type shrinking of a `block.timestamp`'s `uint256`\nto `uint48` cases e.g. in here: \n- https://github.com/CoverProtocol/cover-core-v2/tree/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/ClaimManagement.sol#L39\n- https://github.com/CoverProtocol/cover-core-v2/tree/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/ClaimManagement.sol#L55 \n\nor in here:\n- https://github.com/CoverProtocol/cover-core-v2/tree/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/ClaimManagement.sol#L120\n- https://github.com/CoverProtocol/cover-core-v2/tree/513f5e502a8e8a623729c2c3480fca4e80fdef39/contracts/ClaimManagement.sol#L171\n\nSuch a significant type shrink reduces the application's logic \"time to live\" duration.\n\n##### Recommendation\nIt is recommended to keep the block timestamp being stored within the original\n`uint256` type. Since such recommendation requires quite a significant\nrefactoring, this was made a comment, not a warning.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-02-25",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/README.md#9-block-timestamp-type-inconsistency",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20V2/Cover%20Protocol%20v2%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Absent ETH2 depositor BLS signature parameters check",
        "content": "##### Description\nThis warning is about the function `deposit` in here: https://github.com/abyssfinance/abyss-eth2depositor/blob/a2d58dea4d79846dc682fe93ac3e0eca02323d11/contracts/AbyssEth2Depositor.sol#L61 having inputs for a pretty complicated cryptographic primitive (BLS12-381 with switched G1 and G2 groups inside) with no checks for their correctness at all.\n\nThis can result in faulty signatures, public keys and withdrawal credentials to be submitted which will lead to the loss of withdrawal possibility later.\n\n##### Recommendation\nIt is recommended to implement following checks (according to Ethereum usage of variant 2 of: https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-bls-signature-04#section-2.1):\n* Signature length to be equal to 96 bytes.\n* Public key length to be equal to 48 bytes.\n* Withdrawal credentials, in case they are supposed to be aggregatable public\n    keys, each of them should be equal to 32 bytes.\n",
        "protocol": "Abyss Finance",
        "report_date": "2021-02-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Abyss%20Finance/Abyss%20Eth2%20Depositor/README.md#1-absent-eth2-depositor-bls-signature-parameters-check",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Abyss%20Finance/Abyss%20Eth2%20Depositor/AbyssEth2Depositor%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Reentrant ETH2 depositor function",
        "content": "##### Description\nThis warning is about the function `deposit` (https://github.com/abyssfinance/abyss-eth2depositor/blob/a2d58dea4d79846dc682fe93ac3e0eca02323d11/contracts/AbyssEth2Depositor.sol#L61) being possibly reentrant in here: https://github.com/abyssfinance/abyss-eth2depositor/blob/a2d58dea4d79846dc682fe93ac3e0eca02323d11/contracts/AbyssEth2Depositor.sol#L80.\n\nThis can lead to unpredictable deposits chain initially not supposed to be done by the application logic.\n\n##### Recommendation\nIt is recommended to introduce `nonReentrant` modifier, bringing it from\n(probably) OpenZeppelin's implementation in here: https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/ReentrancyGuard.sol.\n",
        "protocol": "Abyss Finance",
        "report_date": "2021-02-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Abyss%20Finance/Abyss%20Eth2%20Depositor/README.md#2-reentrant-eth2-depositor-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Abyss%20Finance/Abyss%20Eth2%20Depositor/AbyssEth2Depositor%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "ETH2 depositor argument design consideration",
        "content": "##### Description\nThis comment is about absence of possibility to check the correctness of the SHA2-256 hash being passed as a parameter `deposit_data_roots` to the `deposit` function in here: https://github.com/abyssfinance/abyss-eth2depositor/blob/a2d58dea4d79846dc682fe93ac3e0eca02323d11/contracts/AbyssEth2Depositor.sol#L61.\n\n##### Recommendation\nSince the internal structure of data being hashed makes sense, it is better to use some ZK-proof (with Zookrates possibly?), which will bring the possibility to verify the correctness of the input data without having the actual data present.\n",
        "protocol": "Abyss Finance",
        "report_date": "2021-02-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Abyss%20Finance/Abyss%20Eth2%20Depositor/README.md#1-eth2-depositor-argument-design-consideration",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Abyss%20Finance/Abyss%20Eth2%20Depositor/AbyssEth2Depositor%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unfair withdrawn amount",
        "content": "##### Description\nHow to reproduce bug:\n - Deposit N tokens from Alice\n - Deposit N tokens from Bob\n - Deposit N tokens from Eve\n - Request and withdraw N tokens to Alice\n - Request and withdraw N tokens to Bob\n - Request and withdraw N tokens to Eve\n - At this point participant got different withdrawn amount(first lost more funds)\n\nDetailed explanation:\n - Use particular deflationary token as depositing asset https://gist.github.com/algys/eb905ec8efa41f80cf1eab57a3b31649\n - After all withdrawals Alice lost more funds than Eve, that behavior is unfair because they deposited same amount and just lost funds depending on withdrawal order\n\n##### Recommendation\nIt is recommended to refactor rebase logic and reduce amount of code duplication.\n",
        "protocol": "Abyss Finance",
        "report_date": "2021-02-24",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Abyss%20Finance/Abyss%20LockUp/README.md#1-unfair-withdrawn-amount",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Abyss%20Finance/Abyss%20LockUp/AbyssLockup%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potential withdrawal lock and invalid distribution",
        "content": "##### Description\nHow to reproduce bug:\n - Deposit N tokens from Alice\n - Deposit N tokens from Bob\n - Deposit N tokens from Eve\n - Send M (relatively huge amount) to Lockup contract directly (via transfer)\n - Request and withdraw N tokens to Alice\n - Request and withdraw N tokens to Bob\n - Request and withdraw N tokens to Eve\n - At this point participant got different withdrawn amount(first lost more funds), and depending on M amount sometimes contract can be failed on `request` call\n\nDetailed explanation:\n - Use particular deflationary token as depositing asset https://gist.github.com/algys/eb905ec8efa41f80cf1eab57a3b31649\n - After all withdrawals Alice lost more funds than Eve, that behavior is unfair because they deposited same amount and just lost funds depending on withdrawal order\n\n##### Recommendation\nIt is recommended to fix rebase logic related to lockup balance based calculation\n",
        "protocol": "Abyss Finance",
        "report_date": "2021-02-24",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Abyss%20Finance/Abyss%20LockUp/README.md#2-potential-withdrawal-lock-and-invalid-distribution",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Abyss%20Finance/Abyss%20LockUp/AbyssLockup%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potentially `approved` cache miss",
        "content": "##### Description\nAt lines https://github.com/abyssfinance/abyss-lockup/blob/8fe1a854a9b01dc1aa35272b82fd22655d4f42d1/contracts/AbyssSafe3.sol#L202-L216 contract has approval caching mechanism, that works fine if token supports infinity approval, so in other cases cached approve might tell wrong info.\n\n##### Recommendation\nIt is recommended to check approval permanently\n",
        "protocol": "Abyss Finance",
        "report_date": "2021-02-24",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Abyss%20Finance/Abyss%20LockUp/README.md#1-potentially-approved-cache-miss",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Abyss%20Finance/Abyss%20LockUp/AbyssLockup%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Use simplified syntax while working with libs",
        "content": "##### Description\nIn reviewed contracts e.g file https://github.com/abyssfinance/abyss-lockup/blob/8fe1a854a9b01dc1aa35272b82fd22655d4f42d1/contracts/AbyssSafe3.sol explicit syntax used everywhere while working with SafeMath lib:\n```soldity\nSafeMath.div(\n  SafeMath.mul(\n      _data[msg.sender][token].deposited,\n      _tokens[token].divFactorDeposited\n      ),\n  _data[msg.sender][token].divFactorDeposited\n  );\n```\n\nit's better to use simplified one:\n```solidity \n_data[msg.sender][token].deposited.mul(_tokens[token].divFactorDeposited).div(_data[msg.sender][token].divFactorDeposited)\n````\n\n##### Recommendation\nIt is recommended to use simplified syntax\n",
        "protocol": "Abyss Finance",
        "report_date": "2021-02-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Abyss%20Finance/Abyss%20LockUp/README.md#1-use-simplified-syntax-while-working-with-libs",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Abyss%20Finance/Abyss%20LockUp/AbyssLockup%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Reduce copy-pasted code amount",
        "content": "##### Description\nThere are a lot of places when rebases' logic code is copy-pasted:\n  - https://github.com/abyssfinance/abyss-lockup/blob/8fe1a854a9b01dc1aa35272b82fd22655d4f42d1/contracts/AbyssSafe3.sol#L223-L239\n  - https://github.com/abyssfinance/abyss-lockup/blob/8fe1a854a9b01dc1aa35272b82fd22655d4f42d1/contracts/AbyssSafe3.sol#L330-L344\n  - https://github.com/abyssfinance/abyss-lockup/blob/8fe1a854a9b01dc1aa35272b82fd22655d4f42d1/contracts/AbyssSafe3.sol#L472-L482\n\nCode duplication highly increases probability to introducing bugs and makes code reading and reviewing process really hard that increase bug missing probability as well\n\n##### Recommendation\nIt is recommended to incapsulate similar code to special function\n",
        "protocol": "Abyss Finance",
        "report_date": "2021-02-24",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Abyss%20Finance/Abyss%20LockUp/README.md#2-reduce-copy-pasted-code-amount",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Abyss%20Finance/Abyss%20LockUp/AbyssLockup%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potentially unrestricted account withdrawals",
        "content": "##### Description\nThis warning is about any user potentially being able to withdraw advisor's\nshare in here: https://github.com/erwan-rouzel/b-cube-ico/tree/451e249a7200ea094fdfa1baa1a50cb7b17233f2/contracts/Treasury.sol#L158 and private sale participant's share in here: https://github.com/erwan-rouzel/b-cube-ico/tree/451e249a7200ea094fdfa1baa1a50cb7b17233f2/contracts/Treasury.sol#L308.\n\nSome check if `msg.sender` is an advisor is being performed in here: https://github.com/erwan-rouzel/b-cube-ico/tree/451e249a7200ea094fdfa1baa1a50cb7b17233f2/contracts/Treasury.sol#L163 along with a check if `msg.sender` is a private sale participant in here: https://github.com/erwan-rouzel/b-cube-ico/tree/451e249a7200ea094fdfa1baa1a50cb7b17233f2/contracts/Treasury.sol#L163, but it could be done better.\n\n##### Recommendation\nIt is recommended to introduce a more explicit advisor and private sale membership check with a function modifier just like it was done with OpenZeppelin's `onlyWhitelistAdmin`: https://docs.openzeppelin.com/contracts/2.x/api/access#WhitelistAdminRole-onlyWhitelistAdmin--.\n",
        "protocol": "B-Cube",
        "report_date": "2021-02-15",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/B-Cube/README.md#1-potentially-unrestricted-account-withdrawals",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/B-Cube/B-Cube%20ICO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potentially incorrect allowance amount",
        "content": "##### Description\nThis warning concerns the potentially incorrect computation of the allowance for advisors and private sale members in here: \n- https://github.com/erwan-rouzel/b-cube-ico/tree/451e249a7200ea094fdfa1baa1a50cb7b17233f2/contracts/Treasury.sol#L165\n- https://github.com/erwan-rouzel/b-cube-ico/tree/451e249a7200ea094fdfa1baa1a50cb7b17233f2/contracts/Treasury.sol#L166\n- https://github.com/erwan-rouzel/b-cube-ico/tree/451e249a7200ea094fdfa1baa1a50cb7b17233f2/contracts/Treasury.sol#L167.\n\n##### Recommendation\nIt is recommended to introduce `SafeMath` usage for calculating allowance `increase` values.\n",
        "protocol": "B-Cube",
        "report_date": "2021-02-15",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/B-Cube/README.md#2-potentially-incorrect-allowance-amount",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/B-Cube/B-Cube%20ICO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potentially incorrect price data",
        "content": "##### Description\nThis warning is about potentially incorrect price data being calculated from Chainlink oracle results in here: https://github.com/erwan-rouzel/b-cube-ico/tree/451e249a7200ea094fdfa1baa1a50cb7b17233f2/contracts/BCubePrivateSale.sol#L112. Chainlink output can be of a little bit more complicated format than it is expected in the most trivial case (e.g. https://blog.chain.link/fetch-current-crypto-price-data-solidity/).\nAt the line https://github.com/erwan-rouzel/b-cube-ico/tree/451e249a7200ea094fdfa1baa1a50cb7b17233f2/contracts/BCubePrivateSale.sol#L120, arithmetic operations are performed on the query results without using the `SafeMath`.\n\n##### Recommendation\nIt is recommended to pay attention to handling Chainlink output data format correctly (in case it is not yet) and handle all the arithmetic operations with it with `SafeMath` usage.\n",
        "protocol": "B-Cube",
        "report_date": "2021-02-15",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/B-Cube/README.md#3-potentially-incorrect-price-data",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/B-Cube/B-Cube%20ICO%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect events parameter",
        "content": "##### Description\nAt the lines below:\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L252\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L267\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L282\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L291\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L306\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L321\n \nthere are places where we have events which require an affected user address as a parameter, however in these cases `msg.sender` is wrongly used as a parameter. These functions accept special `user` parameter that should be used in events instead of `msg.sender`. The issue marked as major since it can fatally affect the user's side code that is based on events.\n\n##### Recommendation\nWe suggest replacing `msg.sender` to `user`.\n",
        "protocol": "SushiSwap",
        "report_date": "2021-02-15",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/README.md#1-incorrect-events-parameter",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/Sushiswap%20Bentobox%20Smart%20Contract%20Audit%20(1).pdf"
    },
    {
        "title": "No validation of the address parameter value in contract constructor",
        "content": "##### Description\nThe variable is assigned the value of the constructor input parameter. But this parameter is not checked before this. If the value turns out to be zero, then it will be necessary to redeploy the contract, since there is no other functionality to set this variable.\n\n* At line https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/BentoBox.sol#L46 the `WETH` variable is set to the value of the `WETH_` input parameter.\n* At line https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L123 the `bentoBox` variable is set to the value of the `bentoBox__` input parameter.\n* At line https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/swappers/SushiSwapSwapper.sol#L17 the `bentoBox` variable is set to the value of the `bentoBox_` input parameter.\n* At line https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/swappers/SushiSwapSwapper.sol#L18 the `factory` variable is set to the value of the `factory_` input parameter.\n\n##### Recommendation\nIn all the cases, it is necessary to add a check of the input parameter to zero before initializing the variables.\n",
        "protocol": "SushiSwap",
        "report_date": "2021-02-15",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/README.md#1-no-validation-of-the-address-parameter-value-in-contract-constructor",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/Sushiswap%20Bentobox%20Smart%20Contract%20Audit%20(1).pdf"
    },
    {
        "title": "Loss of tokens is possible when sent to a zero address",
        "content": "##### Description\nIn smart contracts, tokens are transferred from one address to another and an approval is issued for such operations.\nWhen sending tokens to a zero address, they will no longer be used and they will be lost.\nSuch actions are performed on the following lines:\nIn https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/ERC20.sol on lines 22, 31-33, 39.\nIn https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/BentoBox.sol on lines 107, 122, 126, 133, 161, 179.\n\n##### Recommendation\nAdd address verification to zero.\n",
        "protocol": "SushiSwap",
        "report_date": "2021-02-15",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/README.md#2-loss-of-tokens-is-possible-when-sent-to-a-zero-address",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/Sushiswap%20Bentobox%20Smart%20Contract%20Audit%20(1).pdf"
    },
    {
        "title": "It is possible to process a non-existing array element or skip an array element",
        "content": "##### Description\n* At line https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L467 we are working with the elements of the `borrowFractions` array in a loop.\nFor each element of the `users` array, there must be an element of the` borrowFractions` array.\nBut if an error is made when transferring data for these arrays, then it is possible to refer to a nonexistent element of the array, or vice versa, any element will not be processed.\nThis will cause the `liquidate()` function to work incorrectly.\n\n* At line https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/BentoBox.sol#L122 we are working with the elements of the `amounts` array in a loop.\nFor each element of the `tos` array, there must be an element of the `amounts` array.\nBut if an error is made when transferring data for these arrays, then it is possible to refer to a nonexistent element of the array, or vice versa, any element will not be processed.\nThis will cause the `transferMultipleFrom()` function to work incorrectly.\n\n##### Recommendation\nAdd a condition so that the length of the `users` array were equal to the length of the` borrowFractions` array.\n",
        "protocol": "SushiSwap",
        "report_date": "2021-02-15",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/README.md#3-it-is-possible-to-process-a-non-existing-array-element-or-skip-an-array-element",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/Sushiswap%20Bentobox%20Smart%20Contract%20Audit%20(1).pdf"
    },
    {
        "title": "Division by zero is possible",
        "content": "##### Description\nAt the lines below division by zero is possible:\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L227, the variable `_totalBorrow.fraction` can be equal to zero.\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L259 the variable `_totalAsset.amount` can be equal to zero.\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L274 the variable `_totalBorrow.amount` can be equal to zero.\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L300 the variable `_totalAsset.fraction` can be equal to zero.\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L315 the variable `_totalBorrow.fraction` can be equal to zero.\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L469 the variable `_totalBorrow.fraction` can be equal to zero.\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/BentoHelper.sol#L67 the variable `info[i].totalAssetFraction` can be equal to zero.\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/BentoHelper.sol#L70 the variable `info[i].totalBorrowFraction` can be equal to zero.\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/oracles/ChainlinkOracle.sol#L29 the variable `priceC` can be equal to zero.\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/oracles/ChainlinkOracle.sol#L29 the variable `decimals` can be equal to zero.\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/oracles/CompoundOracle.sol#L49 the variable `division` and the value `_getPrice(collateralSymbol)` can be equal to zero.\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/oracles/CompoundOracle.sol#L55 the variable `division` and the value `_peekPrice(collateralSymbol)` can be equal to zero.\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/oracles/SimpleSLPTWAP0Oracle.sol#L62 the variable `timeElapsed` can be equal to zero.\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/oracles/SimpleSLPTWAP0Oracle.sol#L83 the variable `timeElapsed` can be equal to zero.\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/oracles/SimpleSLPTWAP1Oracle.sol#L61 the variable `timeElapsed` can be equal to zero.\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/oracles/SimpleSLPTWAP1Oracle.sol#L82 the variable `timeElapsed` can be equal to zero.\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/swappers/SushiSwapSwapper.sol#L25 the variable `denominator` can be equal to zero.\n - https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/swappers/SushiSwapSwapper.sol#L32 the variable `denominator` can be equal to zero.\n\n##### Recommendation\nWe will redo the division operation using the SafeMath Library.\n",
        "protocol": "SushiSwap",
        "report_date": "2021-02-15",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/README.md#4-division-by-zero-is-possible",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/Sushiswap%20Bentobox%20Smart%20Contract%20Audit%20(1).pdf"
    },
    {
        "title": "Using \"magic\" numbers",
        "content": "##### Description\nThe use in the source code of some unknown where taken values impair its understanding:\n - At line https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/ERC20.sol#L55 the value is `\\x19\\x01`.\n - At line https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/ERC20.sol#L57 the value is `0x6e71edae12b1b97f4d1f60370fef10105fa2faae0126114a169c64845d6126c9`.\n - At line https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/BentoBox.sol#L171 the value is `0x23b872dd`.\n - At line https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/BentoBox.sol#L186 the value is `0xa9059cbb`.\n - At line https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L586 the value is `0xa9059cbb`.\n - At lines 178, 389, 398, 503, 546 https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol the value is `1e5`.\n - At lines 177, 195, 198, 203 https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol the value is `1e18`.\n - At lines 86, 89 https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol the value is `0x95d89b41`.\n - At lines 96, 99 https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol the value is `0x06fdde03`.\n - At line https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L106 the value is `0x313ce567`.\n - At line https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L471 the value is `1e23`.\n\n##### Recommendation\nIt is recommended that you create constants with meaningful names to use numeric values.\n",
        "protocol": "SushiSwap",
        "report_date": "2021-02-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/README.md#1-using-magic-numbers",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/Sushiswap%20Bentobox%20Smart%20Contract%20Audit%20(1).pdf"
    },
    {
        "title": "The function returns a public variable",
        "content": "##### Description\nFor the https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L243 line, the `updateExchangeRate()` function returns a value.\nLines https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L155 and https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L457 call this function.\nBut the return value is not processed.\nThe `updateExchangeRate()` function changes the `exchangeRate` public variable. There is no need to return a public variable.\n\n##### Recommendation\nChange the logic of the `updateExchangeRate()` function so that it did not return a public variable.\n",
        "protocol": "SushiSwap",
        "report_date": "2021-02-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/README.md#2-the-function-returns-a-public-variable",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/Sushiswap%20Bentobox%20Smart%20Contract%20Audit%20(1).pdf"
    },
    {
        "title": "The function returns a variable, but it is not processed",
        "content": "##### Description\nAt line https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/interfaces/ISwapper.sol#L12, the `swap()` function returns a variable of type `uint256`.\nBut after calling this function, there is no processing of the received value. It is found in the following places:\n - At line https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L428\n - At line https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L498\n - At line https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L519.\n\n##### Recommendation\nAdd return value handling or rewrite the function logic so that it did not return a variable.\n",
        "protocol": "SushiSwap",
        "report_date": "2021-02-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/README.md#3-the-function-returns-a-variable-but-it-is-not-processed",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/Sushiswap%20Bentobox%20Smart%20Contract%20Audit%20(1).pdf"
    },
    {
        "title": "Define `symbol` and `name` methods as `external`",
        "content": "##### Description\nAt the line https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L85 and https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L95 methods `symbol` and `name` which is expected to be used as `external` define as `public`.\n\n##### Recommendation\nDefine them as `external` to prevent internal usage.\n",
        "protocol": "SushiSwap",
        "report_date": "2021-02-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/README.md#4-define-symbol-and-name-methods-as-external",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/Sushiswap%20Bentobox%20Smart%20Contract%20Audit%20(1).pdf"
    },
    {
        "title": "Remove unnecessary comment",
        "content": "##### Description\nAt https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L429 the comment\n> // TODO: Reentrancy issue? Should we take a before and after balance?\n\nit is not really needed because it seems there is no re-entrancy issue here.\n\n##### Recommendation\nRemove the comment or discuss the problem.\n",
        "protocol": "SushiSwap",
        "report_date": "2021-02-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/README.md#5-remove-unnecessary-comment",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/Sushiswap%20Bentobox%20Smart%20Contract%20Audit%20(1).pdf"
    },
    {
        "title": "Forward success status",
        "content": "##### Description\nAt https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L236 the `success` variable is got, but not returned at https://github.com/sushiswap/bentobox/blob/c2e150b16b8764ebfe2e1e6e267ae14e10738065/contracts/LendingPair.sol#L243.\n\n##### Recommendation\nIt may be useful for a caller to know if oracle value was really got or the old value was used, so `return success, exchangeRate`.\n",
        "protocol": "SushiSwap",
        "report_date": "2021-02-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/README.md#6-forward-success-status",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/SushiSwap/BentoBox/Sushiswap%20Bentobox%20Smart%20Contract%20Audit%20(1).pdf"
    },
    {
        "title": "It is possible to process a non-existing array element or skip an array element",
        "content": "##### Description\nAt the line https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/Strategy.sol#L424 is working with the elements of the `_newPositions` array in a loop.\nFor each element of the `lenders` array, there must be an element of the`_newPositions` array. But now the iteration of elements for the `_newPositions` array is not done correctly.\nThis will cause the `manualAllocation()` function to work incorrectly.\n\n##### Recommendation\nIt is necessary to correct the index value for the `_newPositions` array:\n\n`if (address(lenders[j]) == _newPositions[i].lender) {`\n\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-02-15",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/README.md#1-it-is-possible-to-process-a-non-existing-array-element-or-skip-an-array-element",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/Yearn%20Generic%20Lender%20SCA.pdf"
    },
    {
        "title": "Ignore failure status for `CToken`",
        "content": "##### Description\nThere are many reasons for failure `CToken`, but Lenders contracts ignore it in the all places.\nInterface methods of `CToken`:\nFor \n```\nfunction mint(uint256 mintAmount) external returns (uint256);\n```\n- https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericCompound.sol#L140\n-  https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericCream.sol#L119\n\nFor \n```\nfunction redeemUnderlying(uint256 redeemAmount) external returns (uint256);\n```\n- https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericCompound.sol#L85\n- https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericCompound.sol#L113\n- https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericCompound.sol#L116\n\n-  https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericCream.sol#L78\n-  https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericCream.sol#L106\n-  https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericCream.sol#L109\n\n\nReturn value (`uint256`) is enum of errors which may be:\n\n```\nenum Error {\n    NO_ERROR,\n    UNAUTHORIZED,\n    COMPTROLLER_MISMATCH,\n    INSUFFICIENT_SHORTFALL,\n    INSUFFICIENT_LIQUIDITY,\n    INVALID_CLOSE_FACTOR,\n    INVALID_COLLATERAL_FACTOR,\n    INVALID_LIQUIDATION_INCENTIVE,\n    MARKET_NOT_ENTERED, // no longer possible\n    MARKET_NOT_LISTED,\n    MARKET_ALREADY_LISTED,\n    MATH_ERROR,\n    NONZERO_BORROW_BALANCE,\n    PRICE_ERROR,\n    REJECTION,\n    SNAPSHOT_ERROR,\n    TOO_MANY_ASSETS,\n    TOO_MUCH_REPAY\n}\n```\n\n##### Recommendation\nWe recommend to validate return of every method for `CToken`. If method returns no `NO_ERROR` \u2014 revert it.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-02-15",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/README.md#2-ignore-failure-status-for-ctoken",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/Yearn%20Generic%20Lender%20SCA.pdf"
    },
    {
        "title": "Safe math library not used",
        "content": "##### Description\nIf you do not use the library for safe math, then an arithmetic overflow may occur, which will lead to incorrect operation of smart contracts.\nIn the contract https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/Strategy.sol on lines: 136, 155, 180, 206, 213, 287, 430, 464, 543, 547 calculations are without safe mathematics.\n\n##### Recommendation\nAll arithmetic operations need to be redone using the Safe math library.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-02-15",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/README.md#1-safe-math-library-not-used",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/Yearn%20Generic%20Lender%20SCA.pdf"
    },
    {
        "title": "There is no processing of the value returned by the function",
        "content": "##### Description\nIn the https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/IGenericLender.sol  contract, line 21 has a function `withdrawAll()`. This function returns a value of type `bool`.\nFor the line https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/Strategy.sol#L40, the variable `lenders` of type`IGenericLender[]`is initialized.\nIn the contract https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/Strategy.sol on lines 393 and 414 there is a call to the function `withdrawAll()`.\nBut the return value is not processed.\n\n##### Recommendation\nAdd processing of the value returned by the function.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-02-15",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/README.md#2-there-is-no-processing-of-the-value-returned-by-the-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/Yearn%20Generic%20Lender%20SCA.pdf"
    },
    {
        "title": "The return value is not processed when transferring tokens",
        "content": "##### Description\nAccording to the ERC-20 specification, the `transfer()` function returns a variable of the `bool` type.\nAt the line https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericLenderBase.sol#L56 there is a call to the `transfer()` function.\nBut the return value is not processed. This can lead to incorrect operation of the smart contract.\n\n##### Recommendation\nIt is necessary to add handling of the value returned by the `transfer()` function.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-02-15",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/README.md#3-the-return-value-is-not-processed-when-transferring-tokens",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/Yearn%20Generic%20Lender%20SCA.pdf"
    },
    {
        "title": "Gas overflow during iteration (DoS)",
        "content": "##### Description\nEach iteration of the cycle requires a gas flow.\nA moment may come when more gas is required than it is allocated to record one block. In this case, all iterations of the loop will fail.\nAffected lines:\nhttps://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/Strategy.sol#L413\n\n##### Recommendation\nIt is recommended adding a check for the maximum possible number of elements of the arrays.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-02-15",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/README.md#4-gas-overflow-during-iteration-dos",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/Yearn%20Generic%20Lender%20SCA.pdf"
    },
    {
        "title": "Add additional check for `addLender`",
        "content": "##### Description\nAt the line https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/Strategy.sol#L67 in method `addLender` there are no checks for `want`.\n\n##### Recommendation\nIt is recommended to check that `want` token of Strategy equals `want` token of Lender.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-02-15",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/README.md#5-add-additional-check-for-addlender",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/Yearn%20Generic%20Lender%20SCA.pdf"
    },
    {
        "title": "Potential error `Index out of range`",
        "content": "##### Description\nIn methods:\n- `estimateAdjustPosition` at the line https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/Strategy.sol#L267:\n`_potential = lenders[_highest].aprAfterDeposit(toAdd)` \n\n- `adjustPosition` at the line https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/Strategy.sol#L399:\n`lenders[highest].deposit()`\n\n- `_withdrawSome` at the line https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/Strategy.sol#L464:\n `amountWithdrawn += lenders[lowest].withdraw(_amount - amountWithdrawn)`\n\nThere are risks that `lenders` array may be empty.\n\n##### Recommendation\nIt is recommended to add next code:\n```\nif (lenders.length == 0) {\n    return;\n}\n```\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-02-15",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/README.md#6-potential-error-index-out-of-range",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/Yearn%20Generic%20Lender%20SCA.pdf"
    },
    {
        "title": "Potential money remains on the strategy",
        "content": "##### Description\nAt the line https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/Strategy.sol#L431:\n\n`uint256 toSend = assets.mul(_newPositions[i].share).div(1000)`\n\nThen the contract sends `toSend` amount to lender and deposits it immediately. \n\nFor example imagine that `assets` equals 33 and `lenderRatio[]` equals [{address1, 500}, {address2, 500}]. Next logic:\n0. want.balanceOf(address(this)) -> 33\n1. toSend = (33 * 500) // 1000 = 16 -> deposit it to address1\n2. toSend = (33 * 500) // 1000 = 16 -> deposit it to address2\n3. require(share == 1000, \"SHARE!=1000\") -> true\n4. want.balanceOf(address(this)) -> 1 // remain tokens\n\n##### Recommendation\nIt is recommended to process remain tokens and deposit them too.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-02-15",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/README.md#7-potential-money-remains-on-the-strategy",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/Yearn%20Generic%20Lender%20SCA.pdf"
    },
    {
        "title": "Using magic numbers",
        "content": "##### Description\nThe use in the source code of some unknown where taken values impairs its understanding.\n\nThe value is `1000`:\n- in the contract https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/Strategy.sol on lines 45, 431, 436\n\nThe value is `1e18`:\n- in the contract https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/Strategy.sol#L543\n- in the contract https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericCompound.sol#L62\n- in the contract https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericDyDx.sol on lines 177, 178\n- in the contract https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericCream.sol#L55\n- in the contract https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/EthCream.sol#L53\n- in the contract https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/EthCompound.sol on lines 59, 181, 189, 191\n\nThe value is `1`:\n- in the contract https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/AlphaHomoLender.sol#L137\n- in the contract https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/EthCompound.sol#L108\n- in the contract https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/EthCream.sol#L102\n- in the contract https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericCompound.sol#L108\n- in the contract https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericCream.sol#L101\n- in the contract https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericDyDx.sol#L106\n\n\n##### Recommendation\nIt is recommended that you create constants with meaningful names for using numeric values.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-02-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/README.md#1-using-magic-numbers",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/Yearn%20Generic%20Lender%20SCA.pdf"
    },
    {
        "title": "Function without logic",
        "content": "##### Description\nAt the line https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/Interfaces/GenericLender/IGeneric.sol#L23 has an external function `enabled()`.\nThis function always returns true when executed. There is no other logic in this function.\nThis function is located in the following locations:\n- at the line https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/AlphaHomoLender.sol#L177\n- at the line https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/EthCompound.sol#L164\n- at the line https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/EthCream.sol#L143\n- at the line https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericCompound.sol#L150\n- at the line https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericCream.sol#L129\n- at the line https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericDyDx.sol#L160\n\n##### Recommendation\nIt is recommended that you remove this function or add logic to the body of the function.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-02-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/README.md#2-function-without-logic",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/Yearn%20Generic%20Lender%20SCA.pdf"
    },
    {
        "title": "The unchangeable value of the variable",
        "content": "##### Description\nThe contract https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/Strategy.sol#L477 has an internal function `liquidatePosition()`.\nOne of the return variables for this function is called `_loss`.\nThe value of this variable is always `0`.\nThis can be seen on lines 482, 486, 488.\n\n##### Recommendation\nIt is recommended to delete a variable whose value does not change.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-02-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/README.md#3-the-unchangeable-value-of-the-variable",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/Yearn%20Generic%20Lender%20SCA.pdf"
    },
    {
        "title": "Maximum value in function `approve()`",
        "content": "##### Description\nSetting a maximum value for the amount of tokens that can be manipulated after calling the `approve()` function could cause an attacker to invoke his transaction for his profit.\nSuch calls are now in the following places:\n https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericCream.sol#L39\n https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericLenderBase.sol#L45\n https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericCompound.sol#L46\n https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericDyDx.sol#L34\n\n##### Recommendation\nWhen calling the `approve()` function, set the actual value for the amount of tokens. \n",
        "protocol": "Yearn Finance",
        "report_date": "2021-02-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/README.md#4-maximum-value-in-function-approve",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/Yearn%20Generic%20Lender%20SCA.pdf"
    },
    {
        "title": "Unresolved `TODO`",
        "content": "##### Description\nUnresolved `TODO` was found in https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/GenericLender/GenericDyDx.sol#L29.\n\n##### Recommendation\nIt is recommended to resolve it.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-02-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/README.md#5-unresolved-todo",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/Yearn%20Generic%20Lender%20SCA.pdf"
    },
    {
        "title": "Add modifier for `emergencyExit` state",
        "content": "##### Description\nSome functions of https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/Strategy.sol don't check `emergencyExit` state. This allows to continue working with the contract after exit.\n\n##### Recommendation\nIt is recommended fixing it with special modifier `emergencyExit`.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-02-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/README.md#6-add-modifier-for-emergencyexit-state",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/Yearn%20Generic%20Lender%20SCA.pdf"
    },
    {
        "title": "Add event for`migrate`",
        "content": "##### Description\nAt the line https://github.com/Grandthrax/yearnV2-generic-lender-strat/blob/979ef2f0e5da39ca59a5907c37ba2064fcd6be82/contracts/Strategy.sol#L554 for the migration process there is only a `Transfer` event.\n\n##### Recommendation\nIt is recommended to emit special event `Migrated` in order to keep users up to date.\n",
        "protocol": "Yearn Finance",
        "report_date": "2021-02-15",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/README.md#7-add-event-formigrate",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Generic%20Lender/Yearn%20Generic%20Lender%20SCA.pdf"
    },
    {
        "title": "It is possible to carry out attacks to manipulate pools within one transaction using a flash loan",
        "content": "##### Description\nIn contracts https://github.com/CoverProtocol/cover-peripheral/tree/d5b37e34d47abec3252cdabd46e55e34a72421d4/contracts/CoverRouter.sol and https://github.com/CoverProtocol/cover-peripheral/tree/d5b37e34d47abec3252cdabd46e55e34a72421d4/contracts/Rollover.sol, any user can exchange tokens with a contract. Any user can add and remove liquidity. An attacker can take a flash loan and perform multiple liquidity manipulations within a single transaction. These manipulations can lead to a loss of funds for other users.\n\n##### Recommendation\nIt is recommended to add protection against token manipulation with flash loans.\nHere's some sample code:\n\n```solidity\nmapping(address => uint256) private _lastSwapBlock;\n\nfunction some() external {\n   _preventSameTxOrigin();\n   ....\n   some logic\n   ...\n }\n\nfunction _preventSameTxOrigin() private {\n   require(block.number > _lastSwapBlock[tx.origin], \"SAME_TX_ORIGIN\");\n   _lastSwapBlock[tx.origin] = block.number;\n }\n```\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-01-11",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20Peripheral/README.md#1-it-is-possible-to-carry-out-attacks-to-manipulate-pools-within-one-transaction-using-a-flash-loan",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20Peripheral/Cover%20Protocol%20Peripheral%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possibility to steal tokens from the contract balance",
        "content": "##### Description\nMethod `addCoverAndCreatePools` defined at https://github.com/CoverProtocol/cover-peripheral/tree/d5b37e34d47abec3252cdabd46e55e34a72421d4/contracts/CoverRouter.sol#L128 accepts `_protocol` and `_collateral` addresses as arguments, then call `_addCover` that makes approve for `_protocol` an unlimited amount of `_collateral` tokens and call `_protocol.addCover`. There are no checks of `_protocol` and `_collateral` validity, so an attacker can pass malicious `_protocol` and get unlimited approval of `_collateral` tokens:\n```solidity\nif (_token.allowance(address(this), _spender) < _amount) {\n  _token.approve(_spender, uint256(-1));\n}\n```\n\nAccording to the contract logic in an optimistic flow a contract shouldn't have any tokens in balance, but this invariant not fully checked, e.g. if `_protocol.addCover` at https://github.com/CoverProtocol/cover-peripheral/tree/d5b37e34d47abec3252cdabd46e55e34a72421d4/contracts/Rollover.sol#L75 fails and returns false, then the transaction will be executed successfully, but the user's funds will be left on the CoverRouter balance.\n\n##### Recommendation\nWe recommend to not use unlimited approve and add particular checks to keep the zero balance invariant.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-01-11",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20Peripheral/README.md#2-possibility-to-steal-tokens-from-the-contract-balance",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20Peripheral/Cover%20Protocol%20Peripheral%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No validation of the address parameter value in contract constructor",
        "content": "##### Description\nThe variable is assigned to the value of the constructor input parameter. But the parameter is not checked before this. If the value turns out to be zero, then it will be necessary to redeploy the contract since there is no other functionality to set this variable.\n\n* At line https://github.com/CoverProtocol/cover-peripheral/tree/d5b37e34d47abec3252cdabd46e55e34a72421d4/contracts/CoverRouter.sol#L36 the `protocolFactory` variable is set to the value of the `_protocolFactory` input parameter.\n* At line https://github.com/CoverProtocol/cover-peripheral/tree/d5b37e34d47abec3252cdabd46e55e34a72421d4/contracts/CoverRouter.sol#L37 the `bFactory` variable is set to the value of the `_bFactory` input parameter.\n\n##### Recommendation\nIn all the cases, it is necessary to add a check of the input parameter to zero before initializing the variables.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-01-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20Peripheral/README.md#1-no-validation-of-the-address-parameter-value-in-contract-constructor",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20Peripheral/Cover%20Protocol%20Peripheral%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "It is possible to use a Front-Running attack",
        "content": "##### Description\nSince all transactions are visible in the mempool for a little while before being executed, the observers of the network can see and react to an action before it is included in a block. An example of how this can be exploited is with a decentralized exchange where a buy order transaction can be seen, and a second order can be broadcast and executed before the first transaction is included.\n\nAt line https://github.com/CoverProtocol/cover-peripheral/tree/d5b37e34d47abec3252cdabd46e55e34a72421d4/contracts/CoverRouter.sol#L64, any user can execute the `rolloverAndAddLiquidityForAccount()` function. This function calls other functions and exchanges tokens between the contract and the `_account` address. Due to the fact that another user completes the transaction earlier, a profitable position in the trade may be lost and the user will lose his profit. \n\n##### Recommendation\nThe best remediation is to remove the benefit of Front-Running in your application, mainly by removing the importance of transaction ordering or time. It will be possible to make use of the maximum or minimum acceptable price or amount range for the transaction, thereby limiting the price slippage.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-01-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20Peripheral/README.md#2-it-is-possible-to-use-a-front-running-attack",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20Peripheral/Cover%20Protocol%20Peripheral%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Need to check the remaining tokens",
        "content": "##### Description\nThere is the `_transferRem` method in the contract. But in some cases, there are no\nchecks:\n- https://github.com/CoverProtocol/cover-peripheral/tree/d5b37e34d47abec3252cdabd46e55e34a72421d4/contracts/CoverRouter.sol#L45 (`addCoverAndAddLiquidity`)\n- https://github.com/CoverProtocol/cover-peripheral/tree/d5b37e34d47abec3252cdabd46e55e34a72421d4/contracts/CoverRouter.sol#L115 (`addLiquidity`)\n- https://github.com/CoverProtocol/cover-peripheral/tree/d5b37e34d47abec3252cdabd46e55e34a72421d4/contracts/CoverRouter.sol#L158 (`createNewPool`)\n\n##### Recommendation\nWe recommend checking all tokens and transfer remaining balance after every external method of the contract.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-01-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20Peripheral/README.md#3-need-to-check-the-remaining-tokens",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20Peripheral/Cover%20Protocol%20Peripheral%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unlimited approval",
        "content": "##### Description\nAt this line `_token.approve(_spender, uint256(-1)` located at https://github.com/CoverProtocol/cover-peripheral/tree/d5b37e34d47abec3252cdabd46e55e34a72421d4/contracts/Rollover.sol#L64 we have an unlimited approval access from CoverRouter.\n\n##### Recommendation\nWe recommend either to revoke the approval after the execution or to approve only the expected amount.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-01-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20Peripheral/README.md#4-unlimited-approval",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20Peripheral/Cover%20Protocol%20Peripheral%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No events for parameter changes",
        "content": "##### Description\nBasic features for `onlyOwner` don't emit any events:\n- https://github.com/CoverProtocol/cover-peripheral/tree/d5b37e34d47abec3252cdabd46e55e34a72421d4/contracts/CoverRouter.sol#L179 (`setSwapFee`)\n- https://github.com/CoverProtocol/cover-peripheral/tree/d5b37e34d47abec3252cdabd46e55e34a72421d4/contracts/CoverRouter.sol#L185 (`setCovTokenWeights`)\n\n##### Recommendation\nWe recommend to create events:`SwapFeeUpdate`, `CovTokenWeightUpdate`.\n",
        "protocol": "Cover Protocol",
        "report_date": "2021-01-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20Peripheral/README.md#1-no-events-for-parameter-changes",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Cover%20Protocol/Cover%20Protocol%20Peripheral/Cover%20Protocol%20Peripheral%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Safe math library isn't used",
        "content": "##### Description\nAt the lines 101, 108, 116, 151, 154, 156, 377, 387, 396, 621, 627, 641, 664, 667, 672, 675, 691, 696, 697, 701, 705, 706, 710, 770, 772 , 776, 778, 796 in https://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Oracle.sol and at the lines 33, 40, 53, 55, 61, 64, 69, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124 , 126, 128, 131, 133, 135, 137, 139, 141, 143, 189, 196, 209, 211, 217, 220, 225, 246-284, 287, 289, 291, 293, 295, 297, 299 , 320, 323, 330-346, 350-354, 363, 365, 371, 374, 379, 393-398, 435, 438, 445, 450-461, 465-469, 478, 480, 486, 489, 494 , 508-513 in https://github.com/iearn-finance/yoracle.link/faf1309cbe7a05f70b338351315039eb8e5b9c09/master/contracts/Keep3rV1Volatility.sol if you do not use a library for safe math, then an arithmetic overflow may occur, which will lead to incorrect operation of smart contracts.\n\n##### Recommendation\nAll arithmetic operations need to be redone using the safe math library. Moreover, this library is already in the contracts https://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Oracle.sol#L176.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/README.md#1-safe-math-library-isnt-used",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/Yearn%20Finance%20Yoracle.Link%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The number of loop iterations should be limited",
        "content": "##### Description\nIn https://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Oracle.sol there are internal arrays `_pairs` for addresses and an `observations` map for structures `Observation[]`. The number of elements of these arrays in the logic of smart contracts only increases, but there is no functionality to decrease. Theoretically, the number of their elements can be very large, since it is not limited anywhere in the program.\nIn loops, the number of elements of this array is used as the upper bound on the number of iterations. Any iteration in the loop uses gas. But the amount of gas in one block is limited. It means that a situation may arise when there is not enough gas to perform all the iterations of the cycle and the function will stop working.\nThere are such loops here:\nline 575, 595, 662, 670, 696, 705,\n\n##### Recommendation\nIt is necessary in loops to introduce a limit on the number of iterations or on the possible number of array elements in loops.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/README.md#2-the-number-of-loop-iterations-should-be-limited",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/Yearn%20Finance%20Yoracle.Link%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible incorrect operation of the function",
        "content": "##### Description\nAt the line https://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Oracle.sol#L626 the result of the `_valid` function depends on the value of `block.timestamp`. But the `block.timestamp` value is set by the miner. This may result in an incorrect result.  According to the specification https://github.com/ethereum/wiki/blob/c02254611f218f43cbb07517ca8e5d00fd6d6d75/Block-Protocol-2.0.md, the miner can shift `block.timestamp` up to 900 seconds. If the range is greater, then you are safe.\n\n##### Recommendation\nWe recommend adding a restriction on the value of variable `age`. For the same reason, we do not recommend setting the value of the `periodSize` constant less than 900.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/README.md#3-possible-incorrect-operation-of-the-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/Yearn%20Finance%20Yoracle.Link%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "It is possible to go beyond the boundaries of the array",
        "content": "##### Description\nAt the line https://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Oracle.sol#L685 the `sample` function does not check for a valid `observations[pair]` array element number.\nOn lines 700, 701, 709, 710 there is a call to the array element with the `nextIndex` index. But there is nowhere a check that the `nextIndex` value is less than and equal to the value of the variable `length`.\n\n##### Recommendation\nWe recommend to add such a check.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/README.md#4-it-is-possible-to-go-beyond-the-boundaries-of-the-array",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/Yearn%20Finance%20Yoracle.Link%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "There is no check of the ether balance on the contract before it is transferred",
        "content": "##### Description\nAt the line https://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Oracle.sol#L479 before transferring ether from the contract, you need to check that its amount is greater than 0.\n\n##### Recommendation\nAdd checking the ether balance on the contract before transferring it.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/README.md#5-there-is-no-check-of-the-ether-balance-on-the-contract-before-it-is-transferred",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/Yearn%20Finance%20Yoracle.Link%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Function calculation result is not processed",
        "content": "##### Description\nBelow there will be a case when the code does not process the result of calling `approve`.\n\nhttps://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Oracle.sol#L819\n\n`approve` method may return `false`.\n\n##### Recommendation\nCheck the return value of the function.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/README.md#6-function-calculation-result-is-not-processed",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/Yearn%20Finance%20Yoracle.Link%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potential `Out of range` error",
        "content": "##### Description\nCode line https://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Oracle.sol#L638 may return an exception because `observations[pair]` cannot guarantee the length more than 1.\n\n##### Recommendation\nIt is recommended to check it.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/README.md#7-potential-out-of-range-error",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/Yearn%20Finance%20Yoracle.Link%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Contract cannot be compiled",
        "content": "##### Description\nThe contact `Keep3rV1Volatility.sol` has the following syntax errors:\nhttps://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Volatility.sol#L157\nhttps://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Volatility.sol#L428\n\n##### Recommendation\nIt is recommended to fix the errors above.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-28",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/README.md#8-contract-cannot-be-compiled",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/Yearn%20Finance%20Yoracle.Link%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "We recommend changing the scope of functions",
        "content": "##### Description\nChanging the scope of functions will allow making transactions with a lower cost of gas.\n\n##### Recommendation\nhttps://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Oracle.sol\nOn line 560, the `work` function can be changed from `public` to `external`.\nOn line 565, the `workForFree` function can be changed from `public` to `external`.\nOn line 574, function `_updateAll` can be changed from `internal` to `private`.\nOn line 603, the `_update` function can be changed from `internal` to `private`.\nOn line 626, the `_valid` function can be scoped from `\"internal` to `private`.\nOn line 807, function `retBasedBlackScholesEstimate` can be changed from `public` to `external`.\nOn line 818, the `_swap` function can be changed from `internal` to `private`.\n\nhttps://github.com/iearn-finance/yoracle.link/faf1309cbe7a05f70b338351315039eb8e5b9c09/master/contracts/Keep3rV1Volatility.sol\nOn line 26, the `floorLog2` function can be changed from `internal` to `private`.\nOn line 48, the `ln` function can be changed from `internal` to `private`.\nOn line 83, for the `optimalExp` function, the scope can be changed from `internal` to `private`.\n\nThese steps will save you some gas cost for transactions.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-28",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/README.md#1-we-recommend-changing-the-scope-of-functions",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/Yearn%20Finance%20Yoracle.Link%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "We recommend moving the functions to a separate library",
        "content": "##### Description\nIn smart contract https://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Oracle.sol#L751 there is the `sqrt` function and in smart contracts\nhttps://github.com/iearn-finance/yoracle.link/faf1309cbe7a05f70b338351315039eb8e5b9c09/master/contracts/Keep3rV1Volatility.sol#L382 and https://github.com/iearn-finance/yoracle.link/faf1309cbe7a05f70b338351315039eb8e5b9c09/master/contracts/Keep3rV1Volatility.sol#L497 this function is again described.\n\n##### Recommendation\nWe recommend that you describe it once in the library file.\nWe also recommend transferring the following functions to this library:\n`floorLog2` located here https://github.com/iearn-finance/yoracle.link/faf1309cbe7a05f70b338351315039eb8e5b9c09/master/contracts/Keep3rV1Volatility.sol#L182\n`ln` located here https://github.com/iearn-finance/yoracle.link/faf1309cbe7a05f70b338351315039eb8e5b9c09/master/contracts/Keep3rV1Volatility.sol#L204\n`optimalExp` located here https://github.com/iearn-finance/yoracle.link/faf1309cbe7a05f70b338351315039eb8e5b9c09/master/contracts/Keep3rV1Volatility.sol#L239\n`C` located here https://github.com/iearn-finance/yoracle.link/faf1309cbe7a05f70b338351315039eb8e5b9c09/master/contracts/Keep3rV1Volatility.sol#L328\nThe `C` function can be named more meaningfully and clearly.\n\nIt is possible that you can take other functions. But the main thing is that the mathematical functions are located in a separate library.\nThen the source code will be easier to test and understand.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-28",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/README.md#2-we-recommend-moving-the-functions-to-a-separate-library",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/Yearn%20Finance%20Yoracle.Link%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Duplicate code",
        "content": "##### Description\nThe `quote` function is completely repeated here https://github.com/iearn-finance/yoracle.link/faf1309cbe7a05f70b338351315039eb8e5b9c09/master/contracts/Keep3rV1Volatility.sol#L148\nand here https://github.com/iearn-finance/yoracle.link/faf1309cbe7a05f70b338351315039eb8e5b9c09/master/contracts/Keep3rV1Volatility.sol#L304\nIt needs to be described only once.\n\nThe `IERC20` interface is completely repeated here https://github.com/iearn-finance/yoracle.link/faf1309cbe7a05f70b338351315039eb8e5b9c09/master/contracts/Keep3rV1Volatility.sol#L10\nand here https://github.com/iearn-finance/yoracle.link/faf1309cbe7a05f70b338351315039eb8e5b9c09/master/contracts/Keep3rV1Volatility.sol#L166\nIt needs to be described only once.\n\nhttps://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Oracle.sol#L486\nOn lines 486, 495, 560 the code is repeated:\n`require (msg.sender == governance,\" setGovernance:! Gov \");`\nIt is necessary to transfer this code to a separate access modifier.\n\nhttps://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Oracle.sol#L468\nOn lines 468 and 474 the code is repeated:\n`require (KP3R.isMinKeeper (msg.sender, minKeep, 0, 0),\" :: isKeeper: keeper is not registered \");`\nIt is necessary to transfer this code to a separate access modifier.\n\nhttps://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Oracle.sol#L562\nOn lines 562 and 567 the code is repeated:\n`require (worked,\" UniswapV2Oracle:! Work \");`\nIt is necessary to transfer this code to a separate access modifier.\n\nhttps://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Oracle.sol#L632\nOn lines 632 and 652 the code is repeated:\n`require (_valid (pair, periodSize.mul (2)),\" UniswapV2Oracle :: quote: stale prices \");`\nIt is necessary to transfer this code to a separate access modifier.\n\n##### Recommendation\nDuplicate code is a very bad programming practice and is against the principles of SOLID (single responsibility, open\u2013closed, Liskov substitution, interface segregation \u0438 dependency inversion). We recommend refactoring the source code.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-28",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/README.md#3-duplicate-code",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/Yearn%20Finance%20Yoracle.Link%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "We recommend removing additional functionality from the access modifier",
        "content": "##### Description\nAt the line https://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Oracle.sol#L472 the `upkeep` access modifier has additional functionality designed to calculate the amount of ETH and send it from the contract.\nIn accordance with the principles of SOLID (single responsibility, open\u2013closed, Liskov substitution, interface segregation \u0438 dependency inversion) software development, each module is responsible for only one thing. An access modifier should only be responsible for access.\n\n##### Recommendation\nIt is necessary to transfer all additional functionality from this modifier to a separate function.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-28",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/README.md#4-we-recommend-removing-additional-functionality-from-the-access-modifier",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/Yearn%20Finance%20Yoracle.Link%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "We recommend caching the variable",
        "content": "##### Description\nAt the line https://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Oracle.sol#L411 in the `getAmountsIn` function, the length of the `path.length` array is calculated 3 times: on lines 412, 413, 415.\n\n##### Recommendation\nWe recommend storing the value of the array length in a separate variable and referring to this variable.\nThis will slightly reduce the gas consumption.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-28",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/README.md#5-we-recommend-caching-the-variable",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/Yearn%20Finance%20Yoracle.Link%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Mixed formatting",
        "content": "##### Description\n`Tabs` are used instead of `Spaces`:\nhttps://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Volatility.sol#L443\n\n##### Recommendation\nMake corrections to the source code.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-28",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/README.md#6-mixed-formatting",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/Yearn%20Finance%20Yoracle.Link%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potential `Out of range` error",
        "content": "##### Description\nAt the lines https://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Oracle.sol#L656, https://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Oracle.sol#L690 in `observations[pair]` there is always more than 1 element (https://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Oracle.sol#L557). \n\n##### Recommendation\nHowever, it is recommended to check it.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-28",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/README.md#7-potential-out-of-range-error",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/Yearn%20Finance%20Yoracle.Link%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Lack of event",
        "content": "##### Description\nhttps://github.com/iearn-finance/yoracle.link/blob/faf1309cbe7a05f70b338351315039eb8e5b9c09/contracts/Keep3rV1Oracle.sol#L479\nLogging events while a smart contract is running is a good practice.\n\n##### Recommendation\nIt is recommended to emit an event when ethers are transferred.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-28",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/README.md#8-lack-of-event",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Yoracle.Link/Yearn%20Finance%20Yoracle.Link%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potential front running attack or losing of allowance",
        "content": "##### Description\nAt the line https://github.com/1inch-exchange/1inch-token/blob/99fd056f91005ca521a02a005f7bcd8f77e06afc/contracts/ERC20Permit.sol#L53 `_approve` method replaces the allowance, so there are two potential problems here:\n1. If a signer wants to increase the allowance from `A` to `B`, a receiver may withdraw `A+B` using the front-running attack.\n2. If a signer wants to send `A` and `B`, but a receiver forgot to withdraw `A`, the receiver will lose ability to withdraw `A`.\n\n##### Recommendation\nWe suggest to add `permitIncrease`, `permitDecrease` methods and use it instead of the `permit`.\n",
        "protocol": "1inch",
        "report_date": "2020-12-23",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/token/README.md#1-potential-front-running-attack-or-losing-of-allowance",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/token/report.pdf"
    },
    {
        "title": "Mismatch of argument name in `_PERMIT_TYPEHASH` and `permit` function",
        "content": "##### Description\nAt the line https://github.com/1inch-exchange/1inch-token/blob/99fd056f91005ca521a02a005f7bcd8f77e06afc/contracts/ERC20Permit.sol#L27 the `value` argument is used but at the line https://github.com/1inch-exchange/1inch-token/blob/99fd056f91005ca521a02a005f7bcd8f77e06afc/contracts/ERC20Permit.sol#L32 the argument name is `amount`.\n\n##### Recommendation\nWe suggest to rename `amount` to `value` in the `permit` function.\n",
        "protocol": "1inch",
        "report_date": "2020-12-23",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/token/README.md#1-mismatch-of-argument-name-in-_permit_typehash-and-permit-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/1inch/token/report.pdf"
    },
    {
        "title": "Invalid setter function",
        "content": "##### Description\n* In the `setDefaultController()` function defined at line https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/factories/PieFactoryContract.sol#L34, the new value is assigned to the `defaultController` variable. But it is not taken into account that earlier using the `bakePie()` function, the pool owner could be changed to address of `defaultController`. Thus, as a result of the work of the `setDefaultController()` function, the pool owner will remain the same, while it is expected that the pool will be managed from a different address.\n* In the `setFeeBeneficiary()` function defined at line https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/Basket/BasketFacet.sol#L87 , the `LibBasketStorage.basketStorage().FeeBeneficiary` variable is assigned a new value. But it is not taken into account that earlier tokens could be issued to this address in the following places: https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/Basket/BasketFacet.sol#L141, https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/Basket/BasketFacet.sol#L175, https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/Basket/BasketFacet.sol#L216.\n\n\n##### Recommendation\nIt is necessary to carefully check the logic of these functions and make corrections if necessary.\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#1-invalid-setter-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect logic when burning and minting tokens",
        "content": "##### Description\n* The `mint()` function defined at the line https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/ERC20/ERC20Facet.sol#L44 is for minting new tokens.\nThe amount of tokens is increased on the wallet with the address `_receiver`.\nBut the ERC-20 specification also uses the value of the `totalSupply` variable.\nThis variable is not incremented here.\n\n* At line: https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/ERC20/ERC20Facet.sol#L48. The `burn()` function is for burning tokens. The amount of tokens is reduced on the wallet with the address `_from`.\nBut the ERC-20 specification also uses the value of the `totalSupply` variable. The value of this variable is not decremented here.\nAt the same time, the value of the variable `totalSupply` is used 7 times for calculations in this smart contract: \nhttps://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/Basket/BasketFacet.sol.\n\n##### Recommendation\nThis problem needs to be corrected so that the calculations would be correct.\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#2-incorrect-logic-when-burning-and-minting-tokens",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Approve / TransferFrom multiple withdrawal attack",
        "content": "##### Description\nThis known issue is documented here: https://github.com/ethereum/EIPs/issues/738.\n\nSummary / example of the attack:\n1.\tAlice allows Bob to transfer N of Alice's tokens (N>0) by calling approve method on Token smart contract passing Bob's address and N as method arguments\n2.\tAfter some time, Alice decides to change from N to M (M>0) the number of Alice's tokens Bob is allowed to transfer, so she calls approve method again, this time passing Bob's address and M as method arguments\n3.\tBob notices Alice's second transaction before it was mined and quickly sends another transaction that calls transferFrom method to transfer N Alice's tokens somewhere\n4.\tIf Bob's transaction is be executed before Alice's transaction, then Bob will successfully transfer N Alice's tokens and will gain an ability to transfer another M tokens\n5.\tBefore Alice noticed that something went wrong, Bob calls transferFrom method again, this time to transfer M Alice's tokens.\n\nSo, Alice's attempt to change Bob's allowance from N to M (N>0 and M>0) made it possible for Bob to transfer N+M of Alice's tokens, while Alice never wanted to allow so many of her tokens to be transferred by Bob.\n\n##### Recommendation\nWe recommend adding additional sanity checks to the `approve()` function and using the `increaseAllowance()` / `decreaseAllowance ()`  workaround functions:\n`require((_amount == 0) || (allowed[msg.sender][_spender] == 0));`\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#3-approve-transferfrom-multiple-withdrawal-attack",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Gas overflow during iteration (DoS)",
        "content": "##### Description\nEach iteration of the cycle requires a gas flow.\nA moment may come when more gas is required than it is allocated to record one block. In this case, all iterations of the loop will fail.\nAffected lines:\n* https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/factories/PieFactoryContract.sol#L72\n* https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/Call/CallFacet.sol#L43\n* https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/Call/CallFacet.sol#L67\n* https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/Call/CallFacet.sol#L81\n* https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/Basket/BasketFacet.sol on lines 45, 126, 158, 274, 296\n\n##### Recommendation\nWe recommend adding a check for the maximum possible number of elements of the arrays.\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#4-gas-overflow-during-iteration-dos",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Global Protection of malicious backward calls in raw methods execution",
        "content": "##### Description\nAt the lines: https://github.com/pie-dao/ExperiPie/blob/0.0.2/contracts/callManagers/LendingManager/LendingManager.sol#L44, https://github.com/pie-dao/ExperiPie/blob/0.0.2/contracts/callManagers/LendingManager/LendingManager.sol#L70, https://github.com/pie-dao/ExperiPie/blob/0.0.2/contracts/callManagers/LendingManager/LendingManager.sol#L102, https://github.com/pie-dao/ExperiPie/blob/0.0.2/contracts/callManagers/LendingManager/LendingManager.sol#L114, https://github.com/pie-dao/ExperiPie/blob/0.0.2/contracts/callManagers/RSIManager.sol#94, https://github.com/pie-dao/ExperiPie/blob/0.0.2/contracts/callManagers/RSIManager.sol#131 anything can happen in target methods execution.\n\nWe expect one-way class methods execution-graph like:\n```\nA.method1 -> B.method2 -> C.method3\n```\nSo it is better to ensure it.\n\n##### Recommendation\nWith growing complexity and cross-dependency of SmartContracts such mistaken or malicious case can occure and it will not be easy to track. So it is better to place protection against unexpected calls, e.g. place a `totalCallsCount` class-level variable. Increase it every time, any class-method was called.\nAnd do something like:\n\n```\n   totalCallsCountBefore = totalCallsCount;\n   call(target, bytes)\n   require(totalCallsCount == totalCallsCountBefore)\n```\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#5-global-protection-of-malicious-backward-calls-in-raw-methods-execution",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No validation of the address parameter value in contract constructor",
        "content": "##### Description\nThe variable is assigned the value of the constructor input parameter. But this parameter is not checked before this. If the value turns out to be zero, then it will be necessary redeploy the contract, since there is no other functionality to set this variable.\n\nAt the line https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/callManagers/LendingManager/LendingLogicAave.sol#L16 the `lendingPool` variable is set to the value of the `_lendingPool` input parameter.\n\nAt the line https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/callManagers/LendingManager/LendingLogicCompound.sol#L16 the `lendingRegistry` variable is set to the value of the `_lendingRegistry` input parameter.\n\nAt the line https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/callManagers/LendingManager/LendingManager.sol#L24 the `lendingRegistry` variable is set to the value of the `_lendingRegistry` input parameter.\n\nAt the line https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/callManagers/LendingManager/LendingManager.sol#L25 the variable `basket` is assigned the value of the input parameter` _basket`.\n\nAt the line https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/callManagers/RSIManager.sol#L31 values of the following variables are not checked: `_assetShort`,`_assetLong`, `_priceFeed`,`_basket`, `_synthetix`.\n\n##### Recommendation\nIn all the cases, it is necessary to add a check of the input parameter to zero before initializing the variables.\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#1-no-validation-of-the-address-parameter-value-in-contract-constructor",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No validation of the address parameter value in function before using this parameter in access modifiers",
        "content": "##### Description\nIt is possible that parameter value will be equal to zero. Then the work of the smart contract will be blocked.\n\nAt the line https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/callManagers/LendingManager/LendingRegistry.sol#L33 for the `_wrapped` variable in the`setWrappedToProtocol()` function.\n\n\nAt the line https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/callManagers/LendingManager/LendingRegistry.sol#L43 for the variable `_underlying` in the`setWrappedToUnderlying ()` function.\n\nAt the linehttps://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/callManagers/LendingManager/LendingRegistry.sol#L53 for the `_logic` variable in the`setProtocolToLogic()` function.\n\nAt the line https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/callManagers/LendingManager/LendingRegistry.sol#L64 for the variable `_underlying` and` _wrapped` in the `setUnderlyingToProtocolWrapped()` function.\n\nAt the line https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/factories/PieFactoryContract.sol#L35 for the `_controller` variable in the`setDefaultController ()` function.\n\n##### Recommendation\nIt is necessary to add a check of the parameter value to zero before initializing the variables.\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#2-no-validation-of-the-address-parameter-value-in-function-before-using-this-parameter-in-access-modifiers",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible loss of tokens",
        "content": "##### Description\nhttps://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/ERC20/LibERC20.sol#L17\nIf the value of the `_to` parameter is equal to zero, then the tokens will be lost, because they cannot be disposed of.\nHowever, the value of the `es.totalSupply` variable will be incremented.\n\n##### Recommendation\nIn the `mint` function, we recommend adding a check for the`_to` parameter for zero.\n```solidity\nrequire(_to != address(0), \"mint to the zero address\n```\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#3-possible-loss-of-tokens",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Invalid deletion of an array element",
        "content": "##### Description\n* First, for the `removeFacet()` function defined at https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/factories/PieFactoryContract.sol#L39, the value of the `_index` parameter is not checked. If its value turns out to be greater than the number of array elements, then an interrupt will occur due to going out of bounds of the array.\n\n* Second, on line 41, the array element with the number `_index` is assigned to the value of the last array element. Then the last element is removed. Thus, the integrity of the array is violated, because the elements are shuffled and not in the order they were added to the array.\n\n##### Recommendation\nWe recommend that you redo the logic of this function.\nAn example of the correct implementation can be found here:\nhttps://ethereum.stackexchange.com/questions/1527/how-to-delete-an-element-at-a-certain-index-in-an-array \nBut keep in mind that when implementing a cycle, you must set a limit on the maximum number of its iterations.\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#4-invalid-deletion-of-an-array-element",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "The function should return a variable, but this is not done",
        "content": "##### Description\nhttps://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/ERC20/ERC20Facet.sol#L75\nThe `transferFrom()` function should return a boolean variable, but this is not in the source code.\n\n##### Recommendation\nWe recommend adding the return value of this function.\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#5-the-function-should-return-a-variable-but-this-is-not-done",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "It is necessary to check the correctness of the variable value",
        "content": "##### Description\n* At the line https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/ERC20/LibERC20.sol#L25 the `burn()` function decreases the value of the amount of `es.balances` tokens for the`_from` wallet. We recommend adding a check of the current value of the `_from` variable for zero:\n```require(_from != address(0), \"burn from the zero address\");```\n* At the line https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/ERC20/ERC20Facet.sol#L57 the `approve()` function gives a permission to dispose of own tokens for the `_spender` wallet. We recommend adding a check of the current value of the `_spender` variable to zero:\n```require(_spender != address(0), \"approve to the zero address\");```\n* At the line https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/ERC20/ERC20Facet.sol#L79 in the `transferFrom()` function, there is a decrease in the value of the amount tokens allowed to the sender`msg.sender` for the `_from` wallet. We recommend adding a check of the current value of the `_from` variable for zero:\n```require(_from != address(0), \"transfer from the zero address\");```\n* At the line https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/ERC20/ERC20Facet.sol#L115 in the `_transfer ()` function, the value of the amount of tokens for the `_from` wallet is decreasing. We recommend adding a check of the current value of the `_from` variable for zero: \n```require(_from != address(0), \"transfer from the zero address\");```\n\n##### Recommendation\nWe recommend adding a the particular checks.\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#6-it-is-necessary-to-check-the-correctness-of-the-variable-value",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Possible incorrect operation of the function",
        "content": "##### Description\nAt the lines https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/Basket/BasketFacet.sol#L200 and https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/Basket/BasketFacet.sol#L209. The result of the function depends on the value of `block.timestamp`. But the value `block.timestamp` is set by the miner. This may result in an incorrect result. According to the specification https://github.com/ethereum/wiki/blob/c02254611f218f43cbb07517ca8e5d00fd6d6d75/Block-Protocol-2.0.md, the miner can shift `block.timestamp` up to 900 seconds. If the range is greater, then you are safe.\n\n##### Recommendation\nWe recommend that you do not use `block.timestamp` or calculate the difference between the two values so that it is greater than 900.\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#7-possible-incorrect-operation-of-the-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Too open rebalance method",
        "content": "##### Description\nThis is potentially dangerous because of potential manipulations on the market: https://github.com/pie-dao/ExperiPie/blob/0.0.2/contracts/callManagers/RSIManager.sol#L50\n\n##### Recommendation\nWe suggest adding some restrictions for the caller account.\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#8-too-open-rebalance-method",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "`maxCap` can go under `totalSupply`",
        "content": "##### Description\nIf the supply is bigger than new `maxCap`: https://github.com/pie-dao/ExperiPie/blob/0.0.2/contracts/facets/Basket/BasketFacet.sol#L242\n\n##### Recommendation\nWe recommend to add `require(totalSupply <= _maxCap, '...')`.\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#9-maxcap-can-go-under-totalsupply",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "ERC20Face initialize can be called several times",
        "content": "##### Description\nIt is not logical and potentially can cause misunderstanding and mistakes: https://github.com/pie-dao/ExperiPie/blob/0.0.2/contracts/facets/ERC20/ERC20Facet.sol#L16\n\n##### Recommendation\nWe suggest adding the following check:\n```\nrequire(!finalized, '...')\n```\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#10-erc20face-initialize-can-be-called-several-times",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Require success in search over tokens using for-loop",
        "content": "##### Description\nIf a token was not found, it means that something unexpected happen, moreover in that case we also emit event that the token was removed, but it's not true: https://github.com/pie-dao/ExperiPie/blob/0.0.2/contracts/facets/Basket/BasketFacet.sol#L52\n\n##### Recommendation\nWe recommend to fail the call or not to emit a particular event.\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#11-require-success-in-search-over-tokens-using-for-loop",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Exit pool potentially is impossible",
        "content": "##### Description\nAt the lines https://github.com/pie-dao/ExperiPie/blob/0.0.2/contracts/facets/Basket/BasketFacet.sol#L163 and https://github.com/pie-dao/ExperiPie/blob/0.0.2/contracts/facets/Basket/BasketFacet.sol#L179\nDue to `require(tokenBalance.sub(tokenAmount) >= MIN_AMOUNT, \"TOKEN_BALANCE_TOO_LOW\");` it is impossible to leave the pool completely, so some funds will be locked in the pool forever.\n\nIt is not clear why there should be such unsolvable problems if you want just to \"take all your tokens and leave\".\n\n##### Recommendation\nProbably `MIN_AMOUNT` is not 0 because of the division by `totalSupply` in some places. At least this moment should be covered in source code somewhere.\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#12-exit-pool-potentially-is-impossible",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Duplicate code",
        "content": "##### Description\nDuplicate code, i.e. using the same code structures in several places. Combining these structures will improve your code. The use of duplicate code structures impairs the perception of the program logic and can easily lead to errors in subsequent code edits. Duplicate code violates SOLID (single responsibility, open\u2013closed, Liskov substitution, interface segregation \u0438 dependency inversion) software development principles.\n\n##### Recommendation\nAt the lines 24, 36 in file https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/Call/CallFacet.sol instead of this code: \n> `require(msg.sender == LibDiamond.diamondStorage().contractOwner, \"NOT_ALLOWED\");`\n> \nwe recommend making the access modifier\n>`\nmodifier onlyContractOwner() {\n    require(msg.sender == LibDiamond.diamondStorage().contractOwner, \"NOT_ALLOWED\");\n    _;\n}\n`\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#1-duplicate-code",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "There is no check of the amount of ether before calling the paid function",
        "content": "##### Description\nAt the line https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/Call/CallFacet.sol#L99 in the `_call` function, paid functions are called in other contracts. But on the balance of the contract there may not be enough ether to perform these functions and the `_call` function will not be executed.\n\n##### Recommendation\nWe recommend adding such a check.\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#2-there-is-no-check-of-the-amount-of-ether-before-calling-the-paid-function",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No event registration when changing the parameters of the contract",
        "content": "##### Description\nhttps://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/callManagers/LendingManager/LendingLogicAave.sol#L20\nWe recommend adding the `Lend` event logging for the`lend()`function.\n\nhttps://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/callManagers/LendingManager/LendingLogicAave.sol#L42\nWe recommend adding logging of the `UnLend` event for the`unlend()`function.\n\nhttps://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/callManagers/LendingManager/LendingLogicCompound.sol#L19\nWe recommend adding the `Lend` event logging for the`lend()`function.\nhttps://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/callManagers/LendingManager/LendingLogicCompound.sol#L43\nWe recommend adding logging of the `UnLend` event for the`unlend()`function.\n\nhttps://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/callManagers/LendingManager/LendingManager.sol#L93\nWe recommend adding logging of the `RemoveToken` event to the`removeToken()` function.\n\nhttps://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/callManagers/LendingManager/LendingManager.sol#L105\nWe recommend adding logging of the `AddToken` event for the`addToken()` function.\n\n##### Recommendation\nWe recommend adding logging.\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#3-no-event-registration-when-changing-the-parameters-of-the-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Incorrect function logic",
        "content": "##### Description\nAt the line https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/ERC20/ERC20Facet.sol#L105 the `_transfer ()` function is designed to transfer tokens from one wallet to another wallet.\nBut here, for the situation, if the value of the sender's wallet turns out to be equal to zero, tokens are burned from `msg.sender` account instead of from `_from`.\n\n##### Recommendation\nWe recommend that you redo the logic of this function so that only logic remains here,\nresponsible for the transfer of tokens, but not burning.\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#4-incorrect-function-logic",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "We recommend adding an additional parameter when registering an event",
        "content": "##### Description\nAt the line https://github.com/pie-dao/ExperiPie/blob/facf3c246d9c43f5b1e0bad7dc2b0a9a2a2393c5/contracts/facets/Call/CallFacet.sol#L101 calling the `_call()` function performs any action with any contracts.\nHowever, the `Call` event does not store who called the function.\n\n##### Recommendation\nWe recommend adding one more parameter to save the value of `msg.sender`.\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#5-we-recommend-adding-an-additional-parameter-when-registering-an-event",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unclear constants",
        "content": "##### Description\nFor example, it is absolutely unclear what `30 * 10**18` means. At the following lines: https://github.com/pie-dao/ExperiPie/blob/0.0.2/contracts/callManagers/RSIManager.sol#L54, https://github.com/pie-dao/ExperiPie/blob/0.0.2/contracts/callManagers/RSIManager.sol#L58, https://github.com/pie-dao/ExperiPie/blob/0.0.2/contracts/callManagers/RSIManager.sol#L78, https://github.com/pie-dao/ExperiPie/blob/0.0.2/contracts/facets/Basket/BasketFacet.sol#L97, https://github.com/pie-dao/ExperiPie/blob/0.0.2/contracts/facets/Basket/BasketFacet.sol#L107, https://github.com/pie-dao/ExperiPie/blob/0.0.2/contracts/facets/Basket/BasketFacet.sol#L124, https://github.com/pie-dao/ExperiPie/blob/0.0.2/contracts/facets/Basket/BasketFacet.sol#L139\n\n##### Recommendation\nConstants should be described on the top of the class once and have descriptive names and comments if need.\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#6-unclear-constants",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Use `totalSupply <= maxCap` instead of `<`",
        "content": "##### Description\nIt is more rational to use `<=` instead of `<` at the line https://github.com/pie-dao/ExperiPie/blob/0.0.2/contracts/facets/Basket/BasketFacet.sol#L122.\n\n##### Recommendation\nWe suggest to replace operator to `<=` instead of `<`.\n",
        "protocol": "PieDAO",
        "report_date": "2020-12-11",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/README.md#7-use-totalsupply-maxcap-instead-of",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/PieDAO/ExperiPie/PieDAO%20Experipie%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Missing Leading 'F' in LIQUIDATION_BONUS_MASK in ReserveConfiguration.sol",
        "content": "##### Description\n\nhttps://github.com/aave/protocol-v2/blob/f435b2fa0ac589852ca3dd6ae2b0fbfbc7079d54/contracts/libraries/configuration/ReserveConfiguration.sol#L18 \n\nOne leading `F` is missing in this mask.\n\n```solidity\nuint256 constant LIQUIDATION_BONUS_MASK = 0xFFFFFFF0000FFFFFFFF;\n```\n\nThis fact results in the corruption of four bits in the reserve factor field during the operations on the liquidation bonus field. `getLiquidationBonus` is also affected.\n\n##### Recommendation\n\nWe suggest fixing the mask. We also recommend adding tests for each `ReserveConfiguration` field which have other fields set to some values, perform some actions, restore the field to the original value and make sure that the entire mask is intact.\n",
        "protocol": "AAVE",
        "report_date": "2020-12-03",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/protocol%20v2/README.md#missing-leading-f-in-liquidation_bonus_mask-in-reserveconfigurationsol",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/protocol%20v2/report.pdf"
    },
    {
        "title": "Improper Bit-Length Validation in Reserve Configuration",
        "content": "##### Description\n\nhttps://github.com/aave/protocol-v2/blob/f435b2fa0ac589852ca3dd6ae2b0fbfbc7079d54/contracts/libraries/configuration/ReserveConfiguration.sol#L46\n\nhttps://github.com/aave/protocol-v2/blob/f435b2fa0ac589852ca3dd6ae2b0fbfbc7079d54/contracts/libraries/configuration/ReserveConfiguration.sol#L63\n\nhttps://github.com/aave/protocol-v2/blob/f435b2fa0ac589852ca3dd6ae2b0fbfbc7079d54/contracts/libraries/configuration/ReserveConfiguration.sol#L84\n\nhttps://github.com/aave/protocol-v2/blob/f435b2fa0ac589852ca3dd6ae2b0fbfbc7079d54/contracts/libraries/configuration/ReserveConfiguration.sol#L106\n\nhttps://github.com/aave/protocol-v2/blob/f435b2fa0ac589852ca3dd6ae2b0fbfbc7079d54/contracts/libraries/configuration/ReserveConfiguration.sol#L128\n\nBit lengths of the provided values are not checked against bit lengths of the corresponding fields in the `data`.\n\nFor example, here\n\n```solidity\nfunction setLtv(ReserveConfiguration.Map memory self, uint256 ltv) internal pure {\n    self.data = (self.data & LTV_MASK) | ltv;\n```\n\nproviding a value greater than `65535` as `ltv` will result in a corruption of the liquidation threshold field. \n\n##### Recommendation\nWe recommend making sure that passed values fit in the corresponding fields.\n",
        "protocol": "AAVE",
        "report_date": "2020-12-03",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/protocol%20v2/README.md#improper-bit-length-validation-in-reserve-configuration",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/protocol%20v2/report.pdf"
    },
    {
        "title": "Erroneous UserBalance Restriction in Withdrawal Validation",
        "content": "##### Description\n\nhttps://github.com/aave/protocol-v2/blob/f435b2fa0ac589852ca3dd6ae2b0fbfbc7079d54/contracts/libraries/logic/ValidationLogic.sol#L68\n\nIt looks like `userBalance` is erroneously used instead of `amount`. This will result in overly strict restrictions on withdrawals. \n\n##### Recommendation\nWe suggest replacing the argument.\n",
        "protocol": "AAVE",
        "report_date": "2020-12-03",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/protocol%20v2/README.md#erroneous-userbalance-restriction-in-withdrawal-validation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/protocol%20v2/report.pdf"
    },
    {
        "title": "Uninitialized `availableLiquidity` in Loan Size Calculation.",
        "content": "##### Description\n\nhttps://github.com/aave/protocol-v2/blob/f435b2fa0ac589852ca3dd6ae2b0fbfbc7079d54/contracts/libraries/logic/ValidationLogic.sol#L200\n\nThe `vars.availableLiquidity` field is not initialized before usage.\n\n```solidity\n//calculate the max available loan size in stable rate mode as a percentage of the\n//available liquidity\nuint256 maxLoanSizeStable = vars.availableLiquidity.percentMul(maxStableLoanPercent);\n```\n##### Recommendation\nProper initialization should be added.\n",
        "protocol": "AAVE",
        "report_date": "2020-12-03",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/protocol%20v2/README.md#uninitialized-availableliquidity-in-loan-size-calculation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/protocol%20v2/report.pdf"
    },
    {
        "title": "Decimals Mismatch in Reserve Configuration Update",
        "content": "##### Description\nhttps://github.com/aave/protocol-v2/blob/f435b2fa0ac589852ca3dd6ae2b0fbfbc7079d54/contracts/lendingpool/LendingPoolConfigurator.sol#L533 \n\nChanging the decimals here will not automatically change the decimals either in the aToken or in the debt tokens.\n\n```solidity\nfunction setReserveDecimals(address asset, uint256 decimals) external onlyAaveAdmin {\n    ReserveConfiguration.Map memory currentConfig = pool.getConfiguration(asset);\n\n    currentConfig.setDecimals(decimals);\n\n    pool.setConfiguration(asset, currentConfig.data);\n```\n\nAdditionally, the oracle must be updated simultaneously to consider the new value of the decimals. Otherwise, significant mispricing and liquidations may occur. \n##### Recommendation\nWe suggest removing this function. Alternatively, the change may be allowed only for inactive reserve and must be propagated to the tokens.\n",
        "protocol": "AAVE",
        "report_date": "2020-12-03",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/protocol%20v2/README.md#decimals-mismatch-in-reserve-configuration-update",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/protocol%20v2/report.pdf"
    },
    {
        "title": "Flawed Stable Debt Calculation Due to Timestamp Mismatch",
        "content": "##### Description\nhttps://github.com/aave/protocol-v2/blob/f435b2fa0ac589852ca3dd6ae2b0fbfbc7079d54/contracts/libraries/logic/ReserveLogic.sol#L341-L347 \n\nValue `vars.previousStableDebt` calculated this way is actually the current stable debt and always equals to `vars.currentStableDebt`.\n\n```solidity\n//calculate the stable debt until the last timestamp update\nvars.cumulatedStableInterest = MathUtils.calculateCompoundedInterest(\n  vars.avgStableRate,\n  vars.stableSupplyUpdatedTimestamp\n);\n\nvars.previousStableDebt = vars.principalStableDebt.rayMul(vars.cumulatedStableInterest);\n```\n\nAs a result, the stable debt difference is not taken into account. Moreover, the processed stable debt increment is not recorded in any way.\n##### Recommendation\nOne possible solution is to treat `vars.principalStableDebt` as the previous stable debt and update `StableDebtToken`'s `_totalSupply` and `_totalSupplyTimestamp` after the operation.\n",
        "protocol": "AAVE",
        "report_date": "2020-12-03",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/protocol%20v2/README.md#flawed-stable-debt-calculation-due-to-timestamp-mismatch",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/protocol%20v2/report.pdf"
    },
    {
        "title": "Overestimation of Liquidity in Interest Rate Update.",
        "content": "##### Description\nhttps://github.com/aave/protocol-v2/blob/f435b2fa0ac589852ca3dd6ae2b0fbfbc7079d54/contracts/lendingpool/LendingPool.sol#L582\n\n```solidity\nIERC20(asset).safeTransferFrom(receiverAddress, vars.aTokenAddress, vars.amountPlusPremium);\n\nreserve.updateState();\nreserve.cumulateToLiquidityIndex(IERC20(vars.aTokenAddress).totalSupply(), vars.premium);\nreserve.updateInterestRates(asset, vars.aTokenAddress, vars.premium, 0);\n```\n\nhttps://github.com/aave/protocol-v2/blob/f435b2fa0ac589852ca3dd6ae2b0fbfbc7079d54/contracts/lendingpool/LendingPoolCollateralManager.sol#L521\n\n```solidity\nIERC20(toAsset).safeTransferFrom(\n    receiverAddress,\n    address(vars.toReserveAToken),\n    vars.amountToReceive\n);\n\nif (vars.toReserveAToken.balanceOf(msg.sender) == 0) {\n    _usersConfig[msg.sender].setUsingAsCollateral(toReserve.id, true);\n}\n\nvars.toReserveAToken.mint(msg.sender, vars.amountToReceive, toReserve.liquidityIndex);\ntoReserve.updateInterestRates(\n    toAsset,\n    address(vars.toReserveAToken),\n    vars.amountToReceive,\n    0\n);\n```\n\n`updateInterestRates` needs to be called with `liquidityAdded` set to `0` since liquidity was already transferred to the pool's balance. Otherwise, overestimated liquidity would lead to too low debt interest rates.\n\n##### Recommendation\n\nIt is recommended to call `updateInterestRates` with `liquidityAdded` set to `0`.\n",
        "protocol": "AAVE",
        "report_date": "2020-12-03",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/protocol%20v2/README.md#overestimation-of-liquidity-in-interest-rate-update",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/protocol%20v2/report.pdf"
    },
    {
        "title": "Interest Rate Miscalculation Due to Stale Debt Values",
        "content": "##### Description\n\nhttps://github.com/aave/protocol-v2/blob/f435b2fa0ac589852ca3dd6ae2b0fbfbc7079d54/contracts/lendingpool/LendingPoolCollateralManager.sol#L227-L232\n\n```solidity\nprincipalReserve.updateInterestRates(\n  principal,\n  principalReserve.aTokenAddress,\n  vars.actualAmountToLiquidate,\n  0\n);\n\nif (vars.userVariableDebt >= vars.actualAmountToLiquidate) {\n  IVariableDebtToken(principalReserve.variableDebtTokenAddress).burn(\n    user,\n    vars.actualAmountToLiquidate,\n    principalReserve.variableBorrowIndex\n  );\n} else {\n  IVariableDebtToken(principalReserve.variableDebtTokenAddress).burn(\n    user,\n    vars.userVariableDebt,\n    principalReserve.variableBorrowIndex\n  );\n\n  IStableDebtToken(principalReserve.stableDebtTokenAddress).burn(\n    user,\n    vars.actualAmountToLiquidate.sub(vars.userVariableDebt)\n  );\n}\n```\n\nhttps://github.com/aave/protocol-v2/blob/f435b2fa0ac589852ca3dd6ae2b0fbfbc7079d54/contracts/lendingpool/LendingPoolCollateralManager.sol#L409-L414\n\n```solidity\ndebtReserve.updateInterestRates(\n  principal,\n  vars.principalAToken,\n  vars.actualAmountToLiquidate,\n  0\n);\nIERC20(principal).safeTransferFrom(receiver, vars.principalAToken, vars.actualAmountToLiquidate);\n\nif (vars.userVariableDebt >= vars.actualAmountToLiquidate) {\n  IVariableDebtToken(debtReserve.variableDebtTokenAddress).burn(\n    user,\n    vars.actualAmountToLiquidate,\n    debtReserve.variableBorrowIndex\n  );\n} else {\n  IVariableDebtToken(debtReserve.variableDebtTokenAddress).burn(\n    user,\n    vars.userVariableDebt,\n    debtReserve.variableBorrowIndex\n  );\n  IStableDebtToken(debtReserve.stableDebtTokenAddress).burn(\n    user,\n    vars.actualAmountToLiquidate.sub(vars.userVariableDebt)\n  );\n}\n```\n\nDebt reserve interest rates are updated before debt burning takes place.\n\nAs a result, stale total debt values are used during interest rates calculation. \n\n##### Recommendation\nWe suggest switching `updateInterestRates` and the `if` statement.\n",
        "protocol": "AAVE",
        "report_date": "2020-12-03",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/protocol%20v2/README.md#interest-rate-miscalculation-due-to-stale-debt-values",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/protocol%20v2/report.pdf"
    },
    {
        "title": "Inaccurate `liquidityAdded` Parameter Before Flashloan Transfer",
        "content": "##### Description\n\nhttps://github.com/aave/protocol-v2/blob/56d25e81cb0fdfcac785d669d3577b1ef2d9286e/contracts/lendingpool/LendingPool.sol#L511\n\nThe `liquidityAdded` parameter of the `updateInterestRates` call seems to be incorrect as the flashloan body is yet to be transferred thus it will not be included in the interest rates calculation.\n\n##### Recommendation\n\nIt is recommended to fix the `liquidityAdded` parameter.\n",
        "protocol": "AAVE",
        "report_date": "2020-12-03",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/protocol%20v2/README.md#inaccurate-liquidityadded-parameter-before-flashloan-transfer",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/AAVE/protocol%20v2/report.pdf"
    },
    {
        "title": "No validation of address parameter value in contract constructor",
        "content": "##### Description\nThere is no more functionality to initialize the `vault` variable in the contract. If the value of the variable passed to [constructor](https://github.com/iearn-finance/yearn-vaults/blob/54db126821c4d7aaaf5839be935cecb9b1bf088b/contracts/BaseStrategy.sol#L162) is not correct, then the contract will not work.\n\n##### Recommendation\nWe suggest adding a parameter check.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-03",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Solidity%20part)/README.md#1-no-validation-of-address-parameter-value-in-contract-constructor",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Solidity%20part)/Yearn%20Finance%20Vault%20v.2%20(Solidity%20Part)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No validation of the address parameter value in function before using this parameter in access modifiers.",
        "content": "##### Description\n\nAt this function: https://github.com/iearn-finance/yearn-vaults/blob/54db126821c4d7aaaf5839be935cecb9b1bf088b/contracts/BaseStrategy.sol#L171\n```solidity\nfunction setStrategist(address _strategist) external {\n  require(msg.sender == strategist || msg.sender == governance(), \"!authorized\");\n  strategist = _strategist;\n}\n```\nThere is a possibility that the `strategist` variable and the `governance()` function value will simultaneously contain zero or an invalid address value. Then the work of the smart contract will be blocked.\n\n##### Recommendation\nWe suggest adding a parameter check.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-03",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Solidity%20part)/README.md#2-no-validation-of-the-address-parameter-value-in-function-before-using-this-parameter-in-access-modifiers",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Solidity%20part)/Yearn%20Finance%20Vault%20v.2%20(Solidity%20Part)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Ability to change the value of a private variable from another contract",
        "content": "##### Description\nThe private variable `reserve` has a lot to do with the logic behind this smart contract. The value of this variable is changed in this contract. If you change the value of this variable from another contract, then the basic logic of the smart contract may be violated, up to the complete stop of the smart contract.\nConsidering that the setter for this variable `setReserve()` defined [here](https://github.com/iearn-finance/yearn-vaults/blob/54db126821c4d7aaaf5839be935cecb9b1bf088b/contracts/BaseStrategy.sol#L156) is an internal function and there is no event logging when the value of this variable is changed.\nIn addition, according to the rules of clean architecture and the principles of software development SOLID (single responsibility, open\u2013closed, Liskov substitution, interface segregation \u0438 dependency inversion), each module should be responsible for only one functionality.\nIt is not correct when, in addition to the BaseStrategy contract, the logic of the `harvest()` and `setEmergencyExit()` functions will be changed by another contract created for other purposes.\n\n\n##### Recommendation\nWe recommend removing this functionality.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-03",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Solidity%20part)/README.md#3-ability-to-change-the-value-of-a-private-variable-from-another-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Solidity%20part)/Yearn%20Finance%20Vault%20v.2%20(Solidity%20Part)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Function calculation result is not processed",
        "content": "##### Description\nBelow there will be a case when the code does not process the result of calling approve.\nhttps://github.com/iearn-finance/yearn-vaults/blob/v0.1.3/contracts/BaseStrategy.sol#L164\n\napprove method may return false.\n\n##### Recommendation\nWe recommend handling return value\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-03",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Solidity%20part)/README.md#4-function-calculation-result-is-not-processed",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Solidity%20part)/Yearn%20Finance%20Vault%20v.2%20(Solidity%20Part)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Safe math is not used",
        "content": "##### Description\nAt this line: https://github.com/iearn-finance/yearn-vaults/blob/cff924f1894cca1820a588b14d341c4fa4f384c0/contracts/BaseStrategy.sol#L338\n```solidity\nreturn (profitFactor * callCost < credit.add(profit));\n```\nDue to the fact that safe math is not used, overflow and incorrect logic of the `harvestTrigger()` function may occur.\n\n##### Recommendation\nWe suggest using SafeMath\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-03",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Solidity%20part)/README.md#5-safe-math-is-not-used",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Solidity%20part)/Yearn%20Finance%20Vault%20v.2%20(Solidity%20Part)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Function description differs from implementation.",
        "content": "##### Description\nThe function [description](https://github.com/iearn-finance/yearn-vaults/blob/cff924f1894cca1820a588b14d341c4fa4f384c0/contracts/BaseStrategy.sol#L311) says that\n> this call and `tendTrigger` should never return `true` at the same time.\n\nWhen returning the result, you need to add a check for the value of the `tendTrigger()` function\n\n##### Recommendation\nWe recommend explicitly checking the required invariant, in the case if we want to allow overriding these functions you can use an approach like here: https://gist.github.com/algys/edf4f05c01ffd023190d3acca6982259\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-03",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Solidity%20part)/README.md#6-function-description-differs-from-implementation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Solidity%20part)/Yearn%20Finance%20Vault%20v.2%20(Solidity%20Part)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Duplicate code",
        "content": "##### Description\nDuplicate code, i.e. using the same code structures in several places. Combining these structures will improve your code. The use of duplicate code structures impairs the perception of the program logic and can easily lead to errors in subsequent code edits. Duplicate code violates SOLID (single responsibility, open\u2013closed, Liskov substitution, interface segregation \u0438 dependency inversion) software development principles.\n\nhttps://github.com/iearn-finance/yearn-vaults/blob/54db126821c4d7aaaf5839be935cecb9b1bf088b/contracts/BaseStrategy.sol\nLine 170, 175, 180, 185, 190, 383\nInstead of this code: \n`require(msg.sender == strategist || msg.sender == governance(), \"!authorized\");` \nwe recommend making the access modifier\n```\nmodifier onlyStrategistOrGovernance() {\n    require(msg.sender == strategist || msg.sender == governance(), \"!authorized\");\n    _;\n}\n```\n\n\nLine 280, 329\nInstead of this code: \n```\nif (keeper != address(0)) {\n            require(msg.sender == keeper || msg.sender == strategist || msg.sender == governance(), \"!authorized\");\n}\n```\n\n##### Recommendation\nWe recommend moving the code into a separate function\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-03",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Solidity%20part)/README.md#1-duplicate-code",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Solidity%20part)/Yearn%20Finance%20Vault%20v.2%20(Solidity%20Part)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Variable declared but not used",
        "content": "##### Description\nAt this line: https://github.com/iearn-finance/yearn-vaults/blob/54db126821c4d7aaaf5839be935cecb9b1bf088b/contracts/BaseStrategy.sol#L273\nThe `callCost` variable is not used\n\n##### Recommendation\nWe recommend removing unused variables \n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-03",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Solidity%20part)/README.md#2-variable-declared-but-not-used",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Solidity%20part)/Yearn%20Finance%20Vault%20v.2%20(Solidity%20Part)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No event registration when changing the parameters of the contract",
        "content": "##### Description\nIn file: https://github.com/iearn-finance/yearn-vaults/blob/54db126821c4d7aaaf5839be935cecb9b1bf088b/contracts/BaseStrategy.sol\nLines 156, 169, 174, 179, 184, 189, 382\nThere are functions that change contract fields without any event emission.\n\n##### Recommendation\nWe recommend adding logging of actions so that you know who changed what.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-03",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Solidity%20part)/README.md#3-no-event-registration-when-changing-the-parameters-of-the-contract",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Solidity%20part)/Yearn%20Finance%20Vault%20v.2%20(Solidity%20Part)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Exact block timestamps usage.",
        "content": "##### Description\nAt this line: https://github.com/iearn-finance/yearn-vaults/blob/cff924f1894cca1820a588b14d341c4fa4f384c0/contracts/BaseStrategy.sol#L320 \nDependency on particular block exact timestamps can eventually break the business logic because the timestamps not only may vary within the single replication time interval, but they can also be maliciously manipulated.\nAs the result, the output of `harvestTrigger()` will vary every time it gets called.\n\n##### Recommendation\nWe recommend to refactor the business logic to be reliant not on a particular block timestamp, but on the replication interval time range.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-03",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Solidity%20part)/README.md#4-exact-block-timestamps-usage",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Solidity%20part)/Yearn%20Finance%20Vault%20v.2%20(Solidity%20Part)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potential withdrawal lock",
        "content": "##### Description\nAt this line: https://github.com/iearn-finance/yearn-vaults/blob/054034304c7912d227d460feadc23177103de0b9/contracts/Vault.vy#L787\n\n```solidity\namountNeeded: uint256 = value - self.token.balanceOf(self)\n```\n\nIn case if the result of withdrawals in the previous loop iteration `self.token.balanceOf(self)` becomes more than `value` that will cause a transaction revert. That scenario is possible because only for the first iteration we can exactly consider that `value` more than `self.token.balanceOf(self)`, but according to the withdrawal logic there is no check for the following iterations that the real withdrawn amount(after `Strategy(strategy).withdraw(amountNeeded)` call) is less or equal to what is desired `amountNeeded`.\n\n##### Recommendation\nIt seems in normal/optimistic flow that `Strategy(strategy).withdraw(amountNeeded)` never withdraws more tokens than requested, but anyway we recommend properly handling a pessimistic case because strategy is an external contract and can be broken. Due to withdrawal queue, it can be changed only by governance (usually governance is msig or smth like that). Unexpected strategy behavior can lock withdrawals for undefined period that might be fatal in some cases.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-02",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Vyper%20part)/README.md#1-potential-withdrawal-lock",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Vyper%20part)/Yearn%20Finance%20Vault%20v.2%20(Vyper%20part)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Code commentary doesn't comply with real implementation",
        "content": "##### Description\nAt [line](https://github.com/iearn-finance/yearn-vaults/blob/054034304c7912d227d460feadc23177103de0b9/contracts/Vault.vy#L94) it is defined that rate limit has \"tokens per block\" dimension:\n> \"Increase/decrease per block\"\nBut in rate limit checker code https://github.com/iearn-finance/yearn-vaults/blob/054034304c7912d227d460feadc23177103de0b9/contracts/Vault.vy#L1124 `strategy_rateLimit` assumed as variable with \"tokens per second\" dimension\n\n##### Recommendation\nWe recommend keeping commentaries consistent with implementation\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-02",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Vyper%20part)/README.md#1-code-commentary-doesnt-comply-with-real-implementation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Vyper%20part)/Yearn%20Finance%20Vault%20v.2%20(Vyper%20part)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potential issue with re-entrancy",
        "content": "##### Description\nMethod `report` at this [line](https://github.com/iearn-finance/yearn-vaults/blob/054034304c7912d227d460feadc23177103de0b9/contracts/Vault.vy#L1246) called by strategy makes an external call back to strategy in `_assessFees` method: https://github.com/iearn-finance/yearn-vaults/blob/054034304c7912d227d460feadc23177103de0b9/contracts/Vault.vy#L1239. So broken or hacked, strategy can call back vaults methods while the current state is not finalized.\n\n##### Recommendation\nWe recommend adding re-entrancy checks to avoid potential problems. Especially when the code logic is complicated even if for now the code is safe, in future it's really easy to implicitly introduce some bugs.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-02",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Vyper%20part)/README.md#2-potential-issue-with-re-entrancy",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Vyper%20part)/Yearn%20Finance%20Vault%20v.2%20(Vyper%20part)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Adding `Approval` event in `transferFrom`",
        "content": "##### Description\nHere https://github.com/iearn-finance/yearn-vaults/blob/054034304c7912d227d460feadc23177103de0b9/contracts/Vault.vy#L468 we have a decrease in allowance as a result of `transferFrom` call, but new `Approval` event isn't emitted.\n\n##### Recommendation\nThat behavior is not required by EIP20, but it's good to allow the client-side apps to sync the actual allowance amount using only events(without fetch data from the node state). Example from openzeppelin's implementation: https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC20/ERC20.sol#L154\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-02",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Vyper%20part)/README.md#1-adding-approval-event-in-transferfrom",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Vyper%20part)/Yearn%20Finance%20Vault%20v.2%20(Vyper%20part)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Optimize deposit amount check",
        "content": "##### Description\nFollowing [check](https://github.com/iearn-finance/yearn-vaults/blob/054034304c7912d227d460feadc23177103de0b9/contracts/Vault.vy#L668) of deposit, the amount is required only if the previous [condition](https://github.com/iearn-finance/yearn-vaults/blob/054034304c7912d227d460feadc23177103de0b9/contracts/Vault.vy#L658) returns false, in another case `amount` value is already limited by `self.depositLimit - self._totalAssets()`.\n\n##### Recommendation\nWe can move limit [check](https://github.com/iearn-finance/yearn-vaults/blob/054034304c7912d227d460feadc23177103de0b9/contracts/Vault.vy#L668) into `else` branch of the condition above to save gas.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-02",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Vyper%20part)/README.md#2-optimize-deposit-amount-check",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Vyper%20part)/Yearn%20Finance%20Vault%20v.2%20(Vyper%20part)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Typo in commentary",
        "content": "##### Description\nAt line: https://github.com/iearn-finance/yearn-vaults/blob/054034304c7912d227d460feadc23177103de0b9/contracts/Vault.vy#L1270\n```solidity\n@return Amount of debt outstanding (iff totalDebt > debtLimit).\n```\nThere is an extra \u2018f\u2019.\n\n##### Recommendation\nWe suggest removing the excess character.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-02",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Vyper%20part)/README.md#3-typo-in-commentary",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Vyper%20part)/Yearn%20Finance%20Vault%20v.2%20(Vyper%20part)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Implicit loss calculation",
        "content": "##### Description\n`_reportLoss` function defined [here](https://github.com/iearn-finance/yearn-vaults/blob/054034304c7912d227d460feadc23177103de0b9/contracts/Vault.vy#L1191) implicitly changes the passed value of the loss tokens amount. Implicit behavior might be wrongly missed and the caller can expect another result.\n\n##### Recommendation\nWe recommend to reduce the implicit logic as much as possible\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-02",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Vyper%20part)/README.md#4-implicit-loss-calculation",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Vyper%20part)/Yearn%20Finance%20Vault%20v.2%20(Vyper%20part)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Unoptimized `withdrawalQueue` updating",
        "content": "##### Description\nAt lines: https://github.com/iearn-finance/yearn-vaults/blob/054034304c7912d227d460feadc23177103de0b9/contracts/Vault.vy#L1062-L1066, https://github.com/iearn-finance/yearn-vaults/blob/054034304c7912d227d460feadc23177103de0b9/contracts/Vault.vy#L1041-L1046\n\nThere are some places when we need to remove or add strategy. For now, we first iterate over the array to exclude duplicates or find item idx to remove and after that we call `_organizeWithdrawalQueue` to normalize the array. With this approach operations complexity can reach up to O(n^2). \n\n##### Recommendation\nIt seems easier and cheaper to add/remove elements with instant normalization in a single walk through the array.\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-02",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Vyper%20part)/README.md#5-unoptimized-withdrawalqueue-updating",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Vyper%20part)/Yearn%20Finance%20Vault%20v.2%20(Vyper%20part)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Strategy can report loss and gain at the same time",
        "content": "##### Description\nFor now strategy can [report](https://github.com/iearn-finance/yearn-vaults/blob/054034304c7912d227d460feadc23177103de0b9/contracts/Vault.vy#L1246) loss and gain at the same time. It's not a problem according to the code logic but it's little bit weird within the meaning.\n\n##### Recommendation\nWe recommend to make sure that this behavior is correct\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-12-02",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Vyper%20part)/README.md#6-strategy-can-report-loss-and-gain-at-the-same-time",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Vault%20V2%20(Vyper%20part)/Yearn%20Finance%20Vault%20v.2%20(Vyper%20part)%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potential claiming stuck for several periods after withdraw",
        "content": "\nhttps://github.com/defistarter/contracts/blob/9ffe009ee6047ced669711dde14fe38483abdf7e/StakingPool.sol#L341\n\nHere we have division by `periodTotalSupply`, in case if `periodTotalSupply` becomes zero that it will be impossible to claim any reward.\n\nAttack flow:\n\n*Assuming that we have 1 user and 5 periods.*\n\n- at period 0: user stake 10 tokens  (`_historyTotalSupply[0]` = `10`, `user.period` = `0`)\n- at period 1: user claimReward and withdraw all 10 tokens (`_historyTotalSupply[1]` = `0`,  `user.period` = `1`)\n- at period 2: do nothing (`_historyTotalSupply[2]` = `0`, `user.period` = `1`)\n- at period 3: user stake 20 tokens (`_historyTotalSupply[3]` = `20`,  `user.period` = `1`)\n- at period 4: user try to `claimReward` and get error \u201cSafeMath: division by zero\u201d\n\n- contract state at period 4 is:\n\n    - `_historyTotalSupply` = `[10, 0, 0, 20, 0]`\n    - `user.period` = `1`\n\n    so if user try to claimReward we will get:\n    - `savedTotalSupply` = `0` (https://github.com/defistarter/contracts/blob/9ffe009ee6047ced669711dde14fe38483abdf7e/StakingPool.sol#L326)\n    - `periodTotalSupply` = `0` (https://github.com/defistarter/contracts/blob/9ffe009ee6047ced669711dde14fe38483abdf7e/StakingPool.sol#L333)\n\n    and finally here we have division by zero here: https://github.com/defistarter/contracts/blob/9ffe009ee6047ced669711dde14fe38483abdf7e/StakingPool.sol#L341\n\nWe recommend to check the `periodTotalSupply` value before division and omit that in case of zero.\n\nThis particular issue is not marked as critical because that cannot be exploited to steal funds, but issues should be fixed ASAP due to that can break desired contract logic.\n\nStatus: *Fixed at https://github.com/defistarter/contracts/commit/670678d7d2fd01b4c059ab76535c849f556377b4, https://github.com/defistarter/contracts/commit/07edefa4c5931e5fbef97c61d48062c606fc21c4*\n\n",
        "protocol": "Defi Starter",
        "report_date": "2020-11-06",
        "impact": "HIGH",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Defi%20Starter/DefiStarter%20Smart%20Contracts/README.md#1-potential-claiming-stuck-for-several-periods-after-withdraw",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Defi%20Starter/DefiStarter%20Smart%20Contracts/report.pdf"
    },
    {
        "title": "Potential inability to claim reward",
        "content": "\nhttps://github.com/defistarter/contracts/blob/9ffe009ee6047ced669711dde14fe38483abdf7e/StakingPool.sol#L328\n\nThere is a `for` loop with potentially huge amounts of iterations, so that can take an uncontrolled amount of gas and that can cause inability to calculate reward amount for particular users if gas consumption reaches the maximum limit.\n\nWe recommend strictly limiting the amount of loop iterations and allow users to claim their rewards partially in several batches.\n\nStatus: *Acknowledged*\n\n",
        "protocol": "Defi Starter",
        "report_date": "2020-11-06",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Defi%20Starter/DefiStarter%20Smart%20Contracts/README.md#1-potential-inability-to-claim-reward",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Defi%20Starter/DefiStarter%20Smart%20Contracts/report.pdf"
    },
    {
        "title": "`claimReward`/`withdraw` allowed to execute before staking starts",
        "content": "\nhttps://github.com/defistarter/contracts/blob/9ffe009ee6047ced669711dde14fe38483abdf7e/StakingPool.sol#L259\nhttps://github.com/defistarter/contracts/blob/9ffe009ee6047ced669711dde14fe38483abdf7e/StakingPool.sol#L245\n\nThese methods formally can be executed before staking starts but after setup.\n\nIt\u2019s not critical in that case, but anyway we recommend explicitly checking current contract status to minimize the number of possible invariants.\n\nStatus: *Fixed at https://github.com/defistarter/contracts/commit/e3f69de3dc861ddc1d8957c83fb89f26651d1ded*\n\n",
        "protocol": "Defi Starter",
        "report_date": "2020-11-06",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Defi%20Starter/DefiStarter%20Smart%20Contracts/README.md#2-claimrewardwithdraw-allowed-to-execute-before-staking-starts",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Defi%20Starter/DefiStarter%20Smart%20Contracts/report.pdf"
    },
    {
        "title": "Unoptimized check in `calculateReward` loop",
        "content": "\nhttps://github.com/defistarter/contracts/blob/9ffe009ee6047ced669711dde14fe38483abdf7e/StakingPool.sol#L331\n\n```\nif(i > user.period){\n \u2026\n}\n```\nThat check always returns true after the first iteration, so it spent excess gas each iteration. We recommend moving the first iteration calculations out of loop and start loop from `user.period + 1`.  \n\nStatus: *Fixed at https://github.com/defistarter/contracts/commit/670678d7d2fd01b4c059ab76535c849f556377b4*\n",
        "protocol": "Defi Starter",
        "report_date": "2020-11-06",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Defi%20Starter/DefiStarter%20Smart%20Contracts/README.md#1-unoptimized-check-in-calculatereward-loop",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Defi%20Starter/DefiStarter%20Smart%20Contracts/report.pdf"
    },
    {
        "title": "Different code style",
        "content": "\nhttps://github.com/defistarter/contracts/blob/9ffe009ee6047ced669711dde14fe38483abdf7e/StakingPool.sol#L105\n\nHere used snake case for `_fee_beneficiary` naming, but whole other code uses camel case. We recommend using the same naming condition. \n\nStatus: *Fixed at https://github.com/defistarter/contracts/commit/670678d7d2fd01b4c059ab76535c849f556377b4*\n",
        "protocol": "Defi Starter",
        "report_date": "2020-11-06",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Defi%20Starter/DefiStarter%20Smart%20Contracts/README.md#2-different-code-style",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Defi%20Starter/DefiStarter%20Smart%20Contracts/report.pdf"
    },
    {
        "title": "Typo in modifier name",
        "content": "\nhttps://github.com/defistarter/contracts/blob/9ffe009ee6047ced669711dde14fe38483abdf7e/StakingPool.sol#L68\n\nMissed character in `onlyAferSetup`.\n\nStatus: *Fixed at https://github.com/defistarter/contracts/commit/670678d7d2fd01b4c059ab76535c849f556377b4*\n",
        "protocol": "Defi Starter",
        "report_date": "2020-11-06",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Defi%20Starter/DefiStarter%20Smart%20Contracts/README.md#3-typo-in-modifier-name",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Defi%20Starter/DefiStarter%20Smart%20Contracts/report.pdf"
    },
    {
        "title": "Too complicated status checks",
        "content": "\nhttps://github.com/defistarter/contracts/blob/9ffe009ee6047ced669711dde14fe38483abdf7e/StakingPool.sol#L135\nhttps://github.com/defistarter/contracts/blob/9ffe009ee6047ced669711dde14fe38483abdf7e/StakingPool.sol#L148\nhttps://github.com/defistarter/contracts/blob/9ffe009ee6047ced669711dde14fe38483abdf7e/StakingPool.sol#L161\nhttps://github.com/defistarter/contracts/blob/9ffe009ee6047ced669711dde14fe38483abdf7e/StakingPool.sol#L235\nhttps://github.com/defistarter/contracts/blob/9ffe009ee6047ced669711dde14fe38483abdf7e/StakingPool.sol#L265\n\nThere are a lot of different status checks, some of them directly using `endTime`, `closeTime`, `startTime` mixed with `status` field.\nSo it can cause potential issues in the future related to incorrect status interpretation.\n\nWe recommend defining all possible statutes to special `Status` enum and move checks to particular modifiers as `onlyAfterSetup`.\n\nStatus: *Acknowledged*\n\n",
        "protocol": "Defi Starter",
        "report_date": "2020-11-06",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Defi%20Starter/DefiStarter%20Smart%20Contracts/README.md#4-too-complicated-status-checks",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Defi%20Starter/DefiStarter%20Smart%20Contracts/report.pdf"
    },
    {
        "title": "Uncontrolled call of functions",
        "content": "\n- [crv-locker.sol#L84](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/crv-locker.sol#L84) \n\n    Uncontrolled call of functions of another contract on behalf of this contract with the possibility of transferring ETH. Such a call can be made both by the user `governance` and by other users from the map `voters`.\n    In the contract [scrv-voter.sol#L150](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/scrv-voter.sol#L150) and [scrv-voter.sol#L169](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/scrv-voter.sol#L169) there is a reference to such a possibility.\n    But you can call other functions of this contract from any other contract. This can lead to unpredictable consequences.\n\n- [strategy-base.sol#L196](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/strategy-base.sol#L196)\n\n    The `timelock` user in the `_data` parameter can pass any value, which can lead to unpredictable consequences when accessing the contract with the `_target` address.\n    This particular issue qualified as a warning due to the security model assuming that voters are trusted persons/contracts. \n    Anyway we recommend limiting the use of such functionality because uncontrolled calls have very high risks.\n\nStatus: *Acknowledged*.\n\nClient's comment: *The team is aware of this issue, but would like to state that this is necessary since Curve will not whitelist proxy contracts (i.e. we cannot easily change our implementation).\nUse of the `execute` function is reserved for emergency situations. If it is used in an adversarial manner, there is a 12 hour timelock for participants to exit the system.\nBeyond this, control of this function is handled by a 3 of 6 community controlled multisig wallet. The original team is no longer in majority control and power has been transferred to community participants to ensure good faith outcomes.*\n\n",
        "protocol": "Pickle Finance",
        "report_date": "2020-11-05",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/All%20Strategies/README.md#1-uncontrolled-call-of-functions",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/All%20Strategies/Pickle%20Finance%20All%20Stratagies%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No check of parameter values when executing smart contract constructor",
        "content": "\nIt is recommended to append `require(variableAddress != address(0))` requirement right after the constructor execution starts.\n\n- https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/strategy-curve-base.sol\n\n    line 45 variable  `_curve`\n    \n    line 46 variable  `_gauge`\n\n- https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/strategy-staking-rewards-base.sol\n\n    line 22 variable `_rewards`\n\n- https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/strategy-uni-farm-base.sol\n\n    line 36 variable `_token1`\n\n- https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/crv-locker.sol\n\n    line 25 variable `_governance`\n\n- https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/scrv-voter.sol\n\n    line 31 variable  `_governance`\n    \n    line 32 variable  `_crvLocker`\n\n- https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/strategy-curve-scrv-v4.sol\n\n    line 88 variable  `_governance`\n\n    line 89 variable  `_strategist`\n\n    line 90 variable  `_controller`\n\n    line 92 variable  `_scrvVoter`\n\n    line 93 variable  `_crvLocker`\n\n- https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/strategy-curve-scrv-v4_1.sol\n\n    line 63 variable  `_scrvVoter`\n\n    line 64 variable  `_crvLocker`\n\n- https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/pickle-jar.sol\n\n    line 31, 32 variable  `_token`\n\n    line 33 variable  `_governance`\n\n    line 34 variable  `_timelock`\n\n    line 35 variable  `_controller`\n\nStatus: *Fixed at https://github.com/pickle-finance/protocol/pull/17/files*\n\n",
        "protocol": "Pickle Finance",
        "report_date": "2020-11-05",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/All%20Strategies/README.md#2-no-check-of-parameter-values-when-executing-smart-contract-constructor",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/All%20Strategies/Pickle%20Finance%20All%20Stratagies%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Checking for the existence of the recipient's address",
        "content": "\nOne cannot be sure that a third-party smart contract whose functions are accessed using the `IController(controller).treasury()` interface returns the correct address value.\nIn the following places, tokens are transferred using the safeTransfer function, but the existence of an address before the call is not checked:\n- [strategy-base.sol#L151](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/strategy-base.sol#L151)\n- [strategy-uni-farm-base.sol#L62](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/strategy-uni-farm-base.sol#L62)\n- [strategy-uni-farm-base.sol#L97](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/strategy-uni-farm-base.sol#L97) \n- [strategy-uni-farm-base.sol#L101](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/strategy-uni-farm-base.sol#L101)\n- [strategy-uni-farm-base.sol#L111](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/strategy-uni-farm-base.sol#L111)\n- [strategy-curve-3crv-v1.sol#L105](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/strategy-curve-3crv-v1.sol#L105)\n- [strategy-curve-3crv-v1.sol#L129](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/strategy-curve-3crv-v1.sol#L129)\n- [strategy-curve-rencrv-v1.sol#L87](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/strategy-curve-rencrv-v1.sol#L87)\n- [strategy-curve-rencrv-v1.sol#L111](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/strategy-curve-rencrv-v1.sol#L111)\n- [strategy-curve-scrv-v3_1.sol#L124](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/strategy-curve-scrv-v3_1.sol#L124)\n- [strategy-curve-scrv-v3_1.sol#L155](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/strategy-curve-scrv-v3_1.sol#L155)\n- [strategy-curve-scrv-v4.sol#L236](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/strategy-curve-scrv-v4.sol#L236)\n- [strategy-curve-scrv-v4.sol#L324](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/strategy-curve-scrv-v4.sol#L324)\n- [strategy-curve-scrv-v4_1.sol#L200](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/strategy-curve-scrv-v4_1.sol#L200)\n- [strategy-cmpd-dai-v1.sol#L351](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/compound/strategy-cmpd-dai-v1.sol#L351)\n\nIn the following places, tokens are transferred using the safeTransfer function, but the existence of an address after the call is not checked `IController(controller).devfund ()`:\n- [strategy-base.sol#L147](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/strategy-base.sol#L147)\n- [strategy-curve-scrv-v4.sol#L232](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/strategy-curve-scrv-v4.sol#L232)\n\nAccess to the functionality of smart contracts with tokens is carried out using interfaces.\nBut not all token smart contracts can include logic to check addresses for zero values.\nTherefore, it is best to do this before accessing the interfaces.\nBetter to do this in one place for all calls in the src/lib/erc20.sol library.\n\nStatus: *Acknowledged.*\n\nClient's comment: *Changing this in the ERC20 library would force the function's implementation to deviate from the original OpenZeppelin source code. It also removes the ability to burn tokens by sending them to a zero address. Since we have implemented constructor checks for zero addresses, the risk of mistakenly sending tokens to a zero address is largely minimized.*\n \n",
        "protocol": "Pickle Finance",
        "report_date": "2020-11-05",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/All%20Strategies/README.md#3-checking-for-the-existence-of-the-recipients-address",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/All%20Strategies/Pickle%20Finance%20All%20Stratagies%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No limit on the number of loop iterations",
        "content": "\n- [strategy-cmpd-dai-v1.sol#L287](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/compound/strategy-cmpd-dai-v1.sol#L287)\n\n    With small `_borrowAndSupply` and `supplied` values and a large `_supplyAmount` value, there will come a point when there will be so many iterations that there is not enough gas to record changes.\n    It is recommended to check for the expected number of iterations before starting the loop. \n    This problem will not stop the work of the smart contract, because in the `leverageUntil` function, the key parameter of the `_supplyAmount` cycle can be set as a parameter when calling this function, and by selecting the required value, it will be possible to execute the functionality.\n\n- [strategy-cmpd-dai-v1.sol#L320](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/compound/strategy-cmpd-dai-v1.sol#L320)\n\n    With small `_supplyAmount` and `_redeemAndRepay` values and a large `supplied` value, there will come a point when there will be so many iterations that there is not enough gas to record changes. It is recommended to check for the expected number of iterations before starting the loop. \n    This problem will not stop the work of the smart contract, because in the `deleverageUntil` function, the key parameter of the `_supplyAmount` cycle can be set as a parameter when calling this function, and by selecting the required value, it will be possible to execute the functionality.\n\nStatus: *Acknowledged.*\n\nClient's comment: *The team is aware of this issue, but there is already a mitigation strategy. We have the option to change `colFactorLeverageBuffer` and/or `colFactorSyncBuffer` to be of a higher or lower value to avoid the out of gas problem. Additionally, we can leverage or deleverage until a specified supply amount with the `deleverageUntil` and `leverageUntil` functions. Based on the contract`s current operation, it consumes 1.8 million gas for leveraging or deleveraging to the max, so there is already a substantial buffer from the max limit of 12 million gas.*\n\n",
        "protocol": "Pickle Finance",
        "report_date": "2020-11-05",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/All%20Strategies/README.md#4-no-limit-on-the-number-of-loop-iterations",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/All%20Strategies/Pickle%20Finance%20All%20Stratagies%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Interface Consistency",
        "content": "\nThis warning is about the `StrategyBase` interface consistency.\n\nSince the `StrategyCurveSCRVv4_1` interface was changed with recent audit results, to keep the strategy interface consistent it is recommended to update all the other `StrategyBase`-interfaced strategies:\n- [strategy-curve-3crv-v1.sol#L40](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/strategy-curve-3crv-v1.sol#L40)\n- [strategy-curve-rencrv-v1.sol#L41](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/strategy-curve-rencrv-v1.sol#L41)\n- [strategy-curve-scrv-v3_1.sol#L46](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/strategy-curve-scrv-v3_1.sol#L46)\n- [strategy-curve-scrv-v4.sol#L118](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/strategy-curve-scrv-v4.sol#L118)\n\nTheir `getMostPremium()` and `harvest()` functions signature are required to be updated to keep interface compliance and avoid wrecking business-logic using this interface with inconsistent asset index result type or with already known front-run issue.\n\nStatus: *Fixed at https://github.com/pickle-finance/protocol/pull/19*\n\n",
        "protocol": "Pickle Finance",
        "report_date": "2020-11-05",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/All%20Strategies/README.md#5-interface-consistency",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/All%20Strategies/Pickle%20Finance%20All%20Stratagies%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Duplicate code",
        "content": "\nDuplicate code, i.e. using the same code structures in several places.\nCombining these structures will improve your code.\nThe use of duplicate code structures impairs the perception of the program logic and can easily lead to errors in subsequent code edits.\nDuplicate code violates SOLID (single responsibility, open\u2013closed, Liskov substitution, interface segregation \u0438 dependency inversion) software development principles.\n\n- https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/strategy-base.sol\n\n    * line 92,  97, 102, 117, 122, 188\n\n        ```\n        require(msg.sender == timelock, \"!timelock\");\n        ```\n\n        Can make access modifier:\n        ```\n        modifier onlyTimelock {\n            require(msg.sender == timelock);\n            _;\n        }\n        ```\n\n\n    * line 107, 112\n\n        ```\n        require(msg.sender == governance, \"!governance\");\n        ```\n\n        Can make access modifier:\n        ```\n        modifier onlyGovernance {\n            require(msg.sender == governance);\n            _;\n        }\n        ```\n\n    * line 131, 139\n        ```\n            require(msg.sender == controller, \"!controller\");\n        ```\n\n        Can make access modifier:\n        ```\n        modifier onlyController {\n            require(msg.sender == controller);\n            _;\n        }\n        ```\n\n\n- https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/compound/strategy-cmpd-dai-v1.sol\n\n    * line 208, 216, 226, 234\n        ```\n        require(\n            msg.sender == governance || msg.sender == strategist, \"!governance\"\n        );\n        ```\n\n        Can make access modifier:\n        ```\n        modifier onlyGovernanceOrStrategist {\n            require(\n                    msg.sender == governance || msg.sender == strategist, \"!governance\"\n            );\n            _;\n        }\n        ```\n\n- https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/crv-locker.sol\n\n    * line 33, 38, 73, \n        ```\n        require(msg.sender == governance, \"!governance\");\n        ```\n\n        Can make access modifier:\n        ```\n        modifier onlyGovernance {\n            require(msg.sender == governance, \"!governance\");\n            _;\n        }\n        ```\n\n    * line 49, 56, 63, 68, 82\n        ```\n        require(voters[msg.sender] || msg.sender == governance, \"!authorized\");\n        ```\n\n        Can make access modifier:\n        ```\n        modifier onlyVotersOrGovernance {\n            require(voters[msg.sender] || msg.sender == governance, \"!authorized\");\n            _;\n        }\n        ```\n\n- https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/scrv-voter.sol\n\n    * line 36, 41, 46\n        ```\n        require(msg.sender == governance, \"!governance\");\n        ```\n\n        Can make access modifier:\n        ```\n        modifier onlyGovernance {\n            require(msg.sender == governance, \"!governance\");\n            _;\n        }\n        ```\n\n    * line 55, 68, 77, 106, 137, 158\n        ```\n        require(strategies[msg.sender], \"!strategy\");\n        ```\n\n        Can make access modifier:\n        ```\n        modifier onlyStrategies {\n            require(strategies[msg.sender], \"!strategy\");\n            _;\n        }\n        ```\n\n\n- https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/strategy-curve-scrv-v4.sol\n\n    * line 168, 173, 178, 183, 188, 193, 198 \n        ```\n        require(msg.sender == governance, \"!governance\");\n        ```\n\n        Can make access modifier:\n        ```\n        modifier onlyGovernance {\n            require(msg.sender == governance, \"!governance\");\n            _;\n        }\n        ```\n\n    * line 214, 224, 248\n        ```\n        require(msg.sender == controller, \"!controller\");\n        ```\n\n        Can make access modifier:\n        ```\n        modifier onlyController {\n            require(msg.sender == controller, \"!controller\");\n            _;\n        }\n        ```\n\n\n- https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/pickle-jar.sol\n\n    * line 46, 51 \n        ```\n        require(msg.sender == governance, \"!governance\");\n        ```\n\n        Can make access modifier:\n        ```\n        modifier onlyGovernance {\n            require(msg.sender == governance, \"!governance\");\n            _;\n        }\n        ```\n\n    * line 56, 61 \n        ```\n        require(msg.sender == timelock, \"!timelock\");\n        ```\n\n        Can make access modifier:\n        ```\n        modifier onlyTimelock {\n            require(msg.sender == timelock, \"!timelock\");\n            _;\n        }\n        ```\n\nStatus: *Acknowledged.*\n\nClient's comment: *The team understands the comments, but disagrees with the suggested changes. Abstractions made solely for the sake of DRY-ness can often lead to readability and maintainability issues. The team feels that the current implementation is more explicit and makes for much more readable and less error-prone code with less indirection.*\n\n",
        "protocol": "Pickle Finance",
        "report_date": "2020-11-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/All%20Strategies/README.md#1-duplicate-code",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/All%20Strategies/Pickle%20Finance%20All%20Stratagies%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Variable not needed",
        "content": "\n[crv-locker.sol#L87](https://github.com/pickle-finance/protocol/blob/9b0f330a16bc35c964211feae3b335ab398c01b6/src/strategies/curve/crv-locker.sol#L87)\n\nThe variable `success` will always be true.\nWe recommend removing this variable.\n\nStatus: *Fixed at https://github.com/pickle-finance/protocol/pull/18*\n\n",
        "protocol": "Pickle Finance",
        "report_date": "2020-11-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/All%20Strategies/README.md#2-variable-not-needed",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/All%20Strategies/Pickle%20Finance%20All%20Stratagies%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "No check that the address is not zero",
        "content": "\n[TimeLoans.sol#L619](https://github.com/iearn-finance/timeloans.finance/blob/cab5f5b742aba2a4c237c460e1b436c5e8b71ba4/contracts/TimeLoans.sol#L619)  \n\nNo need to burn a token for a zero address.\nIn a well-known library for secure development of smart contracts, a check is done: [ERC20.sol#L250](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/e98b187e641d102db4e9096c3cb71c1325dae73a/contracts/token/ERC20/ERC20.sol#L250) \nDespite the fact that '_burn'  is an internal function and is called now only from the 'withdraw' function, it is necessary to check the address for zero.\nIt is possible that this code will then be used again and the developer can call the '_burn' function in another place where 'msg.sender' is no longer used as an address.\n\n[TimeLoans.sol#L610](https://github.com/iearn-finance/timeloans.finance/blob/cab5f5b742aba2a4c237c460e1b436c5e8b71ba4/contracts/TimeLoans.sol#L610)\n\nNeed to check the address for zero.\nDespite the fact that '_mint'  is an internal function and is called now only from the 'deposit' function, it is necessary to check the address for zero.\nIt is possible that this code will then be used again and the developer can call the '_mint' function in another place where 'msg.sender' is no longer used as an address.\n\nStatus: *Acknowledged*\n\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-11-05",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Timeloans/README.md#1-no-check-that-the-address-is-not-zero",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Timeloans/Yearn%20Finance%20Timeloans.Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Code refactoring is recommended",
        "content": "\n[TimeLoans.sol#L926](https://github.com/iearn-finance/timeloans.finance/blob/cab5f5b742aba2a4c237c460e1b436c5e8b71ba4/contracts/TimeLoans.sol#L926) \n\nThe (`spenderAllowance! = uint (-1)`) check can be removed because all operations to change the number of tokens are implemented using the safe mathematics library.\n\nIt is recommended to rewrite the \u2018transferFrom\u2019' function in accordance with this:\n[ERC20.sol#L152](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/e98b187e641d102db4e9096c3cb71c1325dae73a/contracts/token/ERC20/ERC20.sol#L152) \n\nStatus: *Acknowledged*\n",
        "protocol": "Yearn Finance",
        "report_date": "2020-11-05",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Timeloans/README.md#1-code-refactoring-is-recommended",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Yearn%20Finance/Timeloans/Yearn%20Finance%20Timeloans.Finance%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Harvesting Potential Front-Run",
        "content": "\nThis particular issue is about `harvest()` function having no limitations on\ncaller identifier, not having \"commit and reveal\" scheme usage or any other \nmechanism preventing front-running in here: [strategy-curve-scrv-v4_1.sol#L153](https://github.com/pickle-finance/protocol/blob/master/src/strategies/curve/strategy-curve-scrv-v4_1.sol#L153)\n\nCalling this particular function wrongly (implementing a displacement\nfront-running pattern) brings risks Alice would not being able to rely on \ntransaction execution result in case Bob front-runs harvesting transaction with \nhigher gas fee bid. \n\nThis issue does not break the state, but it breaks the logic contract works \nfrom Alice's point of view.\n\nThis particular issue was classified as a warning because the author is clearly aware about it, from what we see from the comments.\n\nAlso, since there is no way to benefit from front-running this particular\nfunction call, this issue makes no significant damage.\n\nSince this function is a public function, the proof of concept would be a node \nmempool listener, which would transact with enormous gas amount right after\ngets the transaction spotted.\n\n*The issue was resolved with restricting the calling of this function to only EOAs and the strategist or governance addresses along with `onlyBenevolent` modifier being appended to the `harvest` function signature here. The `onlyBenevolent` modifier is defined here.*\n\n",
        "protocol": "Pickle Finance",
        "report_date": "2020-10-09",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/Strategy-Curve-scrv-v4_1/README.md#1-harvesting-potential-front-run",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/Strategy-Curve-scrv-v4_1/Pickle%20Finance%20Strategy-Curve-scrv-v4_1%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Potentially Null Swap Destination Address",
        "content": "\nThis particular issue is about `_swapUniswap` function not being used carefully having \na possibility to swap tokens with `UniswapRouterV2` to `address(0)` destination.\n in here: [strategy-base.sol#L214](https://github.com/pickle-finance/protocol/blob/a808366db95b07c0b8940e919ec72d80e2deaca7/src/strategies/strategy-base.sol#L214) \n\nSince this function is an internal one and the actual destination address is\nstill being checked later, this is not a major issue, but just a warning.\n\nIt is recommended to append `require(_to != address(0))` requirement right after\nthe function execution starts.\n\n*This issue was resolved with the following PR: https://github.com/pickle-finance/protocol/pull/5.*\n",
        "protocol": "Pickle Finance",
        "report_date": "2020-10-09",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/Strategy-Curve-scrv-v4_1/README.md#2-potentially-null-swap-destination-address",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/Strategy-Curve-scrv-v4_1/Pickle%20Finance%20Strategy-Curve-scrv-v4_1%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Non-Null Addresses",
        "content": "\n[strategy-curve-scrv-v4_1.sol#L49](https://github.com/pickle-finance/protocol/blob/master/src/strategies/curve/strategy-curve-scrv-v4_1.sol#L49)\n\n[strategy-base.sol#L44](https://github.com/pickle-finance/protocol/blob/a808366db95b07c0b8940e919ec72d80e2deaca7/src/strategies/strategy-base.sol#L44) \n\nSince all the operations with `address`-typed `StrategyCurveSCRVv4_1` and `StrategyBase` contract fields are being performed with `safeTransfer` or `_approve` functions, checking if an `address`-typed argument is not `0`, it is recommended to implement additional `require`s in contract constructor, checking if each of input arguments `!= address(0)`, to avoid potential issues in newcoming contract updates (according to\n`harvest()` functions comment).\n\n*This issue was resolved with the following PR: https://github.com/pickle-finance/protocol/pull/7.*\n",
        "protocol": "Pickle Finance",
        "report_date": "2020-10-09",
        "impact": "MEDIUM",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/Strategy-Curve-scrv-v4_1/README.md#3-non-null-addresses",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/Strategy-Curve-scrv-v4_1/Pickle%20Finance%20Strategy-Curve-scrv-v4_1%20Security%20Audit%20Report.pdf"
    },
    {
        "title": "Redundant memory allocation for asset index type",
        "content": "\n`getMostPremium()` function (in here: [strategy-curve-scrv-v4_1.sol#L81](https://github.com/pickle-finance/protocol/blob/master/src/strategies/curve/strategy-curve-scrv-v4_1.sol#L81)\nreturns tuple `(address, uint256)`, which\ncontains unnecessarily huge asset index type `uint256`. Since the function \nstructure would require to update the contract anyway in case new stablecoins\nwould be added, there is no need in reserving index type sized for enormously \nhuge amount of assets. \n\nStoring asset index in a type like `uint8` would be more appropriate for now.\n\n*This issue was resolved with the following PR: https://github.com/pickle-finance/protocol/pull/6.*\n",
        "protocol": "Pickle Finance",
        "report_date": "2020-10-09",
        "impact": "LOW",
        "finders": [],
        "github_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/Strategy-Curve-scrv-v4_1/README.md#1-redundant-memory-allocation-for-asset-index-type",
        "pdf_link": "https://github.com/mixbytes/audits_public/blob/master/Pickle%20Finance/Strategy-Curve-scrv-v4_1/Pickle%20Finance%20Strategy-Curve-scrv-v4_1%20Security%20Audit%20Report.pdf"
    }
]
